<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>proxygen: folly::Timekeeper Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">proxygen
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('classfolly_1_1Timekeeper.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classfolly_1_1Timekeeper-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">folly::Timekeeper Class Reference<span class="mlabels"><span class="mlabel">abstract</span></span></div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="Future_8h_source.html">Future.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for folly::Timekeeper:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classfolly_1_1Timekeeper.png" usemap="#folly::Timekeeper_map" alt=""/>
  <map id="folly::Timekeeper_map" name="folly::Timekeeper_map">
<area href="classfolly_1_1ThreadWheelTimekeeper.html" alt="folly::ThreadWheelTimekeeper" shape="rect" coords="0,56,182,80"/>
<area href="classwangle_1_1TimekeeperTester.html" alt="wangle::TimekeeperTester" shape="rect" coords="192,56,374,80"/>
</map>
 </div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ae8c7464c45028ef28d60c87e9e0ee939"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfolly_1_1Timekeeper.html#ae8c7464c45028ef28d60c87e9e0ee939">~Timekeeper</a> ()=default</td></tr>
<tr class="separator:ae8c7464c45028ef28d60c87e9e0ee939"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1c702bd70e6c1b22ee1db289682af047"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classfolly_1_1Future.html">Future</a>&lt; <a class="el" href="structfolly_1_1Unit.html">Unit</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfolly_1_1Timekeeper.html#a1c702bd70e6c1b22ee1db289682af047">after</a> (<a class="el" href="namespacefolly.html#ad1989ff61ba788d22aa07cb22f8c5c49">Duration</a> dur)=0</td></tr>
<tr class="separator:a1c702bd70e6c1b22ee1db289682af047"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad267a3988a2df703b34b44b370738bc4"><td class="memTemplParams" colspan="2">template&lt;class Clock &gt; </td></tr>
<tr class="memitem:ad267a3988a2df703b34b44b370738bc4"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="classfolly_1_1Future.html">Future</a>&lt; <a class="el" href="structfolly_1_1Unit.html">Unit</a> &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classfolly_1_1Timekeeper.html#ad267a3988a2df703b34b44b370738bc4">at</a> (std::chrono::time_point&lt; Clock &gt; <a class="el" href="namespacefolly.html#a7ab90ae4183e3dc37f224c4f494824f9">when</a>)</td></tr>
<tr class="separator:ad267a3988a2df703b34b44b370738bc4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p><a class="el" href="structA.html">A</a> <a class="el" href="classfolly_1_1Timekeeper.html">Timekeeper</a> handles the details of keeping time and fulfilling delay promises. The returned Future&lt;Unit&gt; will either complete after the elapsed time, or in the event of some kind of exceptional error may hold an exception. These Futures respond to cancellation. If you use a lot of Delays and many of them ultimately are unneeded (as would be the case for Delays that are used to trigger timeouts of async operations), then you can and should cancel them to reclaim resources.</p>
<p>Users will typically get one of these via Future::sleep(Duration dur) or use them implicitly behind the scenes by passing a timeout to some <a class="el" href="classfolly_1_1Future.html">Future</a> operation.</p>
<p>Although we don't formally alias Delay = Future&lt;Unit&gt;, that's an appropriate term for it. People will probably also call these Timeouts, and that's ok I guess, but that term is so overloaded I thought it made sense to introduce a cleaner term.</p>
<p>Remember that Duration is a <a class="el" href="namespacestd_1_1chrono.html">std::chrono</a> duration (millisecond resolution at the time of writing). When writing code that uses specific durations, prefer using the explicit <a class="el" href="namespacestd_1_1chrono.html">std::chrono</a> type, e.g. std::chrono::milliseconds over Duration. This makes the code more legible and means you won't be unpleasantly surprised if we redefine Duration to microseconds, or something.</p>
<p>timekeeper.after(std::chrono::duration_cast&lt;Duration&gt;(someNanoseconds)) </p>

<p>Definition at line <a class="el" href="Future_8h_source.html#l02005">2005</a> of file <a class="el" href="Future_8h_source.html">Future.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="ae8c7464c45028ef28d60c87e9e0ee939"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual folly::Timekeeper::~Timekeeper </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span><span class="mlabel">default</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a1c702bd70e6c1b22ee1db289682af047"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="classfolly_1_1Future.html">Future</a>&lt;<a class="el" href="structfolly_1_1Unit.html">Unit</a>&gt; folly::Timekeeper::after </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespacefolly.html#ad1989ff61ba788d22aa07cb22f8c5c49">Duration</a>&#160;</td>
          <td class="paramname"><em>dur</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Returns a future that will complete after the given duration with the elapsed time. Exceptional errors can happen but they must be exceptional. Use the steady (monotonic) clock.</p>
<p>The consumer thread may cancel this <a class="el" href="classfolly_1_1Future.html">Future</a> to reclaim resources.</p>
<p>This future probably completes on the timer thread. You should almost certainly follow it with a <a class="el" href="namespacefolly.html#ad8577f68fd0aaeeb5a563c9cb8fe0d49">via()</a> call or the accuracy of other timers will suffer. </p>

<p>Implemented in <a class="el" href="classwangle_1_1TimekeeperTester.html#a3021823bcca9b086104444d0822fc447">wangle::TimekeeperTester</a>, and <a class="el" href="classfolly_1_1ThreadWheelTimekeeper.html#a5d81beac83d9350f595bcd63de722845">folly::ThreadWheelTimekeeper</a>.</p>

<p>Referenced by <a class="el" href="Future_8cpp_source.html#l00042">folly::futures::sleep()</a>.</p>

</div>
</div>
<a class="anchor" id="ad267a3988a2df703b34b44b370738bc4"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class Clock &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classfolly_1_1Future.html">Future</a>&lt; <a class="el" href="structfolly_1_1Unit.html">Unit</a> &gt; folly::Timekeeper::at </td>
          <td>(</td>
          <td class="paramtype">std::chrono::time_point&lt; Clock &gt;&#160;</td>
          <td class="paramname"><em>when</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Returns a future that will complete at the requested time.</p>
<p>You may cancel this <a class="el" href="classfolly_1_1Future.html">Future</a> to reclaim resources.</p>
<p>NB This is sugar for <code>after(when - now)</code>, so while you are welcome to use a std::chrono::system_clock::time_point it will not track changes to the system clock but rather execute that many milliseconds in the future according to the steady clock. </p>

<p>Definition at line <a class="el" href="Future-inl_8h_source.html#l02386">2386</a> of file <a class="el" href="Future-inl_8h_source.html">Future-inl.h</a>.</p>

<p>References <a class="el" href="classfolly_1_1Future.html#a51c0394d1f18b6aa5fad0af6528f4a3d">folly::Future&lt; T &gt;::makeFuture</a>, and <a class="el" href="TimekeeperTest_8cpp_source.html#l00031">now()</a>.</p>
<div class="fragment"><div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;                                                           {</div><div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;  <span class="keyword">auto</span> <a class="code" href="TimekeeperTest_8cpp.html#a562b4baa36dcf267f35a4ba4e0aef329">now</a> = <a class="code" href="TimekeeperTest_8cpp.html#a562b4baa36dcf267f35a4ba4e0aef329">Clock::now</a>();</div><div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;</div><div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacefolly.html#a7ab90ae4183e3dc37f224c4f494824f9">when</a> &lt;= <a class="code" href="TimekeeperTest_8cpp.html#a562b4baa36dcf267f35a4ba4e0aef329">now</a>) {</div><div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacefolly.html#a4a88b8332a4f97e85ac25c84a34be42e">makeFuture</a>();</div><div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;  }</div><div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;</div><div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classfolly_1_1Timekeeper.html#a1c702bd70e6c1b22ee1db289682af047">after</a>(std::chrono::duration_cast&lt;Duration&gt;(<a class="code" href="namespacefolly.html#a7ab90ae4183e3dc37f224c4f494824f9">when</a> - <a class="code" href="TimekeeperTest_8cpp.html#a562b4baa36dcf267f35a4ba4e0aef329">now</a>));</div><div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;}</div><div class="ttc" id="TimekeeperTest_8cpp_html_a562b4baa36dcf267f35a4ba4e0aef329"><div class="ttname"><a href="TimekeeperTest_8cpp.html#a562b4baa36dcf267f35a4ba4e0aef329">now</a></div><div class="ttdeci">std::chrono::steady_clock::time_point now()</div><div class="ttdef"><b>Definition:</b> <a href="TimekeeperTest_8cpp_source.html#l00031">TimekeeperTest.cpp:31</a></div></div>
<div class="ttc" id="namespacefolly_html_a7ab90ae4183e3dc37f224c4f494824f9"><div class="ttname"><a href="namespacefolly.html#a7ab90ae4183e3dc37f224c4f494824f9">folly::when</a></div><div class="ttdeci">Future&lt; Unit &gt; when(bool p, F &amp;&amp;thunk)</div><div class="ttdef"><b>Definition:</b> <a href="Future-inl_8h_source.html#l02330">Future-inl.h:2330</a></div></div>
<div class="ttc" id="classfolly_1_1Timekeeper_html_a1c702bd70e6c1b22ee1db289682af047"><div class="ttname"><a href="classfolly_1_1Timekeeper.html#a1c702bd70e6c1b22ee1db289682af047">folly::Timekeeper::after</a></div><div class="ttdeci">virtual Future&lt; Unit &gt; after(Duration dur)=0</div></div>
<div class="ttc" id="namespacefolly_html_a4a88b8332a4f97e85ac25c84a34be42e"><div class="ttname"><a href="namespacefolly.html#a4a88b8332a4f97e85ac25c84a34be42e">folly::makeFuture</a></div><div class="ttdeci">Future&lt; typename std::decay&lt; T &gt;::type &gt; makeFuture(T &amp;&amp;t)</div><div class="ttdef"><b>Definition:</b> <a href="Future-inl_8h_source.html#l01310">Future-inl.h:1310</a></div></div>
</div><!-- fragment -->
</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>proxygen/folly/folly/futures/<a class="el" href="Future_8h_source.html">Future.h</a></li>
<li>proxygen/folly/folly/futures/<a class="el" href="Future-inl_8h_source.html">Future-inl.h</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacefolly.html">folly</a></li><li class="navelem"><a class="el" href="classfolly_1_1Timekeeper.html">Timekeeper</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
