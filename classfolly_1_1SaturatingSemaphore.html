<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>proxygen: folly::SaturatingSemaphore&lt; MayBlock, Atom &gt; Class Template Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">proxygen
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('classfolly_1_1SaturatingSemaphore.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pri-types">Private Types</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classfolly_1_1SaturatingSemaphore-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">folly::SaturatingSemaphore&lt; MayBlock, Atom &gt; Class Template Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="SaturatingSemaphore_8h_source.html">SaturatingSemaphore.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a4fc29a70a450249487537f26e7ee3ce3"><td class="memItemLeft" align="right" valign="top">constexpr&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfolly_1_1SaturatingSemaphore.html#a4fc29a70a450249487537f26e7ee3ce3">SaturatingSemaphore</a> () noexcept</td></tr>
<tr class="separator:a4fc29a70a450249487537f26e7ee3ce3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f68577224874a99a8b7c974aa4b995d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfolly_1_1SaturatingSemaphore.html#a6f68577224874a99a8b7c974aa4b995d">~SaturatingSemaphore</a> ()</td></tr>
<tr class="separator:a6f68577224874a99a8b7c974aa4b995d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9e7d5cec3c5f5dfc89ad22a766885abd"><td class="memItemLeft" align="right" valign="top"><a class="el" href="CPortability_8h.html#a416be07eb9da776690749a070a87d72e">FOLLY_ALWAYS_INLINE</a> bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfolly_1_1SaturatingSemaphore.html#a9e7d5cec3c5f5dfc89ad22a766885abd">ready</a> () const noexcept</td></tr>
<tr class="separator:a9e7d5cec3c5f5dfc89ad22a766885abd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a32a1060763f66259b5a83fd2192b95d1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfolly_1_1SaturatingSemaphore.html#a32a1060763f66259b5a83fd2192b95d1">reset</a> () noexcept</td></tr>
<tr class="separator:a32a1060763f66259b5a83fd2192b95d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a98dd0f43d7c05a4ae774300f54148d46"><td class="memItemLeft" align="right" valign="top"><a class="el" href="CPortability_8h.html#a416be07eb9da776690749a070a87d72e">FOLLY_ALWAYS_INLINE</a> void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfolly_1_1SaturatingSemaphore.html#a98dd0f43d7c05a4ae774300f54148d46">post</a> () noexcept</td></tr>
<tr class="separator:a98dd0f43d7c05a4ae774300f54148d46"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adf173edb446c2bc62aa384be2d419506"><td class="memItemLeft" align="right" valign="top"><a class="el" href="CPortability_8h.html#a416be07eb9da776690749a070a87d72e">FOLLY_ALWAYS_INLINE</a> void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfolly_1_1SaturatingSemaphore.html#adf173edb446c2bc62aa384be2d419506">wait</a> (const <a class="el" href="classfolly_1_1WaitOptions.html">WaitOptions</a> &amp;opt=<a class="el" href="classfolly_1_1SaturatingSemaphore.html#a8ea771ca38d5ffb4f95aa89f358e8370">wait_options</a>()) noexcept</td></tr>
<tr class="separator:adf173edb446c2bc62aa384be2d419506"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e96793510e324939b540ea52bb2a51e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="CPortability_8h.html#a416be07eb9da776690749a070a87d72e">FOLLY_ALWAYS_INLINE</a> bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfolly_1_1SaturatingSemaphore.html#a1e96793510e324939b540ea52bb2a51e">try_wait</a> () noexcept</td></tr>
<tr class="separator:a1e96793510e324939b540ea52bb2a51e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a65c98507c78300f2ebc66c761bd83669"><td class="memTemplParams" colspan="2">template&lt;typename Clock , typename Duration &gt; </td></tr>
<tr class="memitem:a65c98507c78300f2ebc66c761bd83669"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="CPortability_8h.html#a416be07eb9da776690749a070a87d72e">FOLLY_ALWAYS_INLINE</a> bool&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classfolly_1_1SaturatingSemaphore.html#a65c98507c78300f2ebc66c761bd83669">try_wait_until</a> (const std::chrono::time_point&lt; Clock, <a class="el" href="namespacefolly.html#ad1989ff61ba788d22aa07cb22f8c5c49">Duration</a> &gt; &amp;deadline, const <a class="el" href="classfolly_1_1WaitOptions.html">WaitOptions</a> &amp;opt=<a class="el" href="classfolly_1_1SaturatingSemaphore.html#a8ea771ca38d5ffb4f95aa89f358e8370">wait_options</a>()) noexcept</td></tr>
<tr class="separator:a65c98507c78300f2ebc66c761bd83669"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8b3c88a1b940947f8c924c540f82ac35"><td class="memTemplParams" colspan="2">template&lt;class Rep , class Period &gt; </td></tr>
<tr class="memitem:a8b3c88a1b940947f8c924c540f82ac35"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="CPortability_8h.html#a416be07eb9da776690749a070a87d72e">FOLLY_ALWAYS_INLINE</a> bool&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classfolly_1_1SaturatingSemaphore.html#a8b3c88a1b940947f8c924c540f82ac35">try_wait_for</a> (const std::chrono::duration&lt; Rep, Period &gt; &amp;duration, const <a class="el" href="classfolly_1_1WaitOptions.html">WaitOptions</a> &amp;opt=<a class="el" href="classfolly_1_1SaturatingSemaphore.html#a8ea771ca38d5ffb4f95aa89f358e8370">wait_options</a>()) noexcept</td></tr>
<tr class="separator:a8b3c88a1b940947f8c924c540f82ac35"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad48e94f3040b35fe54438b49ddbf90d1"><td class="memTemplParams" colspan="2">template&lt;typename Clock , typename Duration &gt; </td></tr>
<tr class="memitem:ad48e94f3040b35fe54438b49ddbf90d1"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="CPortability_8h.html#a86b2395409bf2e155ebd8046a73945b1">FOLLY_NOINLINE</a> bool&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classfolly_1_1SaturatingSemaphore.html#ad48e94f3040b35fe54438b49ddbf90d1">tryWaitSlow</a> (const std::chrono::time_point&lt; Clock, <a class="el" href="namespacefolly.html#ad1989ff61ba788d22aa07cb22f8c5c49">Duration</a> &gt; &amp;deadline, const <a class="el" href="classfolly_1_1WaitOptions.html">WaitOptions</a> &amp;opt) noexcept</td></tr>
<tr class="separator:ad48e94f3040b35fe54438b49ddbf90d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:a8ea771ca38d5ffb4f95aa89f358e8370"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="CPortability_8h.html#a416be07eb9da776690749a070a87d72e">FOLLY_ALWAYS_INLINE</a> <a class="el" href="classfolly_1_1WaitOptions.html">WaitOptions</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfolly_1_1SaturatingSemaphore.html#a8ea771ca38d5ffb4f95aa89f358e8370">wait_options</a> ()</td></tr>
<tr class="separator:a8ea771ca38d5ffb4f95aa89f358e8370"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-types"></a>
Private Types</h2></td></tr>
<tr class="memitem:a7ca991102530faf43fd862b1d680f19a"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfolly_1_1SaturatingSemaphore.html#a7ca991102530faf43fd862b1d680f19a">State</a> : uint32_t { <a class="el" href="classfolly_1_1SaturatingSemaphore.html#a7ca991102530faf43fd862b1d680f19aaa70a218ca24fa01f7be41be89b2a6288">NOTREADY</a> = 0, 
<a class="el" href="classfolly_1_1SaturatingSemaphore.html#a7ca991102530faf43fd862b1d680f19aa9fcb6dac32fc3eea095546639779b6fe">READY</a> = 1, 
<a class="el" href="classfolly_1_1SaturatingSemaphore.html#a7ca991102530faf43fd862b1d680f19aa397af9390ec9483f8cec3264f42f01d1">BLOCKED</a> = 2
 }</td></tr>
<tr class="separator:a7ca991102530faf43fd862b1d680f19a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a960b5c8c0fb7571cf99151e1dca3f955"><td class="memItemLeft" align="right" valign="top"><a class="el" href="CPortability_8h.html#a416be07eb9da776690749a070a87d72e">FOLLY_ALWAYS_INLINE</a> void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfolly_1_1SaturatingSemaphore.html#a960b5c8c0fb7571cf99151e1dca3f955">postFastWaiterMayBlock</a> () noexcept</td></tr>
<tr class="separator:a960b5c8c0fb7571cf99151e1dca3f955"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9e3508e74ec7e0abc6365f59b20dd79f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfolly_1_1SaturatingSemaphore.html#a9e3508e74ec7e0abc6365f59b20dd79f">postSlowWaiterMayBlock</a> (<a class="el" href="ConstexprMathBenchmark_8cpp.html#a09a1e304d66d35dd47daffee9731edaa">uint32_t</a> before) noexcept</td></tr>
<tr class="separator:a9e3508e74ec7e0abc6365f59b20dd79f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae0e69ea25164cd5e3271b3d22c7df87d"><td class="memTemplParams" colspan="2">template&lt;typename Clock , typename Duration &gt; </td></tr>
<tr class="memitem:ae0e69ea25164cd5e3271b3d22c7df87d"><td class="memTemplItemLeft" align="right" valign="top">bool&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classfolly_1_1SaturatingSemaphore.html#ae0e69ea25164cd5e3271b3d22c7df87d">tryWaitSlow</a> (const std::chrono::time_point&lt; Clock, <a class="el" href="namespacefolly.html#ad1989ff61ba788d22aa07cb22f8c5c49">Duration</a> &gt; &amp;deadline, const <a class="el" href="classfolly_1_1WaitOptions.html">WaitOptions</a> &amp;opt) noexcept</td></tr>
<tr class="separator:ae0e69ea25164cd5e3271b3d22c7df87d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:aab910e4a30d1966f37545b37e39cd5e9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacefolly_1_1detail.html#a119b8d460f481815f833da41cdc33141">detail::Futex</a>&lt; <a class="el" href="ConcurrentHashMapTest_8cpp.html#a98ac53dd3c18b4046e7c5cb0bcb64b75">Atom</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfolly_1_1SaturatingSemaphore.html#aab910e4a30d1966f37545b37e39cd5e9">state_</a></td></tr>
<tr class="separator:aab910e4a30d1966f37545b37e39cd5e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><h3>template&lt;bool MayBlock, template&lt; typename &gt; class Atom = std::atomic&gt;<br />
class folly::SaturatingSemaphore&lt; MayBlock, Atom &gt;</h3>

<p><a class="el" href="classfolly_1_1SaturatingSemaphore.html">SaturatingSemaphore</a> is a flag that allows concurrent posting by multiple posters and concurrent non-destructive waiting by multiple waiters.</p>
<p><a class="el" href="structA.html">A</a> <a class="el" href="classfolly_1_1SaturatingSemaphore.html">SaturatingSemaphore</a> allows one or more waiter threads to check, spin, or block, indefinitely or with timeout, for a flag to be set by one or more poster threads. By setting the flag, posters announce to waiters (that may be already waiting or will check the flag in the future) that some condition is true. Posts to an already set flag are idempotent.</p>
<p><a class="el" href="classfolly_1_1SaturatingSemaphore.html">SaturatingSemaphore</a> is called so because it behaves like a hybrid binary/counted <em>semaphore</em> with values zero and infinity, and <a class="el" href="classfolly_1_1SaturatingSemaphore.html#a98dd0f43d7c05a4ae774300f54148d46">post()</a> and <a class="el" href="classfolly_1_1SaturatingSemaphore.html#adf173edb446c2bc62aa384be2d419506">wait()</a> functions. It is called <em>saturating</em> because one <a class="el" href="classfolly_1_1SaturatingSemaphore.html#a98dd0f43d7c05a4ae774300f54148d46">post()</a> is enough to set it to infinity and to satisfy any number of <a class="el" href="classfolly_1_1SaturatingSemaphore.html#adf173edb446c2bc62aa384be2d419506">wait()</a>-s. Once set (to infinity) it remains unchanged by subsequent <a class="el" href="classfolly_1_1SaturatingSemaphore.html#a98dd0f43d7c05a4ae774300f54148d46">post()</a>-s and <a class="el" href="classfolly_1_1SaturatingSemaphore.html#adf173edb446c2bc62aa384be2d419506">wait()</a>-s, until it is <a class="el" href="classfolly_1_1SaturatingSemaphore.html#a32a1060763f66259b5a83fd2192b95d1">reset()</a> back to zero.</p>
<p>The implementation of <a class="el" href="classfolly_1_1SaturatingSemaphore.html">SaturatingSemaphore</a> is based on that of <a class="el" href="classfolly_1_1Baton.html">Baton</a>. It includes no internal padding, and is only 4 bytes in size. Any alignment or padding to avoid false sharing is up to the user. <a class="el" href="classfolly_1_1SaturatingSemaphore.html">SaturatingSemaphore</a> differs from <a class="el" href="classfolly_1_1Baton.html">Baton</a> as follows:</p><ul>
<li><a class="el" href="classfolly_1_1Baton.html">Baton</a> allows at most one call to <a class="el" href="classfolly_1_1SaturatingSemaphore.html#a98dd0f43d7c05a4ae774300f54148d46">post()</a>; this allows any number and concurrently.</li>
<li><a class="el" href="classfolly_1_1Baton.html">Baton</a> allows at most one successful call to any wait variant; this allows any number and concurrently.</li>
</ul>
<p>Template parameter:</p><ul>
<li>bool MayBlock: If false, waiting operations spin only. If true, timed and wait operations may block; adds an atomic instruction to the critical path of posters.</li>
</ul>
<p>Wait options: <a class="el" href="classfolly_1_1WaitOptions.html">WaitOptions</a> contains optional per call setting for spin-max duration: Calls to <a class="el" href="classfolly_1_1SaturatingSemaphore.html#adf173edb446c2bc62aa384be2d419506">wait()</a>, <a class="el" href="classfolly_1_1SaturatingSemaphore.html#a65c98507c78300f2ebc66c761bd83669">try_wait_until()</a>, and <a class="el" href="classfolly_1_1SaturatingSemaphore.html#a8b3c88a1b940947f8c924c540f82ac35">try_wait_for()</a> block only after the passage of the spin-max period. The default spin-max duration is 10 usec. The spin-max option is applicable only if MayBlock is true.</p>
<p>Functions: bool <a class="el" href="classfolly_1_1SaturatingSemaphore.html#a9e7d5cec3c5f5dfc89ad22a766885abd">ready()</a>: Returns true if the flag is set by a call to post, otherwise false. Equivalent to try_wait, but available on const receivers. void <a class="el" href="classfolly_1_1SaturatingSemaphore.html#a32a1060763f66259b5a83fd2192b95d1">reset()</a>; Clears the flag. void <a class="el" href="classfolly_1_1SaturatingSemaphore.html#a98dd0f43d7c05a4ae774300f54148d46">post()</a>; Sets the flag and wakes all current waiters, i.e., causes all concurrent calls to wait, try_wait_for, and try_wait_until to return. void wait( <a class="el" href="classfolly_1_1WaitOptions.html">WaitOptions</a> opt = <a class="el" href="classfolly_1_1SaturatingSemaphore.html#a8ea771ca38d5ffb4f95aa89f358e8370">wait_options()</a>); Waits for the flag to be set by a call to post. bool <a class="el" href="classfolly_1_1SaturatingSemaphore.html#a1e96793510e324939b540ea52bb2a51e">try_wait()</a>; Returns true if the flag is set by a call to post, otherwise false. bool try_wait_until( time_point&amp; deadline, <a class="el" href="classfolly_1_1WaitOptions.html">WaitOptions</a>&amp; = <a class="el" href="classfolly_1_1SaturatingSemaphore.html#a8ea771ca38d5ffb4f95aa89f358e8370">wait_options()</a>); Returns true if the flag is set by a call to post before the deadline, otherwise false. bool try_wait_for( duration&amp;, <a class="el" href="classfolly_1_1WaitOptions.html">WaitOptions</a>&amp; = <a class="el" href="classfolly_1_1SaturatingSemaphore.html#a8ea771ca38d5ffb4f95aa89f358e8370">wait_options()</a>); Returns true if the flag is set by a call to post before the expiration of the specified duration, otherwise false.</p>
<p>Usage: </p><div class="fragment"><div class="line"><a class="code" href="classfolly_1_1SaturatingSemaphore.html#a4fc29a70a450249487537f26e7ee3ce3">SaturatingSemaphore</a>&lt;<span class="comment">/* MayBlock = */</span> <span class="keyword">true</span>&gt; <a class="code" href="PushmiBenchmarks_8cpp.html#ad94c2c2f9fd35a12cc099962b7540071">f</a>;</div><div class="line"><a class="code" href="fizz_2build___2gtest_2src_2gtest_2googletest_2include_2gtest_2gtest_8h.html#a8197fa52f3538588d20d8af4834c9003">ASSERT_FALSE</a>(<a class="code" href="PushmiBenchmarks_8cpp.html#ad94c2c2f9fd35a12cc099962b7540071">f</a>.try_wait());</div><div class="line"><a class="code" href="fizz_2build___2gtest_2src_2gtest_2googletest_2include_2gtest_2gtest_8h.html#a8197fa52f3538588d20d8af4834c9003">ASSERT_FALSE</a>(<a class="code" href="PushmiBenchmarks_8cpp.html#ad94c2c2f9fd35a12cc099962b7540071">f</a>.try_wait_until(</div><div class="line">    <a class="code" href="TimekeeperTest_8cpp.html#a562b4baa36dcf267f35a4ba4e0aef329">std::chrono::steady_clock::now</a>() + std::chrono::microseconds(1)));</div><div class="line"><a class="code" href="fizz_2build___2gtest_2src_2gtest_2googletest_2include_2gtest_2gtest_8h.html#a8197fa52f3538588d20d8af4834c9003">ASSERT_FALSE</a>(<a class="code" href="PushmiBenchmarks_8cpp.html#ad94c2c2f9fd35a12cc099962b7540071">f</a>.try_wait_until(</div><div class="line">    <a class="code" href="TimekeeperTest_8cpp.html#a562b4baa36dcf267f35a4ba4e0aef329">std::chrono::steady_clock::now</a>() + std::chrono::microseconds(1),</div><div class="line">    <a class="code" href="PushmiBenchmarks_8cpp.html#ad94c2c2f9fd35a12cc099962b7540071">f</a>.wait_options().spin_max(std::chrono::microseconds(1))));</div><div class="line"><a class="code" href="PushmiBenchmarks_8cpp.html#ad94c2c2f9fd35a12cc099962b7540071">f</a>.post();</div><div class="line"><a class="code" href="PushmiBenchmarks_8cpp.html#ad94c2c2f9fd35a12cc099962b7540071">f</a>.post();</div><div class="line"><a class="code" href="PushmiBenchmarks_8cpp.html#ad94c2c2f9fd35a12cc099962b7540071">f</a>.wait();</div><div class="line"><a class="code" href="PushmiBenchmarks_8cpp.html#ad94c2c2f9fd35a12cc099962b7540071">f</a>.wait(<a class="code" href="PushmiBenchmarks_8cpp.html#ad94c2c2f9fd35a12cc099962b7540071">f</a>.wait_options().spin_max(std::chrono::nanoseconds(100)));</div><div class="line"><a class="code" href="fizz_2build___2gtest_2src_2gtest_2googletest_2include_2gtest_2gtest_8h.html#ae9244bfbda562e8b798789b001993fa5">ASSERT_TRUE</a>(<a class="code" href="PushmiBenchmarks_8cpp.html#ad94c2c2f9fd35a12cc099962b7540071">f</a>.try_wait());</div><div class="line"><a class="code" href="fizz_2build___2gtest_2src_2gtest_2googletest_2include_2gtest_2gtest_8h.html#ae9244bfbda562e8b798789b001993fa5">ASSERT_TRUE</a>(<a class="code" href="PushmiBenchmarks_8cpp.html#ad94c2c2f9fd35a12cc099962b7540071">f</a>.try_wait_until(</div><div class="line">    <a class="code" href="TimekeeperTest_8cpp.html#a562b4baa36dcf267f35a4ba4e0aef329">std::chrono::steady_clock::now</a>() + std::chrono::microseconds(1)));</div><div class="line"><a class="code" href="PushmiBenchmarks_8cpp.html#ad94c2c2f9fd35a12cc099962b7540071">f</a>.wait();</div><div class="line"><a class="code" href="PushmiBenchmarks_8cpp.html#ad94c2c2f9fd35a12cc099962b7540071">f</a>.reset();</div><div class="line"><a class="code" href="fizz_2build___2gtest_2src_2gtest_2googletest_2include_2gtest_2gtest_8h.html#a8197fa52f3538588d20d8af4834c9003">ASSERT_FALSE</a>(<a class="code" href="PushmiBenchmarks_8cpp.html#ad94c2c2f9fd35a12cc099962b7540071">f</a>.try_wait());</div></div><!-- fragment --> 
<p>Definition at line <a class="el" href="SaturatingSemaphore_8h_source.html#l00120">120</a> of file <a class="el" href="SaturatingSemaphore_8h_source.html">SaturatingSemaphore.h</a>.</p>
</div><h2 class="groupheader">Member Enumeration Documentation</h2>
<a class="anchor" id="a7ca991102530faf43fd862b1d680f19a"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;bool MayBlock, template&lt; typename &gt; class Atom = std::atomic&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="classfolly_1_1SaturatingSemaphore.html#a7ca991102530faf43fd862b1d680f19a">folly::SaturatingSemaphore::State</a> : <a class="el" href="ConstexprMathBenchmark_8cpp.html#a09a1e304d66d35dd47daffee9731edaa">uint32_t</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a class="anchor" id="a7ca991102530faf43fd862b1d680f19aaa70a218ca24fa01f7be41be89b2a6288"></a>NOTREADY&#160;</td><td class="fielddoc">
</td></tr>
<tr><td class="fieldname"><a class="anchor" id="a7ca991102530faf43fd862b1d680f19aa9fcb6dac32fc3eea095546639779b6fe"></a>READY&#160;</td><td class="fielddoc">
</td></tr>
<tr><td class="fieldname"><a class="anchor" id="a7ca991102530faf43fd862b1d680f19aa397af9390ec9483f8cec3264f42f01d1"></a>BLOCKED&#160;</td><td class="fielddoc">
</td></tr>
</table>

<p>Definition at line <a class="el" href="SaturatingSemaphore_8h_source.html#l00123">123</a> of file <a class="el" href="SaturatingSemaphore_8h_source.html">SaturatingSemaphore.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;             : <a class="code" href="ConstexprMathBenchmark_8cpp.html#a09a1e304d66d35dd47daffee9731edaa">uint32_t</a> {</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <a class="code" href="classfolly_1_1SaturatingSemaphore.html#a7ca991102530faf43fd862b1d680f19aaa70a218ca24fa01f7be41be89b2a6288">NOTREADY</a> = 0,</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <a class="code" href="classfolly_1_1SaturatingSemaphore.html#a7ca991102530faf43fd862b1d680f19aa9fcb6dac32fc3eea095546639779b6fe">READY</a> = 1,</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <a class="code" href="classfolly_1_1SaturatingSemaphore.html#a7ca991102530faf43fd862b1d680f19aa397af9390ec9483f8cec3264f42f01d1">BLOCKED</a> = 2,</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  };</div><div class="ttc" id="classfolly_1_1SaturatingSemaphore_html_a7ca991102530faf43fd862b1d680f19aa397af9390ec9483f8cec3264f42f01d1"><div class="ttname"><a href="classfolly_1_1SaturatingSemaphore.html#a7ca991102530faf43fd862b1d680f19aa397af9390ec9483f8cec3264f42f01d1">folly::SaturatingSemaphore::BLOCKED</a></div><div class="ttdef"><b>Definition:</b> <a href="SaturatingSemaphore_8h_source.html#l00126">SaturatingSemaphore.h:126</a></div></div>
<div class="ttc" id="classfolly_1_1SaturatingSemaphore_html_a7ca991102530faf43fd862b1d680f19aa9fcb6dac32fc3eea095546639779b6fe"><div class="ttname"><a href="classfolly_1_1SaturatingSemaphore.html#a7ca991102530faf43fd862b1d680f19aa9fcb6dac32fc3eea095546639779b6fe">folly::SaturatingSemaphore::READY</a></div><div class="ttdef"><b>Definition:</b> <a href="SaturatingSemaphore_8h_source.html#l00125">SaturatingSemaphore.h:125</a></div></div>
<div class="ttc" id="ConstexprMathBenchmark_8cpp_html_a09a1e304d66d35dd47daffee9731edaa"><div class="ttname"><a href="ConstexprMathBenchmark_8cpp.html#a09a1e304d66d35dd47daffee9731edaa">uint32_t</a></div><div class="ttdeci">uint32_t</div><div class="ttdef"><b>Definition:</b> <a href="ConstexprMathBenchmark_8cpp_source.html#l00186">ConstexprMathBenchmark.cpp:186</a></div></div>
<div class="ttc" id="classfolly_1_1SaturatingSemaphore_html_a7ca991102530faf43fd862b1d680f19aaa70a218ca24fa01f7be41be89b2a6288"><div class="ttname"><a href="classfolly_1_1SaturatingSemaphore.html#a7ca991102530faf43fd862b1d680f19aaa70a218ca24fa01f7be41be89b2a6288">folly::SaturatingSemaphore::NOTREADY</a></div><div class="ttdef"><b>Definition:</b> <a href="SaturatingSemaphore_8h_source.html#l00124">SaturatingSemaphore.h:124</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a4fc29a70a450249487537f26e7ee3ce3"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;bool MayBlock, template&lt; typename &gt; class Atom = std::atomic&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">constexpr <a class="el" href="classfolly_1_1SaturatingSemaphore.html">folly::SaturatingSemaphore</a>&lt; MayBlock, <a class="el" href="ConcurrentHashMapTest_8cpp.html#a98ac53dd3c18b4046e7c5cb0bcb64b75">Atom</a> &gt;::<a class="el" href="classfolly_1_1SaturatingSemaphore.html">SaturatingSemaphore</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>constructor </p>

<p>Definition at line <a class="el" href="SaturatingSemaphore_8h_source.html#l00135">135</a> of file <a class="el" href="SaturatingSemaphore_8h_source.html">SaturatingSemaphore.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;: <a class="code" href="classfolly_1_1SaturatingSemaphore.html#aab910e4a30d1966f37545b37e39cd5e9">state_</a>(<a class="code" href="classfolly_1_1SaturatingSemaphore.html#a7ca991102530faf43fd862b1d680f19aaa70a218ca24fa01f7be41be89b2a6288">NOTREADY</a>) {}</div><div class="ttc" id="classfolly_1_1SaturatingSemaphore_html_aab910e4a30d1966f37545b37e39cd5e9"><div class="ttname"><a href="classfolly_1_1SaturatingSemaphore.html#aab910e4a30d1966f37545b37e39cd5e9">folly::SaturatingSemaphore::state_</a></div><div class="ttdeci">detail::Futex&lt; Atom &gt; state_</div><div class="ttdef"><b>Definition:</b> <a href="SaturatingSemaphore_8h_source.html#l00121">SaturatingSemaphore.h:121</a></div></div>
<div class="ttc" id="classfolly_1_1SaturatingSemaphore_html_a7ca991102530faf43fd862b1d680f19aaa70a218ca24fa01f7be41be89b2a6288"><div class="ttname"><a href="classfolly_1_1SaturatingSemaphore.html#a7ca991102530faf43fd862b1d680f19aaa70a218ca24fa01f7be41be89b2a6288">folly::SaturatingSemaphore::NOTREADY</a></div><div class="ttdef"><b>Definition:</b> <a href="SaturatingSemaphore_8h_source.html#l00124">SaturatingSemaphore.h:124</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a6f68577224874a99a8b7c974aa4b995d"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;bool MayBlock, template&lt; typename &gt; class Atom = std::atomic&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classfolly_1_1SaturatingSemaphore.html">folly::SaturatingSemaphore</a>&lt; MayBlock, <a class="el" href="ConcurrentHashMapTest_8cpp.html#a98ac53dd3c18b4046e7c5cb0bcb64b75">Atom</a> &gt;::~<a class="el" href="classfolly_1_1SaturatingSemaphore.html">SaturatingSemaphore</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>destructor </p>

<p>Definition at line <a class="el" href="SaturatingSemaphore_8h_source.html#l00138">138</a> of file <a class="el" href="SaturatingSemaphore_8h_source.html">SaturatingSemaphore.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;{}</div></div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a98dd0f43d7c05a4ae774300f54148d46"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;bool MayBlock, template&lt; typename &gt; class Atom = std::atomic&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="CPortability_8h.html#a416be07eb9da776690749a070a87d72e">FOLLY_ALWAYS_INLINE</a> void <a class="el" href="classfolly_1_1SaturatingSemaphore.html">folly::SaturatingSemaphore</a>&lt; MayBlock, <a class="el" href="ConcurrentHashMapTest_8cpp.html#a98ac53dd3c18b4046e7c5cb0bcb64b75">Atom</a> &gt;::post </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>post </p>

<p>Definition at line <a class="el" href="SaturatingSemaphore_8h_source.html#l00151">151</a> of file <a class="el" href="SaturatingSemaphore_8h_source.html">SaturatingSemaphore.h</a>.</p>

<p>Referenced by <a class="el" href="UnboundedQueue_8h_source.html#l00750">folly::UnboundedQueue&lt; T, SingleProducer, SingleConsumer, MayBlock, LgSegmentSize, LgAlign, Atom &gt;::Entry::putItem()</a>, <a class="el" href="SaturatingSemaphoreTest_8cpp_source.html#l00027">run_basic_test()</a>, <a class="el" href="SaturatingSemaphoreTest_8cpp_source.html#l00073">run_multi_poster_multi_waiter_test()</a>, <a class="el" href="FlatCombining_8h_source.html#l00159">folly::FlatCombining&lt; T, Mutex, Atom, Req &gt;::Rec::setDisconnected()</a>, <a class="el" href="FlatCombining_8h_source.html#l00143">folly::FlatCombining&lt; T, Mutex, Atom, Req &gt;::Rec::setDone()</a>, <a class="el" href="FlatCombining_8h_source.html#l00537">folly::FlatCombining&lt; FcSimpleExample&lt; Mutex, Atom &gt;, Mutex, Atom &gt;::setPending()</a>, <a class="el" href="FlatCombining_8h_source.html#l00131">folly::FlatCombining&lt; T, Mutex, Atom, Req &gt;::Rec::setValid()</a>, and <a class="el" href="MultiFilePollerTest_8cpp_source.html#l00069">TEST_F()</a>.</p>
<div class="fragment"><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;                                           {</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <span class="keywordflow">if</span> (!MayBlock) {</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;      <a class="code" href="classfolly_1_1SaturatingSemaphore.html#aab910e4a30d1966f37545b37e39cd5e9">state_</a>.store(<a class="code" href="classfolly_1_1SaturatingSemaphore.html#a7ca991102530faf43fd862b1d680f19aa9fcb6dac32fc3eea095546639779b6fe">READY</a>, std::memory_order_release);</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;      <a class="code" href="classfolly_1_1SaturatingSemaphore.html#a960b5c8c0fb7571cf99151e1dca3f955">postFastWaiterMayBlock</a>();</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    }</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  }</div><div class="ttc" id="classfolly_1_1SaturatingSemaphore_html_a960b5c8c0fb7571cf99151e1dca3f955"><div class="ttname"><a href="classfolly_1_1SaturatingSemaphore.html#a960b5c8c0fb7571cf99151e1dca3f955">folly::SaturatingSemaphore::postFastWaiterMayBlock</a></div><div class="ttdeci">FOLLY_ALWAYS_INLINE void postFastWaiterMayBlock() noexcept</div><div class="ttdef"><b>Definition:</b> <a href="SaturatingSemaphore_8h_source.html#l00194">SaturatingSemaphore.h:194</a></div></div>
<div class="ttc" id="classfolly_1_1SaturatingSemaphore_html_aab910e4a30d1966f37545b37e39cd5e9"><div class="ttname"><a href="classfolly_1_1SaturatingSemaphore.html#aab910e4a30d1966f37545b37e39cd5e9">folly::SaturatingSemaphore::state_</a></div><div class="ttdeci">detail::Futex&lt; Atom &gt; state_</div><div class="ttdef"><b>Definition:</b> <a href="SaturatingSemaphore_8h_source.html#l00121">SaturatingSemaphore.h:121</a></div></div>
<div class="ttc" id="classfolly_1_1SaturatingSemaphore_html_a7ca991102530faf43fd862b1d680f19aa9fcb6dac32fc3eea095546639779b6fe"><div class="ttname"><a href="classfolly_1_1SaturatingSemaphore.html#a7ca991102530faf43fd862b1d680f19aa9fcb6dac32fc3eea095546639779b6fe">folly::SaturatingSemaphore::READY</a></div><div class="ttdef"><b>Definition:</b> <a href="SaturatingSemaphore_8h_source.html#l00125">SaturatingSemaphore.h:125</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a960b5c8c0fb7571cf99151e1dca3f955"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;bool MayBlock, template&lt; typename &gt; class Atom = std::atomic&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="CPortability_8h.html#a416be07eb9da776690749a070a87d72e">FOLLY_ALWAYS_INLINE</a> void <a class="el" href="classfolly_1_1SaturatingSemaphore.html">folly::SaturatingSemaphore</a>&lt; MayBlock, <a class="el" href="ConcurrentHashMapTest_8cpp.html#a98ac53dd3c18b4046e7c5cb0bcb64b75">Atom</a> &gt;::postFastWaiterMayBlock </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="SaturatingSemaphore_8h_source.html#l00194">194</a> of file <a class="el" href="SaturatingSemaphore_8h_source.html">SaturatingSemaphore.h</a>.</p>

<p>Referenced by <a class="el" href="SaturatingSemaphore_8h_source.html#l00151">folly::SaturatingSemaphore&lt; true, Atom &gt;::post()</a>.</p>
<div class="fragment"><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                                                             {</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <a class="code" href="ConstexprMathBenchmark_8cpp.html#a09a1e304d66d35dd47daffee9731edaa">uint32_t</a> before = <a class="code" href="classfolly_1_1SaturatingSemaphore.html#a7ca991102530faf43fd862b1d680f19aaa70a218ca24fa01f7be41be89b2a6288">NOTREADY</a>;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="Likely_8h.html#affde14445f49f65ff4f5b592e44ee71a">LIKELY</a>(<a class="code" href="classfolly_1_1SaturatingSemaphore.html#aab910e4a30d1966f37545b37e39cd5e9">state_</a>.compare_exchange_strong(</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;            before,</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;            <a class="code" href="classfolly_1_1SaturatingSemaphore.html#a7ca991102530faf43fd862b1d680f19aa9fcb6dac32fc3eea095546639779b6fe">READY</a>,</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;            std::memory_order_release,</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;            std::memory_order_relaxed))) {</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    }</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <a class="code" href="classfolly_1_1SaturatingSemaphore.html#a9e3508e74ec7e0abc6365f59b20dd79f">postSlowWaiterMayBlock</a>(before);</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  }</div><div class="ttc" id="Likely_8h_html_affde14445f49f65ff4f5b592e44ee71a"><div class="ttname"><a href="Likely_8h.html#affde14445f49f65ff4f5b592e44ee71a">LIKELY</a></div><div class="ttdeci">#define LIKELY(x)</div><div class="ttdef"><b>Definition:</b> <a href="Likely_8h_source.html#l00047">Likely.h:47</a></div></div>
<div class="ttc" id="classfolly_1_1SaturatingSemaphore_html_aab910e4a30d1966f37545b37e39cd5e9"><div class="ttname"><a href="classfolly_1_1SaturatingSemaphore.html#aab910e4a30d1966f37545b37e39cd5e9">folly::SaturatingSemaphore::state_</a></div><div class="ttdeci">detail::Futex&lt; Atom &gt; state_</div><div class="ttdef"><b>Definition:</b> <a href="SaturatingSemaphore_8h_source.html#l00121">SaturatingSemaphore.h:121</a></div></div>
<div class="ttc" id="classfolly_1_1SaturatingSemaphore_html_a7ca991102530faf43fd862b1d680f19aa9fcb6dac32fc3eea095546639779b6fe"><div class="ttname"><a href="classfolly_1_1SaturatingSemaphore.html#a7ca991102530faf43fd862b1d680f19aa9fcb6dac32fc3eea095546639779b6fe">folly::SaturatingSemaphore::READY</a></div><div class="ttdef"><b>Definition:</b> <a href="SaturatingSemaphore_8h_source.html#l00125">SaturatingSemaphore.h:125</a></div></div>
<div class="ttc" id="ConstexprMathBenchmark_8cpp_html_a09a1e304d66d35dd47daffee9731edaa"><div class="ttname"><a href="ConstexprMathBenchmark_8cpp.html#a09a1e304d66d35dd47daffee9731edaa">uint32_t</a></div><div class="ttdeci">uint32_t</div><div class="ttdef"><b>Definition:</b> <a href="ConstexprMathBenchmark_8cpp_source.html#l00186">ConstexprMathBenchmark.cpp:186</a></div></div>
<div class="ttc" id="classfolly_1_1SaturatingSemaphore_html_a7ca991102530faf43fd862b1d680f19aaa70a218ca24fa01f7be41be89b2a6288"><div class="ttname"><a href="classfolly_1_1SaturatingSemaphore.html#a7ca991102530faf43fd862b1d680f19aaa70a218ca24fa01f7be41be89b2a6288">folly::SaturatingSemaphore::NOTREADY</a></div><div class="ttdef"><b>Definition:</b> <a href="SaturatingSemaphore_8h_source.html#l00124">SaturatingSemaphore.h:124</a></div></div>
<div class="ttc" id="classfolly_1_1SaturatingSemaphore_html_a9e3508e74ec7e0abc6365f59b20dd79f"><div class="ttname"><a href="classfolly_1_1SaturatingSemaphore.html#a9e3508e74ec7e0abc6365f59b20dd79f">folly::SaturatingSemaphore::postSlowWaiterMayBlock</a></div><div class="ttdeci">void postSlowWaiterMayBlock(uint32_t before) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="SaturatingSemaphore_8h_source.html#l00220">SaturatingSemaphore.h:220</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a9e3508e74ec7e0abc6365f59b20dd79f"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;bool MayBlock, template&lt; typename &gt; class Atom&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="CPortability_8h.html#a86b2395409bf2e155ebd8046a73945b1">FOLLY_NOINLINE</a> void <a class="el" href="classfolly_1_1SaturatingSemaphore.html">folly::SaturatingSemaphore</a>&lt; MayBlock, <a class="el" href="ConcurrentHashMapTest_8cpp.html#a98ac53dd3c18b4046e7c5cb0bcb64b75">Atom</a> &gt;::postSlowWaiterMayBlock </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ConstexprMathBenchmark_8cpp.html#a09a1e304d66d35dd47daffee9731edaa">uint32_t</a>&#160;</td>
          <td class="paramname"><em>before</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Member function definitioonspostSlowWaiterMayBlock </p>

<p>Definition at line <a class="el" href="SaturatingSemaphore_8h_source.html#l00220">220</a> of file <a class="el" href="SaturatingSemaphore_8h_source.html">SaturatingSemaphore.h</a>.</p>

<p>References <a class="el" href="SaturatingSemaphore_8h_source.html#l00126">folly::SaturatingSemaphore&lt; MayBlock, Atom &gt;::BLOCKED</a>, <a class="el" href="Futex-inl_8h_source.html#l00107">folly::detail::futexWake()</a>, <a class="el" href="SaturatingSemaphore_8h_source.html#l00124">folly::SaturatingSemaphore&lt; MayBlock, Atom &gt;::NOTREADY</a>, and <a class="el" href="SaturatingSemaphore_8h_source.html#l00125">folly::SaturatingSemaphore&lt; MayBlock, Atom &gt;::READY</a>.</p>

<p>Referenced by <a class="el" href="SaturatingSemaphore_8h_source.html#l00194">folly::SaturatingSemaphore&lt; true, Atom &gt;::postFastWaiterMayBlock()</a>.</p>
<div class="fragment"><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                              {</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;  <span class="keywordflow">while</span> (<span class="keyword">true</span>) {</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <span class="keywordflow">if</span> (before == <a class="code" href="classfolly_1_1SaturatingSemaphore.html#a7ca991102530faf43fd862b1d680f19aaa70a218ca24fa01f7be41be89b2a6288">NOTREADY</a>) {</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classfolly_1_1SaturatingSemaphore.html#aab910e4a30d1966f37545b37e39cd5e9">state_</a>.compare_exchange_strong(</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;              before,</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;              <a class="code" href="classfolly_1_1SaturatingSemaphore.html#a7ca991102530faf43fd862b1d680f19aa9fcb6dac32fc3eea095546639779b6fe">READY</a>,</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;              std::memory_order_release,</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;              std::memory_order_relaxed)) {</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;      }</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    }</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <span class="keywordflow">if</span> (before == <a class="code" href="classfolly_1_1SaturatingSemaphore.html#a7ca991102530faf43fd862b1d680f19aa9fcb6dac32fc3eea095546639779b6fe">READY</a>) { <span class="comment">// Only if multiple posters</span></div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;      <span class="comment">// The reason for not simply returning (without the following</span></div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;      <span class="comment">// steps) is to prevent the following case:</span></div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;      <span class="comment">//</span></div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;      <span class="comment">//  T1:             T2:             T3:</span></div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;      <span class="comment">//  local1.post();  local2.post();  global.wait();</span></div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;      <span class="comment">//  global.post();  global.post();  global.reset();</span></div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;      <span class="comment">//                                  seq_cst fence</span></div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;      <span class="comment">//                                  local1.try_wait() == true;</span></div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;      <span class="comment">//                                  local2.try_wait() == false;</span></div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;      <span class="comment">//</span></div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;      <span class="comment">// This following steps correspond to T2&#39;s global.post(), where</span></div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;      <span class="comment">// global is already posted by T1.</span></div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;      <span class="comment">//</span></div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;      <span class="comment">// The following fence and load guarantee that T3 does not miss</span></div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;      <span class="comment">// T2&#39;s prior stores, i.e., local2.post() in this example.</span></div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;      <span class="comment">//</span></div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;      <span class="comment">// The following case is prevented:</span></div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;      <span class="comment">//</span></div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;      <span class="comment">// Starting with local2 == NOTREADY and global == READY</span></div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;      <span class="comment">//</span></div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;      <span class="comment">// T2:                              T3:</span></div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;      <span class="comment">// store READY to local2 // post    store NOTREADY to global // reset</span></div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;      <span class="comment">// seq_cst fenc                     seq_cst fence</span></div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;      <span class="comment">// load READY from global // post   load NOTREADY from local2 // try_wait</span></div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;      <span class="comment">//</span></div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;      std::atomic_thread_fence(std::memory_order_seq_cst);</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;      before = <a class="code" href="classfolly_1_1SaturatingSemaphore.html#aab910e4a30d1966f37545b37e39cd5e9">state_</a>.load(std::memory_order_relaxed);</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;      <span class="keywordflow">if</span> (before == <a class="code" href="classfolly_1_1SaturatingSemaphore.html#a7ca991102530faf43fd862b1d680f19aa9fcb6dac32fc3eea095546639779b6fe">READY</a>) {</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;      }</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    }</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    DCHECK_EQ(before, <a class="code" href="classfolly_1_1SaturatingSemaphore.html#a7ca991102530faf43fd862b1d680f19aa397af9390ec9483f8cec3264f42f01d1">BLOCKED</a>);</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classfolly_1_1SaturatingSemaphore.html#aab910e4a30d1966f37545b37e39cd5e9">state_</a>.compare_exchange_strong(</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;            before,</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;            <a class="code" href="classfolly_1_1SaturatingSemaphore.html#a7ca991102530faf43fd862b1d680f19aa9fcb6dac32fc3eea095546639779b6fe">READY</a>,</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;            std::memory_order_release,</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;            std::memory_order_relaxed)) {</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;      <a class="code" href="namespacefolly_1_1detail.html#aeba3f67ff8fb877e9e460b417afdf82f">detail::futexWake</a>(&amp;<a class="code" href="classfolly_1_1SaturatingSemaphore.html#aab910e4a30d1966f37545b37e39cd5e9">state_</a>);</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    }</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;  }</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;}</div><div class="ttc" id="classfolly_1_1SaturatingSemaphore_html_aab910e4a30d1966f37545b37e39cd5e9"><div class="ttname"><a href="classfolly_1_1SaturatingSemaphore.html#aab910e4a30d1966f37545b37e39cd5e9">folly::SaturatingSemaphore::state_</a></div><div class="ttdeci">detail::Futex&lt; Atom &gt; state_</div><div class="ttdef"><b>Definition:</b> <a href="SaturatingSemaphore_8h_source.html#l00121">SaturatingSemaphore.h:121</a></div></div>
<div class="ttc" id="classfolly_1_1SaturatingSemaphore_html_a7ca991102530faf43fd862b1d680f19aa397af9390ec9483f8cec3264f42f01d1"><div class="ttname"><a href="classfolly_1_1SaturatingSemaphore.html#a7ca991102530faf43fd862b1d680f19aa397af9390ec9483f8cec3264f42f01d1">folly::SaturatingSemaphore::BLOCKED</a></div><div class="ttdef"><b>Definition:</b> <a href="SaturatingSemaphore_8h_source.html#l00126">SaturatingSemaphore.h:126</a></div></div>
<div class="ttc" id="classfolly_1_1SaturatingSemaphore_html_a7ca991102530faf43fd862b1d680f19aa9fcb6dac32fc3eea095546639779b6fe"><div class="ttname"><a href="classfolly_1_1SaturatingSemaphore.html#a7ca991102530faf43fd862b1d680f19aa9fcb6dac32fc3eea095546639779b6fe">folly::SaturatingSemaphore::READY</a></div><div class="ttdef"><b>Definition:</b> <a href="SaturatingSemaphore_8h_source.html#l00125">SaturatingSemaphore.h:125</a></div></div>
<div class="ttc" id="classfolly_1_1SaturatingSemaphore_html_a7ca991102530faf43fd862b1d680f19aaa70a218ca24fa01f7be41be89b2a6288"><div class="ttname"><a href="classfolly_1_1SaturatingSemaphore.html#a7ca991102530faf43fd862b1d680f19aaa70a218ca24fa01f7be41be89b2a6288">folly::SaturatingSemaphore::NOTREADY</a></div><div class="ttdef"><b>Definition:</b> <a href="SaturatingSemaphore_8h_source.html#l00124">SaturatingSemaphore.h:124</a></div></div>
<div class="ttc" id="namespacefolly_1_1detail_html_aeba3f67ff8fb877e9e460b417afdf82f"><div class="ttname"><a href="namespacefolly_1_1detail.html#aeba3f67ff8fb877e9e460b417afdf82f">folly::detail::futexWake</a></div><div class="ttdeci">int futexWake(const Futex *futex, int count, uint32_t wakeMask)</div><div class="ttdef"><b>Definition:</b> <a href="Futex-inl_8h_source.html#l00107">Futex-inl.h:107</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a9e7d5cec3c5f5dfc89ad22a766885abd"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;bool MayBlock, template&lt; typename &gt; class Atom = std::atomic&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="CPortability_8h.html#a416be07eb9da776690749a070a87d72e">FOLLY_ALWAYS_INLINE</a> bool <a class="el" href="classfolly_1_1SaturatingSemaphore.html">folly::SaturatingSemaphore</a>&lt; MayBlock, <a class="el" href="ConcurrentHashMapTest_8cpp.html#a98ac53dd3c18b4046e7c5cb0bcb64b75">Atom</a> &gt;::ready </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>ready </p>

<p>Definition at line <a class="el" href="SaturatingSemaphore_8h_source.html#l00141">141</a> of file <a class="el" href="SaturatingSemaphore_8h_source.html">SaturatingSemaphore.h</a>.</p>

<p>Referenced by <a class="el" href="FlatCombining_8h_source.html#l00167">folly::FlatCombining&lt; T, Mutex, Atom, Req &gt;::Rec::isDisconnected()</a>, <a class="el" href="FlatCombining_8h_source.html#l00151">folly::FlatCombining&lt; T, Mutex, Atom, Req &gt;::Rec::isDone()</a>, <a class="el" href="FlatCombining_8h_source.html#l00541">folly::FlatCombining&lt; FcSimpleExample&lt; Mutex, Atom &gt;, Mutex, Atom &gt;::isPending()</a>, <a class="el" href="FlatCombining_8h_source.html#l00139">folly::FlatCombining&lt; T, Mutex, Atom, Req &gt;::Rec::isValid()</a>, <a class="el" href="SaturatingSemaphoreTest_8cpp_source.html#l00027">run_basic_test()</a>, <a class="el" href="SaturatingSemaphoreTest_8cpp_source.html#l00073">run_multi_poster_multi_waiter_test()</a>, <a class="el" href="SaturatingSemaphore_8h_source.html#l00166">folly::SaturatingSemaphore&lt; true, Atom &gt;::try_wait()</a>, and <a class="el" href="SaturatingSemaphore_8h_source.html#l00280">folly::SaturatingSemaphore&lt; MayBlock, Atom &gt;::tryWaitSlow()</a>.</p>
<div class="fragment"><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;                                                  {</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classfolly_1_1SaturatingSemaphore.html#aab910e4a30d1966f37545b37e39cd5e9">state_</a>.load(std::memory_order_acquire) == <a class="code" href="classfolly_1_1SaturatingSemaphore.html#a7ca991102530faf43fd862b1d680f19aa9fcb6dac32fc3eea095546639779b6fe">READY</a>;</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  }</div><div class="ttc" id="classfolly_1_1SaturatingSemaphore_html_aab910e4a30d1966f37545b37e39cd5e9"><div class="ttname"><a href="classfolly_1_1SaturatingSemaphore.html#aab910e4a30d1966f37545b37e39cd5e9">folly::SaturatingSemaphore::state_</a></div><div class="ttdeci">detail::Futex&lt; Atom &gt; state_</div><div class="ttdef"><b>Definition:</b> <a href="SaturatingSemaphore_8h_source.html#l00121">SaturatingSemaphore.h:121</a></div></div>
<div class="ttc" id="classfolly_1_1SaturatingSemaphore_html_a7ca991102530faf43fd862b1d680f19aa9fcb6dac32fc3eea095546639779b6fe"><div class="ttname"><a href="classfolly_1_1SaturatingSemaphore.html#a7ca991102530faf43fd862b1d680f19aa9fcb6dac32fc3eea095546639779b6fe">folly::SaturatingSemaphore::READY</a></div><div class="ttdef"><b>Definition:</b> <a href="SaturatingSemaphore_8h_source.html#l00125">SaturatingSemaphore.h:125</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a32a1060763f66259b5a83fd2192b95d1"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;bool MayBlock, template&lt; typename &gt; class Atom = std::atomic&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classfolly_1_1SaturatingSemaphore.html">folly::SaturatingSemaphore</a>&lt; MayBlock, <a class="el" href="ConcurrentHashMapTest_8cpp.html#a98ac53dd3c18b4046e7c5cb0bcb64b75">Atom</a> &gt;::reset </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>reset </p>

<p>Definition at line <a class="el" href="SaturatingSemaphore_8h_source.html#l00146">146</a> of file <a class="el" href="SaturatingSemaphore_8h_source.html">SaturatingSemaphore.h</a>.</p>

<p>Referenced by <a class="el" href="FlatCombining_8h_source.html#l00163">folly::FlatCombining&lt; T, Mutex, Atom, Req &gt;::Rec::clearDisconnected()</a>, <a class="el" href="FlatCombining_8h_source.html#l00147">folly::FlatCombining&lt; T, Mutex, Atom, Req &gt;::Rec::clearDone()</a>, <a class="el" href="FlatCombining_8h_source.html#l00533">folly::FlatCombining&lt; FcSimpleExample&lt; Mutex, Atom &gt;, Mutex, Atom &gt;::clearPending()</a>, <a class="el" href="FlatCombining_8h_source.html#l00135">folly::FlatCombining&lt; T, Mutex, Atom, Req &gt;::Rec::clearValid()</a>, <a class="el" href="SaturatingSemaphoreTest_8cpp_source.html#l00027">run_basic_test()</a>, and <a class="el" href="MultiFilePollerTest_8cpp_source.html#l00069">TEST_F()</a>.</p>
<div class="fragment"><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;                        {</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <a class="code" href="classfolly_1_1SaturatingSemaphore.html#aab910e4a30d1966f37545b37e39cd5e9">state_</a>.store(<a class="code" href="classfolly_1_1SaturatingSemaphore.html#a7ca991102530faf43fd862b1d680f19aaa70a218ca24fa01f7be41be89b2a6288">NOTREADY</a>, std::memory_order_relaxed);</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  }</div><div class="ttc" id="classfolly_1_1SaturatingSemaphore_html_aab910e4a30d1966f37545b37e39cd5e9"><div class="ttname"><a href="classfolly_1_1SaturatingSemaphore.html#aab910e4a30d1966f37545b37e39cd5e9">folly::SaturatingSemaphore::state_</a></div><div class="ttdeci">detail::Futex&lt; Atom &gt; state_</div><div class="ttdef"><b>Definition:</b> <a href="SaturatingSemaphore_8h_source.html#l00121">SaturatingSemaphore.h:121</a></div></div>
<div class="ttc" id="classfolly_1_1SaturatingSemaphore_html_a7ca991102530faf43fd862b1d680f19aaa70a218ca24fa01f7be41be89b2a6288"><div class="ttname"><a href="classfolly_1_1SaturatingSemaphore.html#a7ca991102530faf43fd862b1d680f19aaa70a218ca24fa01f7be41be89b2a6288">folly::SaturatingSemaphore::NOTREADY</a></div><div class="ttdef"><b>Definition:</b> <a href="SaturatingSemaphore_8h_source.html#l00124">SaturatingSemaphore.h:124</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a1e96793510e324939b540ea52bb2a51e"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;bool MayBlock, template&lt; typename &gt; class Atom = std::atomic&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="CPortability_8h.html#a416be07eb9da776690749a070a87d72e">FOLLY_ALWAYS_INLINE</a> bool <a class="el" href="classfolly_1_1SaturatingSemaphore.html">folly::SaturatingSemaphore</a>&lt; MayBlock, <a class="el" href="ConcurrentHashMapTest_8cpp.html#a98ac53dd3c18b4046e7c5cb0bcb64b75">Atom</a> &gt;::try_wait </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>try_wait </p>

<p>Definition at line <a class="el" href="SaturatingSemaphore_8h_source.html#l00166">166</a> of file <a class="el" href="SaturatingSemaphore_8h_source.html">SaturatingSemaphore.h</a>.</p>

<p>Referenced by <a class="el" href="SaturatingSemaphoreTest_8cpp_source.html#l00027">run_basic_test()</a>, <a class="el" href="SaturatingSemaphoreTest_8cpp_source.html#l00073">run_multi_poster_multi_waiter_test()</a>, <a class="el" href="SaturatingSemaphore_8h_source.html#l00183">folly::SaturatingSemaphore&lt; true, Atom &gt;::try_wait_for()</a>, and <a class="el" href="SaturatingSemaphore_8h_source.html#l00172">folly::SaturatingSemaphore&lt; true, Atom &gt;::try_wait_until()</a>.</p>
<div class="fragment"><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;                                               {</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classfolly_1_1SaturatingSemaphore.html#a9e7d5cec3c5f5dfc89ad22a766885abd">ready</a>();</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  }</div><div class="ttc" id="classfolly_1_1SaturatingSemaphore_html_a9e7d5cec3c5f5dfc89ad22a766885abd"><div class="ttname"><a href="classfolly_1_1SaturatingSemaphore.html#a9e7d5cec3c5f5dfc89ad22a766885abd">folly::SaturatingSemaphore::ready</a></div><div class="ttdeci">FOLLY_ALWAYS_INLINE bool ready() const noexcept</div><div class="ttdef"><b>Definition:</b> <a href="SaturatingSemaphore_8h_source.html#l00141">SaturatingSemaphore.h:141</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a8b3c88a1b940947f8c924c540f82ac35"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;bool MayBlock, template&lt; typename &gt; class Atom = std::atomic&gt; </div>
<div class="memtemplate">
template&lt;class Rep , class Period &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="CPortability_8h.html#a416be07eb9da776690749a070a87d72e">FOLLY_ALWAYS_INLINE</a> bool <a class="el" href="classfolly_1_1SaturatingSemaphore.html">folly::SaturatingSemaphore</a>&lt; MayBlock, <a class="el" href="ConcurrentHashMapTest_8cpp.html#a98ac53dd3c18b4046e7c5cb0bcb64b75">Atom</a> &gt;::try_wait_for </td>
          <td>(</td>
          <td class="paramtype">const std::chrono::duration&lt; Rep, Period &gt; &amp;&#160;</td>
          <td class="paramname"><em>duration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classfolly_1_1WaitOptions.html">WaitOptions</a> &amp;&#160;</td>
          <td class="paramname"><em>opt</em> = <code><a class="el" href="classfolly_1_1SaturatingSemaphore.html#a8ea771ca38d5ffb4f95aa89f358e8370">wait_options</a>()</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>try_wait_for </p>

<p>Definition at line <a class="el" href="SaturatingSemaphore_8h_source.html#l00183">183</a> of file <a class="el" href="SaturatingSemaphore_8h_source.html">SaturatingSemaphore.h</a>.</p>

<p>Referenced by <a class="el" href="SaturatingSemaphoreTest_8cpp_source.html#l00073">run_multi_poster_multi_waiter_test()</a>.</p>
<div class="fragment"><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;                                                        {</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="Likely_8h.html#affde14445f49f65ff4f5b592e44ee71a">LIKELY</a>(<a class="code" href="classfolly_1_1SaturatingSemaphore.html#a1e96793510e324939b540ea52bb2a51e">try_wait</a>())) {</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    }</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <span class="keyword">auto</span> deadline = <a class="code" href="TimekeeperTest_8cpp.html#a562b4baa36dcf267f35a4ba4e0aef329">std::chrono::steady_clock::now</a>() + duration;</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classfolly_1_1SaturatingSemaphore.html#ae0e69ea25164cd5e3271b3d22c7df87d">tryWaitSlow</a>(deadline, opt);</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  }</div><div class="ttc" id="TimekeeperTest_8cpp_html_a562b4baa36dcf267f35a4ba4e0aef329"><div class="ttname"><a href="TimekeeperTest_8cpp.html#a562b4baa36dcf267f35a4ba4e0aef329">now</a></div><div class="ttdeci">std::chrono::steady_clock::time_point now()</div><div class="ttdef"><b>Definition:</b> <a href="TimekeeperTest_8cpp_source.html#l00031">TimekeeperTest.cpp:31</a></div></div>
<div class="ttc" id="Likely_8h_html_affde14445f49f65ff4f5b592e44ee71a"><div class="ttname"><a href="Likely_8h.html#affde14445f49f65ff4f5b592e44ee71a">LIKELY</a></div><div class="ttdeci">#define LIKELY(x)</div><div class="ttdef"><b>Definition:</b> <a href="Likely_8h_source.html#l00047">Likely.h:47</a></div></div>
<div class="ttc" id="classfolly_1_1SaturatingSemaphore_html_ae0e69ea25164cd5e3271b3d22c7df87d"><div class="ttname"><a href="classfolly_1_1SaturatingSemaphore.html#ae0e69ea25164cd5e3271b3d22c7df87d">folly::SaturatingSemaphore::tryWaitSlow</a></div><div class="ttdeci">bool tryWaitSlow(const std::chrono::time_point&lt; Clock, Duration &gt; &amp;deadline, const WaitOptions &amp;opt) noexcept</div></div>
<div class="ttc" id="classfolly_1_1SaturatingSemaphore_html_a1e96793510e324939b540ea52bb2a51e"><div class="ttname"><a href="classfolly_1_1SaturatingSemaphore.html#a1e96793510e324939b540ea52bb2a51e">folly::SaturatingSemaphore::try_wait</a></div><div class="ttdeci">FOLLY_ALWAYS_INLINE bool try_wait() noexcept</div><div class="ttdef"><b>Definition:</b> <a href="SaturatingSemaphore_8h_source.html#l00166">SaturatingSemaphore.h:166</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a65c98507c78300f2ebc66c761bd83669"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;bool MayBlock, template&lt; typename &gt; class Atom = std::atomic&gt; </div>
<div class="memtemplate">
template&lt;typename Clock , typename Duration &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="CPortability_8h.html#a416be07eb9da776690749a070a87d72e">FOLLY_ALWAYS_INLINE</a> bool <a class="el" href="classfolly_1_1SaturatingSemaphore.html">folly::SaturatingSemaphore</a>&lt; MayBlock, <a class="el" href="ConcurrentHashMapTest_8cpp.html#a98ac53dd3c18b4046e7c5cb0bcb64b75">Atom</a> &gt;::try_wait_until </td>
          <td>(</td>
          <td class="paramtype">const std::chrono::time_point&lt; Clock, <a class="el" href="namespacefolly.html#ad1989ff61ba788d22aa07cb22f8c5c49">Duration</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>deadline</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classfolly_1_1WaitOptions.html">WaitOptions</a> &amp;&#160;</td>
          <td class="paramname"><em>opt</em> = <code><a class="el" href="classfolly_1_1SaturatingSemaphore.html#a8ea771ca38d5ffb4f95aa89f358e8370">wait_options</a>()</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>try_wait_until </p>

<p>Definition at line <a class="el" href="SaturatingSemaphore_8h_source.html#l00172">172</a> of file <a class="el" href="SaturatingSemaphore_8h_source.html">SaturatingSemaphore.h</a>.</p>

<p>Referenced by <a class="el" href="SaturatingSemaphoreTest_8cpp_source.html#l00027">run_basic_test()</a>, <a class="el" href="SaturatingSemaphoreTest_8cpp_source.html#l00073">run_multi_poster_multi_waiter_test()</a>, <a class="el" href="MultiFilePollerTest_8cpp_source.html#l00069">TEST_F()</a>, <a class="el" href="UnboundedQueue_8h_source.html#l00771">folly::UnboundedQueue&lt; T, SingleProducer, SingleConsumer, MayBlock, LgSegmentSize, LgAlign, Atom &gt;::Entry::tryWaitUntil()</a>, and <a class="el" href="SaturatingSemaphore_8h_source.html#l00161">folly::SaturatingSemaphore&lt; true, Atom &gt;::wait()</a>.</p>
<div class="fragment"><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;                                                        {</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="Likely_8h.html#affde14445f49f65ff4f5b592e44ee71a">LIKELY</a>(<a class="code" href="classfolly_1_1SaturatingSemaphore.html#a1e96793510e324939b540ea52bb2a51e">try_wait</a>())) {</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    }</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classfolly_1_1SaturatingSemaphore.html#ae0e69ea25164cd5e3271b3d22c7df87d">tryWaitSlow</a>(deadline, opt);</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  }</div><div class="ttc" id="Likely_8h_html_affde14445f49f65ff4f5b592e44ee71a"><div class="ttname"><a href="Likely_8h.html#affde14445f49f65ff4f5b592e44ee71a">LIKELY</a></div><div class="ttdeci">#define LIKELY(x)</div><div class="ttdef"><b>Definition:</b> <a href="Likely_8h_source.html#l00047">Likely.h:47</a></div></div>
<div class="ttc" id="classfolly_1_1SaturatingSemaphore_html_ae0e69ea25164cd5e3271b3d22c7df87d"><div class="ttname"><a href="classfolly_1_1SaturatingSemaphore.html#ae0e69ea25164cd5e3271b3d22c7df87d">folly::SaturatingSemaphore::tryWaitSlow</a></div><div class="ttdeci">bool tryWaitSlow(const std::chrono::time_point&lt; Clock, Duration &gt; &amp;deadline, const WaitOptions &amp;opt) noexcept</div></div>
<div class="ttc" id="classfolly_1_1SaturatingSemaphore_html_a1e96793510e324939b540ea52bb2a51e"><div class="ttname"><a href="classfolly_1_1SaturatingSemaphore.html#a1e96793510e324939b540ea52bb2a51e">folly::SaturatingSemaphore::try_wait</a></div><div class="ttdeci">FOLLY_ALWAYS_INLINE bool try_wait() noexcept</div><div class="ttdef"><b>Definition:</b> <a href="SaturatingSemaphore_8h_source.html#l00166">SaturatingSemaphore.h:166</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ae0e69ea25164cd5e3271b3d22c7df87d"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;bool MayBlock, template&lt; typename &gt; class Atom = std::atomic&gt; </div>
<div class="memtemplate">
template&lt;typename Clock , typename Duration &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classfolly_1_1SaturatingSemaphore.html">folly::SaturatingSemaphore</a>&lt; MayBlock, <a class="el" href="ConcurrentHashMapTest_8cpp.html#a98ac53dd3c18b4046e7c5cb0bcb64b75">Atom</a> &gt;::tryWaitSlow </td>
          <td>(</td>
          <td class="paramtype">const std::chrono::time_point&lt; Clock, <a class="el" href="namespacefolly.html#ad1989ff61ba788d22aa07cb22f8c5c49">Duration</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>deadline</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classfolly_1_1WaitOptions.html">WaitOptions</a> &amp;&#160;</td>
          <td class="paramname"><em>opt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Referenced by <a class="el" href="SaturatingSemaphore_8h_source.html#l00194">folly::SaturatingSemaphore&lt; true, Atom &gt;::postFastWaiterMayBlock()</a>, <a class="el" href="SaturatingSemaphore_8h_source.html#l00183">folly::SaturatingSemaphore&lt; true, Atom &gt;::try_wait_for()</a>, and <a class="el" href="SaturatingSemaphore_8h_source.html#l00172">folly::SaturatingSemaphore&lt; true, Atom &gt;::try_wait_until()</a>.</p>

</div>
</div>
<a class="anchor" id="ad48e94f3040b35fe54438b49ddbf90d1"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;bool MayBlock, template&lt; typename &gt; class Atom = std::atomic&gt; </div>
<div class="memtemplate">
template&lt;typename Clock , typename Duration &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="CPortability_8h.html#a86b2395409bf2e155ebd8046a73945b1">FOLLY_NOINLINE</a> bool <a class="el" href="classfolly_1_1SaturatingSemaphore.html">folly::SaturatingSemaphore</a>&lt; MayBlock, <a class="el" href="ConcurrentHashMapTest_8cpp.html#a98ac53dd3c18b4046e7c5cb0bcb64b75">Atom</a> &gt;::tryWaitSlow </td>
          <td>(</td>
          <td class="paramtype">const std::chrono::time_point&lt; Clock, <a class="el" href="namespacefolly.html#ad1989ff61ba788d22aa07cb22f8c5c49">Duration</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>deadline</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classfolly_1_1WaitOptions.html">WaitOptions</a> &amp;&#160;</td>
          <td class="paramname"><em>opt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>tryWaitSlow </p>

<p>Definition at line <a class="el" href="SaturatingSemaphore_8h_source.html#l00280">280</a> of file <a class="el" href="SaturatingSemaphore_8h_source.html">SaturatingSemaphore.h</a>.</p>

<p>References <a class="el" href="namespacefolly_1_1detail.html#a87c55c2d12ad5b5dc9b7416bbed13720ae0bd4e89620ec924b27166975a2dda57">folly::detail::advance</a>, <a class="el" href="SaturatingSemaphore_8h_source.html#l00126">folly::SaturatingSemaphore&lt; MayBlock, Atom &gt;::BLOCKED</a>, <a class="el" href="MemoryIdler_8h_source.html#l00139">folly::detail::MemoryIdler::futexWaitUntil()</a>, <a class="el" href="LogLevel_8cpp_source.html#l00031">max</a>, <a class="el" href="SaturatingSemaphore_8h_source.html#l00124">folly::SaturatingSemaphore&lt; MayBlock, Atom &gt;::NOTREADY</a>, <a class="el" href="SaturatingSemaphore_8h_source.html#l00125">folly::SaturatingSemaphore&lt; MayBlock, Atom &gt;::READY</a>, <a class="el" href="SaturatingSemaphore_8h_source.html#l00141">folly::SaturatingSemaphore&lt; MayBlock, Atom &gt;::ready()</a>, <a class="el" href="Spin_8h_source.html#l00036">folly::detail::spin_pause_until()</a>, <a class="el" href="Spin_8h_source.html#l00070">folly::detail::spin_yield_until()</a>, <a class="el" href="namespacefolly_1_1detail.html#a87c55c2d12ad5b5dc9b7416bbed13720a260ca9dd8a4577fc00b7bd5810298076">folly::detail::success</a>, <a class="el" href="namespacefolly_1_1detail.html#af130844a971c4ed26a0658a3e79f273cac5b306a30b21dec5abcb84067152687a">folly::detail::TIMEDOUT</a>, and <a class="el" href="namespacefolly_1_1detail.html#a87c55c2d12ad5b5dc9b7416bbed13720a90272dda245ae1fb3cf197e91a8689dc">folly::detail::timeout</a>.</p>
<div class="fragment"><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;                                     {</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;  <span class="keywordflow">switch</span> (<a class="code" href="namespacefolly_1_1detail.html#a02ebef54b3e02a6c828c512abf19a821">detail::spin_pause_until</a>(deadline, opt, [=] { <span class="keywordflow">return</span> <a class="code" href="classfolly_1_1SaturatingSemaphore.html#a9e7d5cec3c5f5dfc89ad22a766885abd">ready</a>(); })) {</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacefolly_1_1detail.html#a87c55c2d12ad5b5dc9b7416bbed13720a260ca9dd8a4577fc00b7bd5810298076">detail::spin_result::success</a>:</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacefolly_1_1detail.html#a87c55c2d12ad5b5dc9b7416bbed13720a90272dda245ae1fb3cf197e91a8689dc">detail::spin_result::timeout</a>:</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacefolly_1_1detail.html#a87c55c2d12ad5b5dc9b7416bbed13720ae0bd4e89620ec924b27166975a2dda57">detail::spin_result::advance</a>:</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;  }</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;  <span class="keywordflow">if</span> (!MayBlock) {</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <span class="keywordflow">switch</span> (<a class="code" href="namespacefolly_1_1detail.html#a0d78db0b1544a87df6e53a695c540061">detail::spin_yield_until</a>(deadline, [=] { <span class="keywordflow">return</span> <a class="code" href="classfolly_1_1SaturatingSemaphore.html#a9e7d5cec3c5f5dfc89ad22a766885abd">ready</a>(); })) {</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="namespacefolly_1_1detail.html#a87c55c2d12ad5b5dc9b7416bbed13720a260ca9dd8a4577fc00b7bd5810298076">detail::spin_result::success</a>:</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="namespacefolly_1_1detail.html#a87c55c2d12ad5b5dc9b7416bbed13720a90272dda245ae1fb3cf197e91a8689dc">detail::spin_result::timeout</a>:</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="namespacefolly_1_1detail.html#a87c55c2d12ad5b5dc9b7416bbed13720ae0bd4e89620ec924b27166975a2dda57">detail::spin_result::advance</a>:</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    }</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;  }</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;  <span class="keyword">auto</span> before = <a class="code" href="classfolly_1_1SaturatingSemaphore.html#aab910e4a30d1966f37545b37e39cd5e9">state_</a>.load(std::memory_order_relaxed);</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;  <span class="keywordflow">while</span> (before == <a class="code" href="classfolly_1_1SaturatingSemaphore.html#a7ca991102530faf43fd862b1d680f19aaa70a218ca24fa01f7be41be89b2a6288">NOTREADY</a> &amp;&amp;</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;         !<a class="code" href="classfolly_1_1SaturatingSemaphore.html#aab910e4a30d1966f37545b37e39cd5e9">state_</a>.compare_exchange_strong(</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;             before,</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;             <a class="code" href="classfolly_1_1SaturatingSemaphore.html#a7ca991102530faf43fd862b1d680f19aa397af9390ec9483f8cec3264f42f01d1">BLOCKED</a>,</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;             std::memory_order_relaxed,</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;             std::memory_order_relaxed)) {</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <span class="keywordflow">if</span> (before == <a class="code" href="classfolly_1_1SaturatingSemaphore.html#a7ca991102530faf43fd862b1d680f19aa9fcb6dac32fc3eea095546639779b6fe">READY</a>) {</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;      <span class="comment">// TODO: move the acquire to the compare_exchange failure load after C++17</span></div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;      std::atomic_thread_fence(std::memory_order_acquire);</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    }</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;  }</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  <span class="keywordflow">while</span> (<span class="keyword">true</span>) {</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    <span class="keyword">auto</span> rv = <a class="code" href="structfolly_1_1detail_1_1MemoryIdler.html#afd31d32f83b5d646dfb7dd3ff1ab434b">detail::MemoryIdler::futexWaitUntil</a>(<a class="code" href="classfolly_1_1SaturatingSemaphore.html#aab910e4a30d1966f37545b37e39cd5e9">state_</a>, <a class="code" href="classfolly_1_1SaturatingSemaphore.html#a7ca991102530faf43fd862b1d680f19aa397af9390ec9483f8cec3264f42f01d1">BLOCKED</a>, deadline);</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    <span class="keywordflow">if</span> (rv == <a class="code" href="namespacefolly_1_1detail.html#af130844a971c4ed26a0658a3e79f273cac5b306a30b21dec5abcb84067152687a">detail::FutexResult::TIMEDOUT</a>) {</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;      assert(deadline != (<a class="code" href="LogLevel_8cpp.html#a15c8b90f03cae068a6979f32590642e2">std::chrono::time_point&lt;Clock, Duration&gt;::max</a>()));</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    }</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classfolly_1_1SaturatingSemaphore.html#a9e7d5cec3c5f5dfc89ad22a766885abd">ready</a>()) {</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    }</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;  }</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;}</div><div class="ttc" id="classfolly_1_1SaturatingSemaphore_html_a9e7d5cec3c5f5dfc89ad22a766885abd"><div class="ttname"><a href="classfolly_1_1SaturatingSemaphore.html#a9e7d5cec3c5f5dfc89ad22a766885abd">folly::SaturatingSemaphore::ready</a></div><div class="ttdeci">FOLLY_ALWAYS_INLINE bool ready() const noexcept</div><div class="ttdef"><b>Definition:</b> <a href="SaturatingSemaphore_8h_source.html#l00141">SaturatingSemaphore.h:141</a></div></div>
<div class="ttc" id="structfolly_1_1detail_1_1MemoryIdler_html_afd31d32f83b5d646dfb7dd3ff1ab434b"><div class="ttname"><a href="structfolly_1_1detail_1_1MemoryIdler.html#afd31d32f83b5d646dfb7dd3ff1ab434b">folly::detail::MemoryIdler::futexWaitUntil</a></div><div class="ttdeci">static FutexResult futexWaitUntil(Futex &amp;fut, uint32_t expected, Deadline const &amp;deadline, uint32_t waitMask=-1, IdleTime const &amp;idleTimeout=defaultIdleTimeout.load(std::memory_order_acquire), size_t stackToRetain=kDefaultStackToRetain, float timeoutVariationFrac=0.5)</div><div class="ttdef"><b>Definition:</b> <a href="MemoryIdler_8h_source.html#l00139">MemoryIdler.h:139</a></div></div>
<div class="ttc" id="namespacefolly_1_1detail_html_a87c55c2d12ad5b5dc9b7416bbed13720a90272dda245ae1fb3cf197e91a8689dc"><div class="ttname"><a href="namespacefolly_1_1detail.html#a87c55c2d12ad5b5dc9b7416bbed13720a90272dda245ae1fb3cf197e91a8689dc">folly::detail::spin_result::timeout</a></div></div>
<div class="ttc" id="namespacefolly_1_1detail_html_a0d78db0b1544a87df6e53a695c540061"><div class="ttname"><a href="namespacefolly_1_1detail.html#a0d78db0b1544a87df6e53a695c540061">folly::detail::spin_yield_until</a></div><div class="ttdeci">spin_result spin_yield_until(std::chrono::time_point&lt; Clock, Duration &gt; const &amp;deadline, F f)</div><div class="ttdef"><b>Definition:</b> <a href="Spin_8h_source.html#l00070">Spin.h:70</a></div></div>
<div class="ttc" id="LogLevel_8cpp_html_a15c8b90f03cae068a6979f32590642e2"><div class="ttname"><a href="LogLevel_8cpp.html#a15c8b90f03cae068a6979f32590642e2">max</a></div><div class="ttdeci">LogLevel max</div><div class="ttdef"><b>Definition:</b> <a href="LogLevel_8cpp_source.html#l00031">LogLevel.cpp:31</a></div></div>
<div class="ttc" id="classfolly_1_1SaturatingSemaphore_html_aab910e4a30d1966f37545b37e39cd5e9"><div class="ttname"><a href="classfolly_1_1SaturatingSemaphore.html#aab910e4a30d1966f37545b37e39cd5e9">folly::SaturatingSemaphore::state_</a></div><div class="ttdeci">detail::Futex&lt; Atom &gt; state_</div><div class="ttdef"><b>Definition:</b> <a href="SaturatingSemaphore_8h_source.html#l00121">SaturatingSemaphore.h:121</a></div></div>
<div class="ttc" id="classfolly_1_1SaturatingSemaphore_html_a7ca991102530faf43fd862b1d680f19aa397af9390ec9483f8cec3264f42f01d1"><div class="ttname"><a href="classfolly_1_1SaturatingSemaphore.html#a7ca991102530faf43fd862b1d680f19aa397af9390ec9483f8cec3264f42f01d1">folly::SaturatingSemaphore::BLOCKED</a></div><div class="ttdef"><b>Definition:</b> <a href="SaturatingSemaphore_8h_source.html#l00126">SaturatingSemaphore.h:126</a></div></div>
<div class="ttc" id="classfolly_1_1SaturatingSemaphore_html_a7ca991102530faf43fd862b1d680f19aa9fcb6dac32fc3eea095546639779b6fe"><div class="ttname"><a href="classfolly_1_1SaturatingSemaphore.html#a7ca991102530faf43fd862b1d680f19aa9fcb6dac32fc3eea095546639779b6fe">folly::SaturatingSemaphore::READY</a></div><div class="ttdef"><b>Definition:</b> <a href="SaturatingSemaphore_8h_source.html#l00125">SaturatingSemaphore.h:125</a></div></div>
<div class="ttc" id="namespacefolly_1_1detail_html_a87c55c2d12ad5b5dc9b7416bbed13720a260ca9dd8a4577fc00b7bd5810298076"><div class="ttname"><a href="namespacefolly_1_1detail.html#a87c55c2d12ad5b5dc9b7416bbed13720a260ca9dd8a4577fc00b7bd5810298076">folly::detail::spin_result::success</a></div></div>
<div class="ttc" id="namespacefolly_1_1detail_html_a87c55c2d12ad5b5dc9b7416bbed13720ae0bd4e89620ec924b27166975a2dda57"><div class="ttname"><a href="namespacefolly_1_1detail.html#a87c55c2d12ad5b5dc9b7416bbed13720ae0bd4e89620ec924b27166975a2dda57">folly::detail::spin_result::advance</a></div></div>
<div class="ttc" id="classfolly_1_1SaturatingSemaphore_html_a7ca991102530faf43fd862b1d680f19aaa70a218ca24fa01f7be41be89b2a6288"><div class="ttname"><a href="classfolly_1_1SaturatingSemaphore.html#a7ca991102530faf43fd862b1d680f19aaa70a218ca24fa01f7be41be89b2a6288">folly::SaturatingSemaphore::NOTREADY</a></div><div class="ttdef"><b>Definition:</b> <a href="SaturatingSemaphore_8h_source.html#l00124">SaturatingSemaphore.h:124</a></div></div>
<div class="ttc" id="namespacefolly_1_1detail_html_a02ebef54b3e02a6c828c512abf19a821"><div class="ttname"><a href="namespacefolly_1_1detail.html#a02ebef54b3e02a6c828c512abf19a821">folly::detail::spin_pause_until</a></div><div class="ttdeci">spin_result spin_pause_until(std::chrono::time_point&lt; Clock, Duration &gt; const &amp;deadline, WaitOptions const &amp;opt, F f)</div><div class="ttdef"><b>Definition:</b> <a href="Spin_8h_source.html#l00036">Spin.h:36</a></div></div>
<div class="ttc" id="namespacefolly_1_1detail_html_af130844a971c4ed26a0658a3e79f273cac5b306a30b21dec5abcb84067152687a"><div class="ttname"><a href="namespacefolly_1_1detail.html#af130844a971c4ed26a0658a3e79f273cac5b306a30b21dec5abcb84067152687a">folly::detail::FutexResult::TIMEDOUT</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="adf173edb446c2bc62aa384be2d419506"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;bool MayBlock, template&lt; typename &gt; class Atom = std::atomic&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="CPortability_8h.html#a416be07eb9da776690749a070a87d72e">FOLLY_ALWAYS_INLINE</a> void <a class="el" href="classfolly_1_1SaturatingSemaphore.html">folly::SaturatingSemaphore</a>&lt; MayBlock, <a class="el" href="ConcurrentHashMapTest_8cpp.html#a98ac53dd3c18b4046e7c5cb0bcb64b75">Atom</a> &gt;::wait </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classfolly_1_1WaitOptions.html">WaitOptions</a> &amp;&#160;</td>
          <td class="paramname"><em>opt</em> = <code><a class="el" href="classfolly_1_1SaturatingSemaphore.html#a8ea771ca38d5ffb4f95aa89f358e8370">wait_options</a>()</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>wait </p>

<p>Definition at line <a class="el" href="SaturatingSemaphore_8h_source.html#l00161">161</a> of file <a class="el" href="SaturatingSemaphore_8h_source.html">SaturatingSemaphore.h</a>.</p>

<p>Referenced by <a class="el" href="FlatCombining_8h_source.html#l00155">folly::FlatCombining&lt; T, Mutex, Atom, Req &gt;::Rec::awaitDone()</a>, <a class="el" href="FlatCombining_8h_source.html#l00545">folly::FlatCombining&lt; FcSimpleExample&lt; Mutex, Atom &gt;, Mutex, Atom &gt;::awaitPending()</a>, <a class="el" href="UnboundedQueue_8h_source.html#l00765">folly::UnboundedQueue&lt; T, SingleProducer, SingleConsumer, MayBlock, LgSegmentSize, LgAlign, Atom &gt;::Entry::peekItem()</a>, <a class="el" href="SaturatingSemaphoreTest_8cpp_source.html#l00027">run_basic_test()</a>, <a class="el" href="SaturatingSemaphoreTest_8cpp_source.html#l00073">run_multi_poster_multi_waiter_test()</a>, and <a class="el" href="UnboundedQueue_8h_source.html#l00755">folly::UnboundedQueue&lt; T, SingleProducer, SingleConsumer, MayBlock, LgSegmentSize, LgAlign, Atom &gt;::Entry::takeItem()</a>.</p>
<div class="fragment"><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;                                                              {</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <a class="code" href="classfolly_1_1SaturatingSemaphore.html#a65c98507c78300f2ebc66c761bd83669">try_wait_until</a>(<a class="code" href="LogLevel_8cpp.html#a15c8b90f03cae068a6979f32590642e2">std::chrono::steady_clock::time_point::max</a>(), opt);</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  }</div><div class="ttc" id="LogLevel_8cpp_html_a15c8b90f03cae068a6979f32590642e2"><div class="ttname"><a href="LogLevel_8cpp.html#a15c8b90f03cae068a6979f32590642e2">max</a></div><div class="ttdeci">LogLevel max</div><div class="ttdef"><b>Definition:</b> <a href="LogLevel_8cpp_source.html#l00031">LogLevel.cpp:31</a></div></div>
<div class="ttc" id="classfolly_1_1SaturatingSemaphore_html_a65c98507c78300f2ebc66c761bd83669"><div class="ttname"><a href="classfolly_1_1SaturatingSemaphore.html#a65c98507c78300f2ebc66c761bd83669">folly::SaturatingSemaphore::try_wait_until</a></div><div class="ttdeci">FOLLY_ALWAYS_INLINE bool try_wait_until(const std::chrono::time_point&lt; Clock, Duration &gt; &amp;deadline, const WaitOptions &amp;opt=wait_options()) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="SaturatingSemaphore_8h_source.html#l00172">SaturatingSemaphore.h:172</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a8ea771ca38d5ffb4f95aa89f358e8370"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;bool MayBlock, template&lt; typename &gt; class Atom = std::atomic&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="CPortability_8h.html#a416be07eb9da776690749a070a87d72e">FOLLY_ALWAYS_INLINE</a> <a class="el" href="classfolly_1_1WaitOptions.html">WaitOptions</a> <a class="el" href="classfolly_1_1SaturatingSemaphore.html">folly::SaturatingSemaphore</a>&lt; MayBlock, <a class="el" href="ConcurrentHashMapTest_8cpp.html#a98ac53dd3c18b4046e7c5cb0bcb64b75">Atom</a> &gt;::wait_options </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="SaturatingSemaphore_8h_source.html#l00130">130</a> of file <a class="el" href="SaturatingSemaphore_8h_source.html">SaturatingSemaphore.h</a>.</p>

<p>Referenced by <a class="el" href="SaturatingSemaphoreTest_8cpp_source.html#l00027">run_basic_test()</a>, <a class="el" href="SaturatingSemaphoreTest_8cpp_source.html#l00073">run_multi_poster_multi_waiter_test()</a>, and <a class="el" href="UnboundedQueue_8h_source.html#l00771">folly::UnboundedQueue&lt; T, SingleProducer, SingleConsumer, MayBlock, LgSegmentSize, LgAlign, Atom &gt;::Entry::tryWaitUntil()</a>.</p>
<div class="fragment"><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;                                                        {</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="keywordflow">return</span> {};</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  }</div></div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="aab910e4a30d1966f37545b37e39cd5e9"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;bool MayBlock, template&lt; typename &gt; class Atom = std::atomic&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacefolly_1_1detail.html#a119b8d460f481815f833da41cdc33141">detail::Futex</a>&lt;<a class="el" href="ConcurrentHashMapTest_8cpp.html#a98ac53dd3c18b4046e7c5cb0bcb64b75">Atom</a>&gt; <a class="el" href="classfolly_1_1SaturatingSemaphore.html">folly::SaturatingSemaphore</a>&lt; MayBlock, <a class="el" href="ConcurrentHashMapTest_8cpp.html#a98ac53dd3c18b4046e7c5cb0bcb64b75">Atom</a> &gt;::state_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="SaturatingSemaphore_8h_source.html#l00121">121</a> of file <a class="el" href="SaturatingSemaphore_8h_source.html">SaturatingSemaphore.h</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>proxygen/folly/folly/synchronization/<a class="el" href="SaturatingSemaphore_8h_source.html">SaturatingSemaphore.h</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacefolly.html">folly</a></li><li class="navelem"><a class="el" href="classfolly_1_1SaturatingSemaphore.html">SaturatingSemaphore</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
