<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>proxygen: proxygen/folly/folly/io/async/Request.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">proxygen
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('Request_8h_source.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">Request.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="Request_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> * Copyright 2014-present Facebook, Inc.</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> * you may not use this file except in compliance with the License.</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> * You may obtain a copy of the License at</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> *   http://www.apache.org/licenses/LICENSE-2.0</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"> * Unless required by applicable law or agreed to in writing, software</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"> * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"> * See the License for the specific language governing permissions and</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"> * limitations under the License.</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#pragma once</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &lt;memory&gt;</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &lt;string&gt;</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="Synchronized_8h.html">folly/Synchronized.h</a>&gt;</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="F14Map_8h.html">folly/container/F14Map.h</a>&gt;</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="sorted__vector__types_8h.html">folly/sorted_vector_types.h</a>&gt;</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespacefolly.html">folly</a> {</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment"> * A token to be used to fetch data from RequestContext.</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment"> * Generally you will want this to be a static, created only once using a</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment"> * string, and then only copied. The string constructor is expensive.</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00033"></a><span class="lineno"><a class="line" href="classfolly_1_1RequestToken.html">   33</a></span>&#160;<span class="keyword">class </span><a class="code" href="classfolly_1_1RequestToken.html">RequestToken</a> {</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160; <span class="keyword">public</span>:</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  <span class="keyword">explicit</span> <a class="code" href="classfolly_1_1RequestToken.html#a7c67eafa4ee7f40b08a2e8d0d8e57a88">RequestToken</a>(<span class="keyword">const</span> <a class="code" href="Conv_8cpp.html#ae1adbce218e7a9d09164012443191d24">std::string</a>&amp; str);</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;</div><div class="line"><a name="l00037"></a><span class="lineno"><a class="line" href="classfolly_1_1RequestToken.html#ae4629e07eff2a0cfd20e72c2977150c7">   37</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classfolly_1_1RequestToken.html#ae4629e07eff2a0cfd20e72c2977150c7">operator==</a>(<span class="keyword">const</span> <a class="code" href="classfolly_1_1RequestToken.html">RequestToken</a>&amp; other)<span class="keyword"> const </span>{</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classfolly_1_1RequestToken.html#a2469ff0f1eb69cf17827307e45761063">token_</a> == other.<a class="code" href="classfolly_1_1RequestToken.html#a2469ff0f1eb69cf17827307e45761063">token_</a>;</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  }</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  <span class="comment">// Slow, use only for debug log messages.</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  <a class="code" href="Conv_8cpp.html#ae1adbce218e7a9d09164012443191d24">std::string</a> <a class="code" href="classfolly_1_1RequestToken.html#a37dd4dd36b5ab180f5ed5e1a5e767a47">getDebugString</a>() <span class="keyword">const</span>;</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;</div><div class="line"><a name="l00044"></a><span class="lineno"><a class="line" href="classfolly_1_1RequestToken.html#a18fa3706a6ad934c7300bbde7e97d147">   44</a></span>&#160;  <span class="keyword">friend</span> <span class="keyword">struct </span>std::hash&lt;<a class="code" href="namespacefolly.html">folly</a>::<a class="code" href="classfolly_1_1RequestToken.html">RequestToken</a>&gt;;</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160; <span class="keyword">private</span>:</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  static <a class="code" href="structfolly_1_1Synchronized.html">Synchronized</a>&lt;F14FastMap&lt;std::string, uint32_t&gt;&gt;&amp; <a class="code" href="classfolly_1_1RequestToken.html#ae0d15c98481a78f7898f8526c4717687">getCache</a>();</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;</div><div class="line"><a name="l00049"></a><span class="lineno"><a class="line" href="classfolly_1_1RequestToken.html#a2469ff0f1eb69cf17827307e45761063">   49</a></span>&#160;  <a class="code" href="ConstexprMathBenchmark_8cpp.html#a09a1e304d66d35dd47daffee9731edaa">uint32_t</a> <a class="code" href="classfolly_1_1RequestToken.html#a2469ff0f1eb69cf17827307e45761063">token_</a>;</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;};</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;} <span class="comment">// namespace folly</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;namespace <a class="code" href="namespacestd.html">std</a> {</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="keyword">template</span> &lt;&gt;</div><div class="line"><a name="l00056"></a><span class="lineno"><a class="line" href="structstd_1_1hash_3_01folly_1_1RequestToken_01_4.html">   56</a></span>&#160;<span class="keyword">struct </span>hash&lt;<a class="code" href="namespacefolly.html">folly</a>::<a class="code" href="classfolly_1_1RequestToken.html#a7c67eafa4ee7f40b08a2e8d0d8e57a88">RequestToken</a>&gt; {</div><div class="line"><a name="l00057"></a><span class="lineno"><a class="line" href="structstd_1_1hash_3_01folly_1_1RequestToken_01_4.html#a5e80a0b0b65112c88672269f325f1209">   57</a></span>&#160;  <span class="keywordtype">size_t</span> <a class="code" href="structstd_1_1hash_3_01folly_1_1RequestToken_01_4.html#a5e80a0b0b65112c88672269f325f1209">operator()</a>(<span class="keyword">const</span> <a class="code" href="classfolly_1_1RequestToken.html">folly::RequestToken</a>&amp; token)<span class="keyword"> const </span>{</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <span class="keywordflow">return</span> hash&lt;uint32_t&gt;()(token.<a class="code" href="classfolly_1_1RequestToken.html#a2469ff0f1eb69cf17827307e45761063">token_</a>);</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  }</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;};</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;} <span class="comment">// namespace std</span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespacefolly.html">folly</a> {</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">// Some request context that follows an async request through a process</span></div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment">// Everything in the context must be thread safe</span></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;</div><div class="line"><a name="l00068"></a><span class="lineno"><a class="line" href="classfolly_1_1RequestData.html">   68</a></span>&#160;<span class="keyword">class </span><a class="code" href="classfolly_1_1RequestData.html">RequestData</a> {</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160; <span class="keyword">public</span>:</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  <span class="keyword">virtual</span> ~<a class="code" href="classfolly_1_1RequestData.html">RequestData</a>() = <span class="keywordflow">default</span>;</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  <span class="comment">// Avoid calling RequestContext::setContextData, setContextDataIfAbsent, or</span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  <span class="comment">// clearContextData from these callbacks. Doing so will cause deadlock. We</span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  <span class="comment">// could fix these deadlocks, but only at significant performance penalty, so</span></div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  <span class="comment">// just don&#39;t do it!</span></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">bool</span> hasCallback() = 0;</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  <span class="comment">// Callback executed when setting RequestContext. Make sure your RequestData</span></div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  <span class="comment">// instance overrides the hasCallback method to return true otherwise</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  <span class="comment">// the callback will not be executed</span></div><div class="line"><a name="l00081"></a><span class="lineno"><a class="line" href="classfolly_1_1RequestData.html#a9cdb7c06d29cbd0de53597640949e66b">   81</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classfolly_1_1RequestData.html#a9cdb7c06d29cbd0de53597640949e66b">onSet</a>() {}</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  <span class="comment">// Callback executed when unsetting RequestContext. Make sure your RequestData</span></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  <span class="comment">// instance overrides the hasCallback method to return true otherwise</span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  <span class="comment">// the callback will not be executed</span></div><div class="line"><a name="l00085"></a><span class="lineno"><a class="line" href="classfolly_1_1RequestData.html#af544e42488a18dd88c113175d7ced9dd">   85</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classfolly_1_1RequestData.html#af544e42488a18dd88c113175d7ced9dd">onUnset</a>() {}</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160; <span class="keyword">private</span>:</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  <span class="comment">// Start shallow copy implementation details:</span></div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  <span class="comment">// For efficiency, RequestContext provides a raw ptr interface.</span></div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  <span class="comment">// To support shallow copy, we need a shared ptr.</span></div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  <span class="comment">// To keep it as safe as possible (even if a raw ptr is passed back),</span></div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  <span class="comment">// the counter lives directly in RequestData.</span></div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;</div><div class="line"><a name="l00094"></a><span class="lineno"><a class="line" href="classfolly_1_1RequestData.html#adc769bd98269c4df2263c065ec6fce60">   94</a></span>&#160;  <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="classfolly_1_1RequestContext.html">RequestContext</a>;</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  <span class="comment">// Unique ptr with custom destructor, decrement the counter</span></div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  <span class="comment">// and only free if 0</span></div><div class="line"><a name="l00098"></a><span class="lineno"><a class="line" href="structfolly_1_1RequestData_1_1DestructPtr.html">   98</a></span>&#160;  <span class="keyword">struct </span><a class="code" href="structfolly_1_1RequestData_1_1DestructPtr.html">DestructPtr</a> {</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="keywordtype">void</span> operator()(<a class="code" href="classfolly_1_1RequestData.html">RequestData</a>* <a class="code" href="StaticSingletonManager_8cpp.html#a53a30bc00154d79fa155f60e2dfabf5f">ptr</a>);</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  };</div><div class="line"><a name="l00101"></a><span class="lineno"><a class="line" href="classfolly_1_1RequestData.html#a4bef7f0392209a204a5e1b701353b2d3">  101</a></span>&#160;  <span class="keyword">using</span> <a class="code" href="classfolly_1_1RequestData.html#a4bef7f0392209a204a5e1b701353b2d3">SharedPtr</a> = std::unique_ptr&lt;RequestData, DestructPtr&gt;;</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  <span class="comment">// Initialize the pseudo-shared ptr, increment the counter</span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  <span class="keyword">static</span> <a class="code" href="classfolly_1_1RequestData.html#a4bef7f0392209a204a5e1b701353b2d3">SharedPtr</a> constructPtr(<a class="code" href="classfolly_1_1RequestData.html">RequestData</a>* <a class="code" href="StaticSingletonManager_8cpp.html#a53a30bc00154d79fa155f60e2dfabf5f">ptr</a>);</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;</div><div class="line"><a name="l00106"></a><span class="lineno"><a class="line" href="classfolly_1_1RequestData.html#a6f2934bbfee0ed9d87153545b231278a">  106</a></span>&#160;  std::atomic&lt;int&gt; keepAliveCounter_{0};</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  <span class="comment">// End shallow copy</span></div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;};</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment">// If you do not call create() to create a unique request context,</span></div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment">// this default request context will always be returned, and is never</span></div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment">// copied between threads.</span></div><div class="line"><a name="l00113"></a><span class="lineno"><a class="line" href="classfolly_1_1RequestContext.html">  113</a></span>&#160;<span class="keyword">class </span><a class="code" href="classfolly_1_1RequestContext.html">RequestContext</a> {</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160; <span class="keyword">public</span>:</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  <span class="comment">// Create a unique request context for this request.</span></div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  <span class="comment">// It will be passed between queues / threads (where implemented),</span></div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  <span class="comment">// so it should be valid for the lifetime of the request.</span></div><div class="line"><a name="l00118"></a><span class="lineno"><a class="line" href="classfolly_1_1RequestContext.html#a83f614c4acc3510bb2ba5e9d02819d95">  118</a></span>&#160;  <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="classfolly_1_1RequestContext.html#a83f614c4acc3510bb2ba5e9d02819d95">create</a>() {</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    setContext(std::make_shared&lt;RequestContext&gt;());</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  }</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  <span class="comment">// Get the current context.</span></div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  <span class="keyword">static</span> <a class="code" href="classfolly_1_1RequestContext.html">RequestContext</a>* <span class="keyword">get</span>();</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  <span class="comment">// The following APIs are used to add, remove and access RequestData instance</span></div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  <span class="comment">// in the RequestContext instance, normally used for per-RequestContext</span></div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  <span class="comment">// tracking or callback on set and unset. These APIs are Thread-safe.</span></div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  <span class="comment">// These APIs are performance sensitive, so please ask if you need help</span></div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  <span class="comment">// profiling any use of these APIs.</span></div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  <span class="comment">// Add RequestData instance &quot;data&quot; to this RequestContext instance, with</span></div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  <span class="comment">// string identifier &quot;val&quot;. If the same string identifier has already been</span></div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  <span class="comment">// used, will print a warning message for the first time, clear the existing</span></div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  <span class="comment">// RequestData instance for &quot;val&quot;, and **not** add &quot;data&quot;.</span></div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  <span class="keywordtype">void</span> setContextData(</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;      <span class="keyword">const</span> <a class="code" href="classfolly_1_1RequestToken.html">RequestToken</a>&amp; <a class="code" href="String_8cpp.html#a3c8bc0bb4f045bfe78d1196cb786792c">val</a>,</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;      std::unique_ptr&lt;RequestData&gt; <a class="code" href="namespacefolly.html#a23ca01703d6715fb172f4188faa73dc9">data</a>);</div><div class="line"><a name="l00138"></a><span class="lineno"><a class="line" href="classfolly_1_1RequestContext.html#a6ef8bc0040a8bd40f8ef337a3255e1d7">  138</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classfolly_1_1RequestContext.html#a6ef8bc0040a8bd40f8ef337a3255e1d7">setContextData</a>(</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;      <span class="keyword">const</span> <a class="code" href="Conv_8cpp.html#ae1adbce218e7a9d09164012443191d24">std::string</a>&amp; val,</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;      std::unique_ptr&lt;RequestData&gt; data) {</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    setContextData(<a class="code" href="classfolly_1_1RequestToken.html#a7c67eafa4ee7f40b08a2e8d0d8e57a88">RequestToken</a>(val), <a class="code" href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">std::move</a>(data));</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  }</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  <span class="comment">// Add RequestData instance &quot;data&quot; to this RequestContext instance, with</span></div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  <span class="comment">// string identifier &quot;val&quot;. If the same string identifier has already been</span></div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  <span class="comment">// used, return false and do nothing. Otherwise add &quot;data&quot; and return true.</span></div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  <span class="keywordtype">bool</span> setContextDataIfAbsent(</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;      <span class="keyword">const</span> <a class="code" href="classfolly_1_1RequestToken.html">RequestToken</a>&amp; val,</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;      std::unique_ptr&lt;RequestData&gt; data);</div><div class="line"><a name="l00150"></a><span class="lineno"><a class="line" href="classfolly_1_1RequestContext.html#a6015b15d159e1e0f6f369c1ec4239be6">  150</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classfolly_1_1RequestContext.html#a6015b15d159e1e0f6f369c1ec4239be6">setContextDataIfAbsent</a>(</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;      <span class="keyword">const</span> <a class="code" href="Conv_8cpp.html#ae1adbce218e7a9d09164012443191d24">std::string</a>&amp; val,</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;      std::unique_ptr&lt;RequestData&gt; data) {</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <span class="keywordflow">return</span> setContextDataIfAbsent(<a class="code" href="classfolly_1_1RequestToken.html#a7c67eafa4ee7f40b08a2e8d0d8e57a88">RequestToken</a>(val), <a class="code" href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">std::move</a>(data));</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  }</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  <span class="comment">// Remove the RequestData instance with string identifier &quot;val&quot;, if it exists.</span></div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  <span class="keywordtype">void</span> clearContextData(<span class="keyword">const</span> <a class="code" href="classfolly_1_1RequestToken.html">RequestToken</a>&amp; val);</div><div class="line"><a name="l00158"></a><span class="lineno"><a class="line" href="classfolly_1_1RequestContext.html#a0f359adc2b6394e8ca6e917b1a95c327">  158</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classfolly_1_1RequestContext.html#a0f359adc2b6394e8ca6e917b1a95c327">clearContextData</a>(<span class="keyword">const</span> <a class="code" href="Conv_8cpp.html#ae1adbce218e7a9d09164012443191d24">std::string</a>&amp; val) {</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    clearContextData(<a class="code" href="classfolly_1_1RequestToken.html#a7c67eafa4ee7f40b08a2e8d0d8e57a88">RequestToken</a>(val));</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  }</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  <span class="comment">// Returns true if and only if the RequestData instance with string identifier</span></div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  <span class="comment">// &quot;val&quot; exists in this RequestContext instnace.</span></div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  <span class="keywordtype">bool</span> hasContextData(<span class="keyword">const</span> <a class="code" href="classfolly_1_1RequestToken.html">RequestToken</a>&amp; val) <span class="keyword">const</span>;</div><div class="line"><a name="l00165"></a><span class="lineno"><a class="line" href="classfolly_1_1RequestContext.html#a01b8feff97cdad4d2b1f9d31bfedba36">  165</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classfolly_1_1RequestContext.html#a01b8feff97cdad4d2b1f9d31bfedba36">hasContextData</a>(<span class="keyword">const</span> <a class="code" href="Conv_8cpp.html#ae1adbce218e7a9d09164012443191d24">std::string</a>&amp; val)<span class="keyword"> const </span>{</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <span class="keywordflow">return</span> hasContextData(<a class="code" href="classfolly_1_1RequestToken.html#a7c67eafa4ee7f40b08a2e8d0d8e57a88">RequestToken</a>(val));</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  }</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  <span class="comment">// Get (constant) raw pointer of the RequestData instance with string</span></div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;  <span class="comment">// identifier &quot;val&quot; if it exists, otherwise returns null pointer.</span></div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  <a class="code" href="classfolly_1_1RequestData.html">RequestData</a>* getContextData(<span class="keyword">const</span> <a class="code" href="classfolly_1_1RequestToken.html">RequestToken</a>&amp; val);</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  <span class="keyword">const</span> <a class="code" href="classfolly_1_1RequestData.html">RequestData</a>* getContextData(<span class="keyword">const</span> <a class="code" href="classfolly_1_1RequestToken.html">RequestToken</a>&amp; val) <span class="keyword">const</span>;</div><div class="line"><a name="l00173"></a><span class="lineno"><a class="line" href="classfolly_1_1RequestContext.html#aa902aaa1466949fa0b18dbf7cfab3d1e">  173</a></span>&#160;  <a class="code" href="classfolly_1_1RequestData.html">RequestData</a>* <a class="code" href="classfolly_1_1RequestContext.html#aa902aaa1466949fa0b18dbf7cfab3d1e">getContextData</a>(<span class="keyword">const</span> <a class="code" href="Conv_8cpp.html#ae1adbce218e7a9d09164012443191d24">std::string</a>&amp; val) {</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <span class="keywordflow">return</span> getContextData(<a class="code" href="classfolly_1_1RequestToken.html#a7c67eafa4ee7f40b08a2e8d0d8e57a88">RequestToken</a>(val));</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  }</div><div class="line"><a name="l00176"></a><span class="lineno"><a class="line" href="classfolly_1_1RequestContext.html#a5ad5ce37edb439662bc5b5c1e2db13f6">  176</a></span>&#160;  <span class="keyword">const</span> <a class="code" href="classfolly_1_1RequestData.html">RequestData</a>* <a class="code" href="classfolly_1_1RequestContext.html#a5ad5ce37edb439662bc5b5c1e2db13f6">getContextData</a>(<span class="keyword">const</span> <a class="code" href="Conv_8cpp.html#ae1adbce218e7a9d09164012443191d24">std::string</a>&amp; val)<span class="keyword"> const </span>{</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="keywordflow">return</span> getContextData(<a class="code" href="classfolly_1_1RequestToken.html#a7c67eafa4ee7f40b08a2e8d0d8e57a88">RequestToken</a>(val));</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  }</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  <span class="keywordtype">void</span> onSet();</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;  <span class="keywordtype">void</span> onUnset();</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  <span class="comment">// The following API is used to pass the context through queues / threads.</span></div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;  <span class="comment">// saveContext is called to get a shared_ptr to the context, and</span></div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  <span class="comment">// setContext is used to reset it on the other side of the queue.</span></div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  <span class="comment">//</span></div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  <span class="comment">// Whenever possible, use RequestContextScopeGuard instead of setContext</span></div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  <span class="comment">// to make sure that RequestContext is reset to the original value when</span></div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  <span class="comment">// we exit the scope.</span></div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;  <span class="comment">//</span></div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  <span class="comment">// A shared_ptr is used, because many request may fan out across</span></div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;  <span class="comment">// multiple threads, or do post-send processing, etc.</span></div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  <span class="keyword">static</span> std::shared_ptr&lt;RequestContext&gt; setContext(</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;      std::shared_ptr&lt;RequestContext&gt; ctx);</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;</div><div class="line"><a name="l00196"></a><span class="lineno"><a class="line" href="classfolly_1_1RequestContext.html#a400dbde2d305cda780eaf9fbcfe3087c">  196</a></span>&#160;  <span class="keyword">static</span> std::shared_ptr&lt;RequestContext&gt; <a class="code" href="classfolly_1_1RequestContext.html#a400dbde2d305cda780eaf9fbcfe3087c">saveContext</a>() {</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <span class="keywordflow">return</span> getStaticContext();</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  }</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160; <span class="keyword">private</span>:</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  <span class="keyword">static</span> std::shared_ptr&lt;RequestContext&gt;&amp; getStaticContext();</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;  <span class="comment">// Start shallow copy guard implementation details:</span></div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  <span class="comment">// All methods are private to encourage proper use</span></div><div class="line"><a name="l00205"></a><span class="lineno"><a class="line" href="classfolly_1_1RequestContext.html#ac4d84ca4b0d2765e2a64130df82cfb7c">  205</a></span>&#160;  <span class="keyword">friend</span> <span class="keyword">struct </span><a class="code" href="structfolly_1_1ShallowCopyRequestContextScopeGuard.html">ShallowCopyRequestContextScopeGuard</a>;</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;  <span class="comment">// This sets a shallow copy of the current context as current,</span></div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;  <span class="comment">// then return the previous context (so it can be reset later).</span></div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  <span class="keyword">static</span> std::shared_ptr&lt;RequestContext&gt; setShallowCopyContext();</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  <span class="comment">// Similar to setContextData, except it overwrites the data</span></div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;  <span class="comment">// if already set (instead of warn + reset ptr).</span></div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;  <span class="keywordtype">void</span> overwriteContextData(</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;      <span class="keyword">const</span> <a class="code" href="classfolly_1_1RequestToken.html">RequestToken</a>&amp; val,</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;      std::unique_ptr&lt;RequestData&gt; data);</div><div class="line"><a name="l00216"></a><span class="lineno"><a class="line" href="classfolly_1_1RequestContext.html#a75790ac18eed980eed8182129c349a8d">  216</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classfolly_1_1RequestContext.html#a75790ac18eed980eed8182129c349a8d">overwriteContextData</a>(</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;      <span class="keyword">const</span> <a class="code" href="Conv_8cpp.html#ae1adbce218e7a9d09164012443191d24">std::string</a>&amp; val,</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;      std::unique_ptr&lt;RequestData&gt; data) {</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    overwriteContextData(<a class="code" href="classfolly_1_1RequestToken.html#a7c67eafa4ee7f40b08a2e8d0d8e57a88">RequestToken</a>(val), <a class="code" href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">std::move</a>(data));</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;  }</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;  <span class="comment">// End shallow copy guard</span></div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;</div><div class="line"><a name="l00223"></a><span class="lineno"><a class="line" href="classfolly_1_1RequestContext.html#a46d2fb26239afa98fd52f19be3d91c24">  223</a></span>&#160;  <span class="keyword">enum class</span> <a class="code" href="classfolly_1_1RequestContext.html#a46d2fb26239afa98fd52f19be3d91c24">DoSetBehaviour</a> {</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    SET,</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    SET_IF_ABSENT,</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    OVERWRITE,</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;  };</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  <span class="keywordtype">bool</span> doSetContextData(</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;      <span class="keyword">const</span> <a class="code" href="classfolly_1_1RequestToken.html">RequestToken</a>&amp; val,</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;      std::unique_ptr&lt;RequestData&gt;&amp; data,</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;      <a class="code" href="classfolly_1_1RequestContext.html#a46d2fb26239afa98fd52f19be3d91c24">DoSetBehaviour</a> behaviour);</div><div class="line"><a name="l00233"></a><span class="lineno"><a class="line" href="classfolly_1_1RequestContext.html#adeab37d52d57a2c5c16584a965debd81">  233</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classfolly_1_1RequestContext.html#adeab37d52d57a2c5c16584a965debd81">doSetContextData</a>(</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;      <span class="keyword">const</span> <a class="code" href="Conv_8cpp.html#ae1adbce218e7a9d09164012443191d24">std::string</a>&amp; val,</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;      std::unique_ptr&lt;RequestData&gt;&amp; data,</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;      <a class="code" href="classfolly_1_1RequestContext.html#a46d2fb26239afa98fd52f19be3d91c24">DoSetBehaviour</a> behaviour) {</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <span class="keywordflow">return</span> doSetContextData(<a class="code" href="classfolly_1_1RequestToken.html#a7c67eafa4ee7f40b08a2e8d0d8e57a88">RequestToken</a>(val), data, behaviour);</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  }</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;</div><div class="line"><a name="l00240"></a><span class="lineno"><a class="line" href="structfolly_1_1RequestContext_1_1State.html">  240</a></span>&#160;  <span class="keyword">struct </span><a class="code" href="structfolly_1_1RequestContext_1_1State.html">State</a> {</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <span class="comment">// This must be optimized for lookup, its hot path is getContextData</span></div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <span class="comment">// Efficiency of copying the container also matters in setShallowCopyContext</span></div><div class="line"><a name="l00243"></a><span class="lineno"><a class="line" href="structfolly_1_1RequestContext_1_1State.html#a252015670fc86293f27090c15d3b57d7">  243</a></span>&#160;    <a class="code" href="classfolly_1_1F14FastMap.html">F14FastMap&lt;RequestToken, RequestData::SharedPtr&gt;</a> <a class="code" href="structfolly_1_1RequestContext_1_1State.html#a252015670fc86293f27090c15d3b57d7">requestData_</a>;</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <span class="comment">// This must be optimized for iteration, its hot path is setContext</span></div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <span class="comment">// We also use the fact that it&#39;s ordered to efficiently compute</span></div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <span class="comment">// the difference with previous context</span></div><div class="line"><a name="l00247"></a><span class="lineno"><a class="line" href="structfolly_1_1RequestContext_1_1State.html#a6924eca9d8a19af2c07339512860b90c">  247</a></span>&#160;    <a class="code" href="classfolly_1_1sorted__vector__set.html">sorted_vector_set&lt;RequestData*&gt;</a> <a class="code" href="structfolly_1_1RequestContext_1_1State.html#a6924eca9d8a19af2c07339512860b90c">callbackData_</a>;</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;  };</div><div class="line"><a name="l00249"></a><span class="lineno"><a class="line" href="classfolly_1_1RequestContext.html#accab9bf006d7f31e3844e4dcbdea6f4c">  249</a></span>&#160;  <a class="code" href="structfolly_1_1Synchronized.html">folly::Synchronized&lt;State&gt;</a> <a class="code" href="classfolly_1_1RequestContext.html#accab9bf006d7f31e3844e4dcbdea6f4c">state_</a>;</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;};</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;</div><div class="line"><a name="l00256"></a><span class="lineno"><a class="line" href="classfolly_1_1RequestContextScopeGuard.html">  256</a></span>&#160;<span class="keyword">class </span><a class="code" href="classfolly_1_1RequestContextScopeGuard.html">RequestContextScopeGuard</a> {</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160; <span class="keyword">private</span>:</div><div class="line"><a name="l00258"></a><span class="lineno"><a class="line" href="classfolly_1_1RequestContextScopeGuard.html#ab765bdc92e4f621fc06f0ef05549dc9f">  258</a></span>&#160;  std::shared_ptr&lt;RequestContext&gt; <a class="code" href="classfolly_1_1RequestContextScopeGuard.html#ab765bdc92e4f621fc06f0ef05549dc9f">prev_</a>;</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160; <span class="keyword">public</span>:</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;  <a class="code" href="classfolly_1_1RequestContextScopeGuard.html">RequestContextScopeGuard</a>(<span class="keyword">const</span> <a class="code" href="classfolly_1_1RequestContextScopeGuard.html">RequestContextScopeGuard</a>&amp;) = <span class="keyword">delete</span>;</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;  <a class="code" href="classfolly_1_1RequestContextScopeGuard.html">RequestContextScopeGuard</a>&amp; operator=(<span class="keyword">const</span> <a class="code" href="classfolly_1_1RequestContextScopeGuard.html">RequestContextScopeGuard</a>&amp;) = <span class="keyword">delete</span>;</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;  <a class="code" href="classfolly_1_1RequestContextScopeGuard.html">RequestContextScopeGuard</a>(<a class="code" href="classfolly_1_1RequestContextScopeGuard.html">RequestContextScopeGuard</a>&amp;&amp;) = <span class="keyword">delete</span>;</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;  <a class="code" href="classfolly_1_1RequestContextScopeGuard.html">RequestContextScopeGuard</a>&amp; operator=(<a class="code" href="classfolly_1_1RequestContextScopeGuard.html">RequestContextScopeGuard</a>&amp;&amp;) = <span class="keyword">delete</span>;</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;  <span class="comment">// Create a new RequestContext and reset to the original value when</span></div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;  <span class="comment">// this goes out of scope.</span></div><div class="line"><a name="l00268"></a><span class="lineno"><a class="line" href="classfolly_1_1RequestContextScopeGuard.html#a6bd518ef6e60fd26ee09ed2ff9e311e1">  268</a></span>&#160;  <a class="code" href="classfolly_1_1RequestContextScopeGuard.html#a6bd518ef6e60fd26ee09ed2ff9e311e1">RequestContextScopeGuard</a>() : prev_(<a class="code" href="classfolly_1_1RequestContext.html">RequestContext</a>::saveContext()) {</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <a class="code" href="classfolly_1_1RequestContext.html#a83f614c4acc3510bb2ba5e9d02819d95">RequestContext::create</a>();</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  }</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;  <span class="comment">// Set a RequestContext that was previously captured by saveContext(). It will</span></div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;  <span class="comment">// be automatically reset to the original value when this goes out of scope.</span></div><div class="line"><a name="l00274"></a><span class="lineno"><a class="line" href="classfolly_1_1RequestContextScopeGuard.html#a2e528f4100da1860459939db6bff84bc">  274</a></span>&#160;  <span class="keyword">explicit</span> <a class="code" href="classfolly_1_1RequestContextScopeGuard.html#a2e528f4100da1860459939db6bff84bc">RequestContextScopeGuard</a>(std::shared_ptr&lt;RequestContext&gt; ctx)</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;      : prev_(<a class="code" href="classfolly_1_1RequestContext.html">RequestContext</a>::setContext(<a class="code" href="namespacestd.html">std</a>::<a class="code" href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">move</a>(ctx))) {}</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;</div><div class="line"><a name="l00277"></a><span class="lineno"><a class="line" href="classfolly_1_1RequestContextScopeGuard.html#a67de7decd46b5335caf0970efa6a1759">  277</a></span>&#160;  <a class="code" href="classfolly_1_1RequestContextScopeGuard.html#a67de7decd46b5335caf0970efa6a1759">~RequestContextScopeGuard</a>() {</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <a class="code" href="classfolly_1_1RequestContext.html#a55236af0154a1ab4d6fca74f55a6307d">RequestContext::setContext</a>(<a class="code" href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">std::move</a>(prev_));</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;  }</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;};</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;</div><div class="line"><a name="l00289"></a><span class="lineno"><a class="line" href="structfolly_1_1ShallowCopyRequestContextScopeGuard.html">  289</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structfolly_1_1ShallowCopyRequestContextScopeGuard.html">ShallowCopyRequestContextScopeGuard</a> {</div><div class="line"><a name="l00290"></a><span class="lineno"><a class="line" href="structfolly_1_1ShallowCopyRequestContextScopeGuard.html#a4270c529078393021c34e491dad10c5f">  290</a></span>&#160;  <a class="code" href="structfolly_1_1ShallowCopyRequestContextScopeGuard.html#a4270c529078393021c34e491dad10c5f">ShallowCopyRequestContextScopeGuard</a>()</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;      : prev_(<a class="code" href="classfolly_1_1RequestContext.html">RequestContext</a>::setShallowCopyContext()) {}</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;</div><div class="line"><a name="l00299"></a><span class="lineno"><a class="line" href="structfolly_1_1ShallowCopyRequestContextScopeGuard.html#a8d979d28469ac5c9be20dbb9fbb413fe">  299</a></span>&#160;  <a class="code" href="structfolly_1_1ShallowCopyRequestContextScopeGuard.html#a8d979d28469ac5c9be20dbb9fbb413fe">ShallowCopyRequestContextScopeGuard</a>(</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;      <span class="keyword">const</span> <a class="code" href="classfolly_1_1RequestToken.html">RequestToken</a>&amp; <a class="code" href="String_8cpp.html#a3c8bc0bb4f045bfe78d1196cb786792c">val</a>,</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;      std::unique_ptr&lt;RequestData&gt; <a class="code" href="namespacefolly.html#a23ca01703d6715fb172f4188faa73dc9">data</a>)</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;      : <a class="code" href="structfolly_1_1ShallowCopyRequestContextScopeGuard.html">ShallowCopyRequestContextScopeGuard</a>() {</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <a class="code" href="classfolly_1_1RequestContext.html#a7e91895b2a3d8a61bc5002d4e7704f96">RequestContext::get</a>()-&gt;<a class="code" href="classfolly_1_1RequestContext.html#ab5084dfce6e1480fde82b459f84a1454">overwriteContextData</a>(val, <a class="code" href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">std::move</a>(data));</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;  }</div><div class="line"><a name="l00305"></a><span class="lineno"><a class="line" href="structfolly_1_1ShallowCopyRequestContextScopeGuard.html#ae226cb38bc54d4cf6c066eb7ee006ac2">  305</a></span>&#160;  <a class="code" href="structfolly_1_1ShallowCopyRequestContextScopeGuard.html#ae226cb38bc54d4cf6c066eb7ee006ac2">ShallowCopyRequestContextScopeGuard</a>(</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;      <span class="keyword">const</span> <a class="code" href="Conv_8cpp.html#ae1adbce218e7a9d09164012443191d24">std::string</a>&amp; <a class="code" href="String_8cpp.html#a3c8bc0bb4f045bfe78d1196cb786792c">val</a>,</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;      std::unique_ptr&lt;RequestData&gt; <a class="code" href="namespacefolly.html#a23ca01703d6715fb172f4188faa73dc9">data</a>)</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;      : <a class="code" href="structfolly_1_1ShallowCopyRequestContextScopeGuard.html">ShallowCopyRequestContextScopeGuard</a>() {</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <a class="code" href="classfolly_1_1RequestContext.html#a7e91895b2a3d8a61bc5002d4e7704f96">RequestContext::get</a>()-&gt;<a class="code" href="classfolly_1_1RequestContext.html#ab5084dfce6e1480fde82b459f84a1454">overwriteContextData</a>(val, <a class="code" href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">std::move</a>(data));</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;  }</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;</div><div class="line"><a name="l00312"></a><span class="lineno"><a class="line" href="structfolly_1_1ShallowCopyRequestContextScopeGuard.html#a928fd6f99dc2f32f5e841f2f3ace8801">  312</a></span>&#160;  <a class="code" href="structfolly_1_1ShallowCopyRequestContextScopeGuard.html#a928fd6f99dc2f32f5e841f2f3ace8801">~ShallowCopyRequestContextScopeGuard</a>() {</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <a class="code" href="classfolly_1_1RequestContext.html#a55236af0154a1ab4d6fca74f55a6307d">RequestContext::setContext</a>(<a class="code" href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">std::move</a>(prev_));</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;  }</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;  <a class="code" href="structfolly_1_1ShallowCopyRequestContextScopeGuard.html">ShallowCopyRequestContextScopeGuard</a>(</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;      <span class="keyword">const</span> <a class="code" href="structfolly_1_1ShallowCopyRequestContextScopeGuard.html">ShallowCopyRequestContextScopeGuard</a>&amp;) = <span class="keyword">delete</span>;</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  <a class="code" href="structfolly_1_1ShallowCopyRequestContextScopeGuard.html">ShallowCopyRequestContextScopeGuard</a>&amp; operator=(</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;      <span class="keyword">const</span> <a class="code" href="structfolly_1_1ShallowCopyRequestContextScopeGuard.html">ShallowCopyRequestContextScopeGuard</a>&amp;) = <span class="keyword">delete</span>;</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;  <a class="code" href="structfolly_1_1ShallowCopyRequestContextScopeGuard.html">ShallowCopyRequestContextScopeGuard</a>(<a class="code" href="structfolly_1_1ShallowCopyRequestContextScopeGuard.html">ShallowCopyRequestContextScopeGuard</a>&amp;&amp;) =</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;      <span class="keyword">delete</span>;</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;  <a class="code" href="structfolly_1_1ShallowCopyRequestContextScopeGuard.html">ShallowCopyRequestContextScopeGuard</a>&amp; operator=(</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;      <a class="code" href="structfolly_1_1ShallowCopyRequestContextScopeGuard.html">ShallowCopyRequestContextScopeGuard</a>&amp;&amp;) = <span class="keyword">delete</span>;</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160; <span class="keyword">private</span>:</div><div class="line"><a name="l00326"></a><span class="lineno"><a class="line" href="structfolly_1_1ShallowCopyRequestContextScopeGuard.html#a95b88ff1d499db1332e7acb1f57469bb">  326</a></span>&#160;  std::shared_ptr&lt;RequestContext&gt; <a class="code" href="structfolly_1_1ShallowCopyRequestContextScopeGuard.html#a95b88ff1d499db1332e7acb1f57469bb">prev_</a>;</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;};</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;} <span class="comment">// namespace folly</span></div><div class="ttc" id="structfolly_1_1RequestContext_1_1State_html"><div class="ttname"><a href="structfolly_1_1RequestContext_1_1State.html">folly::RequestContext::State</a></div><div class="ttdef"><b>Definition:</b> <a href="Request_8h_source.html#l00240">Request.h:240</a></div></div>
<div class="ttc" id="StaticSingletonManager_8cpp_html_a53a30bc00154d79fa155f60e2dfabf5f"><div class="ttname"><a href="StaticSingletonManager_8cpp.html#a53a30bc00154d79fa155f60e2dfabf5f">ptr</a></div><div class="ttdeci">void * ptr</div><div class="ttdef"><b>Definition:</b> <a href="StaticSingletonManager_8cpp_source.html#l00038">StaticSingletonManager.cpp:38</a></div></div>
<div class="ttc" id="classfolly_1_1RequestContext_html_a5ad5ce37edb439662bc5b5c1e2db13f6"><div class="ttname"><a href="classfolly_1_1RequestContext.html#a5ad5ce37edb439662bc5b5c1e2db13f6">folly::RequestContext::getContextData</a></div><div class="ttdeci">const RequestData * getContextData(const std::string &amp;val) const </div><div class="ttdef"><b>Definition:</b> <a href="Request_8h_source.html#l00176">Request.h:176</a></div></div>
<div class="ttc" id="classfolly_1_1F14FastMap_html"><div class="ttname"><a href="classfolly_1_1F14FastMap.html">folly::F14FastMap</a></div><div class="ttdef"><b>Definition:</b> <a href="F14Map-fwd_8h_source.html#l00054">F14Map-fwd.h:54</a></div></div>
<div class="ttc" id="classfolly_1_1RequestContext_html_a55236af0154a1ab4d6fca74f55a6307d"><div class="ttname"><a href="classfolly_1_1RequestContext.html#a55236af0154a1ab4d6fca74f55a6307d">folly::RequestContext::setContext</a></div><div class="ttdeci">static std::shared_ptr&lt; RequestContext &gt; setContext(std::shared_ptr&lt; RequestContext &gt; ctx)</div><div class="ttdef"><b>Definition:</b> <a href="Request_8cpp_source.html#l00227">Request.cpp:227</a></div></div>
<div class="ttc" id="classfolly_1_1RequestContext_html_a46d2fb26239afa98fd52f19be3d91c24"><div class="ttname"><a href="classfolly_1_1RequestContext.html#a46d2fb26239afa98fd52f19be3d91c24">folly::RequestContext::DoSetBehaviour</a></div><div class="ttdeci">DoSetBehaviour</div><div class="ttdef"><b>Definition:</b> <a href="Request_8h_source.html#l00223">Request.h:223</a></div></div>
<div class="ttc" id="classfolly_1_1RequestToken_html"><div class="ttname"><a href="classfolly_1_1RequestToken.html">folly::RequestToken</a></div><div class="ttdef"><b>Definition:</b> <a href="Request_8h_source.html#l00033">Request.h:33</a></div></div>
<div class="ttc" id="classfolly_1_1RequestToken_html_a37dd4dd36b5ab180f5ed5e1a5e767a47"><div class="ttname"><a href="classfolly_1_1RequestToken.html#a37dd4dd36b5ab180f5ed5e1a5e767a47">folly::RequestToken::getDebugString</a></div><div class="ttdeci">std::string getDebugString() const </div><div class="ttdef"><b>Definition:</b> <a href="Request_8cpp_source.html#l00049">Request.cpp:49</a></div></div>
<div class="ttc" id="classfolly_1_1RequestContext_html_a01b8feff97cdad4d2b1f9d31bfedba36"><div class="ttname"><a href="classfolly_1_1RequestContext.html#a01b8feff97cdad4d2b1f9d31bfedba36">folly::RequestContext::hasContextData</a></div><div class="ttdeci">bool hasContextData(const std::string &amp;val) const </div><div class="ttdef"><b>Definition:</b> <a href="Request_8h_source.html#l00165">Request.h:165</a></div></div>
<div class="ttc" id="sorted__vector__types_8h_html"><div class="ttname"><a href="sorted__vector__types_8h.html">sorted_vector_types.h</a></div></div>
<div class="ttc" id="namespacefolly_1_1gen_html_ac24ec252b1b738a40c274285527c193f"><div class="ttname"><a href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">folly::gen::move</a></div><div class="ttdeci">constexpr detail::Map&lt; Move &gt; move</div><div class="ttdef"><b>Definition:</b> <a href="Base-inl_8h_source.html#l02567">Base-inl.h:2567</a></div></div>
<div class="ttc" id="classfolly_1_1RequestContext_html_a83f614c4acc3510bb2ba5e9d02819d95"><div class="ttname"><a href="classfolly_1_1RequestContext.html#a83f614c4acc3510bb2ba5e9d02819d95">folly::RequestContext::create</a></div><div class="ttdeci">static void create()</div><div class="ttdef"><b>Definition:</b> <a href="Request_8h_source.html#l00118">Request.h:118</a></div></div>
<div class="ttc" id="classfolly_1_1RequestToken_html_ae4629e07eff2a0cfd20e72c2977150c7"><div class="ttname"><a href="classfolly_1_1RequestToken.html#ae4629e07eff2a0cfd20e72c2977150c7">folly::RequestToken::operator==</a></div><div class="ttdeci">bool operator==(const RequestToken &amp;other) const </div><div class="ttdef"><b>Definition:</b> <a href="Request_8h_source.html#l00037">Request.h:37</a></div></div>
<div class="ttc" id="structfolly_1_1RequestData_1_1DestructPtr_html"><div class="ttname"><a href="structfolly_1_1RequestData_1_1DestructPtr.html">folly::RequestData::DestructPtr</a></div><div class="ttdef"><b>Definition:</b> <a href="Request_8h_source.html#l00098">Request.h:98</a></div></div>
<div class="ttc" id="namespacestd_html"><div class="ttname"><a href="namespacestd.html">std</a></div><div class="ttdoc">STL namespace. </div></div>
<div class="ttc" id="String_8cpp_html_a3c8bc0bb4f045bfe78d1196cb786792c"><div class="ttname"><a href="String_8cpp.html#a3c8bc0bb4f045bfe78d1196cb786792c">val</a></div><div class="ttdeci">double val</div><div class="ttdef"><b>Definition:</b> <a href="String_8cpp_source.html#l00273">String.cpp:273</a></div></div>
<div class="ttc" id="structstd_1_1hash_3_01folly_1_1RequestToken_01_4_html_a5e80a0b0b65112c88672269f325f1209"><div class="ttname"><a href="structstd_1_1hash_3_01folly_1_1RequestToken_01_4.html#a5e80a0b0b65112c88672269f325f1209">std::hash&lt; folly::RequestToken &gt;::operator()</a></div><div class="ttdeci">size_t operator()(const folly::RequestToken &amp;token) const </div><div class="ttdef"><b>Definition:</b> <a href="Request_8h_source.html#l00057">Request.h:57</a></div></div>
<div class="ttc" id="Synchronized_8h_html"><div class="ttname"><a href="Synchronized_8h.html">Synchronized.h</a></div></div>
<div class="ttc" id="classfolly_1_1RequestData_html_a9cdb7c06d29cbd0de53597640949e66b"><div class="ttname"><a href="classfolly_1_1RequestData.html#a9cdb7c06d29cbd0de53597640949e66b">folly::RequestData::onSet</a></div><div class="ttdeci">virtual void onSet()</div><div class="ttdef"><b>Definition:</b> <a href="Request_8h_source.html#l00081">Request.h:81</a></div></div>
<div class="ttc" id="namespacefolly_html"><div class="ttname"><a href="namespacefolly.html">folly</a></div><div class="ttdoc">—— Concurrent Priority Queue Implementation —— </div><div class="ttdef"><b>Definition:</b> <a href="AtomicBitSet_8h_source.html#l00029">AtomicBitSet.h:29</a></div></div>
<div class="ttc" id="classfolly_1_1RequestContext_html_a6015b15d159e1e0f6f369c1ec4239be6"><div class="ttname"><a href="classfolly_1_1RequestContext.html#a6015b15d159e1e0f6f369c1ec4239be6">folly::RequestContext::setContextDataIfAbsent</a></div><div class="ttdeci">bool setContextDataIfAbsent(const std::string &amp;val, std::unique_ptr&lt; RequestData &gt; data)</div><div class="ttdef"><b>Definition:</b> <a href="Request_8h_source.html#l00150">Request.h:150</a></div></div>
<div class="ttc" id="classfolly_1_1RequestToken_html_a7c67eafa4ee7f40b08a2e8d0d8e57a88"><div class="ttname"><a href="classfolly_1_1RequestToken.html#a7c67eafa4ee7f40b08a2e8d0d8e57a88">folly::RequestToken::RequestToken</a></div><div class="ttdeci">RequestToken(const std::string &amp;str)</div><div class="ttdef"><b>Definition:</b> <a href="Request_8cpp_source.html#l00027">Request.cpp:27</a></div></div>
<div class="ttc" id="classfolly_1_1RequestContext_html_ab5084dfce6e1480fde82b459f84a1454"><div class="ttname"><a href="classfolly_1_1RequestContext.html#ab5084dfce6e1480fde82b459f84a1454">folly::RequestContext::overwriteContextData</a></div><div class="ttdeci">void overwriteContextData(const RequestToken &amp;val, std::unique_ptr&lt; RequestData &gt; data)</div><div class="ttdef"><b>Definition:</b> <a href="Request_8cpp_source.html#l00141">Request.cpp:141</a></div></div>
<div class="ttc" id="classfolly_1_1RequestContextScopeGuard_html_a2e528f4100da1860459939db6bff84bc"><div class="ttname"><a href="classfolly_1_1RequestContextScopeGuard.html#a2e528f4100da1860459939db6bff84bc">folly::RequestContextScopeGuard::RequestContextScopeGuard</a></div><div class="ttdeci">RequestContextScopeGuard(std::shared_ptr&lt; RequestContext &gt; ctx)</div><div class="ttdef"><b>Definition:</b> <a href="Request_8h_source.html#l00274">Request.h:274</a></div></div>
<div class="ttc" id="structfolly_1_1ShallowCopyRequestContextScopeGuard_html_a928fd6f99dc2f32f5e841f2f3ace8801"><div class="ttname"><a href="structfolly_1_1ShallowCopyRequestContextScopeGuard.html#a928fd6f99dc2f32f5e841f2f3ace8801">folly::ShallowCopyRequestContextScopeGuard::~ShallowCopyRequestContextScopeGuard</a></div><div class="ttdeci">~ShallowCopyRequestContextScopeGuard()</div><div class="ttdef"><b>Definition:</b> <a href="Request_8h_source.html#l00312">Request.h:312</a></div></div>
<div class="ttc" id="classfolly_1_1sorted__vector__set_html"><div class="ttname"><a href="classfolly_1_1sorted__vector__set.html">folly::sorted_vector_set</a></div><div class="ttdef"><b>Definition:</b> <a href="sorted__vector__types_8h_source.html#l00228">sorted_vector_types.h:228</a></div></div>
<div class="ttc" id="structfolly_1_1ShallowCopyRequestContextScopeGuard_html_a4270c529078393021c34e491dad10c5f"><div class="ttname"><a href="structfolly_1_1ShallowCopyRequestContextScopeGuard.html#a4270c529078393021c34e491dad10c5f">folly::ShallowCopyRequestContextScopeGuard::ShallowCopyRequestContextScopeGuard</a></div><div class="ttdeci">ShallowCopyRequestContextScopeGuard()</div><div class="ttdef"><b>Definition:</b> <a href="Request_8h_source.html#l00290">Request.h:290</a></div></div>
<div class="ttc" id="classfolly_1_1RequestContext_html_a400dbde2d305cda780eaf9fbcfe3087c"><div class="ttname"><a href="classfolly_1_1RequestContext.html#a400dbde2d305cda780eaf9fbcfe3087c">folly::RequestContext::saveContext</a></div><div class="ttdeci">static std::shared_ptr&lt; RequestContext &gt; saveContext()</div><div class="ttdef"><b>Definition:</b> <a href="Request_8h_source.html#l00196">Request.h:196</a></div></div>
<div class="ttc" id="classfolly_1_1RequestContext_html_a6ef8bc0040a8bd40f8ef337a3255e1d7"><div class="ttname"><a href="classfolly_1_1RequestContext.html#a6ef8bc0040a8bd40f8ef337a3255e1d7">folly::RequestContext::setContextData</a></div><div class="ttdeci">void setContextData(const std::string &amp;val, std::unique_ptr&lt; RequestData &gt; data)</div><div class="ttdef"><b>Definition:</b> <a href="Request_8h_source.html#l00138">Request.h:138</a></div></div>
<div class="ttc" id="structfolly_1_1Synchronized_html"><div class="ttname"><a href="structfolly_1_1Synchronized.html">folly::Synchronized</a></div><div class="ttdef"><b>Definition:</b> <a href="Synchronized_8h_source.html#l00438">Synchronized.h:438</a></div></div>
<div class="ttc" id="classfolly_1_1RequestContextScopeGuard_html_ab765bdc92e4f621fc06f0ef05549dc9f"><div class="ttname"><a href="classfolly_1_1RequestContextScopeGuard.html#ab765bdc92e4f621fc06f0ef05549dc9f">folly::RequestContextScopeGuard::prev_</a></div><div class="ttdeci">std::shared_ptr&lt; RequestContext &gt; prev_</div><div class="ttdef"><b>Definition:</b> <a href="Request_8h_source.html#l00258">Request.h:258</a></div></div>
<div class="ttc" id="namespacefolly_html_a23ca01703d6715fb172f4188faa73dc9"><div class="ttname"><a href="namespacefolly.html#a23ca01703d6715fb172f4188faa73dc9">folly::data</a></div><div class="ttdeci">constexpr auto data(C &amp;c) -&gt; decltype(c.data())</div><div class="ttdef"><b>Definition:</b> <a href="Access_8h_source.html#l00071">Access.h:71</a></div></div>
<div class="ttc" id="classfolly_1_1RequestContext_html_aa902aaa1466949fa0b18dbf7cfab3d1e"><div class="ttname"><a href="classfolly_1_1RequestContext.html#aa902aaa1466949fa0b18dbf7cfab3d1e">folly::RequestContext::getContextData</a></div><div class="ttdeci">RequestData * getContextData(const std::string &amp;val)</div><div class="ttdef"><b>Definition:</b> <a href="Request_8h_source.html#l00173">Request.h:173</a></div></div>
<div class="ttc" id="structfolly_1_1ShallowCopyRequestContextScopeGuard_html"><div class="ttname"><a href="structfolly_1_1ShallowCopyRequestContextScopeGuard.html">folly::ShallowCopyRequestContextScopeGuard</a></div><div class="ttdef"><b>Definition:</b> <a href="Request_8h_source.html#l00289">Request.h:289</a></div></div>
<div class="ttc" id="classfolly_1_1RequestContextScopeGuard_html_a67de7decd46b5335caf0970efa6a1759"><div class="ttname"><a href="classfolly_1_1RequestContextScopeGuard.html#a67de7decd46b5335caf0970efa6a1759">folly::RequestContextScopeGuard::~RequestContextScopeGuard</a></div><div class="ttdeci">~RequestContextScopeGuard()</div><div class="ttdef"><b>Definition:</b> <a href="Request_8h_source.html#l00277">Request.h:277</a></div></div>
<div class="ttc" id="structfolly_1_1RequestContext_1_1State_html_a6924eca9d8a19af2c07339512860b90c"><div class="ttname"><a href="structfolly_1_1RequestContext_1_1State.html#a6924eca9d8a19af2c07339512860b90c">folly::RequestContext::State::callbackData_</a></div><div class="ttdeci">sorted_vector_set&lt; RequestData * &gt; callbackData_</div><div class="ttdef"><b>Definition:</b> <a href="Request_8h_source.html#l00247">Request.h:247</a></div></div>
<div class="ttc" id="structfolly_1_1RequestContext_1_1State_html_a252015670fc86293f27090c15d3b57d7"><div class="ttname"><a href="structfolly_1_1RequestContext_1_1State.html#a252015670fc86293f27090c15d3b57d7">folly::RequestContext::State::requestData_</a></div><div class="ttdeci">F14FastMap&lt; RequestToken, RequestData::SharedPtr &gt; requestData_</div><div class="ttdef"><b>Definition:</b> <a href="Request_8h_source.html#l00243">Request.h:243</a></div></div>
<div class="ttc" id="classfolly_1_1RequestData_html_af544e42488a18dd88c113175d7ced9dd"><div class="ttname"><a href="classfolly_1_1RequestData.html#af544e42488a18dd88c113175d7ced9dd">folly::RequestData::onUnset</a></div><div class="ttdeci">virtual void onUnset()</div><div class="ttdef"><b>Definition:</b> <a href="Request_8h_source.html#l00085">Request.h:85</a></div></div>
<div class="ttc" id="classfolly_1_1RequestContext_html_adeab37d52d57a2c5c16584a965debd81"><div class="ttname"><a href="classfolly_1_1RequestContext.html#adeab37d52d57a2c5c16584a965debd81">folly::RequestContext::doSetContextData</a></div><div class="ttdeci">bool doSetContextData(const std::string &amp;val, std::unique_ptr&lt; RequestData &gt; &amp;data, DoSetBehaviour behaviour)</div><div class="ttdef"><b>Definition:</b> <a href="Request_8h_source.html#l00233">Request.h:233</a></div></div>
<div class="ttc" id="classfolly_1_1RequestContext_html_a75790ac18eed980eed8182129c349a8d"><div class="ttname"><a href="classfolly_1_1RequestContext.html#a75790ac18eed980eed8182129c349a8d">folly::RequestContext::overwriteContextData</a></div><div class="ttdeci">void overwriteContextData(const std::string &amp;val, std::unique_ptr&lt; RequestData &gt; data)</div><div class="ttdef"><b>Definition:</b> <a href="Request_8h_source.html#l00216">Request.h:216</a></div></div>
<div class="ttc" id="classfolly_1_1RequestData_html_a4bef7f0392209a204a5e1b701353b2d3"><div class="ttname"><a href="classfolly_1_1RequestData.html#a4bef7f0392209a204a5e1b701353b2d3">folly::RequestData::SharedPtr</a></div><div class="ttdeci">std::unique_ptr&lt; RequestData, DestructPtr &gt; SharedPtr</div><div class="ttdef"><b>Definition:</b> <a href="Request_8h_source.html#l00101">Request.h:101</a></div></div>
<div class="ttc" id="classfolly_1_1RequestToken_html_a2469ff0f1eb69cf17827307e45761063"><div class="ttname"><a href="classfolly_1_1RequestToken.html#a2469ff0f1eb69cf17827307e45761063">folly::RequestToken::token_</a></div><div class="ttdeci">uint32_t token_</div><div class="ttdef"><b>Definition:</b> <a href="Request_8h_source.html#l00049">Request.h:49</a></div></div>
<div class="ttc" id="structfolly_1_1ShallowCopyRequestContextScopeGuard_html_a95b88ff1d499db1332e7acb1f57469bb"><div class="ttname"><a href="structfolly_1_1ShallowCopyRequestContextScopeGuard.html#a95b88ff1d499db1332e7acb1f57469bb">folly::ShallowCopyRequestContextScopeGuard::prev_</a></div><div class="ttdeci">std::shared_ptr&lt; RequestContext &gt; prev_</div><div class="ttdef"><b>Definition:</b> <a href="Request_8h_source.html#l00326">Request.h:326</a></div></div>
<div class="ttc" id="classfolly_1_1RequestToken_html_ae0d15c98481a78f7898f8526c4717687"><div class="ttname"><a href="classfolly_1_1RequestToken.html#ae0d15c98481a78f7898f8526c4717687">folly::RequestToken::getCache</a></div><div class="ttdeci">static Synchronized&lt; F14FastMap&lt; std::string, uint32_t &gt; &gt; &amp; getCache()</div><div class="ttdef"><b>Definition:</b> <a href="Request_8cpp_source.html#l00060">Request.cpp:60</a></div></div>
<div class="ttc" id="classfolly_1_1RequestContextScopeGuard_html"><div class="ttname"><a href="classfolly_1_1RequestContextScopeGuard.html">folly::RequestContextScopeGuard</a></div><div class="ttdef"><b>Definition:</b> <a href="Request_8h_source.html#l00256">Request.h:256</a></div></div>
<div class="ttc" id="Conv_8cpp_html_ae1adbce218e7a9d09164012443191d24"><div class="ttname"><a href="Conv_8cpp.html#ae1adbce218e7a9d09164012443191d24">string</a></div><div class="ttdeci">const char * string</div><div class="ttdef"><b>Definition:</b> <a href="Conv_8cpp_source.html#l00212">Conv.cpp:212</a></div></div>
<div class="ttc" id="structfolly_1_1ShallowCopyRequestContextScopeGuard_html_a8d979d28469ac5c9be20dbb9fbb413fe"><div class="ttname"><a href="structfolly_1_1ShallowCopyRequestContextScopeGuard.html#a8d979d28469ac5c9be20dbb9fbb413fe">folly::ShallowCopyRequestContextScopeGuard::ShallowCopyRequestContextScopeGuard</a></div><div class="ttdeci">ShallowCopyRequestContextScopeGuard(const RequestToken &amp;val, std::unique_ptr&lt; RequestData &gt; data)</div><div class="ttdef"><b>Definition:</b> <a href="Request_8h_source.html#l00299">Request.h:299</a></div></div>
<div class="ttc" id="ConstexprMathBenchmark_8cpp_html_a09a1e304d66d35dd47daffee9731edaa"><div class="ttname"><a href="ConstexprMathBenchmark_8cpp.html#a09a1e304d66d35dd47daffee9731edaa">uint32_t</a></div><div class="ttdeci">uint32_t</div><div class="ttdef"><b>Definition:</b> <a href="ConstexprMathBenchmark_8cpp_source.html#l00186">ConstexprMathBenchmark.cpp:186</a></div></div>
<div class="ttc" id="F14Map_8h_html"><div class="ttname"><a href="F14Map_8h.html">F14Map.h</a></div></div>
<div class="ttc" id="classfolly_1_1RequestContext_html"><div class="ttname"><a href="classfolly_1_1RequestContext.html">folly::RequestContext</a></div><div class="ttdef"><b>Definition:</b> <a href="Request_8h_source.html#l00113">Request.h:113</a></div></div>
<div class="ttc" id="classfolly_1_1RequestData_html"><div class="ttname"><a href="classfolly_1_1RequestData.html">folly::RequestData</a></div><div class="ttdef"><b>Definition:</b> <a href="Request_8h_source.html#l00068">Request.h:68</a></div></div>
<div class="ttc" id="classfolly_1_1RequestContextScopeGuard_html_a6bd518ef6e60fd26ee09ed2ff9e311e1"><div class="ttname"><a href="classfolly_1_1RequestContextScopeGuard.html#a6bd518ef6e60fd26ee09ed2ff9e311e1">folly::RequestContextScopeGuard::RequestContextScopeGuard</a></div><div class="ttdeci">RequestContextScopeGuard()</div><div class="ttdef"><b>Definition:</b> <a href="Request_8h_source.html#l00268">Request.h:268</a></div></div>
<div class="ttc" id="classfolly_1_1RequestContext_html_accab9bf006d7f31e3844e4dcbdea6f4c"><div class="ttname"><a href="classfolly_1_1RequestContext.html#accab9bf006d7f31e3844e4dcbdea6f4c">folly::RequestContext::state_</a></div><div class="ttdeci">folly::Synchronized&lt; State &gt; state_</div><div class="ttdef"><b>Definition:</b> <a href="Request_8h_source.html#l00249">Request.h:249</a></div></div>
<div class="ttc" id="structfolly_1_1ShallowCopyRequestContextScopeGuard_html_ae226cb38bc54d4cf6c066eb7ee006ac2"><div class="ttname"><a href="structfolly_1_1ShallowCopyRequestContextScopeGuard.html#ae226cb38bc54d4cf6c066eb7ee006ac2">folly::ShallowCopyRequestContextScopeGuard::ShallowCopyRequestContextScopeGuard</a></div><div class="ttdeci">ShallowCopyRequestContextScopeGuard(const std::string &amp;val, std::unique_ptr&lt; RequestData &gt; data)</div><div class="ttdef"><b>Definition:</b> <a href="Request_8h_source.html#l00305">Request.h:305</a></div></div>
<div class="ttc" id="classfolly_1_1RequestContext_html_a7e91895b2a3d8a61bc5002d4e7704f96"><div class="ttname"><a href="classfolly_1_1RequestContext.html#a7e91895b2a3d8a61bc5002d4e7704f96">folly::RequestContext::get</a></div><div class="ttdeci">static RequestContext * get()</div><div class="ttdef"><b>Definition:</b> <a href="Request_8cpp_source.html#l00290">Request.cpp:290</a></div></div>
<div class="ttc" id="classfolly_1_1RequestContext_html_a0f359adc2b6394e8ca6e917b1a95c327"><div class="ttname"><a href="classfolly_1_1RequestContext.html#a0f359adc2b6394e8ca6e917b1a95c327">folly::RequestContext::clearContextData</a></div><div class="ttdeci">void clearContextData(const std::string &amp;val)</div><div class="ttdef"><b>Definition:</b> <a href="Request_8h_source.html#l00158">Request.h:158</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_d333e33cf903653326082c1f32e03be5.html">proxygen</a></li><li class="navelem"><a class="el" href="dir_32ce190710b1753ff87b781fbaae9b47.html">folly</a></li><li class="navelem"><a class="el" href="dir_dcf8e1233ba68571c5027662569cd1d9.html">folly</a></li><li class="navelem"><a class="el" href="dir_8b8cdcef1613958d35fc1de7b2d6bb26.html">io</a></li><li class="navelem"><a class="el" href="dir_539f767ad421989063a43e032c2d9ec2.html">async</a></li><li class="navelem"><a class="el" href="Request_8h.html">Request.h</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
