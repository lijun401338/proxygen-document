<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>proxygen: folly::io::StreamCodec Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">proxygen
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('classfolly_1_1io_1_1StreamCodec.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pri-types">Private Types</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classfolly_1_1io_1_1StreamCodec-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">folly::io::StreamCodec Class Reference<span class="mlabels"><span class="mlabel">abstract</span></span></div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="Compression_8h_source.html">Compression.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for folly::io::StreamCodec:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classfolly_1_1io_1_1StreamCodec.png" usemap="#folly::io::StreamCodec_map" alt=""/>
  <map id="folly::io::StreamCodec_map" name="folly::io::StreamCodec_map">
<area href="classfolly_1_1io_1_1Codec.html" alt="folly::io::Codec" shape="rect" coords="0,0,134,24"/>
</map>
 </div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:a192cb12c95e700e316bf86043677ece7"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfolly_1_1io_1_1StreamCodec.html#a192cb12c95e700e316bf86043677ece7">FlushOp</a> { <a class="el" href="classfolly_1_1io_1_1StreamCodec.html#a192cb12c95e700e316bf86043677ece7ab50339a10e1de285ac99d4c3990b8693">FlushOp::NONE</a>, 
<a class="el" href="classfolly_1_1io_1_1StreamCodec.html#a192cb12c95e700e316bf86043677ece7a26eed7f078fc015c5252f817059a6f9f">FlushOp::FLUSH</a>, 
<a class="el" href="classfolly_1_1io_1_1StreamCodec.html#a192cb12c95e700e316bf86043677ece7ab1a326c06d88bf042f73d70f50197905">FlushOp::END</a>
 }</td></tr>
<tr class="separator:a192cb12c95e700e316bf86043677ece7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a59e292968229893a8cbf76d84891f6ac"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfolly_1_1io_1_1StreamCodec.html#a59e292968229893a8cbf76d84891f6ac">~StreamCodec</a> () override</td></tr>
<tr class="separator:a59e292968229893a8cbf76d84891f6ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a62415b459c5d3d578eafec1e9b49e491"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfolly_1_1io_1_1StreamCodec.html#a62415b459c5d3d578eafec1e9b49e491">needsDataLength</a> () const </td></tr>
<tr class="separator:a62415b459c5d3d578eafec1e9b49e491"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a91212cf08449806f8a5a39c099084ed6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfolly_1_1io_1_1StreamCodec.html#a91212cf08449806f8a5a39c099084ed6">resetStream</a> (<a class="el" href="classfolly_1_1Optional.html">folly::Optional</a>&lt; <a class="el" href="ConstexprMathBenchmark_8cpp.html#a5dc34568a989dd90728a4ed499cd9fab">uint64_t</a> &gt; <a class="el" href="classfolly_1_1io_1_1StreamCodec.html#ac688c462c86a2488dc8dfb3b56c066ac">uncompressedLength</a>=<a class="el" href="namespacefolly.html#ac22c63dbe5af3b0bedb0f21031691537">folly::none</a>)</td></tr>
<tr class="separator:a91212cf08449806f8a5a39c099084ed6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4018be177bc9dc3568e4a2f6a0cc78b9"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfolly_1_1io_1_1StreamCodec.html#a4018be177bc9dc3568e4a2f6a0cc78b9">compressStream</a> (<a class="el" href="namespacefolly.html#a7f61a634c75bc3bb46447ec2b17ff0fe">folly::ByteRange</a> &amp;input, <a class="el" href="namespacefolly.html#a9efde8a92a713a155d17ccb9452ecd5e">folly::MutableByteRange</a> &amp;output, <a class="el" href="classfolly_1_1io_1_1StreamCodec.html#a192cb12c95e700e316bf86043677ece7">FlushOp</a> flushOp=<a class="el" href="classfolly_1_1io_1_1StreamCodec.html#a192cb12c95e700e316bf86043677ece7ab50339a10e1de285ac99d4c3990b8693">StreamCodec::FlushOp::NONE</a>)</td></tr>
<tr class="separator:a4018be177bc9dc3568e4a2f6a0cc78b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4af531a4b4bc5d0922096cffe6c343a1"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfolly_1_1io_1_1StreamCodec.html#a4af531a4b4bc5d0922096cffe6c343a1">uncompressStream</a> (<a class="el" href="namespacefolly.html#a7f61a634c75bc3bb46447ec2b17ff0fe">folly::ByteRange</a> &amp;input, <a class="el" href="namespacefolly.html#a9efde8a92a713a155d17ccb9452ecd5e">folly::MutableByteRange</a> &amp;output, <a class="el" href="classfolly_1_1io_1_1StreamCodec.html#a192cb12c95e700e316bf86043677ece7">FlushOp</a> flushOp=<a class="el" href="classfolly_1_1io_1_1StreamCodec.html#a192cb12c95e700e316bf86043677ece7ab50339a10e1de285ac99d4c3990b8693">StreamCodec::FlushOp::NONE</a>)</td></tr>
<tr class="separator:a4af531a4b4bc5d0922096cffe6c343a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classfolly_1_1io_1_1Codec"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classfolly_1_1io_1_1Codec')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classfolly_1_1io_1_1Codec.html">folly::io::Codec</a></td></tr>
<tr class="memitem:adefd6878d0721803bcb451f994f97462 inherit pub_methods_classfolly_1_1io_1_1Codec"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfolly_1_1io_1_1Codec.html#adefd6878d0721803bcb451f994f97462">~Codec</a> ()</td></tr>
<tr class="separator:adefd6878d0721803bcb451f994f97462 inherit pub_methods_classfolly_1_1io_1_1Codec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9fb1ed8c2f83d7a9debce09890aae492 inherit pub_methods_classfolly_1_1io_1_1Codec"><td class="memItemLeft" align="right" valign="top"><a class="el" href="ConstexprMathBenchmark_8cpp.html#a5dc34568a989dd90728a4ed499cd9fab">uint64_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfolly_1_1io_1_1Codec.html#a9fb1ed8c2f83d7a9debce09890aae492">maxUncompressedLength</a> () const </td></tr>
<tr class="separator:a9fb1ed8c2f83d7a9debce09890aae492 inherit pub_methods_classfolly_1_1io_1_1Codec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b1410b4c841badc82607a96c1cd045b inherit pub_methods_classfolly_1_1io_1_1Codec"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacefolly_1_1io.html#a1f249567e09c910175371b7309566d2b">CodecType</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfolly_1_1io_1_1Codec.html#a1b1410b4c841badc82607a96c1cd045b">type</a> () const </td></tr>
<tr class="separator:a1b1410b4c841badc82607a96c1cd045b inherit pub_methods_classfolly_1_1io_1_1Codec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a88bd570091fa88bd2580e37caeded8c7 inherit pub_methods_classfolly_1_1io_1_1Codec"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfolly_1_1io_1_1Codec.html#a88bd570091fa88bd2580e37caeded8c7">needsUncompressedLength</a> () const </td></tr>
<tr class="separator:a88bd570091fa88bd2580e37caeded8c7 inherit pub_methods_classfolly_1_1io_1_1Codec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab21582f27a0c672de3c9d0db96b256c4 inherit pub_methods_classfolly_1_1io_1_1Codec"><td class="memItemLeft" align="right" valign="top">std::unique_ptr&lt; <a class="el" href="classfolly_1_1IOBuf.html">IOBuf</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfolly_1_1io_1_1Codec.html#ab21582f27a0c672de3c9d0db96b256c4">compress</a> (const <a class="el" href="classfolly_1_1IOBuf.html">folly::IOBuf</a> *<a class="el" href="namespacefolly.html#a23ca01703d6715fb172f4188faa73dc9">data</a>)</td></tr>
<tr class="separator:ab21582f27a0c672de3c9d0db96b256c4 inherit pub_methods_classfolly_1_1io_1_1Codec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d1de0dec19b80e3e53f37e798841ff7 inherit pub_methods_classfolly_1_1io_1_1Codec"><td class="memItemLeft" align="right" valign="top"><a class="el" href="Conv_8cpp.html#ae1adbce218e7a9d09164012443191d24">std::string</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfolly_1_1io_1_1Codec.html#a7d1de0dec19b80e3e53f37e798841ff7">compress</a> (<a class="el" href="namespacefolly.html#af8d3e3eb9accef5470823e6353f60140">StringPiece</a> <a class="el" href="namespacefolly.html#a23ca01703d6715fb172f4188faa73dc9">data</a>)</td></tr>
<tr class="separator:a7d1de0dec19b80e3e53f37e798841ff7 inherit pub_methods_classfolly_1_1io_1_1Codec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a98e807dc62852420981306ff4e1c642c inherit pub_methods_classfolly_1_1io_1_1Codec"><td class="memItemLeft" align="right" valign="top">std::unique_ptr&lt; <a class="el" href="classfolly_1_1IOBuf.html">IOBuf</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfolly_1_1io_1_1Codec.html#a98e807dc62852420981306ff4e1c642c">uncompress</a> (const <a class="el" href="classfolly_1_1IOBuf.html">IOBuf</a> *<a class="el" href="namespacefolly.html#a23ca01703d6715fb172f4188faa73dc9">data</a>, <a class="el" href="classfolly_1_1Optional.html">folly::Optional</a>&lt; <a class="el" href="ConstexprMathBenchmark_8cpp.html#a5dc34568a989dd90728a4ed499cd9fab">uint64_t</a> &gt; uncompressedLength=<a class="el" href="namespacefolly.html#ac22c63dbe5af3b0bedb0f21031691537">folly::none</a>)</td></tr>
<tr class="separator:a98e807dc62852420981306ff4e1c642c inherit pub_methods_classfolly_1_1io_1_1Codec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5672b657cb128174ed5002a97900bf50 inherit pub_methods_classfolly_1_1io_1_1Codec"><td class="memItemLeft" align="right" valign="top"><a class="el" href="Conv_8cpp.html#ae1adbce218e7a9d09164012443191d24">std::string</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfolly_1_1io_1_1Codec.html#a5672b657cb128174ed5002a97900bf50">uncompress</a> (<a class="el" href="namespacefolly.html#af8d3e3eb9accef5470823e6353f60140">StringPiece</a> <a class="el" href="namespacefolly.html#a23ca01703d6715fb172f4188faa73dc9">data</a>, <a class="el" href="classfolly_1_1Optional.html">folly::Optional</a>&lt; <a class="el" href="ConstexprMathBenchmark_8cpp.html#a5dc34568a989dd90728a4ed499cd9fab">uint64_t</a> &gt; uncompressedLength=<a class="el" href="namespacefolly.html#ac22c63dbe5af3b0bedb0f21031691537">folly::none</a>)</td></tr>
<tr class="separator:a5672b657cb128174ed5002a97900bf50 inherit pub_methods_classfolly_1_1io_1_1Codec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5939c1725a76995cd65be007a830667e inherit pub_methods_classfolly_1_1io_1_1Codec"><td class="memItemLeft" align="right" valign="top"><a class="el" href="ConstexprMathBenchmark_8cpp.html#a5dc34568a989dd90728a4ed499cd9fab">uint64_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfolly_1_1io_1_1Codec.html#a5939c1725a76995cd65be007a830667e">maxCompressedLength</a> (<a class="el" href="ConstexprMathBenchmark_8cpp.html#a5dc34568a989dd90728a4ed499cd9fab">uint64_t</a> uncompressedLength) const </td></tr>
<tr class="separator:a5939c1725a76995cd65be007a830667e inherit pub_methods_classfolly_1_1io_1_1Codec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a05d3b6746620ecd75fdcbfd72d28b52f inherit pub_methods_classfolly_1_1io_1_1Codec"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfolly_1_1Optional.html">folly::Optional</a>&lt; <a class="el" href="ConstexprMathBenchmark_8cpp.html#a5dc34568a989dd90728a4ed499cd9fab">uint64_t</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfolly_1_1io_1_1Codec.html#a05d3b6746620ecd75fdcbfd72d28b52f">getUncompressedLength</a> (const <a class="el" href="classfolly_1_1IOBuf.html">folly::IOBuf</a> *<a class="el" href="namespacefolly.html#a23ca01703d6715fb172f4188faa73dc9">data</a>, <a class="el" href="classfolly_1_1Optional.html">folly::Optional</a>&lt; <a class="el" href="ConstexprMathBenchmark_8cpp.html#a5dc34568a989dd90728a4ed499cd9fab">uint64_t</a> &gt; uncompressedLength=<a class="el" href="namespacefolly.html#ac22c63dbe5af3b0bedb0f21031691537">folly::none</a>) const </td></tr>
<tr class="separator:a05d3b6746620ecd75fdcbfd72d28b52f inherit pub_methods_classfolly_1_1io_1_1Codec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a640b71c9aff7d863b37f39ea91ea5488 inherit pub_methods_classfolly_1_1io_1_1Codec"><td class="memItemLeft" align="right" valign="top">virtual std::vector&lt; <a class="el" href="Conv_8cpp.html#ae1adbce218e7a9d09164012443191d24">std::string</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfolly_1_1io_1_1Codec.html#a640b71c9aff7d863b37f39ea91ea5488">validPrefixes</a> () const </td></tr>
<tr class="separator:a640b71c9aff7d863b37f39ea91ea5488 inherit pub_methods_classfolly_1_1io_1_1Codec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a67b085d74076964b95da10bbf1dd4de0 inherit pub_methods_classfolly_1_1io_1_1Codec"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfolly_1_1io_1_1Codec.html#a67b085d74076964b95da10bbf1dd4de0">canUncompress</a> (const <a class="el" href="classfolly_1_1IOBuf.html">folly::IOBuf</a> *<a class="el" href="namespacefolly.html#a23ca01703d6715fb172f4188faa73dc9">data</a>, <a class="el" href="classfolly_1_1Optional.html">folly::Optional</a>&lt; <a class="el" href="ConstexprMathBenchmark_8cpp.html#a5dc34568a989dd90728a4ed499cd9fab">uint64_t</a> &gt; uncompressedLength=<a class="el" href="namespacefolly.html#ac22c63dbe5af3b0bedb0f21031691537">folly::none</a>) const </td></tr>
<tr class="separator:a67b085d74076964b95da10bbf1dd4de0 inherit pub_methods_classfolly_1_1io_1_1Codec"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:a98efbffab76039a9be12c2bebf7f799f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfolly_1_1io_1_1StreamCodec.html#a98efbffab76039a9be12c2bebf7f799f">StreamCodec</a> (<a class="el" href="namespacefolly_1_1io.html#a1f249567e09c910175371b7309566d2b">CodecType</a> <a class="el" href="classfolly_1_1io_1_1Codec.html#a1b1410b4c841badc82607a96c1cd045b">type</a>, <a class="el" href="classfolly_1_1Optional.html">folly::Optional</a>&lt; int &gt; level=<a class="el" href="namespacefolly.html#ac22c63dbe5af3b0bedb0f21031691537">folly::none</a>, <a class="el" href="namespacefolly.html#af8d3e3eb9accef5470823e6353f60140">folly::StringPiece</a> <a class="el" href="folly_2folly_2experimental_2symbolizer_2SignalHandler_8cpp.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>={}, bool counters=true)</td></tr>
<tr class="separator:a98efbffab76039a9be12c2bebf7f799f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac688c462c86a2488dc8dfb3b56c066ac"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfolly_1_1Optional.html">folly::Optional</a>&lt; <a class="el" href="ConstexprMathBenchmark_8cpp.html#a5dc34568a989dd90728a4ed499cd9fab">uint64_t</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfolly_1_1io_1_1StreamCodec.html#ac688c462c86a2488dc8dfb3b56c066ac">uncompressedLength</a> () const </td></tr>
<tr class="separator:ac688c462c86a2488dc8dfb3b56c066ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_methods_classfolly_1_1io_1_1Codec"><td colspan="2" onclick="javascript:toggleInherit('pro_methods_classfolly_1_1io_1_1Codec')"><img src="closed.png" alt="-"/>&#160;Protected Member Functions inherited from <a class="el" href="classfolly_1_1io_1_1Codec.html">folly::io::Codec</a></td></tr>
<tr class="memitem:a3845870cfa4acbe9136da7a217024c60 inherit pro_methods_classfolly_1_1io_1_1Codec"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfolly_1_1io_1_1Codec.html#a3845870cfa4acbe9136da7a217024c60">Codec</a> (<a class="el" href="namespacefolly_1_1io.html#a1f249567e09c910175371b7309566d2b">CodecType</a> <a class="el" href="classfolly_1_1io_1_1Codec.html#a1b1410b4c841badc82607a96c1cd045b">type</a>, <a class="el" href="classfolly_1_1Optional.html">folly::Optional</a>&lt; int &gt; level=<a class="el" href="namespacefolly.html#ac22c63dbe5af3b0bedb0f21031691537">folly::none</a>, <a class="el" href="namespacefolly.html#af8d3e3eb9accef5470823e6353f60140">folly::StringPiece</a> <a class="el" href="folly_2folly_2experimental_2symbolizer_2SignalHandler_8cpp.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>={}, bool counters=true)</td></tr>
<tr class="separator:a3845870cfa4acbe9136da7a217024c60 inherit pro_methods_classfolly_1_1io_1_1Codec"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-types"></a>
Private Types</h2></td></tr>
<tr class="memitem:a3e49a89bbc00a93f28fbfee404dc8122"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfolly_1_1io_1_1StreamCodec.html#a3e49a89bbc00a93f28fbfee404dc8122">State</a> { <br />
&#160;&#160;<a class="el" href="classfolly_1_1io_1_1StreamCodec.html#a3e49a89bbc00a93f28fbfee404dc8122ab5859d8721cfdc0312b2838b9c985bc1">State::RESET</a>, 
<a class="el" href="classfolly_1_1io_1_1StreamCodec.html#a3e49a89bbc00a93f28fbfee404dc8122a08c078f425b1925fb4be9d7d0ee118b1">State::COMPRESS</a>, 
<a class="el" href="classfolly_1_1io_1_1StreamCodec.html#a3e49a89bbc00a93f28fbfee404dc8122ac09c49918b48515b53142e8783e69263">State::COMPRESS_FLUSH</a>, 
<a class="el" href="classfolly_1_1io_1_1StreamCodec.html#a3e49a89bbc00a93f28fbfee404dc8122a6d6ee4f3f98009edff4aae134116aa39">State::COMPRESS_END</a>, 
<br />
&#160;&#160;<a class="el" href="classfolly_1_1io_1_1StreamCodec.html#a3e49a89bbc00a93f28fbfee404dc8122a125ee7a84dca120371a1d7757d9d4a44">State::UNCOMPRESS</a>, 
<a class="el" href="classfolly_1_1io_1_1StreamCodec.html#a3e49a89bbc00a93f28fbfee404dc8122ab1a326c06d88bf042f73d70f50197905">State::END</a>
<br />
 }</td></tr>
<tr class="separator:a3e49a89bbc00a93f28fbfee404dc8122"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a7530d548ade9c8b6d207458587883671"><td class="memItemLeft" align="right" valign="top">std::unique_ptr&lt; <a class="el" href="classfolly_1_1IOBuf.html">IOBuf</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfolly_1_1io_1_1StreamCodec.html#a7530d548ade9c8b6d207458587883671">doCompress</a> (const <a class="el" href="classfolly_1_1IOBuf.html">folly::IOBuf</a> *<a class="el" href="namespacefolly.html#a23ca01703d6715fb172f4188faa73dc9">data</a>) override</td></tr>
<tr class="separator:a7530d548ade9c8b6d207458587883671"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c541b048c53063cb2cf26cc6d35ac0a"><td class="memItemLeft" align="right" valign="top">std::unique_ptr&lt; <a class="el" href="classfolly_1_1IOBuf.html">IOBuf</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfolly_1_1io_1_1StreamCodec.html#a4c541b048c53063cb2cf26cc6d35ac0a">doUncompress</a> (const <a class="el" href="classfolly_1_1IOBuf.html">folly::IOBuf</a> *<a class="el" href="namespacefolly.html#a23ca01703d6715fb172f4188faa73dc9">data</a>, <a class="el" href="classfolly_1_1Optional.html">folly::Optional</a>&lt; <a class="el" href="ConstexprMathBenchmark_8cpp.html#a5dc34568a989dd90728a4ed499cd9fab">uint64_t</a> &gt; <a class="el" href="classfolly_1_1io_1_1StreamCodec.html#ac688c462c86a2488dc8dfb3b56c066ac">uncompressedLength</a>) override</td></tr>
<tr class="separator:a4c541b048c53063cb2cf26cc6d35ac0a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab8bb3a1432680819dd64e297e7265549"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfolly_1_1io_1_1StreamCodec.html#ab8bb3a1432680819dd64e297e7265549">doNeedsDataLength</a> () const </td></tr>
<tr class="separator:ab8bb3a1432680819dd64e297e7265549"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2bcf03b67f4bfb052e4142927a25ee30"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfolly_1_1io_1_1StreamCodec.html#a2bcf03b67f4bfb052e4142927a25ee30">doResetStream</a> ()=0</td></tr>
<tr class="separator:a2bcf03b67f4bfb052e4142927a25ee30"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9841958a18fb7f2321573bf267ac8139"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfolly_1_1io_1_1StreamCodec.html#a9841958a18fb7f2321573bf267ac8139">doCompressStream</a> (<a class="el" href="namespacefolly.html#a7f61a634c75bc3bb46447ec2b17ff0fe">folly::ByteRange</a> &amp;input, <a class="el" href="namespacefolly.html#a9efde8a92a713a155d17ccb9452ecd5e">folly::MutableByteRange</a> &amp;output, <a class="el" href="classfolly_1_1io_1_1StreamCodec.html#a192cb12c95e700e316bf86043677ece7">FlushOp</a> flushOp)=0</td></tr>
<tr class="separator:a9841958a18fb7f2321573bf267ac8139"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b44a20a9d1c2c4a1706240ffe7b947f"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfolly_1_1io_1_1StreamCodec.html#a6b44a20a9d1c2c4a1706240ffe7b947f">doUncompressStream</a> (<a class="el" href="namespacefolly.html#a7f61a634c75bc3bb46447ec2b17ff0fe">folly::ByteRange</a> &amp;input, <a class="el" href="namespacefolly.html#a9efde8a92a713a155d17ccb9452ecd5e">folly::MutableByteRange</a> &amp;output, <a class="el" href="classfolly_1_1io_1_1StreamCodec.html#a192cb12c95e700e316bf86043677ece7">FlushOp</a> flushOp)=0</td></tr>
<tr class="separator:a6b44a20a9d1c2c4a1706240ffe7b947f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2035300384c68461745f8265ca5d1bd4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfolly_1_1io_1_1StreamCodec.html#a2035300384c68461745f8265ca5d1bd4">assertStateIs</a> (<a class="el" href="classfolly_1_1io_1_1StreamCodec.html#a3e49a89bbc00a93f28fbfee404dc8122">State</a> expected) const </td></tr>
<tr class="separator:a2035300384c68461745f8265ca5d1bd4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a9eefd02e5a959116145f9a6f4c22fa14"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfolly_1_1io_1_1StreamCodec.html#a3e49a89bbc00a93f28fbfee404dc8122">State</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfolly_1_1io_1_1StreamCodec.html#a9eefd02e5a959116145f9a6f4c22fa14">state_</a> {<a class="el" href="classfolly_1_1io_1_1StreamCodec.html#a3e49a89bbc00a93f28fbfee404dc8122ab5859d8721cfdc0312b2838b9c985bc1">State::RESET</a>}</td></tr>
<tr class="separator:a9eefd02e5a959116145f9a6f4c22fa14"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aefc84fc808a028f006ad33489c4fa0ea"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacefolly.html#a7f61a634c75bc3bb46447ec2b17ff0fe">ByteRange</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfolly_1_1io_1_1StreamCodec.html#aefc84fc808a028f006ad33489c4fa0ea">previousInput_</a> {}</td></tr>
<tr class="separator:aefc84fc808a028f006ad33489c4fa0ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a482e9cd24fe79d3fb06a483b442c463f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfolly_1_1Optional.html">folly::Optional</a>&lt; <a class="el" href="ConstexprMathBenchmark_8cpp.html#a5dc34568a989dd90728a4ed499cd9fab">uint64_t</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfolly_1_1io_1_1StreamCodec.html#a482e9cd24fe79d3fb06a483b442c463f">uncompressedLength_</a> {}</td></tr>
<tr class="separator:a482e9cd24fe79d3fb06a483b442c463f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac68c998011fb247fbe3e349bb7356de6"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfolly_1_1io_1_1StreamCodec.html#ac68c998011fb247fbe3e349bb7356de6">progressMade_</a> {true}</td></tr>
<tr class="separator:ac68c998011fb247fbe3e349bb7356de6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pub_static_attribs_classfolly_1_1io_1_1Codec"><td colspan="2" onclick="javascript:toggleInherit('pub_static_attribs_classfolly_1_1io_1_1Codec')"><img src="closed.png" alt="-"/>&#160;Static Public Attributes inherited from <a class="el" href="classfolly_1_1io_1_1Codec.html">folly::io::Codec</a></td></tr>
<tr class="memitem:a19738512212993eff4768be5a7fa45b2 inherit pub_static_attribs_classfolly_1_1io_1_1Codec"><td class="memItemLeft" align="right" valign="top">static constexpr <a class="el" href="ConstexprMathBenchmark_8cpp.html#a5dc34568a989dd90728a4ed499cd9fab">uint64_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfolly_1_1io_1_1Codec.html#a19738512212993eff4768be5a7fa45b2">UNLIMITED_UNCOMPRESSED_LENGTH</a> = <a class="el" href="ConstexprMathBenchmark_8cpp.html#a5dc34568a989dd90728a4ed499cd9fab">uint64_t</a>(-1)</td></tr>
<tr class="separator:a19738512212993eff4768be5a7fa45b2 inherit pub_static_attribs_classfolly_1_1io_1_1Codec"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock">
<p>Definition at line <a class="el" href="Compression_8h_source.html#l00274">274</a> of file <a class="el" href="Compression_8h_source.html">Compression.h</a>.</p>
</div><h2 class="groupheader">Member Enumeration Documentation</h2>
<a class="anchor" id="a192cb12c95e700e316bf86043677ece7"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="classfolly_1_1io_1_1StreamCodec.html#a192cb12c95e700e316bf86043677ece7">folly::io::StreamCodec::FlushOp</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">strong</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a class="anchor" id="a192cb12c95e700e316bf86043677ece7ab50339a10e1de285ac99d4c3990b8693"></a>NONE&#160;</td><td class="fielddoc">
</td></tr>
<tr><td class="fieldname"><a class="anchor" id="a192cb12c95e700e316bf86043677ece7a26eed7f078fc015c5252f817059a6f9f"></a>FLUSH&#160;</td><td class="fielddoc">
</td></tr>
<tr><td class="fieldname"><a class="anchor" id="a192cb12c95e700e316bf86043677ece7ab1a326c06d88bf042f73d70f50197905"></a>END&#160;</td><td class="fielddoc">
</td></tr>
</table>

<p>Definition at line <a class="el" href="Compression_8h_source.html#l00311">311</a> of file <a class="el" href="Compression_8h_source.html">Compression.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;{ <a class="code" href="namespacefolly.html#a268239ef872bd1f7025dca14313f5fc7ab50339a10e1de285ac99d4c3990b8693">NONE</a>, FLUSH, END };</div><div class="ttc" id="namespacefolly_html_a268239ef872bd1f7025dca14313f5fc7ab50339a10e1de285ac99d4c3990b8693"><div class="ttname"><a href="namespacefolly.html#a268239ef872bd1f7025dca14313f5fc7ab50339a10e1de285ac99d4c3990b8693">folly::WriteFlags::NONE</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a3e49a89bbc00a93f28fbfee404dc8122"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="classfolly_1_1io_1_1StreamCodec.html#a3e49a89bbc00a93f28fbfee404dc8122">folly::io::StreamCodec::State</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">strong</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a class="anchor" id="a3e49a89bbc00a93f28fbfee404dc8122ab5859d8721cfdc0312b2838b9c985bc1"></a>RESET&#160;</td><td class="fielddoc">
</td></tr>
<tr><td class="fieldname"><a class="anchor" id="a3e49a89bbc00a93f28fbfee404dc8122a08c078f425b1925fb4be9d7d0ee118b1"></a>COMPRESS&#160;</td><td class="fielddoc">
</td></tr>
<tr><td class="fieldname"><a class="anchor" id="a3e49a89bbc00a93f28fbfee404dc8122ac09c49918b48515b53142e8783e69263"></a>COMPRESS_FLUSH&#160;</td><td class="fielddoc">
</td></tr>
<tr><td class="fieldname"><a class="anchor" id="a3e49a89bbc00a93f28fbfee404dc8122a6d6ee4f3f98009edff4aae134116aa39"></a>COMPRESS_END&#160;</td><td class="fielddoc">
</td></tr>
<tr><td class="fieldname"><a class="anchor" id="a3e49a89bbc00a93f28fbfee404dc8122a125ee7a84dca120371a1d7757d9d4a44"></a>UNCOMPRESS&#160;</td><td class="fielddoc">
</td></tr>
<tr><td class="fieldname"><a class="anchor" id="a3e49a89bbc00a93f28fbfee404dc8122ab1a326c06d88bf042f73d70f50197905"></a>END&#160;</td><td class="fielddoc">
</td></tr>
</table>

<p>Definition at line <a class="el" href="Compression_8h_source.html#l00424">424</a> of file <a class="el" href="Compression_8h_source.html">Compression.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;                   {</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    RESET,</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    COMPRESS,</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    COMPRESS_FLUSH,</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    COMPRESS_END,</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    UNCOMPRESS,</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    END,</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;  };</div></div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a59e292968229893a8cbf76d84891f6ac"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">folly::io::StreamCodec::~StreamCodec </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">override</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="Compression_8h_source.html#l00276">276</a> of file <a class="el" href="Compression_8h_source.html">Compression.h</a>.</p>

<p>References <a class="el" href="Optional_8h_source.html#l00087">folly::none</a>.</p>
<div class="fragment"><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;{}</div></div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a98efbffab76039a9be12c2bebf7f799f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">folly::io::StreamCodec::StreamCodec </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespacefolly_1_1io.html#a1f249567e09c910175371b7309566d2b">CodecType</a>&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classfolly_1_1Optional.html">folly::Optional</a>&lt; int &gt;&#160;</td>
          <td class="paramname"><em>level</em> = <code><a class="el" href="namespacefolly.html#ac22c63dbe5af3b0bedb0f21031691537">folly::none</a></code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacefolly.html#af8d3e3eb9accef5470823e6353f60140">folly::StringPiece</a>&#160;</td>
          <td class="paramname"><em>name</em> = <code>{}</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>counters</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="Compression_8h_source.html#l00392">392</a> of file <a class="el" href="Compression_8h_source.html">Compression.h</a>.</p>

<p>References <a class="el" href="Base-inl_8h_source.html#l02567">folly::gen::move</a>, and <a class="el" href="http__parser_8c_source.html#l00437">name</a>.</p>
<div class="fragment"><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;                              {},</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;      <span class="keywordtype">bool</span> counters = <span class="keyword">true</span>)</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;      : <a class="code" href="classfolly_1_1io_1_1Codec.html#a3845870cfa4acbe9136da7a217024c60">Codec</a>(<a class="code" href="classfolly_1_1io_1_1Codec.html#a1b1410b4c841badc82607a96c1cd045b">type</a>, <a class="code" href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">std::move</a>(level), <a class="code" href="http__parser_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, counters) {}</div><div class="ttc" id="namespacefolly_1_1gen_html_ac24ec252b1b738a40c274285527c193f"><div class="ttname"><a href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">folly::gen::move</a></div><div class="ttdeci">constexpr detail::Map&lt; Move &gt; move</div><div class="ttdef"><b>Definition:</b> <a href="Base-inl_8h_source.html#l02567">Base-inl.h:2567</a></div></div>
<div class="ttc" id="classfolly_1_1io_1_1Codec_html_a3845870cfa4acbe9136da7a217024c60"><div class="ttname"><a href="classfolly_1_1io_1_1Codec.html#a3845870cfa4acbe9136da7a217024c60">folly::io::Codec::Codec</a></div><div class="ttdeci">Codec(CodecType type, folly::Optional&lt; int &gt; level=folly::none, folly::StringPiece name={}, bool counters=true)</div><div class="ttdef"><b>Definition:</b> <a href="Compression_8cpp_source.html#l00071">Compression.cpp:71</a></div></div>
<div class="ttc" id="http__parser_8c_html_a8f8f80d37794cde9472343e4487ba3eb"><div class="ttname"><a href="http__parser_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a></div><div class="ttdeci">const char * name</div><div class="ttdef"><b>Definition:</b> <a href="http__parser_8c_source.html#l00437">http_parser.c:437</a></div></div>
<div class="ttc" id="classfolly_1_1io_1_1Codec_html_a1b1410b4c841badc82607a96c1cd045b"><div class="ttname"><a href="classfolly_1_1io_1_1Codec.html#a1b1410b4c841badc82607a96c1cd045b">folly::io::Codec::type</a></div><div class="ttdeci">CodecType type() const </div><div class="ttdef"><b>Definition:</b> <a href="Compression_8h_source.html#l00147">Compression.h:147</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a2035300384c68461745f8265ca5d1bd4"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void folly::io::StreamCodec::assertStateIs </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfolly_1_1io_1_1StreamCodec.html#a3e49a89bbc00a93f28fbfee404dc8122">State</a>&#160;</td>
          <td class="paramname"><em>expected</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="Compression_8cpp_source.html#l00322">322</a> of file <a class="el" href="Compression_8cpp_source.html">Compression.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;                                                    {</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classfolly_1_1io_1_1StreamCodec.html#a9eefd02e5a959116145f9a6f4c22fa14">state_</a> != expected) {</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    <span class="keywordflow">throw</span> std::logic_error(folly::to&lt;std::string&gt;(</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;        <span class="stringliteral">&quot;Codec: state is &quot;</span>, <a class="code" href="classfolly_1_1io_1_1StreamCodec.html#a9eefd02e5a959116145f9a6f4c22fa14">state_</a>, <span class="stringliteral">&quot;; expected state &quot;</span>, expected));</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;  }</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;}</div><div class="ttc" id="classfolly_1_1io_1_1StreamCodec_html_a9eefd02e5a959116145f9a6f4c22fa14"><div class="ttname"><a href="classfolly_1_1io_1_1StreamCodec.html#a9eefd02e5a959116145f9a6f4c22fa14">folly::io::StreamCodec::state_</a></div><div class="ttdeci">State state_</div><div class="ttdef"><b>Definition:</b> <a href="Compression_8h_source.html#l00434">Compression.h:434</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a4018be177bc9dc3568e4a2f6a0cc78b9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool folly::io::StreamCodec::compressStream </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespacefolly.html#a7f61a634c75bc3bb46447ec2b17ff0fe">folly::ByteRange</a> &amp;&#160;</td>
          <td class="paramname"><em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacefolly.html#a9efde8a92a713a155d17ccb9452ecd5e">folly::MutableByteRange</a> &amp;&#160;</td>
          <td class="paramname"><em>output</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classfolly_1_1io_1_1StreamCodec.html#a192cb12c95e700e316bf86043677ece7">StreamCodec::FlushOp</a>&#160;</td>
          <td class="paramname"><em>flushOp</em> = <code><a class="el" href="classfolly_1_1io_1_1StreamCodec.html#a192cb12c95e700e316bf86043677ece7ab50339a10e1de285ac99d4c3990b8693">StreamCodec::FlushOp::NONE</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compresses some data from the input buffer and writes the compressed data into the output buffer. It may read input without producing any output, except when forced to flush.</p>
<p>The input buffer is advanced to point to the range of data that hasn't yet been read. Compression will resume at this point for the next call to <a class="el" href="classfolly_1_1io_1_1StreamCodec.html#a4018be177bc9dc3568e4a2f6a0cc78b9">compressStream()</a>. The output buffer is advanced one byte past the last byte written.</p>
<p>The default flushOp is NONE, which allows <a class="el" href="classfolly_1_1io_1_1StreamCodec.html#a4018be177bc9dc3568e4a2f6a0cc78b9">compressStream()</a> complete discretion in how much data to gather before writing any output.</p>
<p>If flushOp is END, all pending and input data is flushed to the output buffer, and the frame is ended. <a class="el" href="classfolly_1_1io_1_1StreamCodec.html#a4018be177bc9dc3568e4a2f6a0cc78b9">compressStream()</a> must be called with the same input and flushOp END until it returns true. At this point the caller must call <a class="el" href="classfolly_1_1io_1_1StreamCodec.html#a91212cf08449806f8a5a39c099084ed6">resetStream()</a> to use the codec again.</p>
<p>If flushOp is FLUSH, all pending and input data is flushed to the output buffer, but the frame is not ended. <a class="el" href="classfolly_1_1io_1_1StreamCodec.html#a4018be177bc9dc3568e4a2f6a0cc78b9">compressStream()</a> must be called with the same input and flushOp END until it returns true. At this point the caller can continue to <a class="el" href="classfolly_1_1io_1_1StreamCodec.html#a4018be177bc9dc3568e4a2f6a0cc78b9">compressStream()</a> with any input data and flushOp. The uncompressor, if passed all the produced output data, will be able to uncompress all the input data passed to <a class="el" href="classfolly_1_1io_1_1StreamCodec.html#a4018be177bc9dc3568e4a2f6a0cc78b9">compressStream()</a> so far. Excessive use of flushOp FLUSH will deteriorate compression ratio. This is useful for stateful streaming across a network. Most users don't need to use this flushOp.</p>
<p><a class="el" href="structA.html">A</a> std::logic_error is thrown on incorrect usage of the API. <a class="el" href="structA.html">A</a> std::runtime_error is thrown upon error conditions or if no forward progress could be made twice in a row. </p>

<p>Definition at line <a class="el" href="Compression_8cpp_source.html#l00336">336</a> of file <a class="el" href="Compression_8cpp_source.html">Compression.cpp</a>.</p>

<p>References <a class="el" href="Range_8h_source.html#l00443">folly::Range&lt; Iter &gt;::empty()</a>, <a class="el" href="classfolly_1_1io_1_1StreamCodec.html#a192cb12c95e700e316bf86043677ece7ab1a326c06d88bf042f73d70f50197905">END</a>, <a class="el" href="classfolly_1_1io_1_1StreamCodec.html#a192cb12c95e700e316bf86043677ece7a26eed7f078fc015c5252f817059a6f9f">FLUSH</a>, <a class="el" href="classfolly_1_1io_1_1StreamCodec.html#a192cb12c95e700e316bf86043677ece7ab50339a10e1de285ac99d4c3990b8693">NONE</a>, <a class="el" href="Range_8h_source.html#l00431">folly::Range&lt; Iter &gt;::size()</a>, and <a class="el" href="ConstexprMathBenchmark_8cpp_source.html#l00190">uint64_t</a>.</p>

<p>Referenced by <a class="el" href="CompressionTest_8cpp_source.html#l00819">folly::io::test::compressSome()</a>.</p>
<div class="fragment"><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;                                {</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classfolly_1_1io_1_1StreamCodec.html#a9eefd02e5a959116145f9a6f4c22fa14">state_</a> == <a class="code" href="classfolly_1_1io_1_1StreamCodec.html#a3e49a89bbc00a93f28fbfee404dc8122ab5859d8721cfdc0312b2838b9c985bc1">State::RESET</a> &amp;&amp; input.<a class="code" href="classfolly_1_1Range.html#ac76f445a6485c7472d7e0bcfd0c7292b">empty</a>() &amp;&amp;</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;      flushOp == <a class="code" href="classfolly_1_1io_1_1StreamCodec.html#a192cb12c95e700e316bf86043677ece7ab1a326c06d88bf042f73d70f50197905">StreamCodec::FlushOp::END</a> &amp;&amp;</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;      <a class="code" href="classfolly_1_1io_1_1StreamCodec.html#ac688c462c86a2488dc8dfb3b56c066ac">uncompressedLength</a>().<a class="code" href="classfolly_1_1Optional.html#a3b9821dde9565651713c0013da729ae3">value_or</a>(0) != 0) {</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Codec: invalid uncompressed length&quot;</span>);</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;  }</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="classfolly_1_1io_1_1StreamCodec.html#ac688c462c86a2488dc8dfb3b56c066ac">uncompressedLength</a>() &amp;&amp; <a class="code" href="classfolly_1_1io_1_1StreamCodec.html#a62415b459c5d3d578eafec1e9b49e491">needsDataLength</a>()) {</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Codec: uncompressed length required&quot;</span>);</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;  }</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classfolly_1_1io_1_1StreamCodec.html#a9eefd02e5a959116145f9a6f4c22fa14">state_</a> == <a class="code" href="classfolly_1_1io_1_1StreamCodec.html#a3e49a89bbc00a93f28fbfee404dc8122ab5859d8721cfdc0312b2838b9c985bc1">State::RESET</a> &amp;&amp; !input.<a class="code" href="classfolly_1_1Range.html#ac76f445a6485c7472d7e0bcfd0c7292b">empty</a>() &amp;&amp;</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;      <a class="code" href="classfolly_1_1io_1_1StreamCodec.html#ac688c462c86a2488dc8dfb3b56c066ac">uncompressedLength</a>() == <a class="code" href="ConstexprMathBenchmark_8cpp.html#a5dc34568a989dd90728a4ed499cd9fab">uint64_t</a>(0)) {</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Codec: invalid uncompressed length&quot;</span>);</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;  }</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;  <span class="comment">// Handle input state transitions</span></div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;  <span class="keywordflow">switch</span> (flushOp) {</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="classfolly_1_1io_1_1StreamCodec.html#a192cb12c95e700e316bf86043677ece7ab50339a10e1de285ac99d4c3990b8693">StreamCodec::FlushOp::NONE</a>:</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classfolly_1_1io_1_1StreamCodec.html#a9eefd02e5a959116145f9a6f4c22fa14">state_</a> == <a class="code" href="classfolly_1_1io_1_1StreamCodec.html#a3e49a89bbc00a93f28fbfee404dc8122ab5859d8721cfdc0312b2838b9c985bc1">State::RESET</a>) {</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;        <a class="code" href="classfolly_1_1io_1_1StreamCodec.html#a9eefd02e5a959116145f9a6f4c22fa14">state_</a> = <a class="code" href="classfolly_1_1io_1_1StreamCodec.html#a3e49a89bbc00a93f28fbfee404dc8122a08c078f425b1925fb4be9d7d0ee118b1">State::COMPRESS</a>;</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;      }</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;      <a class="code" href="classfolly_1_1io_1_1StreamCodec.html#a2035300384c68461745f8265ca5d1bd4">assertStateIs</a>(<a class="code" href="classfolly_1_1io_1_1StreamCodec.html#a3e49a89bbc00a93f28fbfee404dc8122a08c078f425b1925fb4be9d7d0ee118b1">State::COMPRESS</a>);</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="classfolly_1_1io_1_1StreamCodec.html#a192cb12c95e700e316bf86043677ece7a26eed7f078fc015c5252f817059a6f9f">StreamCodec::FlushOp::FLUSH</a>:</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classfolly_1_1io_1_1StreamCodec.html#a9eefd02e5a959116145f9a6f4c22fa14">state_</a> == <a class="code" href="classfolly_1_1io_1_1StreamCodec.html#a3e49a89bbc00a93f28fbfee404dc8122ab5859d8721cfdc0312b2838b9c985bc1">State::RESET</a> || <a class="code" href="classfolly_1_1io_1_1StreamCodec.html#a9eefd02e5a959116145f9a6f4c22fa14">state_</a> == <a class="code" href="classfolly_1_1io_1_1StreamCodec.html#a3e49a89bbc00a93f28fbfee404dc8122a08c078f425b1925fb4be9d7d0ee118b1">State::COMPRESS</a>) {</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;        <a class="code" href="classfolly_1_1io_1_1StreamCodec.html#a9eefd02e5a959116145f9a6f4c22fa14">state_</a> = <a class="code" href="classfolly_1_1io_1_1StreamCodec.html#a3e49a89bbc00a93f28fbfee404dc8122ac09c49918b48515b53142e8783e69263">State::COMPRESS_FLUSH</a>;</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;      }</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;      <a class="code" href="classfolly_1_1io_1_1StreamCodec.html#a2035300384c68461745f8265ca5d1bd4">assertStateIs</a>(<a class="code" href="classfolly_1_1io_1_1StreamCodec.html#a3e49a89bbc00a93f28fbfee404dc8122ac09c49918b48515b53142e8783e69263">State::COMPRESS_FLUSH</a>);</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="classfolly_1_1io_1_1StreamCodec.html#a192cb12c95e700e316bf86043677ece7ab1a326c06d88bf042f73d70f50197905">StreamCodec::FlushOp::END</a>:</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classfolly_1_1io_1_1StreamCodec.html#a9eefd02e5a959116145f9a6f4c22fa14">state_</a> == <a class="code" href="classfolly_1_1io_1_1StreamCodec.html#a3e49a89bbc00a93f28fbfee404dc8122ab5859d8721cfdc0312b2838b9c985bc1">State::RESET</a> || <a class="code" href="classfolly_1_1io_1_1StreamCodec.html#a9eefd02e5a959116145f9a6f4c22fa14">state_</a> == <a class="code" href="classfolly_1_1io_1_1StreamCodec.html#a3e49a89bbc00a93f28fbfee404dc8122a08c078f425b1925fb4be9d7d0ee118b1">State::COMPRESS</a>) {</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;        <a class="code" href="classfolly_1_1io_1_1StreamCodec.html#a9eefd02e5a959116145f9a6f4c22fa14">state_</a> = <a class="code" href="classfolly_1_1io_1_1StreamCodec.html#a3e49a89bbc00a93f28fbfee404dc8122a6d6ee4f3f98009edff4aae134116aa39">State::COMPRESS_END</a>;</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;      }</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;      <a class="code" href="classfolly_1_1io_1_1StreamCodec.html#a2035300384c68461745f8265ca5d1bd4">assertStateIs</a>(<a class="code" href="classfolly_1_1io_1_1StreamCodec.html#a3e49a89bbc00a93f28fbfee404dc8122a6d6ee4f3f98009edff4aae134116aa39">State::COMPRESS_END</a>);</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;  }</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;  <span class="keywordtype">size_t</span> <span class="keyword">const</span> inputSize = input.<a class="code" href="classfolly_1_1Range.html#a4c2961b90459f542312422d62ff767b2">size</a>();</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;  <span class="keywordtype">size_t</span> <span class="keyword">const</span> outputSize = output.<a class="code" href="classfolly_1_1Range.html#a4c2961b90459f542312422d62ff767b2">size</a>();</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;  <span class="keywordtype">bool</span> <span class="keyword">const</span> done = <a class="code" href="classfolly_1_1io_1_1StreamCodec.html#a9841958a18fb7f2321573bf267ac8139">doCompressStream</a>(input, output, flushOp);</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;  <span class="keywordflow">if</span> (!done &amp;&amp; inputSize == input.<a class="code" href="classfolly_1_1Range.html#a4c2961b90459f542312422d62ff767b2">size</a>() &amp;&amp; outputSize == output.<a class="code" href="classfolly_1_1Range.html#a4c2961b90459f542312422d62ff767b2">size</a>()) {</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classfolly_1_1io_1_1StreamCodec.html#ac68c998011fb247fbe3e349bb7356de6">progressMade_</a>) {</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;      <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Codec: No forward progress made&quot;</span>);</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    }</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    <span class="comment">// Throw an exception if there is no progress again next time</span></div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    <a class="code" href="classfolly_1_1io_1_1StreamCodec.html#ac68c998011fb247fbe3e349bb7356de6">progressMade_</a> = <span class="keyword">false</span>;</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    <a class="code" href="classfolly_1_1io_1_1StreamCodec.html#ac68c998011fb247fbe3e349bb7356de6">progressMade_</a> = <span class="keyword">true</span>;</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;  }</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;  <span class="comment">// Handle output state transitions</span></div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;  <span class="keywordflow">if</span> (done) {</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classfolly_1_1io_1_1StreamCodec.html#a9eefd02e5a959116145f9a6f4c22fa14">state_</a> == <a class="code" href="classfolly_1_1io_1_1StreamCodec.html#a3e49a89bbc00a93f28fbfee404dc8122ac09c49918b48515b53142e8783e69263">State::COMPRESS_FLUSH</a>) {</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;      <a class="code" href="classfolly_1_1io_1_1StreamCodec.html#a9eefd02e5a959116145f9a6f4c22fa14">state_</a> = <a class="code" href="classfolly_1_1io_1_1StreamCodec.html#a3e49a89bbc00a93f28fbfee404dc8122a08c078f425b1925fb4be9d7d0ee118b1">State::COMPRESS</a>;</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classfolly_1_1io_1_1StreamCodec.html#a9eefd02e5a959116145f9a6f4c22fa14">state_</a> == <a class="code" href="classfolly_1_1io_1_1StreamCodec.html#a3e49a89bbc00a93f28fbfee404dc8122a6d6ee4f3f98009edff4aae134116aa39">State::COMPRESS_END</a>) {</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;      <a class="code" href="classfolly_1_1io_1_1StreamCodec.html#a9eefd02e5a959116145f9a6f4c22fa14">state_</a> = <a class="code" href="classfolly_1_1io_1_1StreamCodec.html#a3e49a89bbc00a93f28fbfee404dc8122ab1a326c06d88bf042f73d70f50197905">State::END</a>;</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    }</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    <span class="comment">// Check internal invariants</span></div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    DCHECK(input.<a class="code" href="classfolly_1_1Range.html#ac76f445a6485c7472d7e0bcfd0c7292b">empty</a>());</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    DCHECK(flushOp != <a class="code" href="classfolly_1_1io_1_1StreamCodec.html#a192cb12c95e700e316bf86043677ece7ab50339a10e1de285ac99d4c3990b8693">StreamCodec::FlushOp::NONE</a>);</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;  }</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;  <span class="keywordflow">return</span> done;</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;}</div><div class="ttc" id="classfolly_1_1io_1_1StreamCodec_html_a9eefd02e5a959116145f9a6f4c22fa14"><div class="ttname"><a href="classfolly_1_1io_1_1StreamCodec.html#a9eefd02e5a959116145f9a6f4c22fa14">folly::io::StreamCodec::state_</a></div><div class="ttdeci">State state_</div><div class="ttdef"><b>Definition:</b> <a href="Compression_8h_source.html#l00434">Compression.h:434</a></div></div>
<div class="ttc" id="classfolly_1_1io_1_1StreamCodec_html_a192cb12c95e700e316bf86043677ece7ab1a326c06d88bf042f73d70f50197905"><div class="ttname"><a href="classfolly_1_1io_1_1StreamCodec.html#a192cb12c95e700e316bf86043677ece7ab1a326c06d88bf042f73d70f50197905">folly::io::StreamCodec::FlushOp::END</a></div></div>
<div class="ttc" id="classfolly_1_1io_1_1StreamCodec_html_a3e49a89bbc00a93f28fbfee404dc8122a08c078f425b1925fb4be9d7d0ee118b1"><div class="ttname"><a href="classfolly_1_1io_1_1StreamCodec.html#a3e49a89bbc00a93f28fbfee404dc8122a08c078f425b1925fb4be9d7d0ee118b1">folly::io::StreamCodec::State::COMPRESS</a></div></div>
<div class="ttc" id="classfolly_1_1Range_html_a4c2961b90459f542312422d62ff767b2"><div class="ttname"><a href="classfolly_1_1Range.html#a4c2961b90459f542312422d62ff767b2">folly::Range::size</a></div><div class="ttdeci">constexpr size_type size() const </div><div class="ttdef"><b>Definition:</b> <a href="Range_8h_source.html#l00431">Range.h:431</a></div></div>
<div class="ttc" id="classfolly_1_1io_1_1StreamCodec_html_a192cb12c95e700e316bf86043677ece7ab50339a10e1de285ac99d4c3990b8693"><div class="ttname"><a href="classfolly_1_1io_1_1StreamCodec.html#a192cb12c95e700e316bf86043677ece7ab50339a10e1de285ac99d4c3990b8693">folly::io::StreamCodec::FlushOp::NONE</a></div></div>
<div class="ttc" id="classfolly_1_1io_1_1StreamCodec_html_a9841958a18fb7f2321573bf267ac8139"><div class="ttname"><a href="classfolly_1_1io_1_1StreamCodec.html#a9841958a18fb7f2321573bf267ac8139">folly::io::StreamCodec::doCompressStream</a></div><div class="ttdeci">virtual bool doCompressStream(folly::ByteRange &amp;input, folly::MutableByteRange &amp;output, FlushOp flushOp)=0</div></div>
<div class="ttc" id="classfolly_1_1Range_html_ac76f445a6485c7472d7e0bcfd0c7292b"><div class="ttname"><a href="classfolly_1_1Range.html#ac76f445a6485c7472d7e0bcfd0c7292b">folly::Range::empty</a></div><div class="ttdeci">constexpr bool empty() const </div><div class="ttdef"><b>Definition:</b> <a href="Range_8h_source.html#l00443">Range.h:443</a></div></div>
<div class="ttc" id="classfolly_1_1io_1_1StreamCodec_html_a192cb12c95e700e316bf86043677ece7a26eed7f078fc015c5252f817059a6f9f"><div class="ttname"><a href="classfolly_1_1io_1_1StreamCodec.html#a192cb12c95e700e316bf86043677ece7a26eed7f078fc015c5252f817059a6f9f">folly::io::StreamCodec::FlushOp::FLUSH</a></div></div>
<div class="ttc" id="classfolly_1_1io_1_1StreamCodec_html_a3e49a89bbc00a93f28fbfee404dc8122a6d6ee4f3f98009edff4aae134116aa39"><div class="ttname"><a href="classfolly_1_1io_1_1StreamCodec.html#a3e49a89bbc00a93f28fbfee404dc8122a6d6ee4f3f98009edff4aae134116aa39">folly::io::StreamCodec::State::COMPRESS_END</a></div></div>
<div class="ttc" id="classfolly_1_1io_1_1StreamCodec_html_a62415b459c5d3d578eafec1e9b49e491"><div class="ttname"><a href="classfolly_1_1io_1_1StreamCodec.html#a62415b459c5d3d578eafec1e9b49e491">folly::io::StreamCodec::needsDataLength</a></div><div class="ttdeci">bool needsDataLength() const </div><div class="ttdef"><b>Definition:</b> <a href="Compression_8cpp_source.html#l00314">Compression.cpp:314</a></div></div>
<div class="ttc" id="classfolly_1_1Optional_html_a3b9821dde9565651713c0013da729ae3"><div class="ttname"><a href="classfolly_1_1Optional.html#a3b9821dde9565651713c0013da729ae3">folly::Optional::value_or</a></div><div class="ttdeci">FOLLY_CPP14_CONSTEXPR Value value_or(U &amp;&amp;dflt) const &amp;</div><div class="ttdef"><b>Definition:</b> <a href="Optional_8h_source.html#l00330">Optional.h:330</a></div></div>
<div class="ttc" id="classfolly_1_1io_1_1StreamCodec_html_a3e49a89bbc00a93f28fbfee404dc8122ab5859d8721cfdc0312b2838b9c985bc1"><div class="ttname"><a href="classfolly_1_1io_1_1StreamCodec.html#a3e49a89bbc00a93f28fbfee404dc8122ab5859d8721cfdc0312b2838b9c985bc1">folly::io::StreamCodec::State::RESET</a></div></div>
<div class="ttc" id="classfolly_1_1io_1_1StreamCodec_html_ac688c462c86a2488dc8dfb3b56c066ac"><div class="ttname"><a href="classfolly_1_1io_1_1StreamCodec.html#ac688c462c86a2488dc8dfb3b56c066ac">folly::io::StreamCodec::uncompressedLength</a></div><div class="ttdeci">folly::Optional&lt; uint64_t &gt; uncompressedLength() const </div><div class="ttdef"><b>Definition:</b> <a href="Compression_8h_source.html#l00401">Compression.h:401</a></div></div>
<div class="ttc" id="ConstexprMathBenchmark_8cpp_html_a5dc34568a989dd90728a4ed499cd9fab"><div class="ttname"><a href="ConstexprMathBenchmark_8cpp.html#a5dc34568a989dd90728a4ed499cd9fab">uint64_t</a></div><div class="ttdeci">uint64_t</div><div class="ttdef"><b>Definition:</b> <a href="ConstexprMathBenchmark_8cpp_source.html#l00190">ConstexprMathBenchmark.cpp:190</a></div></div>
<div class="ttc" id="classfolly_1_1io_1_1StreamCodec_html_ac68c998011fb247fbe3e349bb7356de6"><div class="ttname"><a href="classfolly_1_1io_1_1StreamCodec.html#ac68c998011fb247fbe3e349bb7356de6">folly::io::StreamCodec::progressMade_</a></div><div class="ttdeci">bool progressMade_</div><div class="ttdef"><b>Definition:</b> <a href="Compression_8h_source.html#l00437">Compression.h:437</a></div></div>
<div class="ttc" id="classfolly_1_1io_1_1StreamCodec_html_a3e49a89bbc00a93f28fbfee404dc8122ac09c49918b48515b53142e8783e69263"><div class="ttname"><a href="classfolly_1_1io_1_1StreamCodec.html#a3e49a89bbc00a93f28fbfee404dc8122ac09c49918b48515b53142e8783e69263">folly::io::StreamCodec::State::COMPRESS_FLUSH</a></div></div>
<div class="ttc" id="classfolly_1_1io_1_1StreamCodec_html_a2035300384c68461745f8265ca5d1bd4"><div class="ttname"><a href="classfolly_1_1io_1_1StreamCodec.html#a2035300384c68461745f8265ca5d1bd4">folly::io::StreamCodec::assertStateIs</a></div><div class="ttdeci">void assertStateIs(State expected) const </div><div class="ttdef"><b>Definition:</b> <a href="Compression_8cpp_source.html#l00322">Compression.cpp:322</a></div></div>
<div class="ttc" id="classfolly_1_1io_1_1StreamCodec_html_a3e49a89bbc00a93f28fbfee404dc8122ab1a326c06d88bf042f73d70f50197905"><div class="ttname"><a href="classfolly_1_1io_1_1StreamCodec.html#a3e49a89bbc00a93f28fbfee404dc8122ab1a326c06d88bf042f73d70f50197905">folly::io::StreamCodec::State::END</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a7530d548ade9c8b6d207458587883671"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt; <a class="el" href="classfolly_1_1IOBuf.html">IOBuf</a> &gt; folly::io::StreamCodec::doCompress </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classfolly_1_1IOBuf.html">folly::IOBuf</a> *&#160;</td>
          <td class="paramname"><em>data</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">private</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Implements <a class="el" href="classfolly_1_1io_1_1Codec.html#a572f86c32fd6c0b87aaaa11bd4c39e5a">folly::io::Codec</a>.</p>

<p>Definition at line <a class="el" href="Compression_8cpp_source.html#l00444">444</a> of file <a class="el" href="Compression_8cpp_source.html">Compression.cpp</a>.</p>

<p>References <a class="el" href="Compression_8cpp_source.html#l00434">folly::io::addOutputBuffer()</a>, <a class="el" href="experimental_2test_2BitsBenchmark_8cpp.html#a25bccaee4203f6f142efc1f61e9b66c5">buffer()</a>, <a class="el" href="IOBuf_8cpp_source.html#l00501">folly::IOBuf::computeChainDataLength()</a>, <a class="el" href="SynchronizedTest_8cpp_source.html#l00743">current</a>, <a class="el" href="Access_8h_source.html#l00071">folly::data()</a>, <a class="el" href="IOBuf_8h_source.html#l00499">folly::IOBuf::data()</a>, <a class="el" href="Range_8h_source.html#l00443">folly::Range&lt; Iter &gt;::empty()</a>, <a class="el" href="classfolly_1_1io_1_1StreamCodec.html#a192cb12c95e700e316bf86043677ece7ab1a326c06d88bf042f73d70f50197905">END</a>, <a class="el" href="IOBuf_8h_source.html#l00533">folly::IOBuf::length()</a>, <a class="el" href="Compression_8cpp_source.html#l00291">folly::io::Codec::maxCompressedLength()</a>, <a class="el" href="IOBuf_8h_source.html#l00600">folly::IOBuf::next()</a>, <a class="el" href="classfolly_1_1io_1_1StreamCodec.html#a192cb12c95e700e316bf86043677ece7ab50339a10e1de285ac99d4c3990b8693">NONE</a>, <a class="el" href="fizz_2build___2gtest_2src_2gtest_2googlemock_2test_2gmock__output__test_8py_source.html#l00175">gmock_output_test::output</a>, <a class="el" href="Range_8h_source.html#l00431">folly::Range&lt; Iter &gt;::size()</a>, and <a class="el" href="ConstexprMathBenchmark_8cpp_source.html#l00190">uint64_t</a>.</p>
<div class="fragment"><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;                                                              {</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;  <a class="code" href="ConstexprMathBenchmark_8cpp.html#a5dc34568a989dd90728a4ed499cd9fab">uint64_t</a> <span class="keyword">const</span> <a class="code" href="classfolly_1_1io_1_1StreamCodec.html#ac688c462c86a2488dc8dfb3b56c066ac">uncompressedLength</a> = data-&gt;<a class="code" href="classfolly_1_1IOBuf.html#ac4c405fd5fa405c8d814b4cc86309a34">computeChainDataLength</a>();</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;  <a class="code" href="classfolly_1_1io_1_1StreamCodec.html#a91212cf08449806f8a5a39c099084ed6">resetStream</a>(uncompressedLength);</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;  <a class="code" href="ConstexprMathBenchmark_8cpp.html#a5dc34568a989dd90728a4ed499cd9fab">uint64_t</a> <span class="keyword">const</span> maxCompressedLen = <a class="code" href="classfolly_1_1io_1_1Codec.html#a5939c1725a76995cd65be007a830667e">maxCompressedLength</a>(uncompressedLength);</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;  <span class="keyword">auto</span> constexpr kMaxSingleStepLength = <a class="code" href="ConstexprMathBenchmark_8cpp.html#a5dc34568a989dd90728a4ed499cd9fab">uint64_t</a>(64) &lt;&lt; 20; <span class="comment">// 64 MB</span></div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;  <span class="keyword">auto</span> constexpr kDefaultBufferLength = <a class="code" href="ConstexprMathBenchmark_8cpp.html#a5dc34568a989dd90728a4ed499cd9fab">uint64_t</a>(4) &lt;&lt; 20; <span class="comment">// 4 MB</span></div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;  <a class="code" href="namespacefolly.html#a9efde8a92a713a155d17ccb9452ecd5e">MutableByteRange</a> <a class="code" href="namespacegmock__output__test.html#a4277f8598ba3835393fe82e82d09375d">output</a>;</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;  <span class="keyword">auto</span> <a class="code" href="experimental_2test_2BitsBenchmark_8cpp.html#a25bccaee4203f6f142efc1f61e9b66c5">buffer</a> = <a class="code" href="namespacefolly_1_1io.html#ae5f1fa5c7d5788e7f791fcd9e1196dfa">addOutputBuffer</a>(</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;      output,</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;      maxCompressedLen &lt;= kMaxSingleStepLength ? maxCompressedLen</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;                                               : kDefaultBufferLength);</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;  <span class="comment">// Compress the entire IOBuf chain into the IOBuf chain pointed to by buffer</span></div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;  IOBuf <span class="keyword">const</span>* <a class="code" href="SynchronizedTest_8cpp.html#ab04e2d55ea4a544f3575812582af7b51">current</a> = <a class="code" href="namespacefolly.html#a23ca01703d6715fb172f4188faa73dc9">data</a>;</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;  <a class="code" href="namespacefolly.html#a7f61a634c75bc3bb46447ec2b17ff0fe">ByteRange</a> input{current-&gt;<a class="code" href="classfolly_1_1Range.html#a2aaeaeaee2acdcffedbf021d6396cc72">data</a>(), current-&gt;length()};</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;  <a class="code" href="classfolly_1_1io_1_1StreamCodec.html#a192cb12c95e700e316bf86043677ece7">StreamCodec::FlushOp</a> flushOp = <a class="code" href="classfolly_1_1io_1_1StreamCodec.html#a192cb12c95e700e316bf86043677ece7ab50339a10e1de285ac99d4c3990b8693">StreamCodec::FlushOp::NONE</a>;</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;  <span class="keywordtype">bool</span> done = <span class="keyword">false</span>;</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;  <span class="keywordflow">while</span> (!done) {</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    <span class="keywordflow">while</span> (input.empty() &amp;&amp; current-&gt;next() != <a class="code" href="namespacefolly.html#a23ca01703d6715fb172f4188faa73dc9">data</a>) {</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;      current = current-&gt;next();</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;      input = {current-&gt;data(), current-&gt;length()};</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    }</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    <span class="keywordflow">if</span> (current-&gt;next() == <a class="code" href="namespacefolly.html#a23ca01703d6715fb172f4188faa73dc9">data</a>) {</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;      <span class="comment">// This is the last input buffer so end the stream</span></div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;      flushOp = <a class="code" href="classfolly_1_1io_1_1StreamCodec.html#a192cb12c95e700e316bf86043677ece7ab1a326c06d88bf042f73d70f50197905">StreamCodec::FlushOp::END</a>;</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    }</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    <span class="keywordflow">if</span> (output.empty()) {</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;      <a class="code" href="experimental_2test_2BitsBenchmark_8cpp.html#a25bccaee4203f6f142efc1f61e9b66c5">buffer</a>-&gt;prependChain(<a class="code" href="namespacefolly_1_1io.html#ae5f1fa5c7d5788e7f791fcd9e1196dfa">addOutputBuffer</a>(output, kDefaultBufferLength));</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    }</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    done = <a class="code" href="classfolly_1_1io_1_1StreamCodec.html#a4018be177bc9dc3568e4a2f6a0cc78b9">compressStream</a>(input, output, flushOp);</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    <span class="keywordflow">if</span> (done) {</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;      DCHECK(input.empty());</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;      DCHECK(flushOp == <a class="code" href="classfolly_1_1io_1_1StreamCodec.html#a192cb12c95e700e316bf86043677ece7ab1a326c06d88bf042f73d70f50197905">StreamCodec::FlushOp::END</a>);</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;      DCHECK_EQ(current-&gt;next(), <a class="code" href="namespacefolly.html#a23ca01703d6715fb172f4188faa73dc9">data</a>);</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    }</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;  }</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;  <a class="code" href="experimental_2test_2BitsBenchmark_8cpp.html#a25bccaee4203f6f142efc1f61e9b66c5">buffer</a>-&gt;prev()-&gt;trimEnd(output.size());</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="experimental_2test_2BitsBenchmark_8cpp.html#a25bccaee4203f6f142efc1f61e9b66c5">buffer</a>;</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;}</div><div class="ttc" id="experimental_2test_2BitsBenchmark_8cpp_html_a25bccaee4203f6f142efc1f61e9b66c5"><div class="ttname"><a href="experimental_2test_2BitsBenchmark_8cpp.html#a25bccaee4203f6f142efc1f61e9b66c5">buffer</a></div><div class="ttdeci">std::vector&lt; uint8_t &gt; buffer(kBufferSize+16)</div></div>
<div class="ttc" id="classfolly_1_1io_1_1StreamCodec_html_a192cb12c95e700e316bf86043677ece7ab1a326c06d88bf042f73d70f50197905"><div class="ttname"><a href="classfolly_1_1io_1_1StreamCodec.html#a192cb12c95e700e316bf86043677ece7ab1a326c06d88bf042f73d70f50197905">folly::io::StreamCodec::FlushOp::END</a></div></div>
<div class="ttc" id="classfolly_1_1io_1_1StreamCodec_html_a192cb12c95e700e316bf86043677ece7ab50339a10e1de285ac99d4c3990b8693"><div class="ttname"><a href="classfolly_1_1io_1_1StreamCodec.html#a192cb12c95e700e316bf86043677ece7ab50339a10e1de285ac99d4c3990b8693">folly::io::StreamCodec::FlushOp::NONE</a></div></div>
<div class="ttc" id="namespacefolly_html_a9efde8a92a713a155d17ccb9452ecd5e"><div class="ttname"><a href="namespacefolly.html#a9efde8a92a713a155d17ccb9452ecd5e">folly::MutableByteRange</a></div><div class="ttdeci">Range&lt; unsigned char * &gt; MutableByteRange</div><div class="ttdef"><b>Definition:</b> <a href="Range_8h_source.html#l01164">Range.h:1164</a></div></div>
<div class="ttc" id="namespacefolly_1_1io_html_ae5f1fa5c7d5788e7f791fcd9e1196dfa"><div class="ttname"><a href="namespacefolly_1_1io.html#ae5f1fa5c7d5788e7f791fcd9e1196dfa">folly::io::addOutputBuffer</a></div><div class="ttdeci">static std::unique_ptr&lt; IOBuf &gt; addOutputBuffer(MutableByteRange &amp;output, uint64_t size)</div><div class="ttdef"><b>Definition:</b> <a href="Compression_8cpp_source.html#l00434">Compression.cpp:434</a></div></div>
<div class="ttc" id="SynchronizedTest_8cpp_html_ab04e2d55ea4a544f3575812582af7b51"><div class="ttname"><a href="SynchronizedTest_8cpp.html#ab04e2d55ea4a544f3575812582af7b51">current</a></div><div class="ttdeci">int current</div><div class="ttdef"><b>Definition:</b> <a href="SynchronizedTest_8cpp_source.html#l00743">SynchronizedTest.cpp:743</a></div></div>
<div class="ttc" id="classfolly_1_1Range_html_a2aaeaeaee2acdcffedbf021d6396cc72"><div class="ttname"><a href="classfolly_1_1Range.html#a2aaeaeaee2acdcffedbf021d6396cc72">folly::Range::data</a></div><div class="ttdeci">constexpr Iter data() const </div><div class="ttdef"><b>Definition:</b> <a href="Range_8h_source.html#l00446">Range.h:446</a></div></div>
<div class="ttc" id="namespacefolly_html_a23ca01703d6715fb172f4188faa73dc9"><div class="ttname"><a href="namespacefolly.html#a23ca01703d6715fb172f4188faa73dc9">folly::data</a></div><div class="ttdeci">constexpr auto data(C &amp;c) -&gt; decltype(c.data())</div><div class="ttdef"><b>Definition:</b> <a href="Access_8h_source.html#l00071">Access.h:71</a></div></div>
<div class="ttc" id="classfolly_1_1io_1_1Codec_html_a5939c1725a76995cd65be007a830667e"><div class="ttname"><a href="classfolly_1_1io_1_1Codec.html#a5939c1725a76995cd65be007a830667e">folly::io::Codec::maxCompressedLength</a></div><div class="ttdeci">uint64_t maxCompressedLength(uint64_t uncompressedLength) const </div><div class="ttdef"><b>Definition:</b> <a href="Compression_8cpp_source.html#l00291">Compression.cpp:291</a></div></div>
<div class="ttc" id="classfolly_1_1IOBuf_html_ac4c405fd5fa405c8d814b4cc86309a34"><div class="ttname"><a href="classfolly_1_1IOBuf.html#ac4c405fd5fa405c8d814b4cc86309a34">folly::IOBuf::computeChainDataLength</a></div><div class="ttdeci">std::size_t computeChainDataLength() const </div><div class="ttdef"><b>Definition:</b> <a href="IOBuf_8cpp_source.html#l00501">IOBuf.cpp:501</a></div></div>
<div class="ttc" id="namespacegmock__output__test_html_a4277f8598ba3835393fe82e82d09375d"><div class="ttname"><a href="namespacegmock__output__test.html#a4277f8598ba3835393fe82e82d09375d">gmock_output_test.output</a></div><div class="ttdeci">output</div><div class="ttdef"><b>Definition:</b> <a href="fizz_2build___2gtest_2src_2gtest_2googlemock_2test_2gmock__output__test_8py_source.html#l00175">gmock_output_test.py:175</a></div></div>
<div class="ttc" id="classfolly_1_1io_1_1StreamCodec_html_ac688c462c86a2488dc8dfb3b56c066ac"><div class="ttname"><a href="classfolly_1_1io_1_1StreamCodec.html#ac688c462c86a2488dc8dfb3b56c066ac">folly::io::StreamCodec::uncompressedLength</a></div><div class="ttdeci">folly::Optional&lt; uint64_t &gt; uncompressedLength() const </div><div class="ttdef"><b>Definition:</b> <a href="Compression_8h_source.html#l00401">Compression.h:401</a></div></div>
<div class="ttc" id="classfolly_1_1io_1_1StreamCodec_html_a4018be177bc9dc3568e4a2f6a0cc78b9"><div class="ttname"><a href="classfolly_1_1io_1_1StreamCodec.html#a4018be177bc9dc3568e4a2f6a0cc78b9">folly::io::StreamCodec::compressStream</a></div><div class="ttdeci">bool compressStream(folly::ByteRange &amp;input, folly::MutableByteRange &amp;output, FlushOp flushOp=StreamCodec::FlushOp::NONE)</div><div class="ttdef"><b>Definition:</b> <a href="Compression_8cpp_source.html#l00336">Compression.cpp:336</a></div></div>
<div class="ttc" id="namespacefolly_html_a7f61a634c75bc3bb46447ec2b17ff0fe"><div class="ttname"><a href="namespacefolly.html#a7f61a634c75bc3bb46447ec2b17ff0fe">folly::ByteRange</a></div><div class="ttdeci">Range&lt; const unsigned char * &gt; ByteRange</div><div class="ttdef"><b>Definition:</b> <a href="Range_8h_source.html#l01163">Range.h:1163</a></div></div>
<div class="ttc" id="ConstexprMathBenchmark_8cpp_html_a5dc34568a989dd90728a4ed499cd9fab"><div class="ttname"><a href="ConstexprMathBenchmark_8cpp.html#a5dc34568a989dd90728a4ed499cd9fab">uint64_t</a></div><div class="ttdeci">uint64_t</div><div class="ttdef"><b>Definition:</b> <a href="ConstexprMathBenchmark_8cpp_source.html#l00190">ConstexprMathBenchmark.cpp:190</a></div></div>
<div class="ttc" id="classfolly_1_1io_1_1StreamCodec_html_a91212cf08449806f8a5a39c099084ed6"><div class="ttname"><a href="classfolly_1_1io_1_1StreamCodec.html#a91212cf08449806f8a5a39c099084ed6">folly::io::StreamCodec::resetStream</a></div><div class="ttdeci">void resetStream(folly::Optional&lt; uint64_t &gt; uncompressedLength=folly::none)</div><div class="ttdef"><b>Definition:</b> <a href="Compression_8cpp_source.html#l00329">Compression.cpp:329</a></div></div>
<div class="ttc" id="classfolly_1_1io_1_1StreamCodec_html_a192cb12c95e700e316bf86043677ece7"><div class="ttname"><a href="classfolly_1_1io_1_1StreamCodec.html#a192cb12c95e700e316bf86043677ece7">folly::io::StreamCodec::FlushOp</a></div><div class="ttdeci">FlushOp</div><div class="ttdef"><b>Definition:</b> <a href="Compression_8h_source.html#l00311">Compression.h:311</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a9841958a18fb7f2321573bf267ac8139"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual bool folly::io::StreamCodec::doCompressStream </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespacefolly.html#a7f61a634c75bc3bb46447ec2b17ff0fe">folly::ByteRange</a> &amp;&#160;</td>
          <td class="paramname"><em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacefolly.html#a9efde8a92a713a155d17ccb9452ecd5e">folly::MutableByteRange</a> &amp;&#160;</td>
          <td class="paramname"><em>output</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classfolly_1_1io_1_1StreamCodec.html#a192cb12c95e700e316bf86043677ece7">FlushOp</a>&#160;</td>
          <td class="paramname"><em>flushOp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ab8bb3a1432680819dd64e297e7265549"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool folly::io::StreamCodec::doNeedsDataLength </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="Compression_8cpp_source.html#l00318">318</a> of file <a class="el" href="Compression_8cpp_source.html">Compression.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;                                          {</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;}</div></div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a2bcf03b67f4bfb052e4142927a25ee30"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void folly::io::StreamCodec::doResetStream </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a4c541b048c53063cb2cf26cc6d35ac0a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt; <a class="el" href="classfolly_1_1IOBuf.html">IOBuf</a> &gt; folly::io::StreamCodec::doUncompress </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classfolly_1_1IOBuf.html">folly::IOBuf</a> *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classfolly_1_1Optional.html">folly::Optional</a>&lt; <a class="el" href="ConstexprMathBenchmark_8cpp.html#a5dc34568a989dd90728a4ed499cd9fab">uint64_t</a> &gt;&#160;</td>
          <td class="paramname"><em>uncompressedLength</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">private</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Implements <a class="el" href="classfolly_1_1io_1_1Codec.html#a277e97d9f414ceec32bd218137b3b995">folly::io::Codec</a>.</p>

<p>Definition at line <a class="el" href="Compression_8cpp_source.html#l00494">494</a> of file <a class="el" href="Compression_8cpp_source.html">Compression.cpp</a>.</p>

<p>References <a class="el" href="Compression_8cpp_source.html#l00434">folly::io::addOutputBuffer()</a>, <a class="el" href="Range_8h_source.html#l00672">folly::Range&lt; Iter &gt;::advance()</a>, <a class="el" href="IOBuf_8h_source.html#l00689">folly::IOBuf::append()</a>, <a class="el" href="OptionalTest_8cpp_source.html#l00053">b</a>, <a class="el" href="IOBuf_8h_source.html#l01684">folly::IOBuf::begin()</a>, <a class="el" href="experimental_2test_2BitsBenchmark_8cpp.html#a25bccaee4203f6f142efc1f61e9b66c5">buffer()</a>, <a class="el" href="namespacefolly_1_1io.html#a1f249567e09c910175371b7309566d2ba800edd55a1e18b397e3d5d826f85ce34">folly::io::BZIP2</a>, <a class="el" href="IOBufQueue_8h_source.html#l00083">folly::IOBufQueue::cacheChainLength()</a>, <a class="el" href="Compression_8cpp_source.html#l00263">folly::io::Codec::canUncompress()</a>, <a class="el" href="IOBufQueue_8h_source.html#l00492">folly::IOBufQueue::chainLength()</a>, <a class="el" href="IOBuf_8cpp_source.html#l00527">folly::IOBuf::clone()</a>, <a class="el" href="IOBuf_8cpp_source.html#l00570">folly::IOBuf::cloneCoalescedAsValue()</a>, <a class="el" href="IOBuf_8h_source.html#l01095">folly::IOBuf::coalesce()</a>, <a class="el" href="Compression_8cpp_source.html#l00071">folly::io::Codec::Codec()</a>, <a class="el" href="Compression_8h_source.html#l00442">folly::io::COMPRESSION_LEVEL_BEST</a>, <a class="el" href="Compression_8h_source.html#l00441">folly::io::COMPRESSION_LEVEL_DEFAULT</a>, <a class="el" href="Compression_8h_source.html#l00440">folly::io::COMPRESSION_LEVEL_FASTEST</a>, <a class="el" href="Compression_8cpp_source.html#l00486">folly::io::computeBufferLength()</a>, <a class="el" href="IOBuf_8cpp_source.html#l00501">folly::IOBuf::computeChainDataLength()</a>, <a class="el" href="IOBuf_8cpp_source.html#l00229">folly::IOBuf::create()</a>, <a class="el" href="SynchronizedTest_8cpp_source.html#l00743">current</a>, <a class="el" href="Access_8h_source.html#l00071">folly::data()</a>, <a class="el" href="Range_8h_source.html#l00446">folly::Range&lt; Iter &gt;::data()</a>, <a class="el" href="IOBuf_8h_source.html#l00499">folly::IOBuf::data()</a>, <a class="el" href="folly_2folly_2compression_2Utils_8h_source.html#l00040">folly::io::compression::detail::dataStartsWithLE()</a>, <a class="el" href="classfolly_1_1io_1_1Codec.html#a572f86c32fd6c0b87aaaa11bd4c39e5a">folly::io::Codec::doCompress()</a>, <a class="el" href="classfolly_1_1io_1_1Codec.html#a6839e2901339d70a23070b6e5a51fda9">folly::io::Codec::doMaxCompressedLength()</a>, <a class="el" href="Compression_8cpp_source.html#l00255">folly::io::Codec::doMaxUncompressedLength()</a>, <a class="el" href="Compression_8cpp_source.html#l00251">folly::io::Codec::doNeedsUncompressedLength()</a>, <a class="el" href="classfolly_1_1io_1_1Codec.html#a277e97d9f414ceec32bd218137b3b995">folly::io::Codec::doUncompress()</a>, <a class="el" href="Range_8h_source.html#l00443">folly::Range&lt; Iter &gt;::empty()</a>, <a class="el" href="Varint_8h_source.html#l00109">folly::encodeVarint()</a>, <a class="el" href="classfolly_1_1io_1_1StreamCodec.html#a192cb12c95e700e316bf86043677ece7ab1a326c06d88bf042f73d70f50197905">END</a>, <a class="el" href="classfolly_1_1io_1_1StreamCodec.html#a192cb12c95e700e316bf86043677ece7a26eed7f078fc015c5252f817059a6f9f">FLUSH</a>, <a class="el" href="Compression_8cpp_source.html#l02104">folly::io::getCodec()</a>, <a class="el" href="Compression_8cpp_source.html#l02119">folly::io::getStreamCodec()</a>, <a class="el" href="Compression_8cpp_source.html#l00295">folly::io::Codec::getUncompressedLength()</a>, <a class="el" href="namespacefolly_1_1io.html#a1f249567e09c910175371b7309566d2baf1cd28417b03cfab3a8e16d66e34e18a">folly::io::GZIP</a>, <a class="el" href="Optional_8h_source.html#l00300">folly::Optional&lt; Value &gt;::hasValue()</a>, <a class="el" href="ConstexprMathBenchmark_8cpp_source.html#l00176">int8_t</a>, <a class="el" href="IOBuf_8h_source.html#l00760">folly::IOBuf::isChained()</a>, <a class="el" href="Varint_8h_source.html#l00050">folly::kMaxVarintLength64</a>, <a class="el" href="IOBuf_8h_source.html#l00533">folly::IOBuf::length()</a>, <a class="el" href="namespacefolly_1_1io.html#a1f249567e09c910175371b7309566d2baca0c64c0de8f56bc573828ea6d764594">folly::io::LZ4</a>, <a class="el" href="namespacefolly_1_1io.html#a1f249567e09c910175371b7309566d2ba48e1d7a08182ec855115aacb4f3ad6ef">folly::io::LZ4_FRAME</a>, <a class="el" href="namespacefolly_1_1io.html#a1f249567e09c910175371b7309566d2ba75b5275d3df95721c0d79245dc124d0a">folly::io::LZ4_VARINT_SIZE</a>, <a class="el" href="namespacefolly_1_1io.html#a1f249567e09c910175371b7309566d2ba42c2eee811f4ee3622ca6150a9be0276">folly::io::LZMA2</a>, <a class="el" href="namespacefolly_1_1io.html#a1f249567e09c910175371b7309566d2baa1498965b17c5f8e4682cf7d594b445c">folly::io::LZMA2_VARINT_SIZE</a>, <a class="el" href="LogLevel_8cpp_source.html#l00031">max</a>, <a class="el" href="Compression_8cpp_source.html#l00291">folly::io::Codec::maxCompressedLength()</a>, <a class="el" href="Compression_8cpp_source.html#l00247">folly::io::Codec::maxUncompressedLength()</a>, <a class="el" href="LogLevel_8cpp_source.html#l00030">min</a>, <a class="el" href="IOBufQueue_8h_source.html#l00459">folly::IOBufQueue::move()</a>, <a class="el" href="IOBuf_8h_source.html#l00600">folly::IOBuf::next()</a>, <a class="el" href="namespacefolly_1_1io.html#a1f249567e09c910175371b7309566d2ba62096764a2f2b99c5505b4828cdef7bd">folly::io::NO_COMPRESSION</a>, <a class="el" href="classfolly_1_1io_1_1StreamCodec.html#a192cb12c95e700e316bf86043677ece7ab50339a10e1de285ac99d4c3990b8693">NONE</a>, <a class="el" href="fizz_2build___2gtest_2src_2gtest_2googlemock_2test_2gmock__output__test_8py_source.html#l00175">gmock_output_test::output</a>, <a class="el" href="Cursor_8h_source.html#l00436">folly::io::detail::CursorBase&lt; Derived, BufType &gt;::peekBytes()</a>, <a class="el" href="IOBufQueue_8h_source.html#l00380">folly::IOBufQueue::postallocate()</a>, <a class="el" href="IOBufQueue_8h_source.html#l00356">folly::IOBufQueue::preallocate()</a>, <a class="el" href="folly_2folly_2compression_2Utils_8h_source.html#l00054">folly::io::compression::detail::prefixToStringLE()</a>, <a class="el" href="Range_8h_source.html#l01114">folly::range()</a>, <a class="el" href="Cursor_8h_source.html#l00282">folly::io::detail::CursorBase&lt; Derived, BufType &gt;::read()</a>, <a class="el" href="ScopeGuard_8h_source.html#l00274">SCOPE_EXIT</a>, <a class="el" href="Range_8h_source.html#l00431">folly::Range&lt; Iter &gt;::size()</a>, <a class="el" href="namespacefolly.html#a916e313d8138999fd8886415354f8da5a72ef2b9b6965d078e3c7f95487a82d1c">folly::Skip</a>, <a class="el" href="namespacefolly_1_1io.html#a1f249567e09c910175371b7309566d2ba2069e5c0aea54224dcd6b9b6c78c4902">folly::io::SNAPPY</a>, <a class="el" href="Compression_8cpp_source.html#l02019">stream</a>, <a class="el" href="IOBuf_8h_source.html#l00551">folly::IOBuf::tailroom()</a>, <a class="el" href="namespacefolly.html#aff1c12375d4f55ecde182c4d6b96226faf3153577bcbb418287702d0b5d78b4e2">folly::TooManyBytes</a>, <a class="el" href="Varint_8h_source.html#l00147">folly::tryDecodeVarint()</a>, <a class="el" href="Compression_8h_source.html#l00147">folly::io::Codec::type()</a>, <a class="el" href="ConstexprMathBenchmark_8cpp_source.html#l00186">uint32_t</a>, <a class="el" href="ConstexprMathBenchmark_8cpp_source.html#l00190">uint64_t</a>, <a class="el" href="ConstexprMathBenchmark_8cpp_source.html#l00178">uint8_t</a>, <a class="el" href="Range_8h_source.html#l00695">folly::Range&lt; Iter &gt;::uncheckedAdvance()</a>, <a class="el" href="String_8cpp_source.html#l00273">val</a>, <a class="el" href="Compression_8cpp_source.html#l00259">folly::io::Codec::validPrefixes()</a>, <a class="el" href="IOBuf_8h_source.html#l00526">folly::IOBuf::writableTail()</a>, <a class="el" href="namespacefolly_1_1io.html#a1f249567e09c910175371b7309566d2ba87c23ff88ac9b1c4390a679b63ea3b8c">folly::io::ZLIB</a>, <a class="el" href="namespacefolly_1_1io.html#a1f249567e09c910175371b7309566d2ba8406cc2302e19183037b61249546b234">folly::io::ZSTD</a>, and <a class="el" href="namespacefolly_1_1io.html#a1f249567e09c910175371b7309566d2baca57099a7e7c9f1999a7a2acab223167">folly::io::ZSTD_FAST</a>.</p>
<div class="fragment"><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;                                           {</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;  <span class="keyword">auto</span> constexpr kMaxSingleStepLength = <a class="code" href="ConstexprMathBenchmark_8cpp.html#a5dc34568a989dd90728a4ed499cd9fab">uint64_t</a>(64) &lt;&lt; 20; <span class="comment">// 64 MB</span></div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;  <span class="keyword">auto</span> constexpr kBlockSize = <a class="code" href="ConstexprMathBenchmark_8cpp.html#a5dc34568a989dd90728a4ed499cd9fab">uint64_t</a>(128) &lt;&lt; 10;</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;  <span class="keyword">auto</span> <span class="keyword">const</span> defaultBufferLength =</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;      <a class="code" href="namespacefolly_1_1io.html#a42f2912d72c8328211f65010d660caa6">computeBufferLength</a>(data-&gt;<a class="code" href="classfolly_1_1IOBuf.html#ac4c405fd5fa405c8d814b4cc86309a34">computeChainDataLength</a>(), kBlockSize);</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;  uncompressedLength = <a class="code" href="classfolly_1_1io_1_1Codec.html#a05d3b6746620ecd75fdcbfd72d28b52f">getUncompressedLength</a>(data, uncompressedLength);</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;  <a class="code" href="classfolly_1_1io_1_1StreamCodec.html#a91212cf08449806f8a5a39c099084ed6">resetStream</a>(uncompressedLength);</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;  <a class="code" href="namespacefolly.html#a9efde8a92a713a155d17ccb9452ecd5e">MutableByteRange</a> <a class="code" href="namespacegmock__output__test.html#a4277f8598ba3835393fe82e82d09375d">output</a>;</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;  <span class="keyword">auto</span> <a class="code" href="experimental_2test_2BitsBenchmark_8cpp.html#a25bccaee4203f6f142efc1f61e9b66c5">buffer</a> = <a class="code" href="namespacefolly_1_1io.html#ae5f1fa5c7d5788e7f791fcd9e1196dfa">addOutputBuffer</a>(</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;      output,</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;      (uncompressedLength &amp;&amp; *uncompressedLength &lt;= kMaxSingleStepLength</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;           ? *uncompressedLength</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;           : defaultBufferLength));</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;  <span class="comment">// Uncompress the entire IOBuf chain into the IOBuf chain pointed to by buffer</span></div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;  IOBuf <span class="keyword">const</span>* <a class="code" href="SynchronizedTest_8cpp.html#ab04e2d55ea4a544f3575812582af7b51">current</a> = <a class="code" href="namespacefolly.html#a23ca01703d6715fb172f4188faa73dc9">data</a>;</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;  <a class="code" href="namespacefolly.html#a7f61a634c75bc3bb46447ec2b17ff0fe">ByteRange</a> input{current-&gt;<a class="code" href="classfolly_1_1Range.html#a2aaeaeaee2acdcffedbf021d6396cc72">data</a>(), current-&gt;length()};</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;  <a class="code" href="classfolly_1_1io_1_1StreamCodec.html#a192cb12c95e700e316bf86043677ece7">StreamCodec::FlushOp</a> flushOp = <a class="code" href="classfolly_1_1io_1_1StreamCodec.html#a192cb12c95e700e316bf86043677ece7ab50339a10e1de285ac99d4c3990b8693">StreamCodec::FlushOp::NONE</a>;</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;  <span class="keywordtype">bool</span> done = <span class="keyword">false</span>;</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;  <span class="keywordflow">while</span> (!done) {</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    <span class="keywordflow">while</span> (input.empty() &amp;&amp; current-&gt;next() != <a class="code" href="namespacefolly.html#a23ca01703d6715fb172f4188faa73dc9">data</a>) {</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;      current = current-&gt;next();</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;      input = {current-&gt;data(), current-&gt;length()};</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    }</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    <span class="keywordflow">if</span> (current-&gt;next() == <a class="code" href="namespacefolly.html#a23ca01703d6715fb172f4188faa73dc9">data</a>) {</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;      <span class="comment">// Tell the uncompressor there is no more input (it may optimize)</span></div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;      flushOp = <a class="code" href="classfolly_1_1io_1_1StreamCodec.html#a192cb12c95e700e316bf86043677ece7ab1a326c06d88bf042f73d70f50197905">StreamCodec::FlushOp::END</a>;</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    }</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    <span class="keywordflow">if</span> (output.empty()) {</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;      <a class="code" href="experimental_2test_2BitsBenchmark_8cpp.html#a25bccaee4203f6f142efc1f61e9b66c5">buffer</a>-&gt;prependChain(<a class="code" href="namespacefolly_1_1io.html#ae5f1fa5c7d5788e7f791fcd9e1196dfa">addOutputBuffer</a>(output, defaultBufferLength));</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    }</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    done = <a class="code" href="classfolly_1_1io_1_1StreamCodec.html#a4af531a4b4bc5d0922096cffe6c343a1">uncompressStream</a>(input, output, flushOp);</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;  }</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;  <span class="keywordflow">if</span> (!input.empty()) {</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Codec: Junk after end of data&quot;</span>);</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;  }</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;  <a class="code" href="experimental_2test_2BitsBenchmark_8cpp.html#a25bccaee4203f6f142efc1f61e9b66c5">buffer</a>-&gt;prev()-&gt;trimEnd(output.size());</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;  <span class="keywordflow">if</span> (uncompressedLength &amp;&amp;</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;      *uncompressedLength != <a class="code" href="experimental_2test_2BitsBenchmark_8cpp.html#a25bccaee4203f6f142efc1f61e9b66c5">buffer</a>-&gt;computeChainDataLength()) {</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Codec: invalid uncompressed length&quot;</span>);</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;  }</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="experimental_2test_2BitsBenchmark_8cpp.html#a25bccaee4203f6f142efc1f61e9b66c5">buffer</a>;</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;}</div><div class="ttc" id="experimental_2test_2BitsBenchmark_8cpp_html_a25bccaee4203f6f142efc1f61e9b66c5"><div class="ttname"><a href="experimental_2test_2BitsBenchmark_8cpp.html#a25bccaee4203f6f142efc1f61e9b66c5">buffer</a></div><div class="ttdeci">std::vector&lt; uint8_t &gt; buffer(kBufferSize+16)</div></div>
<div class="ttc" id="classfolly_1_1io_1_1StreamCodec_html_a192cb12c95e700e316bf86043677ece7ab1a326c06d88bf042f73d70f50197905"><div class="ttname"><a href="classfolly_1_1io_1_1StreamCodec.html#a192cb12c95e700e316bf86043677ece7ab1a326c06d88bf042f73d70f50197905">folly::io::StreamCodec::FlushOp::END</a></div></div>
<div class="ttc" id="classfolly_1_1io_1_1StreamCodec_html_a4af531a4b4bc5d0922096cffe6c343a1"><div class="ttname"><a href="classfolly_1_1io_1_1StreamCodec.html#a4af531a4b4bc5d0922096cffe6c343a1">folly::io::StreamCodec::uncompressStream</a></div><div class="ttdeci">bool uncompressStream(folly::ByteRange &amp;input, folly::MutableByteRange &amp;output, FlushOp flushOp=StreamCodec::FlushOp::NONE)</div><div class="ttdef"><b>Definition:</b> <a href="Compression_8cpp_source.html#l00400">Compression.cpp:400</a></div></div>
<div class="ttc" id="classfolly_1_1io_1_1StreamCodec_html_a192cb12c95e700e316bf86043677ece7ab50339a10e1de285ac99d4c3990b8693"><div class="ttname"><a href="classfolly_1_1io_1_1StreamCodec.html#a192cb12c95e700e316bf86043677ece7ab50339a10e1de285ac99d4c3990b8693">folly::io::StreamCodec::FlushOp::NONE</a></div></div>
<div class="ttc" id="namespacefolly_1_1io_html_a42f2912d72c8328211f65010d660caa6"><div class="ttname"><a href="namespacefolly_1_1io.html#a42f2912d72c8328211f65010d660caa6">folly::io::computeBufferLength</a></div><div class="ttdeci">static uint64_t computeBufferLength(uint64_t const compressedLength, uint64_t const blockSize)</div><div class="ttdef"><b>Definition:</b> <a href="Compression_8cpp_source.html#l00486">Compression.cpp:486</a></div></div>
<div class="ttc" id="namespacefolly_html_a9efde8a92a713a155d17ccb9452ecd5e"><div class="ttname"><a href="namespacefolly.html#a9efde8a92a713a155d17ccb9452ecd5e">folly::MutableByteRange</a></div><div class="ttdeci">Range&lt; unsigned char * &gt; MutableByteRange</div><div class="ttdef"><b>Definition:</b> <a href="Range_8h_source.html#l01164">Range.h:1164</a></div></div>
<div class="ttc" id="namespacefolly_1_1io_html_ae5f1fa5c7d5788e7f791fcd9e1196dfa"><div class="ttname"><a href="namespacefolly_1_1io.html#ae5f1fa5c7d5788e7f791fcd9e1196dfa">folly::io::addOutputBuffer</a></div><div class="ttdeci">static std::unique_ptr&lt; IOBuf &gt; addOutputBuffer(MutableByteRange &amp;output, uint64_t size)</div><div class="ttdef"><b>Definition:</b> <a href="Compression_8cpp_source.html#l00434">Compression.cpp:434</a></div></div>
<div class="ttc" id="SynchronizedTest_8cpp_html_ab04e2d55ea4a544f3575812582af7b51"><div class="ttname"><a href="SynchronizedTest_8cpp.html#ab04e2d55ea4a544f3575812582af7b51">current</a></div><div class="ttdeci">int current</div><div class="ttdef"><b>Definition:</b> <a href="SynchronizedTest_8cpp_source.html#l00743">SynchronizedTest.cpp:743</a></div></div>
<div class="ttc" id="classfolly_1_1Range_html_a2aaeaeaee2acdcffedbf021d6396cc72"><div class="ttname"><a href="classfolly_1_1Range.html#a2aaeaeaee2acdcffedbf021d6396cc72">folly::Range::data</a></div><div class="ttdeci">constexpr Iter data() const </div><div class="ttdef"><b>Definition:</b> <a href="Range_8h_source.html#l00446">Range.h:446</a></div></div>
<div class="ttc" id="namespacefolly_html_a23ca01703d6715fb172f4188faa73dc9"><div class="ttname"><a href="namespacefolly.html#a23ca01703d6715fb172f4188faa73dc9">folly::data</a></div><div class="ttdeci">constexpr auto data(C &amp;c) -&gt; decltype(c.data())</div><div class="ttdef"><b>Definition:</b> <a href="Access_8h_source.html#l00071">Access.h:71</a></div></div>
<div class="ttc" id="classfolly_1_1IOBuf_html_ac4c405fd5fa405c8d814b4cc86309a34"><div class="ttname"><a href="classfolly_1_1IOBuf.html#ac4c405fd5fa405c8d814b4cc86309a34">folly::IOBuf::computeChainDataLength</a></div><div class="ttdeci">std::size_t computeChainDataLength() const </div><div class="ttdef"><b>Definition:</b> <a href="IOBuf_8cpp_source.html#l00501">IOBuf.cpp:501</a></div></div>
<div class="ttc" id="namespacegmock__output__test_html_a4277f8598ba3835393fe82e82d09375d"><div class="ttname"><a href="namespacegmock__output__test.html#a4277f8598ba3835393fe82e82d09375d">gmock_output_test.output</a></div><div class="ttdeci">output</div><div class="ttdef"><b>Definition:</b> <a href="fizz_2build___2gtest_2src_2gtest_2googlemock_2test_2gmock__output__test_8py_source.html#l00175">gmock_output_test.py:175</a></div></div>
<div class="ttc" id="namespacefolly_html_a7f61a634c75bc3bb46447ec2b17ff0fe"><div class="ttname"><a href="namespacefolly.html#a7f61a634c75bc3bb46447ec2b17ff0fe">folly::ByteRange</a></div><div class="ttdeci">Range&lt; const unsigned char * &gt; ByteRange</div><div class="ttdef"><b>Definition:</b> <a href="Range_8h_source.html#l01163">Range.h:1163</a></div></div>
<div class="ttc" id="ConstexprMathBenchmark_8cpp_html_a5dc34568a989dd90728a4ed499cd9fab"><div class="ttname"><a href="ConstexprMathBenchmark_8cpp.html#a5dc34568a989dd90728a4ed499cd9fab">uint64_t</a></div><div class="ttdeci">uint64_t</div><div class="ttdef"><b>Definition:</b> <a href="ConstexprMathBenchmark_8cpp_source.html#l00190">ConstexprMathBenchmark.cpp:190</a></div></div>
<div class="ttc" id="classfolly_1_1io_1_1StreamCodec_html_a91212cf08449806f8a5a39c099084ed6"><div class="ttname"><a href="classfolly_1_1io_1_1StreamCodec.html#a91212cf08449806f8a5a39c099084ed6">folly::io::StreamCodec::resetStream</a></div><div class="ttdeci">void resetStream(folly::Optional&lt; uint64_t &gt; uncompressedLength=folly::none)</div><div class="ttdef"><b>Definition:</b> <a href="Compression_8cpp_source.html#l00329">Compression.cpp:329</a></div></div>
<div class="ttc" id="classfolly_1_1io_1_1StreamCodec_html_a192cb12c95e700e316bf86043677ece7"><div class="ttname"><a href="classfolly_1_1io_1_1StreamCodec.html#a192cb12c95e700e316bf86043677ece7">folly::io::StreamCodec::FlushOp</a></div><div class="ttdeci">FlushOp</div><div class="ttdef"><b>Definition:</b> <a href="Compression_8h_source.html#l00311">Compression.h:311</a></div></div>
<div class="ttc" id="classfolly_1_1io_1_1Codec_html_a05d3b6746620ecd75fdcbfd72d28b52f"><div class="ttname"><a href="classfolly_1_1io_1_1Codec.html#a05d3b6746620ecd75fdcbfd72d28b52f">folly::io::Codec::getUncompressedLength</a></div><div class="ttdeci">folly::Optional&lt; uint64_t &gt; getUncompressedLength(const folly::IOBuf *data, folly::Optional&lt; uint64_t &gt; uncompressedLength=folly::none) const </div><div class="ttdef"><b>Definition:</b> <a href="Compression_8cpp_source.html#l00295">Compression.cpp:295</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a6b44a20a9d1c2c4a1706240ffe7b947f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual bool folly::io::StreamCodec::doUncompressStream </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespacefolly.html#a7f61a634c75bc3bb46447ec2b17ff0fe">folly::ByteRange</a> &amp;&#160;</td>
          <td class="paramname"><em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacefolly.html#a9efde8a92a713a155d17ccb9452ecd5e">folly::MutableByteRange</a> &amp;&#160;</td>
          <td class="paramname"><em>output</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classfolly_1_1io_1_1StreamCodec.html#a192cb12c95e700e316bf86043677ece7">FlushOp</a>&#160;</td>
          <td class="paramname"><em>flushOp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a62415b459c5d3d578eafec1e9b49e491"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool folly::io::StreamCodec::needsDataLength </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Does the codec need the data length before compression streaming? </p>

<p>Definition at line <a class="el" href="Compression_8cpp_source.html#l00314">314</a> of file <a class="el" href="Compression_8cpp_source.html">Compression.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;                                        {</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classfolly_1_1io_1_1StreamCodec.html#ab8bb3a1432680819dd64e297e7265549">doNeedsDataLength</a>();</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;}</div><div class="ttc" id="classfolly_1_1io_1_1StreamCodec_html_ab8bb3a1432680819dd64e297e7265549"><div class="ttname"><a href="classfolly_1_1io_1_1StreamCodec.html#ab8bb3a1432680819dd64e297e7265549">folly::io::StreamCodec::doNeedsDataLength</a></div><div class="ttdeci">virtual bool doNeedsDataLength() const </div><div class="ttdef"><b>Definition:</b> <a href="Compression_8cpp_source.html#l00318">Compression.cpp:318</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a91212cf08449806f8a5a39c099084ed6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void folly::io::StreamCodec::resetStream </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfolly_1_1Optional.html">folly::Optional</a>&lt; <a class="el" href="ConstexprMathBenchmark_8cpp.html#a5dc34568a989dd90728a4ed499cd9fab">uint64_t</a> &gt;&#160;</td>
          <td class="paramname"><em>uncompressedLength</em> = <code><a class="el" href="namespacefolly.html#ac22c63dbe5af3b0bedb0f21031691537">folly::none</a></code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Reset the state of the codec, and set the uncompressed length for the next streaming operation. If uncompressedLength is not none it must be exactly the uncompressed length. <a class="el" href="classfolly_1_1io_1_1StreamCodec.html#a4018be177bc9dc3568e4a2f6a0cc78b9">compressStream()</a> must be passed exactly uncompressedLength input bytes before the stream is ended. <a class="el" href="classfolly_1_1io_1_1StreamCodec.html#a4af531a4b4bc5d0922096cffe6c343a1">uncompressStream()</a> must be passed a compressed frame that uncompresses to uncompressedLength. </p>

<p>Definition at line <a class="el" href="Compression_8cpp_source.html#l00329">329</a> of file <a class="el" href="Compression_8cpp_source.html">Compression.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;                                                                   {</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;  <a class="code" href="classfolly_1_1io_1_1StreamCodec.html#a9eefd02e5a959116145f9a6f4c22fa14">state_</a> = <a class="code" href="classfolly_1_1io_1_1StreamCodec.html#a3e49a89bbc00a93f28fbfee404dc8122ab5859d8721cfdc0312b2838b9c985bc1">State::RESET</a>;</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;  <a class="code" href="classfolly_1_1io_1_1StreamCodec.html#a482e9cd24fe79d3fb06a483b442c463f">uncompressedLength_</a> = <a class="code" href="classfolly_1_1io_1_1StreamCodec.html#ac688c462c86a2488dc8dfb3b56c066ac">uncompressedLength</a>;</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;  <a class="code" href="classfolly_1_1io_1_1StreamCodec.html#ac68c998011fb247fbe3e349bb7356de6">progressMade_</a> = <span class="keyword">true</span>;</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;  <a class="code" href="classfolly_1_1io_1_1StreamCodec.html#a2bcf03b67f4bfb052e4142927a25ee30">doResetStream</a>();</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;}</div><div class="ttc" id="classfolly_1_1io_1_1StreamCodec_html_a9eefd02e5a959116145f9a6f4c22fa14"><div class="ttname"><a href="classfolly_1_1io_1_1StreamCodec.html#a9eefd02e5a959116145f9a6f4c22fa14">folly::io::StreamCodec::state_</a></div><div class="ttdeci">State state_</div><div class="ttdef"><b>Definition:</b> <a href="Compression_8h_source.html#l00434">Compression.h:434</a></div></div>
<div class="ttc" id="classfolly_1_1io_1_1StreamCodec_html_a482e9cd24fe79d3fb06a483b442c463f"><div class="ttname"><a href="classfolly_1_1io_1_1StreamCodec.html#a482e9cd24fe79d3fb06a483b442c463f">folly::io::StreamCodec::uncompressedLength_</a></div><div class="ttdeci">folly::Optional&lt; uint64_t &gt; uncompressedLength_</div><div class="ttdef"><b>Definition:</b> <a href="Compression_8h_source.html#l00436">Compression.h:436</a></div></div>
<div class="ttc" id="classfolly_1_1io_1_1StreamCodec_html_a2bcf03b67f4bfb052e4142927a25ee30"><div class="ttname"><a href="classfolly_1_1io_1_1StreamCodec.html#a2bcf03b67f4bfb052e4142927a25ee30">folly::io::StreamCodec::doResetStream</a></div><div class="ttdeci">virtual void doResetStream()=0</div></div>
<div class="ttc" id="classfolly_1_1io_1_1StreamCodec_html_a3e49a89bbc00a93f28fbfee404dc8122ab5859d8721cfdc0312b2838b9c985bc1"><div class="ttname"><a href="classfolly_1_1io_1_1StreamCodec.html#a3e49a89bbc00a93f28fbfee404dc8122ab5859d8721cfdc0312b2838b9c985bc1">folly::io::StreamCodec::State::RESET</a></div></div>
<div class="ttc" id="classfolly_1_1io_1_1StreamCodec_html_ac688c462c86a2488dc8dfb3b56c066ac"><div class="ttname"><a href="classfolly_1_1io_1_1StreamCodec.html#ac688c462c86a2488dc8dfb3b56c066ac">folly::io::StreamCodec::uncompressedLength</a></div><div class="ttdeci">folly::Optional&lt; uint64_t &gt; uncompressedLength() const </div><div class="ttdef"><b>Definition:</b> <a href="Compression_8h_source.html#l00401">Compression.h:401</a></div></div>
<div class="ttc" id="classfolly_1_1io_1_1StreamCodec_html_ac68c998011fb247fbe3e349bb7356de6"><div class="ttname"><a href="classfolly_1_1io_1_1StreamCodec.html#ac68c998011fb247fbe3e349bb7356de6">folly::io::StreamCodec::progressMade_</a></div><div class="ttdeci">bool progressMade_</div><div class="ttdef"><b>Definition:</b> <a href="Compression_8h_source.html#l00437">Compression.h:437</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ac688c462c86a2488dc8dfb3b56c066ac"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classfolly_1_1Optional.html">folly::Optional</a>&lt;<a class="el" href="ConstexprMathBenchmark_8cpp.html#a5dc34568a989dd90728a4ed499cd9fab">uint64_t</a>&gt; folly::io::StreamCodec::uncompressedLength </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="Compression_8h_source.html#l00401">401</a> of file <a class="el" href="Compression_8h_source.html">Compression.h</a>.</p>

<p>References <a class="el" href="Access_8h_source.html#l00071">folly::data()</a>.</p>
<div class="fragment"><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;                                                     {</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classfolly_1_1io_1_1StreamCodec.html#a482e9cd24fe79d3fb06a483b442c463f">uncompressedLength_</a>;</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;  }</div><div class="ttc" id="classfolly_1_1io_1_1StreamCodec_html_a482e9cd24fe79d3fb06a483b442c463f"><div class="ttname"><a href="classfolly_1_1io_1_1StreamCodec.html#a482e9cd24fe79d3fb06a483b442c463f">folly::io::StreamCodec::uncompressedLength_</a></div><div class="ttdeci">folly::Optional&lt; uint64_t &gt; uncompressedLength_</div><div class="ttdef"><b>Definition:</b> <a href="Compression_8h_source.html#l00436">Compression.h:436</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a4af531a4b4bc5d0922096cffe6c343a1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool folly::io::StreamCodec::uncompressStream </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespacefolly.html#a7f61a634c75bc3bb46447ec2b17ff0fe">folly::ByteRange</a> &amp;&#160;</td>
          <td class="paramname"><em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacefolly.html#a9efde8a92a713a155d17ccb9452ecd5e">folly::MutableByteRange</a> &amp;&#160;</td>
          <td class="paramname"><em>output</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classfolly_1_1io_1_1StreamCodec.html#a192cb12c95e700e316bf86043677ece7">StreamCodec::FlushOp</a>&#160;</td>
          <td class="paramname"><em>flushOp</em> = <code><a class="el" href="classfolly_1_1io_1_1StreamCodec.html#a192cb12c95e700e316bf86043677ece7ab50339a10e1de285ac99d4c3990b8693">StreamCodec::FlushOp::NONE</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Uncompresses some data from the input buffer and writes the uncompressed data into the output buffer. It may read input without producing any output.</p>
<p>The input buffer is advanced to point to the range of data that hasn't yet been read. Uncompression will resume at this point for the next call to <a class="el" href="classfolly_1_1io_1_1StreamCodec.html#a4af531a4b4bc5d0922096cffe6c343a1">uncompressStream()</a>. The output buffer is advanced one byte past the last byte written.</p>
<p>The default flushOp is NONE, which allows <a class="el" href="classfolly_1_1io_1_1StreamCodec.html#a4af531a4b4bc5d0922096cffe6c343a1">uncompressStream()</a> complete discretion in how much output data to flush. The uncompressor may not make maximum forward progress, but will make some forward progress when possible.</p>
<p>If flushOp is END, the caller guarantees that no more input will be presented to <a class="el" href="classfolly_1_1io_1_1StreamCodec.html#a4af531a4b4bc5d0922096cffe6c343a1">uncompressStream()</a>. <a class="el" href="classfolly_1_1io_1_1StreamCodec.html#a4af531a4b4bc5d0922096cffe6c343a1">uncompressStream()</a> must be called with the same input and flushOp END until it returns true. This is not mandatory, but if the input is all available in one buffer, and there is enough output space to write the entire frame, codecs can uncompress faster.</p>
<p>If flushOp is FLUSH, <a class="el" href="classfolly_1_1io_1_1StreamCodec.html#a4af531a4b4bc5d0922096cffe6c343a1">uncompressStream()</a> is guaranteed to make the maximum amount of forward progress possible. When using this flushOp and <a class="el" href="classfolly_1_1io_1_1StreamCodec.html#a4af531a4b4bc5d0922096cffe6c343a1">uncompressStream()</a> returns with <code>!output.<a class="el" href="namespacefolly.html#a689e45e870f8267348e24cea50d6877f">empty()</a></code> the caller knows that all pending output has been flushed. This is useful for stateful streaming across a network, and it should be used in conjunction with <a class="el" href="classfolly_1_1io_1_1StreamCodec.html#a4018be177bc9dc3568e4a2f6a0cc78b9">compressStream()</a> with flushOp FLUSH. Most users don't need to use this flushOp.</p>
<p><a class="el" href="structA.html">A</a> std::runtime_error is thrown upon error conditions or if no forward progress could be made upon two consecutive calls to the function (only the second call will throw an exception).</p>
<p>Returns true at the end of a frame. At this point <a class="el" href="classfolly_1_1io_1_1StreamCodec.html#a91212cf08449806f8a5a39c099084ed6">resetStream()</a> must be called to reuse the codec. </p>

<p>Definition at line <a class="el" href="Compression_8cpp_source.html#l00400">400</a> of file <a class="el" href="Compression_8cpp_source.html">Compression.cpp</a>.</p>

<p>References <a class="el" href="Range_8h_source.html#l00443">folly::Range&lt; Iter &gt;::empty()</a>, and <a class="el" href="Range_8h_source.html#l00431">folly::Range&lt; Iter &gt;::size()</a>.</p>

<p>Referenced by <a class="el" href="CompressionTest_8cpp_source.html#l00840">folly::io::test::uncompressSome()</a>.</p>
<div class="fragment"><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;                                {</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classfolly_1_1io_1_1StreamCodec.html#a9eefd02e5a959116145f9a6f4c22fa14">state_</a> == <a class="code" href="classfolly_1_1io_1_1StreamCodec.html#a3e49a89bbc00a93f28fbfee404dc8122ab5859d8721cfdc0312b2838b9c985bc1">State::RESET</a> &amp;&amp; input.<a class="code" href="classfolly_1_1Range.html#ac76f445a6485c7472d7e0bcfd0c7292b">empty</a>()) {</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classfolly_1_1io_1_1StreamCodec.html#ac688c462c86a2488dc8dfb3b56c066ac">uncompressedLength</a>().<a class="code" href="classfolly_1_1Optional.html#a3b9821dde9565651713c0013da729ae3">value_or</a>(0) == 0) {</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    }</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;  }</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;  <span class="comment">// Handle input state transitions</span></div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classfolly_1_1io_1_1StreamCodec.html#a9eefd02e5a959116145f9a6f4c22fa14">state_</a> == <a class="code" href="classfolly_1_1io_1_1StreamCodec.html#a3e49a89bbc00a93f28fbfee404dc8122ab5859d8721cfdc0312b2838b9c985bc1">State::RESET</a>) {</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    <a class="code" href="classfolly_1_1io_1_1StreamCodec.html#a9eefd02e5a959116145f9a6f4c22fa14">state_</a> = <a class="code" href="classfolly_1_1io_1_1StreamCodec.html#a3e49a89bbc00a93f28fbfee404dc8122a125ee7a84dca120371a1d7757d9d4a44">State::UNCOMPRESS</a>;</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;  }</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;  <a class="code" href="classfolly_1_1io_1_1StreamCodec.html#a2035300384c68461745f8265ca5d1bd4">assertStateIs</a>(<a class="code" href="classfolly_1_1io_1_1StreamCodec.html#a3e49a89bbc00a93f28fbfee404dc8122a125ee7a84dca120371a1d7757d9d4a44">State::UNCOMPRESS</a>);</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;  <span class="keywordtype">size_t</span> <span class="keyword">const</span> inputSize = input.<a class="code" href="classfolly_1_1Range.html#a4c2961b90459f542312422d62ff767b2">size</a>();</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;  <span class="keywordtype">size_t</span> <span class="keyword">const</span> outputSize = output.<a class="code" href="classfolly_1_1Range.html#a4c2961b90459f542312422d62ff767b2">size</a>();</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;  <span class="keywordtype">bool</span> <span class="keyword">const</span> done = <a class="code" href="classfolly_1_1io_1_1StreamCodec.html#a6b44a20a9d1c2c4a1706240ffe7b947f">doUncompressStream</a>(input, output, flushOp);</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;  <span class="keywordflow">if</span> (!done &amp;&amp; inputSize == input.<a class="code" href="classfolly_1_1Range.html#a4c2961b90459f542312422d62ff767b2">size</a>() &amp;&amp; outputSize == output.<a class="code" href="classfolly_1_1Range.html#a4c2961b90459f542312422d62ff767b2">size</a>()) {</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classfolly_1_1io_1_1StreamCodec.html#ac68c998011fb247fbe3e349bb7356de6">progressMade_</a>) {</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;      <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Codec: no forward progress made&quot;</span>);</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    }</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    <span class="comment">// Throw an exception if there is no progress again next time</span></div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    <a class="code" href="classfolly_1_1io_1_1StreamCodec.html#ac68c998011fb247fbe3e349bb7356de6">progressMade_</a> = <span class="keyword">false</span>;</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    <a class="code" href="classfolly_1_1io_1_1StreamCodec.html#ac68c998011fb247fbe3e349bb7356de6">progressMade_</a> = <span class="keyword">true</span>;</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;  }</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;  <span class="comment">// Handle output state transitions</span></div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;  <span class="keywordflow">if</span> (done) {</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    <a class="code" href="classfolly_1_1io_1_1StreamCodec.html#a9eefd02e5a959116145f9a6f4c22fa14">state_</a> = <a class="code" href="classfolly_1_1io_1_1StreamCodec.html#a3e49a89bbc00a93f28fbfee404dc8122ab1a326c06d88bf042f73d70f50197905">State::END</a>;</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;  }</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;  <span class="keywordflow">return</span> done;</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;}</div><div class="ttc" id="classfolly_1_1io_1_1StreamCodec_html_a9eefd02e5a959116145f9a6f4c22fa14"><div class="ttname"><a href="classfolly_1_1io_1_1StreamCodec.html#a9eefd02e5a959116145f9a6f4c22fa14">folly::io::StreamCodec::state_</a></div><div class="ttdeci">State state_</div><div class="ttdef"><b>Definition:</b> <a href="Compression_8h_source.html#l00434">Compression.h:434</a></div></div>
<div class="ttc" id="classfolly_1_1Range_html_a4c2961b90459f542312422d62ff767b2"><div class="ttname"><a href="classfolly_1_1Range.html#a4c2961b90459f542312422d62ff767b2">folly::Range::size</a></div><div class="ttdeci">constexpr size_type size() const </div><div class="ttdef"><b>Definition:</b> <a href="Range_8h_source.html#l00431">Range.h:431</a></div></div>
<div class="ttc" id="classfolly_1_1io_1_1StreamCodec_html_a6b44a20a9d1c2c4a1706240ffe7b947f"><div class="ttname"><a href="classfolly_1_1io_1_1StreamCodec.html#a6b44a20a9d1c2c4a1706240ffe7b947f">folly::io::StreamCodec::doUncompressStream</a></div><div class="ttdeci">virtual bool doUncompressStream(folly::ByteRange &amp;input, folly::MutableByteRange &amp;output, FlushOp flushOp)=0</div></div>
<div class="ttc" id="classfolly_1_1io_1_1StreamCodec_html_a3e49a89bbc00a93f28fbfee404dc8122a125ee7a84dca120371a1d7757d9d4a44"><div class="ttname"><a href="classfolly_1_1io_1_1StreamCodec.html#a3e49a89bbc00a93f28fbfee404dc8122a125ee7a84dca120371a1d7757d9d4a44">folly::io::StreamCodec::State::UNCOMPRESS</a></div></div>
<div class="ttc" id="classfolly_1_1Range_html_ac76f445a6485c7472d7e0bcfd0c7292b"><div class="ttname"><a href="classfolly_1_1Range.html#ac76f445a6485c7472d7e0bcfd0c7292b">folly::Range::empty</a></div><div class="ttdeci">constexpr bool empty() const </div><div class="ttdef"><b>Definition:</b> <a href="Range_8h_source.html#l00443">Range.h:443</a></div></div>
<div class="ttc" id="classfolly_1_1Optional_html_a3b9821dde9565651713c0013da729ae3"><div class="ttname"><a href="classfolly_1_1Optional.html#a3b9821dde9565651713c0013da729ae3">folly::Optional::value_or</a></div><div class="ttdeci">FOLLY_CPP14_CONSTEXPR Value value_or(U &amp;&amp;dflt) const &amp;</div><div class="ttdef"><b>Definition:</b> <a href="Optional_8h_source.html#l00330">Optional.h:330</a></div></div>
<div class="ttc" id="classfolly_1_1io_1_1StreamCodec_html_a3e49a89bbc00a93f28fbfee404dc8122ab5859d8721cfdc0312b2838b9c985bc1"><div class="ttname"><a href="classfolly_1_1io_1_1StreamCodec.html#a3e49a89bbc00a93f28fbfee404dc8122ab5859d8721cfdc0312b2838b9c985bc1">folly::io::StreamCodec::State::RESET</a></div></div>
<div class="ttc" id="classfolly_1_1io_1_1StreamCodec_html_ac688c462c86a2488dc8dfb3b56c066ac"><div class="ttname"><a href="classfolly_1_1io_1_1StreamCodec.html#ac688c462c86a2488dc8dfb3b56c066ac">folly::io::StreamCodec::uncompressedLength</a></div><div class="ttdeci">folly::Optional&lt; uint64_t &gt; uncompressedLength() const </div><div class="ttdef"><b>Definition:</b> <a href="Compression_8h_source.html#l00401">Compression.h:401</a></div></div>
<div class="ttc" id="classfolly_1_1io_1_1StreamCodec_html_ac68c998011fb247fbe3e349bb7356de6"><div class="ttname"><a href="classfolly_1_1io_1_1StreamCodec.html#ac68c998011fb247fbe3e349bb7356de6">folly::io::StreamCodec::progressMade_</a></div><div class="ttdeci">bool progressMade_</div><div class="ttdef"><b>Definition:</b> <a href="Compression_8h_source.html#l00437">Compression.h:437</a></div></div>
<div class="ttc" id="classfolly_1_1io_1_1StreamCodec_html_a2035300384c68461745f8265ca5d1bd4"><div class="ttname"><a href="classfolly_1_1io_1_1StreamCodec.html#a2035300384c68461745f8265ca5d1bd4">folly::io::StreamCodec::assertStateIs</a></div><div class="ttdeci">void assertStateIs(State expected) const </div><div class="ttdef"><b>Definition:</b> <a href="Compression_8cpp_source.html#l00322">Compression.cpp:322</a></div></div>
<div class="ttc" id="classfolly_1_1io_1_1StreamCodec_html_a3e49a89bbc00a93f28fbfee404dc8122ab1a326c06d88bf042f73d70f50197905"><div class="ttname"><a href="classfolly_1_1io_1_1StreamCodec.html#a3e49a89bbc00a93f28fbfee404dc8122ab1a326c06d88bf042f73d70f50197905">folly::io::StreamCodec::State::END</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="aefc84fc808a028f006ad33489c4fa0ea"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacefolly.html#a7f61a634c75bc3bb46447ec2b17ff0fe">ByteRange</a> folly::io::StreamCodec::previousInput_ {}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="Compression_8h_source.html#l00435">435</a> of file <a class="el" href="Compression_8h_source.html">Compression.h</a>.</p>

</div>
</div>
<a class="anchor" id="ac68c998011fb247fbe3e349bb7356de6"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool folly::io::StreamCodec::progressMade_ {true}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="Compression_8h_source.html#l00437">437</a> of file <a class="el" href="Compression_8h_source.html">Compression.h</a>.</p>

</div>
</div>
<a class="anchor" id="a9eefd02e5a959116145f9a6f4c22fa14"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classfolly_1_1io_1_1StreamCodec.html#a3e49a89bbc00a93f28fbfee404dc8122">State</a> folly::io::StreamCodec::state_ {<a class="el" href="classfolly_1_1io_1_1StreamCodec.html#a3e49a89bbc00a93f28fbfee404dc8122ab5859d8721cfdc0312b2838b9c985bc1">State::RESET</a>}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="Compression_8h_source.html#l00434">434</a> of file <a class="el" href="Compression_8h_source.html">Compression.h</a>.</p>

</div>
</div>
<a class="anchor" id="a482e9cd24fe79d3fb06a483b442c463f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classfolly_1_1Optional.html">folly::Optional</a>&lt;<a class="el" href="ConstexprMathBenchmark_8cpp.html#a5dc34568a989dd90728a4ed499cd9fab">uint64_t</a>&gt; folly::io::StreamCodec::uncompressedLength_ {}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="Compression_8h_source.html#l00436">436</a> of file <a class="el" href="Compression_8h_source.html">Compression.h</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>proxygen/folly/folly/compression/<a class="el" href="Compression_8h_source.html">Compression.h</a></li>
<li>proxygen/folly/folly/compression/<a class="el" href="Compression_8cpp_source.html">Compression.cpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacefolly.html">folly</a></li><li class="navelem"><a class="el" href="namespacefolly_1_1io.html">io</a></li><li class="navelem"><a class="el" href="classfolly_1_1io_1_1StreamCodec.html">StreamCodec</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
