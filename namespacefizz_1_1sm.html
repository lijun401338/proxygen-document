<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>proxygen: fizz::sm Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">proxygen
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li class="current"><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="namespaces.html"><span>Namespace&#160;List</span></a></li>
      <li><a href="namespacemembers.html"><span>Namespace&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('namespacefizz_1_1sm.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">fizz::sm Namespace Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfizz_1_1sm_1_1EventHandler.html">EventHandler</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfizz_1_1sm_1_1EventHandlerBase.html">EventHandlerBase</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structfizz_1_1sm_1_1Or.html">Or</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structfizz_1_1sm_1_1Or_3_01Condition_00_01Conditions_8_8_8_01_4.html">Or&lt; Condition, Conditions... &gt;</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfizz_1_1sm_1_1StateMachine.html">StateMachine</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structfizz_1_1sm_1_1StateSame.html">StateSame</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structfizz_1_1sm_1_1StateSame_3_01SM_00_01s_00_01s_01_4.html">StateSame&lt; SM, s, s &gt;</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a67fe5b94d4a788b7ad0a914f5f1629fb"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefizz_1_1sm.html#a67fe5b94d4a788b7ad0a914f5f1629fb">FIZZ_DECLARE_EVENT_HANDLER</a> (<a class="el" href="structfizz_1_1client_1_1ClientTypes.html">ClientTypes</a>, StateEnum::Uninitialized, <a class="el" href="namespacefizz.html#a1135430496a56ed55bdfc4a77ccb35fba49ab28040dfa07f53544970c6d147e1e">Event::Connect</a>, StateEnum::ExpectingServerHello)</td></tr>
<tr class="separator:a67fe5b94d4a788b7ad0a914f5f1629fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa432ce5dd0f7cf32750942d518e24537"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefizz_1_1sm.html#aa432ce5dd0f7cf32750942d518e24537">FIZZ_DECLARE_EVENT_HANDLER</a> (<a class="el" href="structfizz_1_1client_1_1ClientTypes.html">ClientTypes</a>, StateEnum::ExpectingServerHello, <a class="el" href="namespacefizz.html#a1135430496a56ed55bdfc4a77ccb35fba51ad30e8de321aca8d16fe7a2d9f62c5">Event::HelloRetryRequest</a>, StateEnum::ExpectingServerHello)</td></tr>
<tr class="separator:aa432ce5dd0f7cf32750942d518e24537"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa1d144bfaacab1a145ea43dd0b2aa076"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefizz_1_1sm.html#aa1d144bfaacab1a145ea43dd0b2aa076">FIZZ_DECLARE_EVENT_HANDLER</a> (<a class="el" href="structfizz_1_1client_1_1ClientTypes.html">ClientTypes</a>, StateEnum::ExpectingServerHello, <a class="el" href="namespacefizz.html#a1135430496a56ed55bdfc4a77ccb35fbae9540adbf7cbc0f41bcadaedcd0aba77">Event::ServerHello</a>, StateEnum::ExpectingEncryptedExtensions)</td></tr>
<tr class="separator:aa1d144bfaacab1a145ea43dd0b2aa076"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20540afd4898438b2779d6582bbda0de"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefizz_1_1sm.html#a20540afd4898438b2779d6582bbda0de">FIZZ_DECLARE_EVENT_HANDLER</a> (<a class="el" href="structfizz_1_1client_1_1ClientTypes.html">ClientTypes</a>, StateEnum::ExpectingServerHello, <a class="el" href="namespacefizz.html#a1135430496a56ed55bdfc4a77ccb35fba47a1bca7303595211ec9f86e386b364f">Event::EarlyAppWrite</a>, <a class="el" href="TraceFieldType_8txt.html#a1f3f354b00fe1430d9c1002be04264a9">StateEnum::Error</a>)</td></tr>
<tr class="separator:a20540afd4898438b2779d6582bbda0de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4112e6ae8909a18e9fb4442be2fb4958"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefizz_1_1sm.html#a4112e6ae8909a18e9fb4442be2fb4958">FIZZ_DECLARE_EVENT_HANDLER</a> (<a class="el" href="structfizz_1_1client_1_1ClientTypes.html">ClientTypes</a>, StateEnum::ExpectingEncryptedExtensions, <a class="el" href="namespacefizz.html#a1135430496a56ed55bdfc4a77ccb35fbaf36aecb2d027d9ed8fc384235422899f">Event::EncryptedExtensions</a>, StateEnum::ExpectingCertificate, StateEnum::ExpectingFinished)</td></tr>
<tr class="separator:a4112e6ae8909a18e9fb4442be2fb4958"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa1964ee9afe64372f2810d1dc41f27bf"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefizz_1_1sm.html#aa1964ee9afe64372f2810d1dc41f27bf">FIZZ_DECLARE_EVENT_HANDLER</a> (<a class="el" href="structfizz_1_1client_1_1ClientTypes.html">ClientTypes</a>, StateEnum::ExpectingEncryptedExtensions, <a class="el" href="namespacefizz.html#a1135430496a56ed55bdfc4a77ccb35fba47a1bca7303595211ec9f86e386b364f">Event::EarlyAppWrite</a>, <a class="el" href="TraceFieldType_8txt.html#a1f3f354b00fe1430d9c1002be04264a9">StateEnum::Error</a>)</td></tr>
<tr class="separator:aa1964ee9afe64372f2810d1dc41f27bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a59c89ac3e67645abd7fba272838e24c2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefizz_1_1sm.html#a59c89ac3e67645abd7fba272838e24c2">FIZZ_DECLARE_EVENT_HANDLER</a> (<a class="el" href="structfizz_1_1client_1_1ClientTypes.html">ClientTypes</a>, StateEnum::ExpectingCertificate, <a class="el" href="namespacefizz.html#a1135430496a56ed55bdfc4a77ccb35fbabb861a7fa47a1dbce10ce727453e054f">Event::CertificateRequest</a>, StateEnum::ExpectingCertificate)</td></tr>
<tr class="separator:a59c89ac3e67645abd7fba272838e24c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec9574ff6a99c5b3186f49e28d720de8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefizz_1_1sm.html#aec9574ff6a99c5b3186f49e28d720de8">FIZZ_DECLARE_EVENT_HANDLER</a> (<a class="el" href="structfizz_1_1client_1_1ClientTypes.html">ClientTypes</a>, StateEnum::ExpectingCertificate, <a class="el" href="namespacefizz.html#a1135430496a56ed55bdfc4a77ccb35fbaeb0f48a107df1a0f343d4cd513b555e6">Event::Certificate</a>, StateEnum::ExpectingCertificateVerify)</td></tr>
<tr class="separator:aec9574ff6a99c5b3186f49e28d720de8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a86123a7eeed7308070e711decf324b89"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefizz_1_1sm.html#a86123a7eeed7308070e711decf324b89">FIZZ_DECLARE_EVENT_HANDLER</a> (<a class="el" href="structfizz_1_1client_1_1ClientTypes.html">ClientTypes</a>, StateEnum::ExpectingCertificate, <a class="el" href="namespacefizz.html#a1135430496a56ed55bdfc4a77ccb35fba3f5a8d119f352c5d1814151dae409dfc">Event::CompressedCertificate</a>, StateEnum::ExpectingCertificateVerify)</td></tr>
<tr class="separator:a86123a7eeed7308070e711decf324b89"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a852d73976106b6e867cee97de0ffe4f4"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefizz_1_1sm.html#a852d73976106b6e867cee97de0ffe4f4">FIZZ_DECLARE_EVENT_HANDLER</a> (<a class="el" href="structfizz_1_1client_1_1ClientTypes.html">ClientTypes</a>, StateEnum::ExpectingCertificate, <a class="el" href="namespacefizz.html#a1135430496a56ed55bdfc4a77ccb35fba47a1bca7303595211ec9f86e386b364f">Event::EarlyAppWrite</a>, <a class="el" href="TraceFieldType_8txt.html#a1f3f354b00fe1430d9c1002be04264a9">StateEnum::Error</a>)</td></tr>
<tr class="separator:a852d73976106b6e867cee97de0ffe4f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6825414067f97bf47a6a415b904659ac"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefizz_1_1sm.html#a6825414067f97bf47a6a415b904659ac">FIZZ_DECLARE_EVENT_HANDLER</a> (<a class="el" href="structfizz_1_1client_1_1ClientTypes.html">ClientTypes</a>, StateEnum::ExpectingCertificateVerify, <a class="el" href="namespacefizz.html#a1135430496a56ed55bdfc4a77ccb35fba9827062845b39dfab4ecab4c13a6722a">Event::CertificateVerify</a>, StateEnum::ExpectingFinished)</td></tr>
<tr class="separator:a6825414067f97bf47a6a415b904659ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8dc56e803ba5f0b21ef373ece5649efc"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefizz_1_1sm.html#a8dc56e803ba5f0b21ef373ece5649efc">FIZZ_DECLARE_EVENT_HANDLER</a> (<a class="el" href="structfizz_1_1client_1_1ClientTypes.html">ClientTypes</a>, StateEnum::ExpectingCertificateVerify, <a class="el" href="namespacefizz.html#a1135430496a56ed55bdfc4a77ccb35fba47a1bca7303595211ec9f86e386b364f">Event::EarlyAppWrite</a>, <a class="el" href="TraceFieldType_8txt.html#a1f3f354b00fe1430d9c1002be04264a9">StateEnum::Error</a>)</td></tr>
<tr class="separator:a8dc56e803ba5f0b21ef373ece5649efc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9979f9d28ac923772bb7eac153dd7d7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefizz_1_1sm.html#ac9979f9d28ac923772bb7eac153dd7d7">FIZZ_DECLARE_EVENT_HANDLER</a> (<a class="el" href="structfizz_1_1client_1_1ClientTypes.html">ClientTypes</a>, StateEnum::ExpectingFinished, <a class="el" href="namespacefizz.html#a1135430496a56ed55bdfc4a77ccb35fba8f3d10eb21bd36347c258679eba9e92b">Event::Finished</a>, StateEnum::Established)</td></tr>
<tr class="separator:ac9979f9d28ac923772bb7eac153dd7d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa86523b057dbdd1cb33341f5c255fe31"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefizz_1_1sm.html#aa86523b057dbdd1cb33341f5c255fe31">FIZZ_DECLARE_EVENT_HANDLER</a> (<a class="el" href="structfizz_1_1client_1_1ClientTypes.html">ClientTypes</a>, StateEnum::ExpectingFinished, <a class="el" href="namespacefizz.html#a1135430496a56ed55bdfc4a77ccb35fba47a1bca7303595211ec9f86e386b364f">Event::EarlyAppWrite</a>, <a class="el" href="TraceFieldType_8txt.html#a1f3f354b00fe1430d9c1002be04264a9">StateEnum::Error</a>)</td></tr>
<tr class="separator:aa86523b057dbdd1cb33341f5c255fe31"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af62004d9beee9533fed5aa2665a0445f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefizz_1_1sm.html#af62004d9beee9533fed5aa2665a0445f">FIZZ_DECLARE_EVENT_HANDLER</a> (<a class="el" href="structfizz_1_1client_1_1ClientTypes.html">ClientTypes</a>, StateEnum::Established, <a class="el" href="namespacefizz.html#a1135430496a56ed55bdfc4a77ccb35fba47a1bca7303595211ec9f86e386b364f">Event::EarlyAppWrite</a>, <a class="el" href="TraceFieldType_8txt.html#a1f3f354b00fe1430d9c1002be04264a9">StateEnum::Error</a>)</td></tr>
<tr class="separator:af62004d9beee9533fed5aa2665a0445f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3b3fd5ae4ee1920c8fac11f1e94f482c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefizz_1_1sm.html#a3b3fd5ae4ee1920c8fac11f1e94f482c">FIZZ_DECLARE_EVENT_HANDLER</a> (<a class="el" href="structfizz_1_1client_1_1ClientTypes.html">ClientTypes</a>, StateEnum::Established, <a class="el" href="namespacefizz.html#a1135430496a56ed55bdfc4a77ccb35fbae94ec29c1c92594130e418b7d1972cda">Event::NewSessionTicket</a>, <a class="el" href="TraceFieldType_8txt.html#a1f3f354b00fe1430d9c1002be04264a9">StateEnum::Error</a>)</td></tr>
<tr class="separator:a3b3fd5ae4ee1920c8fac11f1e94f482c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5ae50cf2c3f7a18511839ec2ab0cd99b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefizz_1_1sm.html#a5ae50cf2c3f7a18511839ec2ab0cd99b">FIZZ_DECLARE_EVENT_HANDLER</a> (<a class="el" href="structfizz_1_1client_1_1ClientTypes.html">ClientTypes</a>, StateEnum::Established, <a class="el" href="namespacefizz.html#a1135430496a56ed55bdfc4a77ccb35fba068ed5f36c096c0d86fee9b0cd2aec01">Event::AppData</a>, <a class="el" href="TraceFieldType_8txt.html#a1f3f354b00fe1430d9c1002be04264a9">StateEnum::Error</a>)</td></tr>
<tr class="separator:a5ae50cf2c3f7a18511839ec2ab0cd99b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d1ed3d20b42dc451ef18c5fc988f2d8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefizz_1_1sm.html#a7d1ed3d20b42dc451ef18c5fc988f2d8">FIZZ_DECLARE_EVENT_HANDLER</a> (<a class="el" href="structfizz_1_1client_1_1ClientTypes.html">ClientTypes</a>, StateEnum::Established, <a class="el" href="namespacefizz.html#a1135430496a56ed55bdfc4a77ccb35fbaeed31df3f971bee9af441382c6c1e272">Event::AppWrite</a>, <a class="el" href="TraceFieldType_8txt.html#a1f3f354b00fe1430d9c1002be04264a9">StateEnum::Error</a>)</td></tr>
<tr class="separator:a7d1ed3d20b42dc451ef18c5fc988f2d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ac4a69cfcae3993bb2b3a868c7280d4"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefizz_1_1sm.html#a0ac4a69cfcae3993bb2b3a868c7280d4">FIZZ_DECLARE_EVENT_HANDLER</a> (<a class="el" href="structfizz_1_1client_1_1ClientTypes.html">ClientTypes</a>, StateEnum::Established, <a class="el" href="namespacefizz.html#a1135430496a56ed55bdfc4a77ccb35fbaa175bae4a622096eb215c37b84c56837">Event::KeyUpdate</a>, <a class="el" href="TraceFieldType_8txt.html#a1f3f354b00fe1430d9c1002be04264a9">StateEnum::Error</a>)</td></tr>
<tr class="separator:a0ac4a69cfcae3993bb2b3a868c7280d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a533ed96916e1921378aae2c32071d0dc"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classfolly_1_1Optional.html">folly::Optional</a>&lt; <a class="el" href="structfizz_1_1client_1_1CachedPsk.html">CachedPsk</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefizz_1_1sm.html#a533ed96916e1921378aae2c32071d0dc">validatePsk</a> (const <a class="el" href="classfizz_1_1client_1_1FizzClientContext.html">FizzClientContext</a> &amp;<a class="el" href="wangle_2__build_2CMakeCache_8txt.html#a261f9f58ccbeaa962c4e675e4212c9cc">context</a>, <a class="el" href="classfolly_1_1Optional.html">folly::Optional</a>&lt; <a class="el" href="structfizz_1_1client_1_1CachedPsk.html">CachedPsk</a> &gt; psk)</td></tr>
<tr class="separator:a533ed96916e1921378aae2c32071d0dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2b0f26d2057cd4dc981188cb5b15c436"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="PackedSyncPtrTest_8cpp.html#a2a761d9ec8bcdc907b3e45a3ba097c32">std::map</a>&lt; <a class="el" href="namespacefizz.html#a11069edebaa08949c9a6696ef4bb85e2">NamedGroup</a>, std::unique_ptr&lt; <a class="el" href="classfizz_1_1KeyExchange.html">KeyExchange</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefizz_1_1sm.html#a2b0f26d2057cd4dc981188cb5b15c436">getKeyExchangers</a> (const <a class="el" href="classfizz_1_1Factory.html">Factory</a> &amp;factory, const std::vector&lt; <a class="el" href="namespacefizz.html#a11069edebaa08949c9a6696ef4bb85e2">NamedGroup</a> &gt; &amp;groups)</td></tr>
<tr class="separator:a2b0f26d2057cd4dc981188cb5b15c436"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a633e0f785158f85ece0161e42edb81cb"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="structfizz_1_1ClientHello.html">ClientHello</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefizz_1_1sm.html#a633e0f785158f85ece0161e42edb81cb">getClientHello</a> (const <a class="el" href="classfizz_1_1Factory.html">Factory</a> &amp;, const <a class="el" href="namespacefizz.html#a796015128e6988829a7719b9cb09749e">Random</a> &amp;<a class="el" href="FBStringBenchmark_8cpp.html#a0f5dc778f46ef846ca354b005f6ff3f4">random</a>, const std::vector&lt; <a class="el" href="namespacefizz.html#a23e4ec7baa80cc6f92fdbeadccf0d22e">CipherSuite</a> &gt; &amp;supportedCiphers, const std::vector&lt; <a class="el" href="namespacefizz.html#a3a1cbf7ef22de4d4c5144b3090d7ebc1">ProtocolVersion</a> &gt; &amp;supportedVersions, const std::vector&lt; <a class="el" href="namespacefizz.html#a11069edebaa08949c9a6696ef4bb85e2">NamedGroup</a> &gt; &amp;supportedGroups, const <a class="el" href="PackedSyncPtrTest_8cpp.html#a2a761d9ec8bcdc907b3e45a3ba097c32">std::map</a>&lt; <a class="el" href="namespacefizz.html#a11069edebaa08949c9a6696ef4bb85e2">NamedGroup</a>, std::unique_ptr&lt; <a class="el" href="classfizz_1_1KeyExchange.html">KeyExchange</a> &gt;&gt; &amp;shares, const std::vector&lt; <a class="el" href="namespacefizz.html#a1410cf02b9d3a95b34f9dbf22d372749">SignatureScheme</a> &gt; &amp;supportedSigSchemes, const std::vector&lt; <a class="el" href="namespacefizz.html#a1e500492a0a0633f62bf1c3d4acea880">PskKeyExchangeMode</a> &gt; &amp;supportedPskModes, const <a class="el" href="classfolly_1_1Optional.html">folly::Optional</a>&lt; <a class="el" href="Conv_8cpp.html#ae1adbce218e7a9d09164012443191d24">std::string</a> &gt; &amp;hostname, const std::vector&lt; <a class="el" href="Conv_8cpp.html#ae1adbce218e7a9d09164012443191d24">std::string</a> &gt; &amp;supportedAlpns, const std::vector&lt; <a class="el" href="namespacefizz.html#aef5b19e8cb60e324e310f0a9f2afdd95">CertificateCompressionAlgorithm</a> &gt; &amp;compressionAlgos, const <a class="el" href="classfolly_1_1Optional.html">Optional</a>&lt; <a class="el" href="structfizz_1_1client_1_1EarlyDataParams.html">EarlyDataParams</a> &gt; &amp;earlyDataParams, const <a class="el" href="namespacefizz.html#af020f21a568ff86800e03d6ad2a9b84d">Buf</a> &amp;legacySessionId, <a class="el" href="classfizz_1_1ClientExtensions.html">ClientExtensions</a> *extensions, <a class="el" href="namespacefizz.html#af020f21a568ff86800e03d6ad2a9b84d">Buf</a> cookie=<a class="el" href="http__parser__cpp_8cpp.html#ab979d9d4b4923f7c54d6caa6e1a61936">nullptr</a>)</td></tr>
<tr class="separator:a633e0f785158f85ece0161e42edb81cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a59b0297c4633d263313e4447852413fc"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="structfizz_1_1ClientPresharedKey.html">ClientPresharedKey</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefizz_1_1sm.html#a59b0297c4633d263313e4447852413fc">getPskExtension</a> (const <a class="el" href="structfizz_1_1client_1_1CachedPsk.html">CachedPsk</a> &amp;psk)</td></tr>
<tr class="separator:a59b0297c4633d263313e4447852413fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac149c92413a5d39358c39ee5530accf0"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="namespacefizz.html#af020f21a568ff86800e03d6ad2a9b84d">Buf</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefizz_1_1sm.html#ac149c92413a5d39358c39ee5530accf0">encodeAndAddBinders</a> (<a class="el" href="structfizz_1_1ClientHello.html">ClientHello</a> <a class="el" href="HandshakeTypesTest_8cpp.html#aba518b904616df44c3d7dfde825a4c54">chlo</a>, const <a class="el" href="structfizz_1_1client_1_1CachedPsk.html">CachedPsk</a> &amp;psk, <a class="el" href="classfizz_1_1KeyScheduler.html">KeyScheduler</a> &amp;<a class="el" href="FilePoller_8cpp.html#af8aa2314425a86a160127ccd900704f8">scheduler</a>, <a class="el" href="classfizz_1_1HandshakeContext.html">HandshakeContext</a> &amp;handshakeContext)</td></tr>
<tr class="separator:ac149c92413a5d39358c39ee5530accf0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5762d174435b87040bb9e13f3aad652c"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classfolly_1_1Optional.html">Optional</a>&lt; <a class="el" href="structfizz_1_1client_1_1EarlyDataParams.html">EarlyDataParams</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefizz_1_1sm.html#a5762d174435b87040bb9e13f3aad652c">getEarlyDataParams</a> (const <a class="el" href="classfizz_1_1client_1_1FizzClientContext.html">FizzClientContext</a> &amp;<a class="el" href="wangle_2__build_2CMakeCache_8txt.html#a261f9f58ccbeaa962c4e675e4212c9cc">context</a>, const <a class="el" href="classfolly_1_1Optional.html">Optional</a>&lt; <a class="el" href="structfizz_1_1client_1_1CachedPsk.html">CachedPsk</a> &gt; &amp;psk)</td></tr>
<tr class="separator:a5762d174435b87040bb9e13f3aad652c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4800617fb250b2236b307edd74e971ae"><td class="memTemplParams" colspan="2">template&lt;typename ServerMessage &gt; </td></tr>
<tr class="memitem:a4800617fb250b2236b307edd74e971ae"><td class="memTemplItemLeft" align="right" valign="top">static std::pair&lt; <a class="el" href="namespacefizz.html#a3a1cbf7ef22de4d4c5144b3090d7ebc1">ProtocolVersion</a>, <a class="el" href="namespacefizz.html#a23e4ec7baa80cc6f92fdbeadccf0d22e">CipherSuite</a> &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacefizz_1_1sm.html#a4800617fb250b2236b307edd74e971ae">getAndValidateVersionAndCipher</a> (const ServerMessage &amp;msg, const std::vector&lt; <a class="el" href="namespacefizz.html#a3a1cbf7ef22de4d4c5144b3090d7ebc1">ProtocolVersion</a> &gt; &amp;supportedVersions, const std::vector&lt; <a class="el" href="namespacefizz.html#a23e4ec7baa80cc6f92fdbeadccf0d22e">CipherSuite</a> &gt; &amp;supportedCiphers)</td></tr>
<tr class="separator:a4800617fb250b2236b307edd74e971ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a070457422b5607a9c4e9ad6e9852fc0a"><td class="memItemLeft" align="right" valign="top">static auto&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefizz_1_1sm.html#a070457422b5607a9c4e9ad6e9852fc0a">negotiateParameters</a> (const <a class="el" href="structfizz_1_1ServerHello.html">ServerHello</a> &amp;shlo, const std::vector&lt; <a class="el" href="namespacefizz.html#a3a1cbf7ef22de4d4c5144b3090d7ebc1">ProtocolVersion</a> &gt; &amp;supportedVersions, const std::vector&lt; <a class="el" href="namespacefizz.html#a23e4ec7baa80cc6f92fdbeadccf0d22e">CipherSuite</a> &gt; &amp;supportedCiphers, const <a class="el" href="PackedSyncPtrTest_8cpp.html#a2a761d9ec8bcdc907b3e45a3ba097c32">std::map</a>&lt; <a class="el" href="namespacefizz.html#a11069edebaa08949c9a6696ef4bb85e2">NamedGroup</a>, std::unique_ptr&lt; <a class="el" href="classfizz_1_1KeyExchange.html">KeyExchange</a> &gt;&gt; &amp;keyExchangers)</td></tr>
<tr class="separator:a070457422b5607a9c4e9ad6e9852fc0a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c68fb59aedcda5ae05c736113c37577"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefizz_1_1sm.html#a2c68fb59aedcda5ae05c736113c37577">validateNegotiationConsistency</a> (const <a class="el" href="classfizz_1_1client_1_1State.html">State</a> &amp;<a class="el" href="http__parser_8c.html#adc6e5733fc3c22f0a7b2914188c49c90">state</a>, <a class="el" href="namespacefizz.html#a3a1cbf7ef22de4d4c5144b3090d7ebc1">ProtocolVersion</a> <a class="el" href="ClientProtocol_8cpp.html#abe1b247743d4691ae90a9b12b08cc176">version</a>, <a class="el" href="namespacefizz.html#a23e4ec7baa80cc6f92fdbeadccf0d22e">CipherSuite</a> <a class="el" href="ClientProtocol_8cpp.html#aa7e60e524fbc7254437c13c7d22a9dfa">cipher</a>)</td></tr>
<tr class="separator:a2c68fb59aedcda5ae05c736113c37577"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeaa892397a583ac5f45f11fac85f35c5"><td class="memItemLeft" align="right" valign="top">static NegotiatedPsk&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefizz_1_1sm.html#aeaa892397a583ac5f45f11fac85f35c5">negotiatePsk</a> (const std::vector&lt; <a class="el" href="namespacefizz.html#a1e500492a0a0633f62bf1c3d4acea880">PskKeyExchangeMode</a> &gt; &amp;supportedPskModes, const <a class="el" href="classfolly_1_1Optional.html">folly::Optional</a>&lt; <a class="el" href="structfizz_1_1client_1_1CachedPsk.html">CachedPsk</a> &gt; &amp;attemptedPsk, const <a class="el" href="structfizz_1_1ServerHello.html">ServerHello</a> &amp;shlo, <a class="el" href="namespacefizz.html#a3a1cbf7ef22de4d4c5144b3090d7ebc1">ProtocolVersion</a> <a class="el" href="ClientProtocol_8cpp.html#abe1b247743d4691ae90a9b12b08cc176">version</a>, <a class="el" href="namespacefizz.html#a23e4ec7baa80cc6f92fdbeadccf0d22e">CipherSuite</a> <a class="el" href="ClientProtocol_8cpp.html#aa7e60e524fbc7254437c13c7d22a9dfa">cipher</a>, bool hasExchange)</td></tr>
<tr class="separator:aeaa892397a583ac5f45f11fac85f35c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad2722bea5d78fbf97e0c336dca94412b"><td class="memItemLeft" align="right" valign="top">static HrrParams&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefizz_1_1sm.html#ad2722bea5d78fbf97e0c336dca94412b">negotiateParameters</a> (const <a class="el" href="structfizz_1_1HelloRetryRequest.html">HelloRetryRequest</a> &amp;hrr, const std::vector&lt; <a class="el" href="namespacefizz.html#a3a1cbf7ef22de4d4c5144b3090d7ebc1">ProtocolVersion</a> &gt; &amp;supportedVersions, const std::vector&lt; <a class="el" href="namespacefizz.html#a23e4ec7baa80cc6f92fdbeadccf0d22e">CipherSuite</a> &gt; &amp;supportedCiphers, const std::vector&lt; <a class="el" href="namespacefizz.html#a11069edebaa08949c9a6696ef4bb85e2">NamedGroup</a> &gt; &amp;supportedGroups)</td></tr>
<tr class="separator:ad2722bea5d78fbf97e0c336dca94412b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad45aca895afa36167103c8ead0047667"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="PackedSyncPtrTest_8cpp.html#a2a761d9ec8bcdc907b3e45a3ba097c32">std::map</a>&lt; <a class="el" href="namespacefizz.html#a11069edebaa08949c9a6696ef4bb85e2">NamedGroup</a>, std::unique_ptr&lt; <a class="el" href="classfizz_1_1KeyExchange.html">KeyExchange</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefizz_1_1sm.html#ad45aca895afa36167103c8ead0047667">getHrrKeyExchangers</a> (const <a class="el" href="classfizz_1_1Factory.html">Factory</a> &amp;factory, <a class="el" href="PackedSyncPtrTest_8cpp.html#a2a761d9ec8bcdc907b3e45a3ba097c32">std::map</a>&lt; <a class="el" href="namespacefizz.html#a11069edebaa08949c9a6696ef4bb85e2">NamedGroup</a>, std::unique_ptr&lt; <a class="el" href="classfizz_1_1KeyExchange.html">KeyExchange</a> &gt;&gt; previous, <a class="el" href="classfolly_1_1Optional.html">Optional</a>&lt; <a class="el" href="namespacefizz.html#a11069edebaa08949c9a6696ef4bb85e2">NamedGroup</a> &gt; negotiatedGroup)</td></tr>
<tr class="separator:ad45aca895afa36167103c8ead0047667"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf0120204069cbc65af5c150e792c7f0"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefizz_1_1sm.html#aaf0120204069cbc65af5c150e792c7f0">validateAcceptedEarly</a> (const <a class="el" href="classfizz_1_1client_1_1State.html">State</a> &amp;<a class="el" href="http__parser_8c.html#adc6e5733fc3c22f0a7b2914188c49c90">state</a>, const <a class="el" href="classfolly_1_1Optional.html">Optional</a>&lt; <a class="el" href="Conv_8cpp.html#ae1adbce218e7a9d09164012443191d24">std::string</a> &gt; &amp;<a class="el" href="ExtensionsTest_8cpp.html#af3a28898b95e8b84c27bda7309ad2fd5">alpn</a>)</td></tr>
<tr class="separator:aaf0120204069cbc65af5c150e792c7f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae24c3ac85b6cdaac0fa07ac8b30f8ba3"><td class="memItemLeft" align="right" valign="top">static std::tuple&lt; <a class="el" href="classfolly_1_1Optional.html">folly::Optional</a>&lt; <a class="el" href="namespacefizz.html#a1410cf02b9d3a95b34f9dbf22d372749">SignatureScheme</a> &gt;, std::shared_ptr&lt; const <a class="el" href="classfizz_1_1SelfCert.html">SelfCert</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefizz_1_1sm.html#ae24c3ac85b6cdaac0fa07ac8b30f8ba3">getClientCert</a> (const <a class="el" href="classfizz_1_1client_1_1State.html">State</a> &amp;<a class="el" href="http__parser_8c.html#adc6e5733fc3c22f0a7b2914188c49c90">state</a>, const std::vector&lt; <a class="el" href="namespacefizz.html#a1410cf02b9d3a95b34f9dbf22d372749">SignatureScheme</a> &gt; &amp;schemes)</td></tr>
<tr class="separator:ae24c3ac85b6cdaac0fa07ac8b30f8ba3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a515b52bb842b6ab525b35577dbf5f978"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="namespacefizz_1_1client.html#a006e2e73a7a79d2e74d951b5ca583ce0">MutateState</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefizz_1_1sm.html#a515b52bb842b6ab525b35577dbf5f978">handleCertMsg</a> (const <a class="el" href="classfizz_1_1client_1_1State.html">State</a> &amp;<a class="el" href="http__parser_8c.html#adc6e5733fc3c22f0a7b2914188c49c90">state</a>, <a class="el" href="structfizz_1_1CertificateMsg.html">CertificateMsg</a> certMsg, <a class="el" href="classfolly_1_1Optional.html">folly::Optional</a>&lt; <a class="el" href="namespacefizz.html#aef5b19e8cb60e324e310f0a9f2afdd95">CertificateCompressionAlgorithm</a> &gt; algo)</td></tr>
<tr class="separator:a515b52bb842b6ab525b35577dbf5f978"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a03235ecab0fc70d5d39d17ac34a651b9"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="ConstexprMathBenchmark_8cpp.html#a09a1e304d66d35dd47daffee9731edaa">uint32_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefizz_1_1sm.html#a03235ecab0fc70d5d39d17ac34a651b9">getMaxEarlyDataSize</a> (const <a class="el" href="structfizz_1_1NewSessionTicket.html">NewSessionTicket</a> &amp;<a class="el" href="HandshakeTypesTest_8cpp.html#a4a94a2c9d0b18e88889a8d7fcf70d170">nst</a>)</td></tr>
<tr class="separator:a03235ecab0fc70d5d39d17ac34a651b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a33ca709a3c063053fe765502ae066942"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="namespacefizz_1_1client.html#ae137a3bcd5e2f1dd0f85cae406ef34d0">Actions</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefizz_1_1sm.html#a33ca709a3c063053fe765502ae066942">ignoreEarlyAppWrite</a> (const <a class="el" href="classfizz_1_1client_1_1State.html">State</a> &amp;<a class="el" href="http__parser_8c.html#adc6e5733fc3c22f0a7b2914188c49c90">state</a>, <a class="el" href="structfizz_1_1EarlyAppWrite.html">EarlyAppWrite</a> write)</td></tr>
<tr class="separator:a33ca709a3c063053fe765502ae066942"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a44019a7df397aaed71a2cd2880d7fb72"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="namespacefizz_1_1client.html#ae137a3bcd5e2f1dd0f85cae406ef34d0">Actions</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefizz_1_1sm.html#a44019a7df397aaed71a2cd2880d7fb72">handleEarlyAppWrite</a> (const <a class="el" href="classfizz_1_1client_1_1State.html">State</a> &amp;<a class="el" href="http__parser_8c.html#adc6e5733fc3c22f0a7b2914188c49c90">state</a>, <a class="el" href="structfizz_1_1EarlyAppWrite.html">EarlyAppWrite</a> appWrite)</td></tr>
<tr class="separator:a44019a7df397aaed71a2cd2880d7fb72"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a407fa00fdc598f9f8a460c4add05187e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefizz_1_1sm.html#a407fa00fdc598f9f8a460c4add05187e">FIZZ_DECLARE_EVENT_HANDLER</a> (<a class="el" href="structfizz_1_1server_1_1ServerTypes.html">ServerTypes</a>, StateEnum::Uninitialized, <a class="el" href="namespacefizz.html#a1135430496a56ed55bdfc4a77ccb35fbac4408d335012a56ff58937d78050efad">Event::Accept</a>, StateEnum::ExpectingClientHello)</td></tr>
<tr class="separator:a407fa00fdc598f9f8a460c4add05187e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8eb0cb46d51aefea64e1d3c38a197cce"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefizz_1_1sm.html#a8eb0cb46d51aefea64e1d3c38a197cce">FIZZ_DECLARE_EVENT_HANDLER</a> (<a class="el" href="structfizz_1_1server_1_1ServerTypes.html">ServerTypes</a>, StateEnum::ExpectingClientHello, <a class="el" href="namespacefizz.html#a1135430496a56ed55bdfc4a77ccb35fba6c9bc94067a94a346562a06539fc68c2">Event::ClientHello</a>, StateEnum::ExpectingClientHello, StateEnum::ExpectingCertificate, StateEnum::ExpectingFinished, StateEnum::AcceptingEarlyData, <a class="el" href="TraceFieldType_8txt.html#a1f3f354b00fe1430d9c1002be04264a9">StateEnum::Error</a>)</td></tr>
<tr class="separator:a8eb0cb46d51aefea64e1d3c38a197cce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa93d8bd3334c9a2bf8598157e706acef"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefizz_1_1sm.html#aa93d8bd3334c9a2bf8598157e706acef">FIZZ_DECLARE_EVENT_HANDLER</a> (<a class="el" href="structfizz_1_1server_1_1ServerTypes.html">ServerTypes</a>, StateEnum::AcceptingEarlyData, <a class="el" href="namespacefizz.html#a1135430496a56ed55bdfc4a77ccb35fba068ed5f36c096c0d86fee9b0cd2aec01">Event::AppData</a>, <a class="el" href="TraceFieldType_8txt.html#a1f3f354b00fe1430d9c1002be04264a9">StateEnum::Error</a>)</td></tr>
<tr class="separator:aa93d8bd3334c9a2bf8598157e706acef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af83b1df2e2ff0f5dcbb42207ebf5b7e3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefizz_1_1sm.html#af83b1df2e2ff0f5dcbb42207ebf5b7e3">FIZZ_DECLARE_EVENT_HANDLER</a> (<a class="el" href="structfizz_1_1server_1_1ServerTypes.html">ServerTypes</a>, StateEnum::AcceptingEarlyData, <a class="el" href="namespacefizz.html#a1135430496a56ed55bdfc4a77ccb35fbaeed31df3f971bee9af441382c6c1e272">Event::AppWrite</a>, <a class="el" href="TraceFieldType_8txt.html#a1f3f354b00fe1430d9c1002be04264a9">StateEnum::Error</a>)</td></tr>
<tr class="separator:af83b1df2e2ff0f5dcbb42207ebf5b7e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a62d61788fc4c97703b4ef438d63caff5"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefizz_1_1sm.html#a62d61788fc4c97703b4ef438d63caff5">FIZZ_DECLARE_EVENT_HANDLER</a> (<a class="el" href="structfizz_1_1server_1_1ServerTypes.html">ServerTypes</a>, StateEnum::AcceptingEarlyData, <a class="el" href="namespacefizz.html#a1135430496a56ed55bdfc4a77ccb35fbaa721941f5b643b5e34853abce82db763">Event::EndOfEarlyData</a>, StateEnum::ExpectingFinished)</td></tr>
<tr class="separator:a62d61788fc4c97703b4ef438d63caff5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a78a8bd43dfd829e4a8ac25d7dc463b36"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefizz_1_1sm.html#a78a8bd43dfd829e4a8ac25d7dc463b36">FIZZ_DECLARE_EVENT_HANDLER</a> (<a class="el" href="structfizz_1_1server_1_1ServerTypes.html">ServerTypes</a>, StateEnum::ExpectingCertificate, <a class="el" href="namespacefizz.html#a1135430496a56ed55bdfc4a77ccb35fbaeb0f48a107df1a0f343d4cd513b555e6">Event::Certificate</a>, StateEnum::ExpectingCertificateVerify, StateEnum::ExpectingFinished) FIZZ_DECLARE_EVENT_HANDLER(<a class="el" href="structfizz_1_1server_1_1ServerTypes.html">ServerTypes</a></td></tr>
<tr class="separator:a78a8bd43dfd829e4a8ac25d7dc463b36"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20a668c9f22abc91bcf5b5b12c23773e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefizz_1_1sm.html#a20a668c9f22abc91bcf5b5b12c23773e">FIZZ_DECLARE_EVENT_HANDLER</a> (<a class="el" href="structfizz_1_1server_1_1ServerTypes.html">ServerTypes</a>, StateEnum::ExpectingFinished, <a class="el" href="namespacefizz.html#a1135430496a56ed55bdfc4a77ccb35fbaeed31df3f971bee9af441382c6c1e272">Event::AppWrite</a>, <a class="el" href="TraceFieldType_8txt.html#a1f3f354b00fe1430d9c1002be04264a9">StateEnum::Error</a>)</td></tr>
<tr class="separator:a20a668c9f22abc91bcf5b5b12c23773e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a44ff9dde09c0f844ad715237fa4341c6"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefizz_1_1sm.html#a44ff9dde09c0f844ad715237fa4341c6">FIZZ_DECLARE_EVENT_HANDLER</a> (<a class="el" href="structfizz_1_1server_1_1ServerTypes.html">ServerTypes</a>, StateEnum::ExpectingFinished, <a class="el" href="namespacefizz.html#a1135430496a56ed55bdfc4a77ccb35fba8f3d10eb21bd36347c258679eba9e92b">Event::Finished</a>, StateEnum::AcceptingData)</td></tr>
<tr class="separator:a44ff9dde09c0f844ad715237fa4341c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee5b92bb225776087a793a2c3dca4c49"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefizz_1_1sm.html#aee5b92bb225776087a793a2c3dca4c49">FIZZ_DECLARE_EVENT_HANDLER</a> (<a class="el" href="structfizz_1_1server_1_1ServerTypes.html">ServerTypes</a>, StateEnum::AcceptingData, <a class="el" href="namespacefizz.html#a1135430496a56ed55bdfc4a77ccb35fbad36da62dfdcc7f2a272f558c7895ce44">Event::WriteNewSessionTicket</a>, <a class="el" href="TraceFieldType_8txt.html#a1f3f354b00fe1430d9c1002be04264a9">StateEnum::Error</a>)</td></tr>
<tr class="separator:aee5b92bb225776087a793a2c3dca4c49"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f2420a2f7c4cce2f744f2a6ba1f6c2f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefizz_1_1sm.html#a4f2420a2f7c4cce2f744f2a6ba1f6c2f">FIZZ_DECLARE_EVENT_HANDLER</a> (<a class="el" href="structfizz_1_1server_1_1ServerTypes.html">ServerTypes</a>, StateEnum::AcceptingData, <a class="el" href="namespacefizz.html#a1135430496a56ed55bdfc4a77ccb35fba068ed5f36c096c0d86fee9b0cd2aec01">Event::AppData</a>, <a class="el" href="TraceFieldType_8txt.html#a1f3f354b00fe1430d9c1002be04264a9">StateEnum::Error</a>)</td></tr>
<tr class="separator:a4f2420a2f7c4cce2f744f2a6ba1f6c2f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a51863826a80f499cbd4307586af83b4b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefizz_1_1sm.html#a51863826a80f499cbd4307586af83b4b">FIZZ_DECLARE_EVENT_HANDLER</a> (<a class="el" href="structfizz_1_1server_1_1ServerTypes.html">ServerTypes</a>, StateEnum::AcceptingData, <a class="el" href="namespacefizz.html#a1135430496a56ed55bdfc4a77ccb35fbaeed31df3f971bee9af441382c6c1e272">Event::AppWrite</a>, <a class="el" href="TraceFieldType_8txt.html#a1f3f354b00fe1430d9c1002be04264a9">StateEnum::Error</a>)</td></tr>
<tr class="separator:a51863826a80f499cbd4307586af83b4b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a863c4e4230356170d4a51d088a167d9f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefizz_1_1sm.html#a863c4e4230356170d4a51d088a167d9f">FIZZ_DECLARE_EVENT_HANDLER</a> (<a class="el" href="structfizz_1_1server_1_1ServerTypes.html">ServerTypes</a>, StateEnum::AcceptingData, <a class="el" href="namespacefizz.html#a1135430496a56ed55bdfc4a77ccb35fbaa175bae4a622096eb215c37b84c56837">Event::KeyUpdate</a>, StateEnum::AcceptingData)</td></tr>
<tr class="separator:a863c4e4230356170d4a51d088a167d9f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e5f6f07be3a21682f75c5e3c7ecda24"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefizz_1_1sm.html#a5e5f6f07be3a21682f75c5e3c7ecda24">addHandshakeLogging</a> (const <a class="el" href="classfizz_1_1server_1_1State.html">State</a> &amp;<a class="el" href="http__parser_8c.html#adc6e5733fc3c22f0a7b2914188c49c90">state</a>, const <a class="el" href="structfizz_1_1ClientHello.html">ClientHello</a> &amp;<a class="el" href="HandshakeTypesTest_8cpp.html#aba518b904616df44c3d7dfde825a4c54">chlo</a>)</td></tr>
<tr class="separator:a5e5f6f07be3a21682f75c5e3c7ecda24"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a13d2556838d260066a8ff5c2a12da30a"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefizz_1_1sm.html#a13d2556838d260066a8ff5c2a12da30a">validateClientHello</a> (const <a class="el" href="structfizz_1_1ClientHello.html">ClientHello</a> &amp;<a class="el" href="HandshakeTypesTest_8cpp.html#aba518b904616df44c3d7dfde825a4c54">chlo</a>)</td></tr>
<tr class="separator:a13d2556838d260066a8ff5c2a12da30a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae1ce9840b6e7d93711ece74877e28dbe"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classfolly_1_1Optional.html">Optional</a>&lt; <a class="el" href="namespacefizz.html#a3a1cbf7ef22de4d4c5144b3090d7ebc1">ProtocolVersion</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefizz_1_1sm.html#ae1ce9840b6e7d93711ece74877e28dbe">negotiateVersion</a> (const <a class="el" href="structfizz_1_1ClientHello.html">ClientHello</a> &amp;<a class="el" href="HandshakeTypesTest_8cpp.html#aba518b904616df44c3d7dfde825a4c54">chlo</a>, const std::vector&lt; <a class="el" href="namespacefizz.html#a3a1cbf7ef22de4d4c5144b3090d7ebc1">ProtocolVersion</a> &gt; &amp;versions)</td></tr>
<tr class="separator:ae1ce9840b6e7d93711ece74877e28dbe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a608010fb3d6c87adc53661b826d9d8ee"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classfolly_1_1Optional.html">Optional</a>&lt; <a class="el" href="structfizz_1_1server_1_1CookieState.html">CookieState</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefizz_1_1sm.html#a608010fb3d6c87adc53661b826d9d8ee">getCookieState</a> (const <a class="el" href="structfizz_1_1ClientHello.html">ClientHello</a> &amp;<a class="el" href="HandshakeTypesTest_8cpp.html#aba518b904616df44c3d7dfde825a4c54">chlo</a>, <a class="el" href="namespacefizz.html#a3a1cbf7ef22de4d4c5144b3090d7ebc1">ProtocolVersion</a> <a class="el" href="ClientProtocol_8cpp.html#abe1b247743d4691ae90a9b12b08cc176">version</a>, <a class="el" href="namespacefizz.html#a23e4ec7baa80cc6f92fdbeadccf0d22e">CipherSuite</a> <a class="el" href="ClientProtocol_8cpp.html#aa7e60e524fbc7254437c13c7d22a9dfa">cipher</a>, const <a class="el" href="classfizz_1_1server_1_1CookieCipher.html">CookieCipher</a> *cookieCipher)</td></tr>
<tr class="separator:a608010fb3d6c87adc53661b826d9d8ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a81231a44af952737bf3919482b887313"><td class="memItemLeft" align="right" valign="top">static ResumptionStateResult&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefizz_1_1sm.html#a81231a44af952737bf3919482b887313">getResumptionState</a> (const <a class="el" href="structfizz_1_1ClientHello.html">ClientHello</a> &amp;<a class="el" href="HandshakeTypesTest_8cpp.html#aba518b904616df44c3d7dfde825a4c54">chlo</a>, const <a class="el" href="classfizz_1_1server_1_1TicketCipher.html">TicketCipher</a> *ticketCipher, const std::vector&lt; <a class="el" href="namespacefizz.html#a1e500492a0a0633f62bf1c3d4acea880">PskKeyExchangeMode</a> &gt; &amp;supportedModes)</td></tr>
<tr class="separator:a81231a44af952737bf3919482b887313"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae567083a18954a26954cf2cdd6dd815c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfolly_1_1Future.html">Future</a>&lt; <a class="el" href="namespacefizz_1_1server.html#a55ad2ae3bd23edb629aaf3638e973963">ReplayCacheResult</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefizz_1_1sm.html#ae567083a18954a26954cf2cdd6dd815c">getReplayCacheResult</a> (const <a class="el" href="structfizz_1_1ClientHello.html">ClientHello</a> &amp;<a class="el" href="HandshakeTypesTest_8cpp.html#aba518b904616df44c3d7dfde825a4c54">chlo</a>, bool zeroRttEnabled, <a class="el" href="classfizz_1_1server_1_1ReplayCache.html">ReplayCache</a> *replayCache)</td></tr>
<tr class="separator:ae567083a18954a26954cf2cdd6dd815c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c78fa192ff6b42a7b1a79ab5cf4e380"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefizz_1_1sm.html#a3c78fa192ff6b42a7b1a79ab5cf4e380">validateResumptionState</a> (const <a class="el" href="structfizz_1_1server_1_1ResumptionState.html">ResumptionState</a> &amp;resState, <a class="el" href="namespacefizz.html#a1e500492a0a0633f62bf1c3d4acea880">PskKeyExchangeMode</a>, <a class="el" href="namespacefizz.html#a3a1cbf7ef22de4d4c5144b3090d7ebc1">ProtocolVersion</a> <a class="el" href="ClientProtocol_8cpp.html#abe1b247743d4691ae90a9b12b08cc176">version</a>, <a class="el" href="namespacefizz.html#a23e4ec7baa80cc6f92fdbeadccf0d22e">CipherSuite</a> <a class="el" href="ClientProtocol_8cpp.html#aa7e60e524fbc7254437c13c7d22a9dfa">cipher</a>)</td></tr>
<tr class="separator:a3c78fa192ff6b42a7b1a79ab5cf4e380"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af3f48f3974ff4da2a63e3673866610b5"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="namespacefizz.html#a23e4ec7baa80cc6f92fdbeadccf0d22e">CipherSuite</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefizz_1_1sm.html#af3f48f3974ff4da2a63e3673866610b5">negotiateCipher</a> (const <a class="el" href="structfizz_1_1ClientHello.html">ClientHello</a> &amp;<a class="el" href="HandshakeTypesTest_8cpp.html#aba518b904616df44c3d7dfde825a4c54">chlo</a>, const std::vector&lt; std::vector&lt; <a class="el" href="namespacefizz.html#a23e4ec7baa80cc6f92fdbeadccf0d22e">CipherSuite</a> &gt;&gt; &amp;supportedCiphers)</td></tr>
<tr class="separator:af3f48f3974ff4da2a63e3673866610b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa59e947e9834b14d1ba7100c475c307e"><td class="memItemLeft" align="right" valign="top">static std::pair&lt; std::unique_ptr&lt; <a class="el" href="classfizz_1_1KeyScheduler.html">KeyScheduler</a> &gt;, std::unique_ptr&lt; <a class="el" href="classfizz_1_1HandshakeContext.html">HandshakeContext</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefizz_1_1sm.html#aa59e947e9834b14d1ba7100c475c307e">setupSchedulerAndContext</a> (const <a class="el" href="classfizz_1_1Factory.html">Factory</a> &amp;factory, <a class="el" href="namespacefizz.html#a23e4ec7baa80cc6f92fdbeadccf0d22e">CipherSuite</a> <a class="el" href="ClientProtocol_8cpp.html#aa7e60e524fbc7254437c13c7d22a9dfa">cipher</a>, const <a class="el" href="structfizz_1_1ClientHello.html">ClientHello</a> &amp;<a class="el" href="HandshakeTypesTest_8cpp.html#aba518b904616df44c3d7dfde825a4c54">chlo</a>, const <a class="el" href="classfolly_1_1Optional.html">Optional</a>&lt; <a class="el" href="structfizz_1_1server_1_1ResumptionState.html">ResumptionState</a> &gt; &amp;resState, const <a class="el" href="classfolly_1_1Optional.html">Optional</a>&lt; <a class="el" href="structfizz_1_1server_1_1CookieState.html">CookieState</a> &gt; &amp;cookieState, <a class="el" href="namespacefizz.html#ab017b61ecd944032c374d31740161131">PskType</a> pskType, std::unique_ptr&lt; <a class="el" href="classfizz_1_1HandshakeContext.html">HandshakeContext</a> &gt; handshakeContext, <a class="el" href="namespacefizz.html#a3a1cbf7ef22de4d4c5144b3090d7ebc1">ProtocolVersion</a>)</td></tr>
<tr class="separator:aa59e947e9834b14d1ba7100c475c307e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a44ac44fa0698a8dc734362655b93098b"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefizz_1_1sm.html#a44ac44fa0698a8dc734362655b93098b">validateGroups</a> (const std::vector&lt; <a class="el" href="structfizz_1_1KeyShareEntry.html">KeyShareEntry</a> &gt; &amp;client_shares)</td></tr>
<tr class="separator:a44ac44fa0698a8dc734362655b93098b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6195470e66b28f21de9c1a35cc0ff8cf"><td class="memItemLeft" align="right" valign="top">static std::tuple&lt; <a class="el" href="namespacefizz.html#a11069edebaa08949c9a6696ef4bb85e2">NamedGroup</a>, <a class="el" href="classfolly_1_1Optional.html">Optional</a>&lt; <a class="el" href="namespacefizz.html#af020f21a568ff86800e03d6ad2a9b84d">Buf</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefizz_1_1sm.html#a6195470e66b28f21de9c1a35cc0ff8cf">negotiateGroup</a> (<a class="el" href="namespacefizz.html#a3a1cbf7ef22de4d4c5144b3090d7ebc1">ProtocolVersion</a> <a class="el" href="ClientProtocol_8cpp.html#abe1b247743d4691ae90a9b12b08cc176">version</a>, const <a class="el" href="structfizz_1_1ClientHello.html">ClientHello</a> &amp;<a class="el" href="HandshakeTypesTest_8cpp.html#aba518b904616df44c3d7dfde825a4c54">chlo</a>, const std::vector&lt; <a class="el" href="namespacefizz.html#a11069edebaa08949c9a6696ef4bb85e2">NamedGroup</a> &gt; &amp;supportedGroups)</td></tr>
<tr class="separator:a6195470e66b28f21de9c1a35cc0ff8cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab2252ea6f82b291b35118344ff5134ae"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="namespacefizz.html#af020f21a568ff86800e03d6ad2a9b84d">Buf</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefizz_1_1sm.html#ab2252ea6f82b291b35118344ff5134ae">doKex</a> (const <a class="el" href="classfizz_1_1Factory.html">Factory</a> &amp;factory, <a class="el" href="namespacefizz.html#a11069edebaa08949c9a6696ef4bb85e2">NamedGroup</a> <a class="el" href="ClientProtocol_8cpp.html#a100fbfdcc383ea1165570b83a874c0e0">group</a>, const <a class="el" href="namespacefizz.html#af020f21a568ff86800e03d6ad2a9b84d">Buf</a> &amp;clientShare, <a class="el" href="classfizz_1_1KeyScheduler.html">KeyScheduler</a> &amp;<a class="el" href="FilePoller_8cpp.html#af8aa2314425a86a160127ccd900704f8">scheduler</a>)</td></tr>
<tr class="separator:ab2252ea6f82b291b35118344ff5134ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a624d6a233df96caa433238b479494b9f"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="namespacefizz.html#af020f21a568ff86800e03d6ad2a9b84d">Buf</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefizz_1_1sm.html#a624d6a233df96caa433238b479494b9f">getHelloRetryRequest</a> (<a class="el" href="namespacefizz.html#a3a1cbf7ef22de4d4c5144b3090d7ebc1">ProtocolVersion</a> <a class="el" href="ClientProtocol_8cpp.html#abe1b247743d4691ae90a9b12b08cc176">version</a>, <a class="el" href="namespacefizz.html#a23e4ec7baa80cc6f92fdbeadccf0d22e">CipherSuite</a> <a class="el" href="ClientProtocol_8cpp.html#aa7e60e524fbc7254437c13c7d22a9dfa">cipher</a>, <a class="el" href="namespacefizz.html#a11069edebaa08949c9a6696ef4bb85e2">NamedGroup</a> <a class="el" href="ClientProtocol_8cpp.html#a100fbfdcc383ea1165570b83a874c0e0">group</a>, <a class="el" href="namespacefizz.html#af020f21a568ff86800e03d6ad2a9b84d">Buf</a> legacySessionId, <a class="el" href="classfizz_1_1HandshakeContext.html">HandshakeContext</a> &amp;handshakeContext)</td></tr>
<tr class="separator:a624d6a233df96caa433238b479494b9f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:affbeb1f8646bca9434a62803e100adfa"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="namespacefizz.html#af020f21a568ff86800e03d6ad2a9b84d">Buf</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefizz_1_1sm.html#affbeb1f8646bca9434a62803e100adfa">getServerHello</a> (<a class="el" href="namespacefizz.html#a3a1cbf7ef22de4d4c5144b3090d7ebc1">ProtocolVersion</a> <a class="el" href="ClientProtocol_8cpp.html#abe1b247743d4691ae90a9b12b08cc176">version</a>, <a class="el" href="namespacefizz.html#a796015128e6988829a7719b9cb09749e">Random</a> <a class="el" href="FBStringBenchmark_8cpp.html#a0f5dc778f46ef846ca354b005f6ff3f4">random</a>, <a class="el" href="namespacefizz.html#a23e4ec7baa80cc6f92fdbeadccf0d22e">CipherSuite</a> <a class="el" href="ClientProtocol_8cpp.html#aa7e60e524fbc7254437c13c7d22a9dfa">cipher</a>, bool psk, <a class="el" href="classfolly_1_1Optional.html">Optional</a>&lt; <a class="el" href="namespacefizz.html#a11069edebaa08949c9a6696ef4bb85e2">NamedGroup</a> &gt; <a class="el" href="ClientProtocol_8cpp.html#a100fbfdcc383ea1165570b83a874c0e0">group</a>, <a class="el" href="classfolly_1_1Optional.html">Optional</a>&lt; <a class="el" href="namespacefizz.html#af020f21a568ff86800e03d6ad2a9b84d">Buf</a> &gt; serverShare, <a class="el" href="namespacefizz.html#af020f21a568ff86800e03d6ad2a9b84d">Buf</a> legacy_session_id, <a class="el" href="classfizz_1_1HandshakeContext.html">HandshakeContext</a> &amp;handshakeContext)</td></tr>
<tr class="separator:affbeb1f8646bca9434a62803e100adfa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac1a5cc121e01d7f131286dcdc299a030"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classfolly_1_1Optional.html">Optional</a>&lt; <a class="el" href="Conv_8cpp.html#ae1adbce218e7a9d09164012443191d24">std::string</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefizz_1_1sm.html#ac1a5cc121e01d7f131286dcdc299a030">negotiateAlpn</a> (const <a class="el" href="structfizz_1_1ClientHello.html">ClientHello</a> &amp;<a class="el" href="HandshakeTypesTest_8cpp.html#aba518b904616df44c3d7dfde825a4c54">chlo</a>, <a class="el" href="classfolly_1_1Optional.html">folly::Optional</a>&lt; <a class="el" href="Conv_8cpp.html#ae1adbce218e7a9d09164012443191d24">std::string</a> &gt; zeroRttAlpn, const <a class="el" href="classfizz_1_1server_1_1FizzServerContext.html">FizzServerContext</a> &amp;<a class="el" href="wangle_2__build_2CMakeCache_8txt.html#a261f9f58ccbeaa962c4e675e4212c9cc">context</a>)</td></tr>
<tr class="separator:ac1a5cc121e01d7f131286dcdc299a030"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a708a6d968e319b72fe49694081ca74b0"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classfolly_1_1Optional.html">Optional</a>&lt; std::chrono::milliseconds &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefizz_1_1sm.html#a708a6d968e319b72fe49694081ca74b0">getClockSkew</a> (const <a class="el" href="classfolly_1_1Optional.html">Optional</a>&lt; <a class="el" href="structfizz_1_1server_1_1ResumptionState.html">ResumptionState</a> &gt; &amp;psk, <a class="el" href="classfolly_1_1Optional.html">Optional</a>&lt; <a class="el" href="ConstexprMathBenchmark_8cpp.html#a09a1e304d66d35dd47daffee9731edaa">uint32_t</a> &gt; <a class="el" href="ServerProtocol_8cpp.html#a48b7bb199764d94aa8aa98b19f949e40">obfuscatedAge</a>)</td></tr>
<tr class="separator:a708a6d968e319b72fe49694081ca74b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac3e04624bd83db69e7ec28bed6fcfa4b"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="namespacefizz.html#a02f9d49d996b83310b2a38e93684c959">EarlyDataType</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefizz_1_1sm.html#ac3e04624bd83db69e7ec28bed6fcfa4b">negotiateEarlyDataType</a> (bool acceptEarlyData, const <a class="el" href="structfizz_1_1ClientHello.html">ClientHello</a> &amp;<a class="el" href="HandshakeTypesTest_8cpp.html#aba518b904616df44c3d7dfde825a4c54">chlo</a>, const <a class="el" href="classfolly_1_1Optional.html">Optional</a>&lt; <a class="el" href="structfizz_1_1server_1_1ResumptionState.html">ResumptionState</a> &gt; &amp;psk, <a class="el" href="namespacefizz.html#a23e4ec7baa80cc6f92fdbeadccf0d22e">CipherSuite</a> <a class="el" href="ClientProtocol_8cpp.html#aa7e60e524fbc7254437c13c7d22a9dfa">cipher</a>, <a class="el" href="classfolly_1_1Optional.html">Optional</a>&lt; <a class="el" href="namespacefizz.html#a7935d663f79e6ee45ba86b8d3b4dad9a">KeyExchangeType</a> &gt; keyExchangeType, const <a class="el" href="classfolly_1_1Optional.html">Optional</a>&lt; <a class="el" href="structfizz_1_1server_1_1CookieState.html">CookieState</a> &gt; &amp;cookieState, <a class="el" href="classfolly_1_1Optional.html">Optional</a>&lt; <a class="el" href="Conv_8cpp.html#ae1adbce218e7a9d09164012443191d24">std::string</a> &gt; <a class="el" href="ExtensionsTest_8cpp.html#af3a28898b95e8b84c27bda7309ad2fd5">alpn</a>, <a class="el" href="namespacefizz_1_1server.html#a55ad2ae3bd23edb629aaf3638e973963">ReplayCacheResult</a> replayCacheResult, <a class="el" href="classfolly_1_1Optional.html">Optional</a>&lt; std::chrono::milliseconds &gt; clockSkew, <a class="el" href="structfizz_1_1server_1_1ClockSkewTolerance.html">ClockSkewTolerance</a> clockSkewTolerance, const <a class="el" href="classfizz_1_1server_1_1AppTokenValidator.html">AppTokenValidator</a> *appTokenValidator)</td></tr>
<tr class="separator:ac3e04624bd83db69e7ec28bed6fcfa4b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a302eababdc4104e4730008e945c20537"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="namespacefizz.html#af020f21a568ff86800e03d6ad2a9b84d">Buf</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefizz_1_1sm.html#a302eababdc4104e4730008e945c20537">getEncryptedExt</a> (<a class="el" href="classfizz_1_1HandshakeContext.html">HandshakeContext</a> &amp;handshakeContext, const <a class="el" href="classfolly_1_1Optional.html">folly::Optional</a>&lt; <a class="el" href="Conv_8cpp.html#ae1adbce218e7a9d09164012443191d24">std::string</a> &gt; &amp;selectedAlpn, <a class="el" href="namespacefizz.html#a02f9d49d996b83310b2a38e93684c959">EarlyDataType</a> earlyData, std::vector&lt; <a class="el" href="structfizz_1_1Extension.html">Extension</a> &gt; otherExtensions)</td></tr>
<tr class="separator:a302eababdc4104e4730008e945c20537"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3222cd5869d6a0fdb3a46ad9afc86b71"><td class="memItemLeft" align="right" valign="top">static std::pair&lt; std::shared_ptr&lt; <a class="el" href="classfizz_1_1SelfCert.html">SelfCert</a> &gt;, <a class="el" href="namespacefizz.html#a1410cf02b9d3a95b34f9dbf22d372749">SignatureScheme</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefizz_1_1sm.html#a3222cd5869d6a0fdb3a46ad9afc86b71">chooseCert</a> (const <a class="el" href="classfizz_1_1server_1_1FizzServerContext.html">FizzServerContext</a> &amp;<a class="el" href="wangle_2__build_2CMakeCache_8txt.html#a261f9f58ccbeaa962c4e675e4212c9cc">context</a>, const <a class="el" href="structfizz_1_1ClientHello.html">ClientHello</a> &amp;<a class="el" href="HandshakeTypesTest_8cpp.html#aba518b904616df44c3d7dfde825a4c54">chlo</a>)</td></tr>
<tr class="separator:a3222cd5869d6a0fdb3a46ad9afc86b71"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a22670936c1c7049b8d2a5f9d01a12f8d"><td class="memItemLeft" align="right" valign="top">static std::tuple&lt; <a class="el" href="namespacefizz.html#af020f21a568ff86800e03d6ad2a9b84d">Buf</a>, <a class="el" href="classfolly_1_1Optional.html">folly::Optional</a>&lt; <a class="el" href="namespacefizz.html#aef5b19e8cb60e324e310f0a9f2afdd95">CertificateCompressionAlgorithm</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefizz_1_1sm.html#a22670936c1c7049b8d2a5f9d01a12f8d">getCertificate</a> (const std::shared_ptr&lt; const <a class="el" href="classfizz_1_1SelfCert.html">SelfCert</a> &gt; &amp;<a class="el" href="ClientProtocol_8cpp.html#ac2dc8f08e34c6a154ad8ff2f4266bf3c">serverCert</a>, const <a class="el" href="classfizz_1_1server_1_1FizzServerContext.html">FizzServerContext</a> &amp;<a class="el" href="wangle_2__build_2CMakeCache_8txt.html#a261f9f58ccbeaa962c4e675e4212c9cc">context</a>, const <a class="el" href="structfizz_1_1ClientHello.html">ClientHello</a> &amp;<a class="el" href="HandshakeTypesTest_8cpp.html#aba518b904616df44c3d7dfde825a4c54">chlo</a>, <a class="el" href="classfizz_1_1HandshakeContext.html">HandshakeContext</a> &amp;handshakeContext)</td></tr>
<tr class="separator:a22670936c1c7049b8d2a5f9d01a12f8d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab9bb199543996f37302ae426666594c5"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="namespacefizz.html#af020f21a568ff86800e03d6ad2a9b84d">Buf</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefizz_1_1sm.html#ab9bb199543996f37302ae426666594c5">getCertificateVerify</a> (<a class="el" href="namespacefizz.html#a1410cf02b9d3a95b34f9dbf22d372749">SignatureScheme</a> sigScheme, <a class="el" href="namespacefizz.html#af020f21a568ff86800e03d6ad2a9b84d">Buf</a> signature, <a class="el" href="classfizz_1_1HandshakeContext.html">HandshakeContext</a> &amp;handshakeContext)</td></tr>
<tr class="separator:ab9bb199543996f37302ae426666594c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b7f9e7e89c473a5bcffee7965ce7b11"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="namespacefizz.html#af020f21a568ff86800e03d6ad2a9b84d">Buf</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefizz_1_1sm.html#a1b7f9e7e89c473a5bcffee7965ce7b11">getCertificateRequest</a> (const std::vector&lt; <a class="el" href="namespacefizz.html#a1410cf02b9d3a95b34f9dbf22d372749">SignatureScheme</a> &gt; &amp;acceptableSigSchemes, const <a class="el" href="classfizz_1_1CertificateVerifier.html">CertificateVerifier</a> *const verifier, <a class="el" href="classfizz_1_1HandshakeContext.html">HandshakeContext</a> &amp;handshakeContext)</td></tr>
<tr class="separator:a1b7f9e7e89c473a5bcffee7965ce7b11"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae07a16d08f9254937d3fdcb4a52b5f19"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="structfizz_1_1WriteToSocket.html">WriteToSocket</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefizz_1_1sm.html#ae07a16d08f9254937d3fdcb4a52b5f19">writeNewSessionTicket</a> (const <a class="el" href="classfizz_1_1server_1_1FizzServerContext.html">FizzServerContext</a> &amp;<a class="el" href="wangle_2__build_2CMakeCache_8txt.html#a261f9f58ccbeaa962c4e675e4212c9cc">context</a>, const <a class="el" href="classfizz_1_1WriteRecordLayer.html">WriteRecordLayer</a> &amp;recordLayer, std::chrono::seconds ticketLifetime, <a class="el" href="ConstexprMathBenchmark_8cpp.html#a09a1e304d66d35dd47daffee9731edaa">uint32_t</a> ticketAgeAdd, <a class="el" href="namespacefizz.html#af020f21a568ff86800e03d6ad2a9b84d">Buf</a> nonce, <a class="el" href="namespacefizz.html#af020f21a568ff86800e03d6ad2a9b84d">Buf</a> <a class="el" href="TicketCodecTest_8cpp.html#a7093cc9e41a6fdad6b2f2aa9211604c6">ticket</a>, <a class="el" href="namespacefizz.html#a3a1cbf7ef22de4d4c5144b3090d7ebc1">ProtocolVersion</a> <a class="el" href="ClientProtocol_8cpp.html#abe1b247743d4691ae90a9b12b08cc176">version</a>)</td></tr>
<tr class="separator:ae07a16d08f9254937d3fdcb4a52b5f19"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa8528d02dcd2f7fcd8505a80acaa741f"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classfolly_1_1Future.html">Future</a>&lt; <a class="el" href="classfolly_1_1Optional.html">Optional</a>&lt; <a class="el" href="structfizz_1_1WriteToSocket.html">WriteToSocket</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefizz_1_1sm.html#aa8528d02dcd2f7fcd8505a80acaa741f">generateTicket</a> (const <a class="el" href="classfizz_1_1server_1_1State.html">State</a> &amp;<a class="el" href="http__parser_8c.html#adc6e5733fc3c22f0a7b2914188c49c90">state</a>, const std::vector&lt; <a class="el" href="ConstexprMathBenchmark_8cpp.html#ae1affc9ca37cfb624959c866a73f83c2">uint8_t</a> &gt; &amp;resumptionMasterSecret, <a class="el" href="namespacefizz.html#af020f21a568ff86800e03d6ad2a9b84d">Buf</a> appToken=<a class="el" href="http__parser__cpp_8cpp.html#ab979d9d4b4923f7c54d6caa6e1a61936">nullptr</a>)</td></tr>
<tr class="separator:aa8528d02dcd2f7fcd8505a80acaa741f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a5e5f6f07be3a21682f75c5e3c7ecda24"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void fizz::sm::addHandshakeLogging </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classfizz_1_1server_1_1State.html">State</a> &amp;&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structfizz_1_1ClientHello.html">ClientHello</a> &amp;&#160;</td>
          <td class="paramname"><em>chlo</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ServerProtocol_8cpp_source.html#l00311">311</a> of file <a class="el" href="ServerProtocol_8cpp_source.html">ServerProtocol.cpp</a>.</p>

<p>References <a class="el" href="fizz_2fizz_2record_2Types_8h_source.html#l00191">fizz::ClientHello::cipher_suites</a>, <a class="el" href="server_2State_8h_source.html#l00042">fizz::server::HandshakeLogging::clientCiphers</a>, <a class="el" href="server_2State_8h_source.html#l00043">fizz::server::HandshakeLogging::clientExtensions</a>, <a class="el" href="server_2State_8h_source.html#l00048">fizz::server::HandshakeLogging::clientKeyExchangeModes</a>, <a class="el" href="server_2State_8h_source.html#l00047">fizz::server::HandshakeLogging::clientKeyShares</a>, <a class="el" href="server_2State_8h_source.html#l00040">fizz::server::HandshakeLogging::clientLegacyVersion</a>, <a class="el" href="server_2State_8h_source.html#l00051">fizz::server::HandshakeLogging::clientRandom</a>, <a class="el" href="server_2State_8h_source.html#l00044">fizz::server::HandshakeLogging::clientRecordVersion</a>, <a class="el" href="server_2State_8h_source.html#l00050">fizz::server::HandshakeLogging::clientSessionIdSent</a>, <a class="el" href="server_2State_8h_source.html#l00049">fizz::server::HandshakeLogging::clientSignatureAlgorithms</a>, <a class="el" href="server_2State_8h_source.html#l00045">fizz::server::HandshakeLogging::clientSni</a>, <a class="el" href="server_2State_8h_source.html#l00046">fizz::server::HandshakeLogging::clientSupportedGroups</a>, <a class="el" href="server_2State_8h_source.html#l00041">fizz::server::HandshakeLogging::clientSupportedVersions</a>, <a class="el" href="fizz_2fizz_2record_2Types_8h_source.html#l00193">fizz::ClientHello::extensions</a>, <a class="el" href="server_2State_8h_source.html#l00193">fizz::server::State::handshakeLogging()</a>, <a class="el" href="fizz_2fizz_2record_2Types_8h_source.html#l00190">fizz::ClientHello::legacy_session_id</a>, <a class="el" href="fizz_2fizz_2record_2Types_8h_source.html#l00188">fizz::ClientHello::legacy_version</a>, <a class="el" href="Base-inl_8h_source.html#l02567">folly::gen::move</a>, <a class="el" href="fizz_2fizz_2record_2Types_8h_source.html#l00189">fizz::ClientHello::random</a>, <a class="el" href="server_2State_8h_source.html#l00213">fizz::server::State::readRecordLayer()</a>, and <a class="el" href="ExtensionsTest_8cpp_source.html#l00023">sni</a>.</p>

<p>Referenced by <a class="el" href="ServerProtocol_8cpp_source.html#l00953">getCertificateRequest()</a>.</p>
<div class="fragment"><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;                                                                             {</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;  <span class="keywordflow">if</span> (state.<a class="code" href="classfizz_1_1server_1_1State.html#a7b686e41383374b12052d0d8e43b02d2">handshakeLogging</a>()) {</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    state.<a class="code" href="classfizz_1_1server_1_1State.html#a7b686e41383374b12052d0d8e43b02d2">handshakeLogging</a>()-&gt;<a class="code" href="structfizz_1_1server_1_1HandshakeLogging.html#af8ea77bbb8523dcf9b57eb7c12d05cd6">clientLegacyVersion</a> = <a class="code" href="HandshakeTypesTest_8cpp.html#aba518b904616df44c3d7dfde825a4c54">chlo</a>.legacy_version;</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    <span class="keyword">auto</span> supportedVersions = getExtension&lt;SupportedVersions&gt;(<a class="code" href="HandshakeTypesTest_8cpp.html#aba518b904616df44c3d7dfde825a4c54">chlo</a>.extensions);</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    <span class="keywordflow">if</span> (supportedVersions) {</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;      state.<a class="code" href="classfizz_1_1server_1_1State.html#a7b686e41383374b12052d0d8e43b02d2">handshakeLogging</a>()-&gt;<a class="code" href="structfizz_1_1server_1_1HandshakeLogging.html#a00f64b157b20c5da4d59d383de4c0ccc">clientSupportedVersions</a> =</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;          supportedVersions-&gt;versions;</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    }</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    state.<a class="code" href="classfizz_1_1server_1_1State.html#a7b686e41383374b12052d0d8e43b02d2">handshakeLogging</a>()-&gt;<a class="code" href="structfizz_1_1server_1_1HandshakeLogging.html#a94c7ff84fdb6e37d55cb1124b67de245">clientCiphers</a> = <a class="code" href="HandshakeTypesTest_8cpp.html#aba518b904616df44c3d7dfde825a4c54">chlo</a>.cipher_suites;</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    state.<a class="code" href="classfizz_1_1server_1_1State.html#a7b686e41383374b12052d0d8e43b02d2">handshakeLogging</a>()-&gt;<a class="code" href="structfizz_1_1server_1_1HandshakeLogging.html#a4d1fc5f14ac57b0ae0a76c7639d9077b">clientExtensions</a>.clear();</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; extension : <a class="code" href="HandshakeTypesTest_8cpp.html#aba518b904616df44c3d7dfde825a4c54">chlo</a>.extensions) {</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;      state.<a class="code" href="classfizz_1_1server_1_1State.html#a7b686e41383374b12052d0d8e43b02d2">handshakeLogging</a>()-&gt;<a class="code" href="structfizz_1_1server_1_1HandshakeLogging.html#a4d1fc5f14ac57b0ae0a76c7639d9077b">clientExtensions</a>.push_back(</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;          extension.extension_type);</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    }</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    <span class="keyword">auto</span> plaintextReadRecord =</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        <span class="keyword">dynamic_cast&lt;</span>PlaintextReadRecordLayer*<span class="keyword">&gt;</span>(state.<a class="code" href="classfizz_1_1server_1_1State.html#a914f13c66b77f66f43dc5192863570b3">readRecordLayer</a>());</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    <span class="keywordflow">if</span> (plaintextReadRecord) {</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;      state.<a class="code" href="classfizz_1_1server_1_1State.html#a7b686e41383374b12052d0d8e43b02d2">handshakeLogging</a>()-&gt;<a class="code" href="structfizz_1_1server_1_1HandshakeLogging.html#abdffc8c678c35d1667ec38b6802c30d6">clientRecordVersion</a> =</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;          plaintextReadRecord-&gt;getReceivedRecordVersion();</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    }</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <span class="keyword">auto</span> <a class="code" href="ExtensionsTest_8cpp.html#add4169bd6ee9aa37de918700cbc2938f">sni</a> = getExtension&lt;ServerNameList&gt;(<a class="code" href="HandshakeTypesTest_8cpp.html#aba518b904616df44c3d7dfde825a4c54">chlo</a>.extensions);</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="ExtensionsTest_8cpp.html#add4169bd6ee9aa37de918700cbc2938f">sni</a> &amp;&amp; !<a class="code" href="ExtensionsTest_8cpp.html#add4169bd6ee9aa37de918700cbc2938f">sni</a>-&gt;server_name_list.empty()) {</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;      state.<a class="code" href="classfizz_1_1server_1_1State.html#a7b686e41383374b12052d0d8e43b02d2">handshakeLogging</a>()-&gt;<a class="code" href="structfizz_1_1server_1_1HandshakeLogging.html#ac388a900fc22587322b395b6e81fb389">clientSni</a> = <a class="code" href="ExtensionsTest_8cpp.html#add4169bd6ee9aa37de918700cbc2938f">sni</a>-&gt;server_name_list.front()</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;                                                .hostname-&gt;moveToFbString()</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;                                                .toStdString();</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    }</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    <span class="keyword">auto</span> supportedGroups = getExtension&lt;SupportedGroups&gt;(<a class="code" href="HandshakeTypesTest_8cpp.html#aba518b904616df44c3d7dfde825a4c54">chlo</a>.extensions);</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    <span class="keywordflow">if</span> (supportedGroups) {</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;      state.<a class="code" href="classfizz_1_1server_1_1State.html#a7b686e41383374b12052d0d8e43b02d2">handshakeLogging</a>()-&gt;<a class="code" href="structfizz_1_1server_1_1HandshakeLogging.html#aaa989152d03b6cea6d0165cd96eb2864">clientSupportedGroups</a> =</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;          <a class="code" href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">std::move</a>(supportedGroups-&gt;named_group_list);</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    }</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <span class="keyword">auto</span> keyShare = getExtension&lt;ClientKeyShare&gt;(<a class="code" href="HandshakeTypesTest_8cpp.html#aba518b904616df44c3d7dfde825a4c54">chlo</a>.extensions);</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    <span class="keywordflow">if</span> (keyShare &amp;&amp; !state.<a class="code" href="classfizz_1_1server_1_1State.html#a7b686e41383374b12052d0d8e43b02d2">handshakeLogging</a>()-&gt;<a class="code" href="structfizz_1_1server_1_1HandshakeLogging.html#a1083cb3a9b479be9bdc951ffdc570b0d">clientKeyShares</a>) {</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;      std::vector&lt;NamedGroup&gt; shares;</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; entry : keyShare-&gt;client_shares) {</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;        shares.push_back(entry.group);</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;      }</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;      state.<a class="code" href="classfizz_1_1server_1_1State.html#a7b686e41383374b12052d0d8e43b02d2">handshakeLogging</a>()-&gt;<a class="code" href="structfizz_1_1server_1_1HandshakeLogging.html#a1083cb3a9b479be9bdc951ffdc570b0d">clientKeyShares</a> = <a class="code" href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">std::move</a>(shares);</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    }</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    <span class="keyword">auto</span> exchangeModes = getExtension&lt;PskKeyExchangeModes&gt;(<a class="code" href="HandshakeTypesTest_8cpp.html#aba518b904616df44c3d7dfde825a4c54">chlo</a>.extensions);</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    <span class="keywordflow">if</span> (exchangeModes) {</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;      state.<a class="code" href="classfizz_1_1server_1_1State.html#a7b686e41383374b12052d0d8e43b02d2">handshakeLogging</a>()-&gt;<a class="code" href="structfizz_1_1server_1_1HandshakeLogging.html#af1fc334ad0e5f81b41cbafebd8fd8e3f">clientKeyExchangeModes</a> =</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;          <a class="code" href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">std::move</a>(exchangeModes-&gt;modes);</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    }</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    <span class="keyword">auto</span> clientSigSchemes = getExtension&lt;SignatureAlgorithms&gt;(<a class="code" href="HandshakeTypesTest_8cpp.html#aba518b904616df44c3d7dfde825a4c54">chlo</a>.extensions);</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    <span class="keywordflow">if</span> (clientSigSchemes) {</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;      state.<a class="code" href="classfizz_1_1server_1_1State.html#a7b686e41383374b12052d0d8e43b02d2">handshakeLogging</a>()-&gt;<a class="code" href="structfizz_1_1server_1_1HandshakeLogging.html#aa3d355c5c4be24510ed4ef0b28b1a974">clientSignatureAlgorithms</a> =</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;          <a class="code" href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">std::move</a>(clientSigSchemes-&gt;supported_signature_algorithms);</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    }</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    state.<a class="code" href="classfizz_1_1server_1_1State.html#a7b686e41383374b12052d0d8e43b02d2">handshakeLogging</a>()-&gt;<a class="code" href="structfizz_1_1server_1_1HandshakeLogging.html#a1a74b83c00891f7d94243d9d8ba8af1c">clientSessionIdSent</a> =</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;        <a class="code" href="HandshakeTypesTest_8cpp.html#aba518b904616df44c3d7dfde825a4c54">chlo</a>.legacy_session_id &amp;&amp; !<a class="code" href="HandshakeTypesTest_8cpp.html#aba518b904616df44c3d7dfde825a4c54">chlo</a>.legacy_session_id-&gt;empty();</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    state.<a class="code" href="classfizz_1_1server_1_1State.html#a7b686e41383374b12052d0d8e43b02d2">handshakeLogging</a>()-&gt;<a class="code" href="structfizz_1_1server_1_1HandshakeLogging.html#a3d82a6cc4ee43c589ad3775a435bd0d9">clientRandom</a> = <a class="code" href="HandshakeTypesTest_8cpp.html#aba518b904616df44c3d7dfde825a4c54">chlo</a>.random;</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;  }</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;}</div><div class="ttc" id="structfizz_1_1server_1_1HandshakeLogging_html_a94c7ff84fdb6e37d55cb1124b67de245"><div class="ttname"><a href="structfizz_1_1server_1_1HandshakeLogging.html#a94c7ff84fdb6e37d55cb1124b67de245">fizz::server::HandshakeLogging::clientCiphers</a></div><div class="ttdeci">std::vector&lt; CipherSuite &gt; clientCiphers</div><div class="ttdef"><b>Definition:</b> <a href="server_2State_8h_source.html#l00042">State.h:42</a></div></div>
<div class="ttc" id="structfizz_1_1server_1_1HandshakeLogging_html_abdffc8c678c35d1667ec38b6802c30d6"><div class="ttname"><a href="structfizz_1_1server_1_1HandshakeLogging.html#abdffc8c678c35d1667ec38b6802c30d6">fizz::server::HandshakeLogging::clientRecordVersion</a></div><div class="ttdeci">folly::Optional&lt; ProtocolVersion &gt; clientRecordVersion</div><div class="ttdef"><b>Definition:</b> <a href="server_2State_8h_source.html#l00044">State.h:44</a></div></div>
<div class="ttc" id="HandshakeTypesTest_8cpp_html_aba518b904616df44c3d7dfde825a4c54"><div class="ttname"><a href="HandshakeTypesTest_8cpp.html#aba518b904616df44c3d7dfde825a4c54">chlo</a></div><div class="ttdeci">static const std::string chlo</div><div class="ttdef"><b>Definition:</b> <a href="HandshakeTypesTest_8cpp_source.html#l00023">HandshakeTypesTest.cpp:23</a></div></div>
<div class="ttc" id="structfizz_1_1server_1_1HandshakeLogging_html_a1a74b83c00891f7d94243d9d8ba8af1c"><div class="ttname"><a href="structfizz_1_1server_1_1HandshakeLogging.html#a1a74b83c00891f7d94243d9d8ba8af1c">fizz::server::HandshakeLogging::clientSessionIdSent</a></div><div class="ttdeci">folly::Optional&lt; bool &gt; clientSessionIdSent</div><div class="ttdef"><b>Definition:</b> <a href="server_2State_8h_source.html#l00050">State.h:50</a></div></div>
<div class="ttc" id="namespacefolly_1_1gen_html_ac24ec252b1b738a40c274285527c193f"><div class="ttname"><a href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">folly::gen::move</a></div><div class="ttdeci">constexpr detail::Map&lt; Move &gt; move</div><div class="ttdef"><b>Definition:</b> <a href="Base-inl_8h_source.html#l02567">Base-inl.h:2567</a></div></div>
<div class="ttc" id="structfizz_1_1server_1_1HandshakeLogging_html_a1083cb3a9b479be9bdc951ffdc570b0d"><div class="ttname"><a href="structfizz_1_1server_1_1HandshakeLogging.html#a1083cb3a9b479be9bdc951ffdc570b0d">fizz::server::HandshakeLogging::clientKeyShares</a></div><div class="ttdeci">folly::Optional&lt; std::vector&lt; NamedGroup &gt; &gt; clientKeyShares</div><div class="ttdef"><b>Definition:</b> <a href="server_2State_8h_source.html#l00047">State.h:47</a></div></div>
<div class="ttc" id="structfizz_1_1server_1_1HandshakeLogging_html_af1fc334ad0e5f81b41cbafebd8fd8e3f"><div class="ttname"><a href="structfizz_1_1server_1_1HandshakeLogging.html#af1fc334ad0e5f81b41cbafebd8fd8e3f">fizz::server::HandshakeLogging::clientKeyExchangeModes</a></div><div class="ttdeci">std::vector&lt; PskKeyExchangeMode &gt; clientKeyExchangeModes</div><div class="ttdef"><b>Definition:</b> <a href="server_2State_8h_source.html#l00048">State.h:48</a></div></div>
<div class="ttc" id="structfizz_1_1server_1_1HandshakeLogging_html_a3d82a6cc4ee43c589ad3775a435bd0d9"><div class="ttname"><a href="structfizz_1_1server_1_1HandshakeLogging.html#a3d82a6cc4ee43c589ad3775a435bd0d9">fizz::server::HandshakeLogging::clientRandom</a></div><div class="ttdeci">folly::Optional&lt; Random &gt; clientRandom</div><div class="ttdef"><b>Definition:</b> <a href="server_2State_8h_source.html#l00051">State.h:51</a></div></div>
<div class="ttc" id="classfizz_1_1server_1_1State_html_a914f13c66b77f66f43dc5192863570b3"><div class="ttname"><a href="classfizz_1_1server_1_1State.html#a914f13c66b77f66f43dc5192863570b3">fizz::server::State::readRecordLayer</a></div><div class="ttdeci">ReadRecordLayer * readRecordLayer() const </div><div class="ttdef"><b>Definition:</b> <a href="server_2State_8h_source.html#l00213">State.h:213</a></div></div>
<div class="ttc" id="structfizz_1_1server_1_1HandshakeLogging_html_ac388a900fc22587322b395b6e81fb389"><div class="ttname"><a href="structfizz_1_1server_1_1HandshakeLogging.html#ac388a900fc22587322b395b6e81fb389">fizz::server::HandshakeLogging::clientSni</a></div><div class="ttdeci">folly::Optional&lt; std::string &gt; clientSni</div><div class="ttdef"><b>Definition:</b> <a href="server_2State_8h_source.html#l00045">State.h:45</a></div></div>
<div class="ttc" id="structfizz_1_1server_1_1HandshakeLogging_html_af8ea77bbb8523dcf9b57eb7c12d05cd6"><div class="ttname"><a href="structfizz_1_1server_1_1HandshakeLogging.html#af8ea77bbb8523dcf9b57eb7c12d05cd6">fizz::server::HandshakeLogging::clientLegacyVersion</a></div><div class="ttdeci">folly::Optional&lt; ProtocolVersion &gt; clientLegacyVersion</div><div class="ttdef"><b>Definition:</b> <a href="server_2State_8h_source.html#l00040">State.h:40</a></div></div>
<div class="ttc" id="structfizz_1_1server_1_1HandshakeLogging_html_a00f64b157b20c5da4d59d383de4c0ccc"><div class="ttname"><a href="structfizz_1_1server_1_1HandshakeLogging.html#a00f64b157b20c5da4d59d383de4c0ccc">fizz::server::HandshakeLogging::clientSupportedVersions</a></div><div class="ttdeci">std::vector&lt; ProtocolVersion &gt; clientSupportedVersions</div><div class="ttdef"><b>Definition:</b> <a href="server_2State_8h_source.html#l00041">State.h:41</a></div></div>
<div class="ttc" id="structfizz_1_1server_1_1HandshakeLogging_html_aa3d355c5c4be24510ed4ef0b28b1a974"><div class="ttname"><a href="structfizz_1_1server_1_1HandshakeLogging.html#aa3d355c5c4be24510ed4ef0b28b1a974">fizz::server::HandshakeLogging::clientSignatureAlgorithms</a></div><div class="ttdeci">std::vector&lt; SignatureScheme &gt; clientSignatureAlgorithms</div><div class="ttdef"><b>Definition:</b> <a href="server_2State_8h_source.html#l00049">State.h:49</a></div></div>
<div class="ttc" id="classfizz_1_1server_1_1State_html_a7b686e41383374b12052d0d8e43b02d2"><div class="ttname"><a href="classfizz_1_1server_1_1State.html#a7b686e41383374b12052d0d8e43b02d2">fizz::server::State::handshakeLogging</a></div><div class="ttdeci">HandshakeLogging * handshakeLogging() const </div><div class="ttdef"><b>Definition:</b> <a href="server_2State_8h_source.html#l00193">State.h:193</a></div></div>
<div class="ttc" id="ExtensionsTest_8cpp_html_add4169bd6ee9aa37de918700cbc2938f"><div class="ttname"><a href="ExtensionsTest_8cpp.html#add4169bd6ee9aa37de918700cbc2938f">sni</a></div><div class="ttdeci">StringPiece sni</div><div class="ttdef"><b>Definition:</b> <a href="ExtensionsTest_8cpp_source.html#l00023">ExtensionsTest.cpp:23</a></div></div>
<div class="ttc" id="structfizz_1_1server_1_1HandshakeLogging_html_a4d1fc5f14ac57b0ae0a76c7639d9077b"><div class="ttname"><a href="structfizz_1_1server_1_1HandshakeLogging.html#a4d1fc5f14ac57b0ae0a76c7639d9077b">fizz::server::HandshakeLogging::clientExtensions</a></div><div class="ttdeci">std::vector&lt; ExtensionType &gt; clientExtensions</div><div class="ttdef"><b>Definition:</b> <a href="server_2State_8h_source.html#l00043">State.h:43</a></div></div>
<div class="ttc" id="structfizz_1_1server_1_1HandshakeLogging_html_aaa989152d03b6cea6d0165cd96eb2864"><div class="ttname"><a href="structfizz_1_1server_1_1HandshakeLogging.html#aaa989152d03b6cea6d0165cd96eb2864">fizz::server::HandshakeLogging::clientSupportedGroups</a></div><div class="ttdeci">std::vector&lt; NamedGroup &gt; clientSupportedGroups</div><div class="ttdef"><b>Definition:</b> <a href="server_2State_8h_source.html#l00046">State.h:46</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a3222cd5869d6a0fdb3a46ad9afc86b71"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static std::pair&lt;std::shared_ptr&lt;<a class="el" href="classfizz_1_1SelfCert.html">SelfCert</a>&gt;, <a class="el" href="namespacefizz.html#a1410cf02b9d3a95b34f9dbf22d372749">SignatureScheme</a>&gt; fizz::sm::chooseCert </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classfizz_1_1server_1_1FizzServerContext.html">FizzServerContext</a> &amp;&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structfizz_1_1ClientHello.html">ClientHello</a> &amp;&#160;</td>
          <td class="paramname"><em>chlo</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ServerProtocol_8cpp_source.html#l00891">891</a> of file <a class="el" href="ServerProtocol_8cpp_source.html">ServerProtocol.cpp</a>.</p>

<p>References <a class="el" href="fizz_2fizz_2record_2Types_8h_source.html#l00193">fizz::ClientHello::extensions</a>, <a class="el" href="FizzServerContext_8h_source.html#l00192">fizz::server::FizzServerContext::getCert()</a>, <a class="el" href="namespacefizz.html#a147eec03bf3a9683f4e214820a1f758aa79db796776246d2c3aaca8b375e662c4">fizz::handshake_failure</a>, <a class="el" href="namespacefizz.html#a147eec03bf3a9683f4e214820a1f758aac3adda9630b39fc3300eb2f1aa7209ed">fizz::missing_extension</a>, and <a class="el" href="ExtensionsTest_8cpp_source.html#l00023">sni</a>.</p>

<p>Referenced by <a class="el" href="ServerProtocol_8cpp_source.html#l00953">getCertificateRequest()</a>.</p>
<div class="fragment"><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;                             {</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span>&amp; clientSigSchemes =</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;      getExtension&lt;SignatureAlgorithms&gt;(<a class="code" href="HandshakeTypesTest_8cpp.html#aba518b904616df44c3d7dfde825a4c54">chlo</a>.extensions);</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;  <span class="keywordflow">if</span> (!clientSigSchemes) {</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;    <span class="keywordflow">throw</span> FizzException(<span class="stringliteral">&quot;no sig schemes&quot;</span>, AlertDescription::missing_extension);</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;  }</div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;  <a class="code" href="classfolly_1_1Optional.html">Optional&lt;std::string&gt;</a> <a class="code" href="ExtensionsTest_8cpp.html#add4169bd6ee9aa37de918700cbc2938f">sni</a>;</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;  <span class="keyword">auto</span> serverNameList = getExtension&lt;ServerNameList&gt;(<a class="code" href="HandshakeTypesTest_8cpp.html#aba518b904616df44c3d7dfde825a4c54">chlo</a>.extensions);</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;  <span class="keywordflow">if</span> (serverNameList &amp;&amp; !serverNameList-&gt;server_name_list.empty()) {</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;    sni = serverNameList-&gt;server_name_list.front()</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;              .hostname-&gt;moveToFbString()</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;              .toStdString();</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;  }</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;  <span class="keyword">auto</span> certAndScheme =</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;      context.<a class="code" href="classfizz_1_1server_1_1FizzServerContext.html#a712db46e5347fe045249cf976c46550e">getCert</a>(sni, clientSigSchemes-&gt;supported_signature_algorithms);</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;  <span class="keywordflow">if</span> (!certAndScheme) {</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;    <span class="keywordflow">throw</span> FizzException(</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;        <span class="stringliteral">&quot;could not find suitable cert&quot;</span>, AlertDescription::handshake_failure);</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;  }</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;  <span class="keywordflow">return</span> *certAndScheme;</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;}</div><div class="ttc" id="classfizz_1_1server_1_1FizzServerContext_html_a712db46e5347fe045249cf976c46550e"><div class="ttname"><a href="classfizz_1_1server_1_1FizzServerContext.html#a712db46e5347fe045249cf976c46550e">fizz::server::FizzServerContext::getCert</a></div><div class="ttdeci">folly::Optional&lt; std::pair&lt; std::shared_ptr&lt; SelfCert &gt;, SignatureScheme &gt; &gt; getCert(const folly::Optional&lt; std::string &gt; &amp;sni, const std::vector&lt; SignatureScheme &gt; &amp;peerSigSchemes) const </div><div class="ttdef"><b>Definition:</b> <a href="FizzServerContext_8h_source.html#l00192">FizzServerContext.h:192</a></div></div>
<div class="ttc" id="HandshakeTypesTest_8cpp_html_aba518b904616df44c3d7dfde825a4c54"><div class="ttname"><a href="HandshakeTypesTest_8cpp.html#aba518b904616df44c3d7dfde825a4c54">chlo</a></div><div class="ttdeci">static const std::string chlo</div><div class="ttdef"><b>Definition:</b> <a href="HandshakeTypesTest_8cpp_source.html#l00023">HandshakeTypesTest.cpp:23</a></div></div>
<div class="ttc" id="classfolly_1_1Optional_html"><div class="ttname"><a href="classfolly_1_1Optional.html">folly::Optional</a></div><div class="ttdef"><b>Definition:</b> <a href="Optional_8h_source.html#l00071">Optional.h:71</a></div></div>
<div class="ttc" id="ExtensionsTest_8cpp_html_add4169bd6ee9aa37de918700cbc2938f"><div class="ttname"><a href="ExtensionsTest_8cpp.html#add4169bd6ee9aa37de918700cbc2938f">sni</a></div><div class="ttdeci">StringPiece sni</div><div class="ttdef"><b>Definition:</b> <a href="ExtensionsTest_8cpp_source.html#l00023">ExtensionsTest.cpp:23</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ab2252ea6f82b291b35118344ff5134ae"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="namespacefizz.html#af020f21a568ff86800e03d6ad2a9b84d">Buf</a> fizz::sm::doKex </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classfizz_1_1Factory.html">Factory</a> &amp;&#160;</td>
          <td class="paramname"><em>factory</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacefizz.html#a11069edebaa08949c9a6696ef4bb85e2">NamedGroup</a>&#160;</td>
          <td class="paramname"><em>group</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespacefizz.html#af020f21a568ff86800e03d6ad2a9b84d">Buf</a> &amp;&#160;</td>
          <td class="paramname"><em>clientShare</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classfizz_1_1KeyScheduler.html">KeyScheduler</a> &amp;&#160;</td>
          <td class="paramname"><em>scheduler</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ServerProtocol_8cpp_source.html#l00659">659</a> of file <a class="el" href="ServerProtocol_8cpp_source.html">ServerProtocol.cpp</a>.</p>

<p>References <a class="el" href="KeyScheduler_8cpp_source.html#l00041">fizz::KeyScheduler::deriveHandshakeSecret()</a>, and <a class="el" href="Factory_8h_source.html#l00090">fizz::Factory::makeKeyExchange()</a>.</p>

<p>Referenced by <a class="el" href="ServerProtocol_8cpp_source.html#l00953">getCertificateRequest()</a>.</p>
<div class="fragment"><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;                             {</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;  <span class="keyword">auto</span> kex = factory.makeKeyExchange(<a class="code" href="ClientProtocol_8cpp.html#a100fbfdcc383ea1165570b83a874c0e0">group</a>);</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;  kex-&gt;generateKeyPair();</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;  <span class="keyword">auto</span> sharedSecret = kex-&gt;generateSharedSecret(clientShare-&gt;coalesce());</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;  <a class="code" href="FilePoller_8cpp.html#af8aa2314425a86a160127ccd900704f8">scheduler</a>.deriveHandshakeSecret(sharedSecret-&gt;coalesce());</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;  <span class="keywordflow">return</span> kex-&gt;getKeyShare();</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;}</div><div class="ttc" id="FilePoller_8cpp_html_af8aa2314425a86a160127ccd900704f8"><div class="ttname"><a href="FilePoller_8cpp.html#af8aa2314425a86a160127ccd900704f8">scheduler</a></div><div class="ttdeci">std::shared_ptr&lt; folly::FunctionScheduler &gt; scheduler</div><div class="ttdef"><b>Definition:</b> <a href="FilePoller_8cpp_source.html#l00050">FilePoller.cpp:50</a></div></div>
<div class="ttc" id="ClientProtocol_8cpp_html_a100fbfdcc383ea1165570b83a874c0e0"><div class="ttname"><a href="ClientProtocol_8cpp.html#a100fbfdcc383ea1165570b83a874c0e0">group</a></div><div class="ttdeci">Optional&lt; NamedGroup &gt; group</div><div class="ttdef"><b>Definition:</b> <a href="ClientProtocol_8cpp_source.html#l01007">ClientProtocol.cpp:1007</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ac149c92413a5d39358c39ee5530accf0"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="namespacefizz.html#af020f21a568ff86800e03d6ad2a9b84d">Buf</a> fizz::sm::encodeAndAddBinders </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structfizz_1_1ClientHello.html">ClientHello</a>&#160;</td>
          <td class="paramname"><em>chlo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structfizz_1_1client_1_1CachedPsk.html">CachedPsk</a> &amp;&#160;</td>
          <td class="paramname"><em>psk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classfizz_1_1KeyScheduler.html">KeyScheduler</a> &amp;&#160;</td>
          <td class="paramname"><em>scheduler</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classfizz_1_1HandshakeContext.html">HandshakeContext</a> &amp;&#160;</td>
          <td class="paramname"><em>handshakeContext</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Returns the encoded client hello after updating the binder.</p>
<p>Will derive the early secret on the key scheduler and append the client hello to the handshake context. </p>

<p>Definition at line <a class="el" href="ClientProtocol_8cpp_source.html#l00452">452</a> of file <a class="el" href="ClientProtocol_8cpp_source.html">ClientProtocol.cpp</a>.</p>

<p>References <a class="el" href="IOBufQueue_8cpp_source.html#l00143">folly::IOBufQueue::append()</a>, <a class="el" href="classfizz_1_1HandshakeContext.html#a5a9aa3245a54ccfec4a44bd2fdbd7ac8">fizz::HandshakeContext::appendToTranscript()</a>, <a class="el" href="Extensions_8h_source.html#l00060">fizz::PskBinder::binder</a>, <a class="el" href="IOBufQueue_8h_source.html#l00083">folly::IOBufQueue::cacheChainLength()</a>, <a class="el" href="IOBufQueue_8h_source.html#l00492">folly::IOBufQueue::chainLength()</a>, <a class="el" href="KeyScheduler_8cpp_source.html#l00032">fizz::KeyScheduler::deriveEarlySecret()</a>, <a class="el" href="extensions_2tokenbinding_2Types_8cpp_source.html#l00113">fizz::encodeExtension()</a>, <a class="el" href="Types-inl_8h_source.html#l00515">fizz::encodeHandshake()</a>, <a class="el" href="fizz_2fizz_2record_2Types_8h_source.html#l00193">fizz::ClientHello::extensions</a>, <a class="el" href="namespacefizz.html#ab017b61ecd944032c374d31740161131ab206a1b4ea1097761f78e8876f6da779">fizz::External</a>, <a class="el" href="namespacefizz.html#a9d0163dd2203bcf4649a864a2bde8343af4382706ea7c944a59d51f78de085266">fizz::ExternalPskBinder</a>, <a class="el" href="Extensions-inl_8h_source.html#l00354">fizz::getBinderLength()</a>, <a class="el" href="classfizz_1_1HandshakeContext.html#a866e8afdee84ac76ea9a43d93d910e46">fizz::HandshakeContext::getBlankContext()</a>, <a class="el" href="classfizz_1_1HandshakeContext.html#aca30b1432be73ee4187e82d860ab0dee">fizz::HandshakeContext::getFinishedData()</a>, <a class="el" href="ClientProtocol_8cpp_source.html#l00427">getPskExtension()</a>, <a class="el" href="KeyScheduler_8cpp_source.html#l00114">fizz::KeyScheduler::getSecret()</a>, <a class="el" href="IOBufQueue_8h_source.html#l00459">folly::IOBufQueue::move()</a>, <a class="el" href="Base-inl_8h_source.html#l02567">folly::gen::move</a>, <a class="el" href="Range_8h_source.html#l01114">folly::range()</a>, <a class="el" href="namespacefizz.html#a9d0163dd2203bcf4649a864a2bde8343a34513d7b3f018af52652c52974627e63">fizz::ResumptionPskBinder</a>, <a class="el" href="PskCache_8h_source.html#l00022">fizz::client::CachedPsk::secret</a>, <a class="el" href="IOBufQueue_8h_source.html#l00420">folly::IOBufQueue::split()</a>, and <a class="el" href="PskCache_8h_source.html#l00023">fizz::client::CachedPsk::type</a>.</p>

<p>Referenced by <a class="el" href="ClientProtocol_8cpp_source.html#l00498">getEarlyDataParams()</a>, and <a class="el" href="ClientProtocol_8cpp_source.html#l01036">getHrrKeyExchangers()</a>.</p>
<div class="fragment"><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;                                        {</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;  <a class="code" href="FilePoller_8cpp.html#af8aa2314425a86a160127ccd900704f8">scheduler</a>.deriveEarlySecret(<a class="code" href="namespacefolly.html#a79a54cd1a19a22878c86be5f90a33643">folly::range</a>(psk.<a class="code" href="structfizz_1_1client_1_1CachedPsk.html#aab513bd12865ea702f860793a11d7a50">secret</a>));</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;  <span class="keyword">auto</span> binderKey = <a class="code" href="FilePoller_8cpp.html#af8aa2314425a86a160127ccd900704f8">scheduler</a>.getSecret(</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;      psk.<a class="code" href="structfizz_1_1client_1_1CachedPsk.html#a985bf605b72a739c181a6de5ec506d1f">type</a> == PskType::External ? EarlySecrets::ExternalPskBinder</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;                                    : EarlySecrets::ResumptionPskBinder,</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;      handshakeContext.getBlankContext());</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;  <span class="keyword">auto</span> pskExt = <a class="code" href="namespacefizz_1_1sm.html#a59b0297c4633d263313e4447852413fc">getPskExtension</a>(psk);</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;  <a class="code" href="HandshakeTypesTest_8cpp.html#aba518b904616df44c3d7dfde825a4c54">chlo</a>.extensions.push_back(<a class="code" href="namespacefizz.html#af6485298511d0a74eb07b27570e62378">encodeExtension</a>(pskExt));</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;  <span class="keywordtype">size_t</span> binderLength = <a class="code" href="namespacefizz.html#aebe96b30473a27e492b63cb870a9695d">getBinderLength</a>(<a class="code" href="HandshakeTypesTest_8cpp.html#aba518b904616df44c3d7dfde825a4c54">chlo</a>);</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;  <span class="keyword">auto</span> preEncoded = <a class="code" href="namespacefizz.html#a1fef0ecdfd4a6c07fd32b5dd0dcb2b23">encodeHandshake</a>(<a class="code" href="HandshakeTypesTest_8cpp.html#aba518b904616df44c3d7dfde825a4c54">chlo</a>);</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;  <span class="comment">// Add the ClientHello up to the binder list to the transcript.</span></div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;  {</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    <a class="code" href="classfolly_1_1IOBufQueue.html">folly::IOBufQueue</a> chloQueue(<a class="code" href="classfolly_1_1IOBufQueue.html#a5c33b90ce5e034f00043394564f295da">folly::IOBufQueue::cacheChainLength</a>());</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    chloQueue.append(<a class="code" href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">std::move</a>(preEncoded));</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    <span class="keyword">auto</span> chloPrefix = chloQueue.split(chloQueue.chainLength() - binderLength);</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    handshakeContext.appendToTranscript(chloPrefix);</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;  }</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;  PskBinder binder;</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;  binder.binder = handshakeContext.getFinishedData(<a class="code" href="namespacefolly.html#a79a54cd1a19a22878c86be5f90a33643">folly::range</a>(binderKey));</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;  pskExt.binders.clear();</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;  pskExt.binders.push_back(<a class="code" href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">std::move</a>(binder));</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;  <a class="code" href="HandshakeTypesTest_8cpp.html#aba518b904616df44c3d7dfde825a4c54">chlo</a>.extensions.pop_back();</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;  <a class="code" href="HandshakeTypesTest_8cpp.html#aba518b904616df44c3d7dfde825a4c54">chlo</a>.extensions.push_back(<a class="code" href="namespacefizz.html#af6485298511d0a74eb07b27570e62378">encodeExtension</a>(<a class="code" href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">std::move</a>(pskExt)));</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;  <span class="keyword">auto</span> encoded = <a class="code" href="namespacefizz.html#a1fef0ecdfd4a6c07fd32b5dd0dcb2b23">encodeHandshake</a>(<a class="code" href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">std::move</a>(<a class="code" href="HandshakeTypesTest_8cpp.html#aba518b904616df44c3d7dfde825a4c54">chlo</a>));</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;  <span class="comment">// Add the binder list to the transcript.</span></div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;  <a class="code" href="classfolly_1_1IOBufQueue.html">folly::IOBufQueue</a> chloQueue(<a class="code" href="classfolly_1_1IOBufQueue.html#a5c33b90ce5e034f00043394564f295da">folly::IOBufQueue::cacheChainLength</a>());</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;  chloQueue.append(encoded-&gt;clone());</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;  chloQueue.split(chloQueue.chainLength() - binderLength);</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;  handshakeContext.appendToTranscript(chloQueue.move());</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;  <span class="keywordflow">return</span> encoded;</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;}</div><div class="ttc" id="namespacefizz_html_a1fef0ecdfd4a6c07fd32b5dd0dcb2b23"><div class="ttname"><a href="namespacefizz.html#a1fef0ecdfd4a6c07fd32b5dd0dcb2b23">fizz::encodeHandshake</a></div><div class="ttdeci">Buf encodeHandshake(T &amp;&amp;handshakeMsg)</div><div class="ttdef"><b>Definition:</b> <a href="Types-inl_8h_source.html#l00515">Types-inl.h:515</a></div></div>
<div class="ttc" id="namespacefizz_html_aebe96b30473a27e492b63cb870a9695d"><div class="ttname"><a href="namespacefizz.html#aebe96b30473a27e492b63cb870a9695d">fizz::getBinderLength</a></div><div class="ttdeci">size_t getBinderLength(const ClientHello &amp;chlo)</div><div class="ttdef"><b>Definition:</b> <a href="Extensions-inl_8h_source.html#l00354">Extensions-inl.h:354</a></div></div>
<div class="ttc" id="HandshakeTypesTest_8cpp_html_aba518b904616df44c3d7dfde825a4c54"><div class="ttname"><a href="HandshakeTypesTest_8cpp.html#aba518b904616df44c3d7dfde825a4c54">chlo</a></div><div class="ttdeci">static const std::string chlo</div><div class="ttdef"><b>Definition:</b> <a href="HandshakeTypesTest_8cpp_source.html#l00023">HandshakeTypesTest.cpp:23</a></div></div>
<div class="ttc" id="namespacefolly_1_1gen_html_ac24ec252b1b738a40c274285527c193f"><div class="ttname"><a href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">folly::gen::move</a></div><div class="ttdeci">constexpr detail::Map&lt; Move &gt; move</div><div class="ttdef"><b>Definition:</b> <a href="Base-inl_8h_source.html#l02567">Base-inl.h:2567</a></div></div>
<div class="ttc" id="FilePoller_8cpp_html_af8aa2314425a86a160127ccd900704f8"><div class="ttname"><a href="FilePoller_8cpp.html#af8aa2314425a86a160127ccd900704f8">scheduler</a></div><div class="ttdeci">std::shared_ptr&lt; folly::FunctionScheduler &gt; scheduler</div><div class="ttdef"><b>Definition:</b> <a href="FilePoller_8cpp_source.html#l00050">FilePoller.cpp:50</a></div></div>
<div class="ttc" id="classfolly_1_1IOBufQueue_html_a5c33b90ce5e034f00043394564f295da"><div class="ttname"><a href="classfolly_1_1IOBufQueue.html#a5c33b90ce5e034f00043394564f295da">folly::IOBufQueue::cacheChainLength</a></div><div class="ttdeci">static Options cacheChainLength()</div><div class="ttdef"><b>Definition:</b> <a href="IOBufQueue_8h_source.html#l00083">IOBufQueue.h:83</a></div></div>
<div class="ttc" id="structfizz_1_1client_1_1CachedPsk_html_aab513bd12865ea702f860793a11d7a50"><div class="ttname"><a href="structfizz_1_1client_1_1CachedPsk.html#aab513bd12865ea702f860793a11d7a50">fizz::client::CachedPsk::secret</a></div><div class="ttdeci">std::string secret</div><div class="ttdef"><b>Definition:</b> <a href="PskCache_8h_source.html#l00022">PskCache.h:22</a></div></div>
<div class="ttc" id="namespacefolly_html_a79a54cd1a19a22878c86be5f90a33643"><div class="ttname"><a href="namespacefolly.html#a79a54cd1a19a22878c86be5f90a33643">folly::range</a></div><div class="ttdeci">constexpr Range&lt; Iter &gt; range(Iter first, Iter last)</div><div class="ttdef"><b>Definition:</b> <a href="Range_8h_source.html#l01114">Range.h:1114</a></div></div>
<div class="ttc" id="classfolly_1_1IOBufQueue_html"><div class="ttname"><a href="classfolly_1_1IOBufQueue.html">folly::IOBufQueue</a></div><div class="ttdef"><b>Definition:</b> <a href="IOBufQueue_8h_source.html#l00035">IOBufQueue.h:35</a></div></div>
<div class="ttc" id="namespacefizz_1_1sm_html_a59b0297c4633d263313e4447852413fc"><div class="ttname"><a href="namespacefizz_1_1sm.html#a59b0297c4633d263313e4447852413fc">fizz::sm::getPskExtension</a></div><div class="ttdeci">static ClientPresharedKey getPskExtension(const CachedPsk &amp;psk)</div><div class="ttdef"><b>Definition:</b> <a href="ClientProtocol_8cpp_source.html#l00427">ClientProtocol.cpp:427</a></div></div>
<div class="ttc" id="namespacefizz_html_af6485298511d0a74eb07b27570e62378"><div class="ttname"><a href="namespacefizz.html#af6485298511d0a74eb07b27570e62378">fizz::encodeExtension</a></div><div class="ttdeci">Extension encodeExtension(const TokenBindingParameters &amp;params)</div><div class="ttdef"><b>Definition:</b> <a href="extensions_2tokenbinding_2Types_8cpp_source.html#l00113">Types.cpp:113</a></div></div>
<div class="ttc" id="structfizz_1_1client_1_1CachedPsk_html_a985bf605b72a739c181a6de5ec506d1f"><div class="ttname"><a href="structfizz_1_1client_1_1CachedPsk.html#a985bf605b72a739c181a6de5ec506d1f">fizz::client::CachedPsk::type</a></div><div class="ttdeci">PskType type</div><div class="ttdef"><b>Definition:</b> <a href="PskCache_8h_source.html#l00023">PskCache.h:23</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a67fe5b94d4a788b7ad0a914f5f1629fb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">fizz::sm::FIZZ_DECLARE_EVENT_HANDLER </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structfizz_1_1client_1_1ClientTypes.html">ClientTypes</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">StateEnum::Uninitialized&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacefizz.html#a1135430496a56ed55bdfc4a77ccb35fba49ab28040dfa07f53544970c6d147e1e">Event::Connect</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">StateEnum::ExpectingServerHello&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="aa432ce5dd0f7cf32750942d518e24537"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">fizz::sm::FIZZ_DECLARE_EVENT_HANDLER </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structfizz_1_1client_1_1ClientTypes.html">ClientTypes</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">StateEnum::ExpectingServerHello&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacefizz.html#a1135430496a56ed55bdfc4a77ccb35fba51ad30e8de321aca8d16fe7a2d9f62c5">Event::HelloRetryRequest</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">StateEnum::ExpectingServerHello&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a407fa00fdc598f9f8a460c4add05187e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">fizz::sm::FIZZ_DECLARE_EVENT_HANDLER </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structfizz_1_1server_1_1ServerTypes.html">ServerTypes</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">StateEnum::Uninitialized&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacefizz.html#a1135430496a56ed55bdfc4a77ccb35fbac4408d335012a56ff58937d78050efad">Event::Accept</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">StateEnum::ExpectingClientHello&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="aa1d144bfaacab1a145ea43dd0b2aa076"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">fizz::sm::FIZZ_DECLARE_EVENT_HANDLER </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structfizz_1_1client_1_1ClientTypes.html">ClientTypes</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">StateEnum::ExpectingServerHello&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacefizz.html#a1135430496a56ed55bdfc4a77ccb35fbae9540adbf7cbc0f41bcadaedcd0aba77">Event::ServerHello</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">StateEnum::ExpectingEncryptedExtensions&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a8eb0cb46d51aefea64e1d3c38a197cce"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">fizz::sm::FIZZ_DECLARE_EVENT_HANDLER </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structfizz_1_1server_1_1ServerTypes.html">ServerTypes</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">StateEnum::ExpectingClientHello&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacefizz.html#a1135430496a56ed55bdfc4a77ccb35fba6c9bc94067a94a346562a06539fc68c2">Event::ClientHello</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">StateEnum::ExpectingClientHello&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">StateEnum::ExpectingCertificate&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">StateEnum::ExpectingFinished&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">StateEnum::AcceptingEarlyData&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="TraceFieldType_8txt.html#a1f3f354b00fe1430d9c1002be04264a9">StateEnum::Error</a>&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a20540afd4898438b2779d6582bbda0de"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">fizz::sm::FIZZ_DECLARE_EVENT_HANDLER </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structfizz_1_1client_1_1ClientTypes.html">ClientTypes</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">StateEnum::ExpectingServerHello&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacefizz.html#a1135430496a56ed55bdfc4a77ccb35fba47a1bca7303595211ec9f86e386b364f">Event::EarlyAppWrite</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="TraceFieldType_8txt.html#a1f3f354b00fe1430d9c1002be04264a9">StateEnum::Error</a>&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a4112e6ae8909a18e9fb4442be2fb4958"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">fizz::sm::FIZZ_DECLARE_EVENT_HANDLER </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structfizz_1_1client_1_1ClientTypes.html">ClientTypes</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">StateEnum::ExpectingEncryptedExtensions&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacefizz.html#a1135430496a56ed55bdfc4a77ccb35fbaf36aecb2d027d9ed8fc384235422899f">Event::EncryptedExtensions</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">StateEnum::ExpectingCertificate&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">StateEnum::ExpectingFinished&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="aa93d8bd3334c9a2bf8598157e706acef"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">fizz::sm::FIZZ_DECLARE_EVENT_HANDLER </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structfizz_1_1server_1_1ServerTypes.html">ServerTypes</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">StateEnum::AcceptingEarlyData&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacefizz.html#a1135430496a56ed55bdfc4a77ccb35fba068ed5f36c096c0d86fee9b0cd2aec01">Event::AppData</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="TraceFieldType_8txt.html#a1f3f354b00fe1430d9c1002be04264a9">StateEnum::Error</a>&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="af83b1df2e2ff0f5dcbb42207ebf5b7e3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">fizz::sm::FIZZ_DECLARE_EVENT_HANDLER </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structfizz_1_1server_1_1ServerTypes.html">ServerTypes</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">StateEnum::AcceptingEarlyData&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacefizz.html#a1135430496a56ed55bdfc4a77ccb35fbaeed31df3f971bee9af441382c6c1e272">Event::AppWrite</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="TraceFieldType_8txt.html#a1f3f354b00fe1430d9c1002be04264a9">StateEnum::Error</a>&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="aa1964ee9afe64372f2810d1dc41f27bf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">fizz::sm::FIZZ_DECLARE_EVENT_HANDLER </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structfizz_1_1client_1_1ClientTypes.html">ClientTypes</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">StateEnum::ExpectingEncryptedExtensions&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacefizz.html#a1135430496a56ed55bdfc4a77ccb35fba47a1bca7303595211ec9f86e386b364f">Event::EarlyAppWrite</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="TraceFieldType_8txt.html#a1f3f354b00fe1430d9c1002be04264a9">StateEnum::Error</a>&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a62d61788fc4c97703b4ef438d63caff5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">fizz::sm::FIZZ_DECLARE_EVENT_HANDLER </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structfizz_1_1server_1_1ServerTypes.html">ServerTypes</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">StateEnum::AcceptingEarlyData&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacefizz.html#a1135430496a56ed55bdfc4a77ccb35fbaa721941f5b643b5e34853abce82db763">Event::EndOfEarlyData</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">StateEnum::ExpectingFinished&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a59c89ac3e67645abd7fba272838e24c2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">fizz::sm::FIZZ_DECLARE_EVENT_HANDLER </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structfizz_1_1client_1_1ClientTypes.html">ClientTypes</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">StateEnum::ExpectingCertificate&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacefizz.html#a1135430496a56ed55bdfc4a77ccb35fbabb861a7fa47a1dbce10ce727453e054f">Event::CertificateRequest</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">StateEnum::ExpectingCertificate&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="aec9574ff6a99c5b3186f49e28d720de8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">fizz::sm::FIZZ_DECLARE_EVENT_HANDLER </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structfizz_1_1client_1_1ClientTypes.html">ClientTypes</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">StateEnum::ExpectingCertificate&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacefizz.html#a1135430496a56ed55bdfc4a77ccb35fbaeb0f48a107df1a0f343d4cd513b555e6">Event::Certificate</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">StateEnum::ExpectingCertificateVerify&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a78a8bd43dfd829e4a8ac25d7dc463b36"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">fizz::sm::FIZZ_DECLARE_EVENT_HANDLER </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structfizz_1_1server_1_1ServerTypes.html">ServerTypes</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">StateEnum::ExpectingCertificate&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacefizz.html#a1135430496a56ed55bdfc4a77ccb35fbaeb0f48a107df1a0f343d4cd513b555e6">Event::Certificate</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">StateEnum::ExpectingCertificateVerify&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">StateEnum::ExpectingFinished&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a86123a7eeed7308070e711decf324b89"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">fizz::sm::FIZZ_DECLARE_EVENT_HANDLER </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structfizz_1_1client_1_1ClientTypes.html">ClientTypes</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">StateEnum::ExpectingCertificate&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacefizz.html#a1135430496a56ed55bdfc4a77ccb35fba3f5a8d119f352c5d1814151dae409dfc">Event::CompressedCertificate</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">StateEnum::ExpectingCertificateVerify&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a852d73976106b6e867cee97de0ffe4f4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">fizz::sm::FIZZ_DECLARE_EVENT_HANDLER </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structfizz_1_1client_1_1ClientTypes.html">ClientTypes</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">StateEnum::ExpectingCertificate&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacefizz.html#a1135430496a56ed55bdfc4a77ccb35fba47a1bca7303595211ec9f86e386b364f">Event::EarlyAppWrite</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="TraceFieldType_8txt.html#a1f3f354b00fe1430d9c1002be04264a9">StateEnum::Error</a>&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a20a668c9f22abc91bcf5b5b12c23773e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">fizz::sm::FIZZ_DECLARE_EVENT_HANDLER </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structfizz_1_1server_1_1ServerTypes.html">ServerTypes</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">StateEnum::ExpectingFinished&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacefizz.html#a1135430496a56ed55bdfc4a77ccb35fbaeed31df3f971bee9af441382c6c1e272">Event::AppWrite</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="TraceFieldType_8txt.html#a1f3f354b00fe1430d9c1002be04264a9">StateEnum::Error</a>&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a6825414067f97bf47a6a415b904659ac"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">fizz::sm::FIZZ_DECLARE_EVENT_HANDLER </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structfizz_1_1client_1_1ClientTypes.html">ClientTypes</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">StateEnum::ExpectingCertificateVerify&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacefizz.html#a1135430496a56ed55bdfc4a77ccb35fba9827062845b39dfab4ecab4c13a6722a">Event::CertificateVerify</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">StateEnum::ExpectingFinished&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a44ff9dde09c0f844ad715237fa4341c6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">fizz::sm::FIZZ_DECLARE_EVENT_HANDLER </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structfizz_1_1server_1_1ServerTypes.html">ServerTypes</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">StateEnum::ExpectingFinished&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacefizz.html#a1135430496a56ed55bdfc4a77ccb35fba8f3d10eb21bd36347c258679eba9e92b">Event::Finished</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">StateEnum::AcceptingData&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a8dc56e803ba5f0b21ef373ece5649efc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">fizz::sm::FIZZ_DECLARE_EVENT_HANDLER </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structfizz_1_1client_1_1ClientTypes.html">ClientTypes</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">StateEnum::ExpectingCertificateVerify&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacefizz.html#a1135430496a56ed55bdfc4a77ccb35fba47a1bca7303595211ec9f86e386b364f">Event::EarlyAppWrite</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="TraceFieldType_8txt.html#a1f3f354b00fe1430d9c1002be04264a9">StateEnum::Error</a>&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="aee5b92bb225776087a793a2c3dca4c49"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">fizz::sm::FIZZ_DECLARE_EVENT_HANDLER </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structfizz_1_1server_1_1ServerTypes.html">ServerTypes</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">StateEnum::AcceptingData&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacefizz.html#a1135430496a56ed55bdfc4a77ccb35fbad36da62dfdcc7f2a272f558c7895ce44">Event::WriteNewSessionTicket</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="TraceFieldType_8txt.html#a1f3f354b00fe1430d9c1002be04264a9">StateEnum::Error</a>&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ac9979f9d28ac923772bb7eac153dd7d7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">fizz::sm::FIZZ_DECLARE_EVENT_HANDLER </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structfizz_1_1client_1_1ClientTypes.html">ClientTypes</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">StateEnum::ExpectingFinished&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacefizz.html#a1135430496a56ed55bdfc4a77ccb35fba8f3d10eb21bd36347c258679eba9e92b">Event::Finished</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">StateEnum::Established&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a4f2420a2f7c4cce2f744f2a6ba1f6c2f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">fizz::sm::FIZZ_DECLARE_EVENT_HANDLER </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structfizz_1_1server_1_1ServerTypes.html">ServerTypes</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">StateEnum::AcceptingData&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacefizz.html#a1135430496a56ed55bdfc4a77ccb35fba068ed5f36c096c0d86fee9b0cd2aec01">Event::AppData</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="TraceFieldType_8txt.html#a1f3f354b00fe1430d9c1002be04264a9">StateEnum::Error</a>&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="aa86523b057dbdd1cb33341f5c255fe31"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">fizz::sm::FIZZ_DECLARE_EVENT_HANDLER </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structfizz_1_1client_1_1ClientTypes.html">ClientTypes</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">StateEnum::ExpectingFinished&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacefizz.html#a1135430496a56ed55bdfc4a77ccb35fba47a1bca7303595211ec9f86e386b364f">Event::EarlyAppWrite</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="TraceFieldType_8txt.html#a1f3f354b00fe1430d9c1002be04264a9">StateEnum::Error</a>&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a51863826a80f499cbd4307586af83b4b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">fizz::sm::FIZZ_DECLARE_EVENT_HANDLER </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structfizz_1_1server_1_1ServerTypes.html">ServerTypes</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">StateEnum::AcceptingData&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacefizz.html#a1135430496a56ed55bdfc4a77ccb35fbaeed31df3f971bee9af441382c6c1e272">Event::AppWrite</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="TraceFieldType_8txt.html#a1f3f354b00fe1430d9c1002be04264a9">StateEnum::Error</a>&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="af62004d9beee9533fed5aa2665a0445f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">fizz::sm::FIZZ_DECLARE_EVENT_HANDLER </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structfizz_1_1client_1_1ClientTypes.html">ClientTypes</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">StateEnum::Established&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacefizz.html#a1135430496a56ed55bdfc4a77ccb35fba47a1bca7303595211ec9f86e386b364f">Event::EarlyAppWrite</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="TraceFieldType_8txt.html#a1f3f354b00fe1430d9c1002be04264a9">StateEnum::Error</a>&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a863c4e4230356170d4a51d088a167d9f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">fizz::sm::FIZZ_DECLARE_EVENT_HANDLER </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structfizz_1_1server_1_1ServerTypes.html">ServerTypes</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">StateEnum::AcceptingData&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacefizz.html#a1135430496a56ed55bdfc4a77ccb35fbaa175bae4a622096eb215c37b84c56837">Event::KeyUpdate</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">StateEnum::AcceptingData&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a3b3fd5ae4ee1920c8fac11f1e94f482c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">fizz::sm::FIZZ_DECLARE_EVENT_HANDLER </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structfizz_1_1client_1_1ClientTypes.html">ClientTypes</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">StateEnum::Established&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacefizz.html#a1135430496a56ed55bdfc4a77ccb35fbae94ec29c1c92594130e418b7d1972cda">Event::NewSessionTicket</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="TraceFieldType_8txt.html#a1f3f354b00fe1430d9c1002be04264a9">StateEnum::Error</a>&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a5ae50cf2c3f7a18511839ec2ab0cd99b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">fizz::sm::FIZZ_DECLARE_EVENT_HANDLER </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structfizz_1_1client_1_1ClientTypes.html">ClientTypes</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">StateEnum::Established&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacefizz.html#a1135430496a56ed55bdfc4a77ccb35fba068ed5f36c096c0d86fee9b0cd2aec01">Event::AppData</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="TraceFieldType_8txt.html#a1f3f354b00fe1430d9c1002be04264a9">StateEnum::Error</a>&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a7d1ed3d20b42dc451ef18c5fc988f2d8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">fizz::sm::FIZZ_DECLARE_EVENT_HANDLER </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structfizz_1_1client_1_1ClientTypes.html">ClientTypes</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">StateEnum::Established&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacefizz.html#a1135430496a56ed55bdfc4a77ccb35fbaeed31df3f971bee9af441382c6c1e272">Event::AppWrite</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="TraceFieldType_8txt.html#a1f3f354b00fe1430d9c1002be04264a9">StateEnum::Error</a>&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a0ac4a69cfcae3993bb2b3a868c7280d4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">fizz::sm::FIZZ_DECLARE_EVENT_HANDLER </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structfizz_1_1client_1_1ClientTypes.html">ClientTypes</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">StateEnum::Established&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacefizz.html#a1135430496a56ed55bdfc4a77ccb35fbaa175bae4a622096eb215c37b84c56837">Event::KeyUpdate</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="TraceFieldType_8txt.html#a1f3f354b00fe1430d9c1002be04264a9">StateEnum::Error</a>&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="aa8528d02dcd2f7fcd8505a80acaa741f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="classfolly_1_1Future.html">Future</a>&lt;<a class="el" href="classfolly_1_1Optional.html">Optional</a>&lt;<a class="el" href="structfizz_1_1WriteToSocket.html">WriteToSocket</a>&gt; &gt; fizz::sm::generateTicket </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classfizz_1_1server_1_1State.html">State</a> &amp;&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="ConstexprMathBenchmark_8cpp.html#ae1affc9ca37cfb624959c866a73f83c2">uint8_t</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>resumptionMasterSecret</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacefizz.html#af020f21a568ff86800e03d6ad2a9b84d">Buf</a>&#160;</td>
          <td class="paramname"><em>appToken</em> = <code><a class="el" href="http__parser__cpp_8cpp.html#ab979d9d4b4923f7c54d6caa6e1a61936">nullptr</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ServerProtocol_8cpp_source.html#l01641">1641</a> of file <a class="el" href="ServerProtocol_8cpp_source.html">ServerProtocol.cpp</a>.</p>

<p>References <a class="el" href="namespacefizz_1_1server.html#ab796c23673942d9f8fdd74f8d33cb364a83d319acd4f7d3ddaccc684d484ddb27">fizz::server::AcceptingData</a>, <a class="el" href="server_2Actions_8h_source.html#l00057">fizz::server::detail::actions()</a>, <a class="el" href="ResumptionState_8h_source.html#l00026">fizz::server::ResumptionState::alpn</a>, <a class="el" href="server_2State_8h_source.html#l00168">fizz::server::State::alpn()</a>, <a class="el" href="ResumptionState_8h_source.html#l00029">fizz::server::ResumptionState::appToken</a>, <a class="el" href="namespacefizz.html#a2d0a99663f1db37e8420c978fd7e8f94afc945c3d5cf8f14213002525c45a6fbb">fizz::AppTraffic</a>, <a class="el" href="FizzBaseTest_8cpp_source.html#l00030">fizz::test::appWrite()</a>, <a class="el" href="namespacefizz.html#a147eec03bf3a9683f4e214820a1f758aaa122ea521767a141ab57b4d536bd096b">fizz::bad_certificate</a>, <a class="el" href="Params_8h_source.html#l00053">fizz::AppWrite::callback</a>, <a class="el" href="namespacefizz.html#a147eec03bf3a9683f4e214820a1f758aa61b36abfb2334b2d9435043a7dd32d79">fizz::certificate_required</a>, <a class="el" href="namespacefizz.html#a1135430496a56ed55bdfc4a77ccb35fba9827062845b39dfab4ecab4c13a6722a">fizz::CertificateVerify</a>, <a class="el" href="ResumptionState_8h_source.html#l00021">fizz::server::ResumptionState::cipher</a>, <a class="el" href="server_2State_8h_source.html#l00111">fizz::server::State::cipher()</a>, <a class="el" href="KeyScheduler_8cpp_source.html#l00085">fizz::KeyScheduler::clearMasterSecret()</a>, <a class="el" href="namespacefizz.html#ac1a57c6c1e0a9f90d1777788a3b513b9a577d7068826de925ea2aec01dbadf5e4">fizz::Client</a>, <a class="el" href="namespacefizz.html#ad4370192b1570b3bd64f596f674f7637a252f4f2f302b23186cf414bb5b0625c5">fizz::ClientAppTraffic</a>, <a class="el" href="ResumptionState_8h_source.html#l00024">fizz::server::ResumptionState::clientCert</a>, <a class="el" href="server_2State_8h_source.html#l00097">fizz::server::State::clientCert()</a>, <a class="el" href="server_2State_8h_source.html#l00232">fizz::server::State::clientHandshakeSecret()</a>, <a class="el" href="KeyScheduler_8cpp_source.html#l00090">fizz::KeyScheduler::clientKeyUpdate()</a>, <a class="el" href="protocol_2Actions_8h_source.html#l00041">fizz::WriteToSocket::contents</a>, <a class="el" href="server_2State_8h_source.html#l00083">fizz::server::State::context()</a>, <a class="el" href="IOBuf_8h_source.html#l01587">folly::IOBuf::copyBuffer()</a>, <a class="el" href="IOBuf_8cpp_source.html#l00229">folly::IOBuf::create()</a>, <a class="el" href="Params_8h_source.html#l00054">fizz::AppWrite::data</a>, <a class="el" href="Utils_8cpp_source.html#l00031">fizz::CryptoUtils::equal()</a>, <a class="el" href="server_2State_8h_source.html#l00076">fizz::server::State::executor()</a>, <a class="el" href="namespacefizz_1_1server.html#ab796c23673942d9f8fdd74f8d33cb364a10442ba0695d86de1da950031278053a">fizz::server::ExpectingCertificateVerify</a>, <a class="el" href="namespacefizz.html#a5ab3664effa8057a21f4da0194485acdaa5d7ceb2c59b8cee46c2953fec9abc19">fizz::finished</a>, <a class="el" href="Params_8h_source.html#l00055">fizz::AppWrite::flags</a>, <a class="el" href="FizzServerContext_8h_source.html#l00107">fizz::server::FizzServerContext::getClientAuthMode()</a>, <a class="el" href="FizzServerContext_8h_source.html#l00183">fizz::server::FizzServerContext::getClientCertVerifier()</a>, <a class="el" href="FizzServerContext_8h_source.html#l00258">fizz::server::FizzServerContext::getFactory()</a>, <a class="el" href="Protocol_8h_source.html#l00044">fizz::Protocol::getKeyUpdated()</a>, <a class="el" href="record_2Types_8cpp_source.html#l00016">fizz::getRealDraftVersion()</a>, <a class="el" href="KeyScheduler_8cpp_source.html#l00204">fizz::KeyScheduler::getResumptionSecret()</a>, <a class="el" href="KeyScheduler_8cpp_source.html#l00114">fizz::KeyScheduler::getSecret()</a>, <a class="el" href="FizzServerContext_8h_source.html#l00272">fizz::server::FizzServerContext::getSendNewSessionTicket()</a>, <a class="el" href="FizzServerContext_8h_source.html#l00076">fizz::server::FizzServerContext::getSupportedSigSchemes()</a>, <a class="el" href="FizzServerContext_8h_source.html#l00153">fizz::server::FizzServerContext::getTicketCipher()</a>, <a class="el" href="namespacefizz.html#a147eec03bf3a9683f4e214820a1f758aa79db796776246d2c3aaca8b375e662c4">fizz::handshake_failure</a>, <a class="el" href="server_2State_8h_source.html#l00310">fizz::server::State::handshakeContext()</a>, <a class="el" href="RecordLayer_8cpp_source.html#l00151">fizz::ReadRecordLayer::hasUnparsedHandshakeData()</a>, <a class="el" href="namespacefizz.html#a147eec03bf3a9683f4e214820a1f758aa0bb2e3cfaec11b1cd502d30d896c8b99">fizz::illegal_parameter</a>, <a class="el" href="server_2State_8h_source.html#l00203">fizz::server::State::keyScheduler()</a>, <a class="el" href="Factory_8h_source.html#l00047">fizz::Factory::makeEncryptedReadRecordLayer()</a>, <a class="el" href="Factory_8h_source.html#l00052">fizz::Factory::makeEncryptedWriteRecordLayer()</a>, <a class="el" href="Factory_8h_source.html#l00128">fizz::Factory::makePeerCert()</a>, <a class="el" href="Factory_8h_source.html#l00124">fizz::Factory::makeTicketAgeAdd()</a>, <a class="el" href="Base-inl_8h_source.html#l02567">folly::gen::move</a>, <a class="el" href="Optional_8h_source.html#l00087">folly::none</a>, <a class="el" href="namespacefizz.html#ab017b61ecd944032c374d31740161131a9ed2d871602556951e39f3cebd08d6cb">fizz::NotSupported</a>, <a class="el" href="TimekeeperTest_8cpp_source.html#l00031">now()</a>, <a class="el" href="namespacefizz_1_1server.html#afa366405c336894fd4a7f1c423ab7394aebb061953c0454b2c8ee7b0ac615ebcd">fizz::server::Optional</a>, <a class="el" href="server_2State_8h_source.html#l00133">fizz::server::State::pskType()</a>, <a class="el" href="Range_8h_source.html#l01114">folly::range()</a>, <a class="el" href="server_2State_8h_source.html#l00213">fizz::server::State::readRecordLayer()</a>, <a class="el" href="namespacefizz.html#ae69fe2de1c97b7bd063cd391a7e4a51eafab34e2e31ec8ab3e5973580d4a3eea6">fizz::ResumptionMaster</a>, <a class="el" href="server_2State_8h_source.html#l00248">fizz::server::State::resumptionMasterSecret()</a>, <a class="el" href="ResumptionState_8h_source.html#l00022">fizz::server::ResumptionState::resumptionSecret</a>, <a class="el" href="namespacefizz.html#ad4370192b1570b3bd64f596f674f7637ac76ca33886b773a7e21838ad284d431f">fizz::ServerAppTraffic</a>, <a class="el" href="ResumptionState_8h_source.html#l00023">fizz::server::ResumptionState::serverCert</a>, <a class="el" href="server_2State_8h_source.html#l00090">fizz::server::State::serverCert()</a>, <a class="el" href="KeyScheduler_8cpp_source.html#l00102">fizz::KeyScheduler::serverKeyUpdate()</a>, <a class="el" href="Protocol_8h_source.html#l00020">fizz::Protocol::setAead()</a>, <a class="el" href="TicketCodecTest_8cpp_source.html#l00021">ticket</a>, <a class="el" href="ResumptionState_8h_source.html#l00027">fizz::server::ResumptionState::ticketAgeAdd</a>, <a class="el" href="ResumptionState_8h_source.html#l00028">fizz::server::ResumptionState::ticketIssueTime</a>, <a class="el" href="namespacefizz.html#a3a1cbf7ef22de4d4c5144b3090d7ebc1aafa659196b1c05be67f7495345e7d5a1">fizz::tls_1_3_20</a>, <a class="el" href="client_2State_8cpp_source.html#l00016">fizz::toString()</a>, <a class="el" href="server_2State_8h_source.html#l00258">fizz::server::State::unverifiedCertChain()</a>, <a class="el" href="namespacefizz.html#a6c5782b80a0dbe87cbce3552227f4a7cabe584adbdeda9ac61783941f5a72060f">fizz::update_not_requested</a>, <a class="el" href="ResumptionState_8h_source.html#l00020">fizz::server::ResumptionState::version</a>, <a class="el" href="server_2State_8h_source.html#l00104">fizz::server::State::version()</a>, <a class="el" href="Types-inl_8h_source.html#l00112">fizz::detail::write()</a>, <a class="el" href="RecordLayer_8h_source.html#l00069">fizz::WriteRecordLayer::writeAppData()</a>, <a class="el" href="RecordLayer_8h_source.html#l00074">fizz::WriteRecordLayer::writeHandshake()</a>, <a class="el" href="namespacefizz.html#a1135430496a56ed55bdfc4a77ccb35fbad36da62dfdcc7f2a272f558c7895ce44">fizz::WriteNewSessionTicket</a>, <a class="el" href="ServerProtocol_8cpp_source.html#l01614">writeNewSessionTicket()</a>, and <a class="el" href="server_2State_8h_source.html#l00223">fizz::server::State::writeRecordLayer()</a>.</p>
<div class="fragment"><div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;                            {</div><div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;  <span class="keyword">auto</span> ticketCipher = state.<a class="code" href="classfizz_1_1server_1_1State.html#a7962de96de4592cafc3d67eb80b99f24">context</a>()-&gt;<a class="code" href="classfizz_1_1server_1_1FizzServerContext.html#a6c90f0f0cbeadad7c7ca2dead061bfdc">getTicketCipher</a>();</div><div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;</div><div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;  <span class="keywordflow">if</span> (!ticketCipher || *state.<a class="code" href="classfizz_1_1server_1_1State.html#a42208b7a3e13eb577c4be3ee60157e21">pskType</a>() == PskType::NotSupported) {</div><div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacefolly.html#ac22c63dbe5af3b0bedb0f21031691537">folly::none</a>;</div><div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;  }</div><div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;</div><div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;  <a class="code" href="namespacefizz.html#af020f21a568ff86800e03d6ad2a9b84d">Buf</a> ticketNonce;</div><div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;  <a class="code" href="namespacefizz.html#af020f21a568ff86800e03d6ad2a9b84d">Buf</a> resumptionSecret;</div><div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;  <span class="keyword">auto</span> realDraftVersion = <a class="code" href="namespacefizz.html#af14fcb8cbbab3726a0922291cd13b4d1">getRealDraftVersion</a>(*state.<a class="code" href="classfizz_1_1server_1_1State.html#af14486fc56d77386cfa657fa89e1bf91">version</a>());</div><div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;  <span class="keywordflow">if</span> (realDraftVersion == ProtocolVersion::tls_1_3_20) {</div><div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;    ticketNonce = <span class="keyword">nullptr</span>;</div><div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;    resumptionSecret =</div><div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;        <a class="code" href="classfolly_1_1IOBuf.html#aa1c4b32cfaa7c96d591d8ad5f5f7b959">folly::IOBuf::copyBuffer</a>(<a class="code" href="namespacefolly.html#a79a54cd1a19a22878c86be5f90a33643">folly::range</a>(resumptionMasterSecret));</div><div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;    ticketNonce = <a class="code" href="classfolly_1_1IOBuf.html#a744f20ec9d0829fe17cf78fb48b7785e">folly::IOBuf::create</a>(0);</div><div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;    resumptionSecret = state.<a class="code" href="classfizz_1_1server_1_1State.html#a2f0e0222e87bcc55c79949ff1c285e74">keyScheduler</a>()-&gt;<a class="code" href="classfizz_1_1KeyScheduler.html#aed6b06ff0879e332b49ba4afdc3d7e14">getResumptionSecret</a>(</div><div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;        <a class="code" href="namespacefolly.html#a79a54cd1a19a22878c86be5f90a33643">folly::range</a>(resumptionMasterSecret), ticketNonce-&gt;coalesce());</div><div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;  }</div><div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;</div><div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;  <a class="code" href="structfizz_1_1server_1_1ResumptionState.html">ResumptionState</a> resState;</div><div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;  resState.<a class="code" href="structfizz_1_1server_1_1ResumptionState.html#a4fdbac16786dcbb33ccf0980d97f784e">version</a> = *state.<a class="code" href="classfizz_1_1server_1_1State.html#af14486fc56d77386cfa657fa89e1bf91">version</a>();</div><div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;  resState.<a class="code" href="structfizz_1_1server_1_1ResumptionState.html#a50b823b26e25f055b035a094e566aa8e">cipher</a> = *state.<a class="code" href="classfizz_1_1server_1_1State.html#a47aedc79b7c71d0b4632e5bf6da5b599">cipher</a>();</div><div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;  resState.<a class="code" href="structfizz_1_1server_1_1ResumptionState.html#a04fb81b5278300c380db11d8fa660963">resumptionSecret</a> = <a class="code" href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">std::move</a>(resumptionSecret);</div><div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;  resState.<a class="code" href="structfizz_1_1server_1_1ResumptionState.html#a31e398490b8c135644179f80342036c1">serverCert</a> = state.<a class="code" href="classfizz_1_1server_1_1State.html#a28d2e6fc53b9b3b099de87beac6fe634">serverCert</a>();</div><div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;  resState.<a class="code" href="structfizz_1_1server_1_1ResumptionState.html#afcea3abc64bada5debb35ae6fd345195">clientCert</a> = state.<a class="code" href="classfizz_1_1server_1_1State.html#aba356acdf1361c8c2d420f73d154fd1b">clientCert</a>();</div><div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;  resState.<a class="code" href="structfizz_1_1server_1_1ResumptionState.html#aefed07164d0fe2db7cd5e4a3424e5828">alpn</a> = state.<a class="code" href="classfizz_1_1server_1_1State.html#a82ac86ab1bdb1fa7b9193068ef9ac23c">alpn</a>();</div><div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;  resState.<a class="code" href="structfizz_1_1server_1_1ResumptionState.html#a0ed761e91ea9e971fe08c56d86befd2a">ticketAgeAdd</a> = state.<a class="code" href="classfizz_1_1server_1_1State.html#a7962de96de4592cafc3d67eb80b99f24">context</a>()-&gt;<a class="code" href="classfizz_1_1server_1_1FizzServerContext.html#aa4b538ee9c9b57485e77be5406cc41d7">getFactory</a>()-&gt;<a class="code" href="classfizz_1_1Factory.html#a91c485e751bcb67637ac432fa85d8628">makeTicketAgeAdd</a>();</div><div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;  resState.<a class="code" href="structfizz_1_1server_1_1ResumptionState.html#a7c1e946dac60b43e69500231c329e896">ticketIssueTime</a> = <a class="code" href="TimekeeperTest_8cpp.html#a562b4baa36dcf267f35a4ba4e0aef329">std::chrono::system_clock::now</a>();</div><div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;  resState.<a class="code" href="structfizz_1_1server_1_1ResumptionState.html#a0f2b4be6606213767318229720c50b2d">appToken</a> = <a class="code" href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">std::move</a>(appToken);</div><div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;</div><div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;  <span class="keyword">auto</span> ticketFuture = ticketCipher-&gt;encrypt(<a class="code" href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">std::move</a>(resState));</div><div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;  <span class="keywordflow">return</span> ticketFuture.via(state.<a class="code" href="classfizz_1_1server_1_1State.html#aa2b8c164f681e973104cc603451bc160">executor</a>())</div><div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;      .thenValue(</div><div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;          [&amp;state,</div><div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;           ticketAgeAdd = resState.<a class="code" href="structfizz_1_1server_1_1ResumptionState.html#a0ed761e91ea9e971fe08c56d86befd2a">ticketAgeAdd</a>,</div><div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;           ticketNonce = <a class="code" href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">std::move</a>(ticketNonce)](</div><div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;              <a class="code" href="classfolly_1_1Optional.html">Optional&lt;std::pair&lt;Buf, std::chrono::seconds&gt;</a>&gt; <a class="code" href="TicketCodecTest_8cpp.html#a7093cc9e41a6fdad6b2f2aa9211604c6">ticket</a>) <span class="keyword">mutable</span></div><div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;          -&gt; <a class="code" href="classfolly_1_1Optional.html">Optional&lt;WriteToSocket&gt;</a> {</div><div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="TicketCodecTest_8cpp.html#a7093cc9e41a6fdad6b2f2aa9211604c6">ticket</a>) {</div><div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;              <span class="keywordflow">return</span> <a class="code" href="namespacefolly.html#ac22c63dbe5af3b0bedb0f21031691537">folly::none</a>;</div><div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;            }</div><div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="namespacefizz_1_1sm.html#ae07a16d08f9254937d3fdcb4a52b5f19">writeNewSessionTicket</a>(</div><div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;                *state.<a class="code" href="classfizz_1_1server_1_1State.html#a7962de96de4592cafc3d67eb80b99f24">context</a>(),</div><div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;                *state.<a class="code" href="classfizz_1_1server_1_1State.html#abd57b563417ef8c64787faa107986df4">writeRecordLayer</a>(),</div><div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;                <a class="code" href="TicketCodecTest_8cpp.html#a7093cc9e41a6fdad6b2f2aa9211604c6">ticket</a>-&gt;second,</div><div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;                ticketAgeAdd,</div><div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;                <a class="code" href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">std::move</a>(ticketNonce),</div><div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;                <a class="code" href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">std::move</a>(<a class="code" href="TicketCodecTest_8cpp.html#a7093cc9e41a6fdad6b2f2aa9211604c6">ticket</a>-&gt;first),</div><div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;                *state.<a class="code" href="classfizz_1_1server_1_1State.html#af14486fc56d77386cfa657fa89e1bf91">version</a>());</div><div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;          });</div><div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;}</div><div class="ttc" id="structfizz_1_1server_1_1ResumptionState_html_a4fdbac16786dcbb33ccf0980d97f784e"><div class="ttname"><a href="structfizz_1_1server_1_1ResumptionState.html#a4fdbac16786dcbb33ccf0980d97f784e">fizz::server::ResumptionState::version</a></div><div class="ttdeci">ProtocolVersion version</div><div class="ttdef"><b>Definition:</b> <a href="ResumptionState_8h_source.html#l00020">ResumptionState.h:20</a></div></div>
<div class="ttc" id="structfizz_1_1server_1_1ResumptionState_html_a0ed761e91ea9e971fe08c56d86befd2a"><div class="ttname"><a href="structfizz_1_1server_1_1ResumptionState.html#a0ed761e91ea9e971fe08c56d86befd2a">fizz::server::ResumptionState::ticketAgeAdd</a></div><div class="ttdeci">uint32_t ticketAgeAdd</div><div class="ttdef"><b>Definition:</b> <a href="ResumptionState_8h_source.html#l00027">ResumptionState.h:27</a></div></div>
<div class="ttc" id="classfizz_1_1server_1_1State_html_af14486fc56d77386cfa657fa89e1bf91"><div class="ttname"><a href="classfizz_1_1server_1_1State.html#af14486fc56d77386cfa657fa89e1bf91">fizz::server::State::version</a></div><div class="ttdeci">folly::Optional&lt; ProtocolVersion &gt; version() const </div><div class="ttdef"><b>Definition:</b> <a href="server_2State_8h_source.html#l00104">State.h:104</a></div></div>
<div class="ttc" id="classfolly_1_1IOBuf_html_a744f20ec9d0829fe17cf78fb48b7785e"><div class="ttname"><a href="classfolly_1_1IOBuf.html#a744f20ec9d0829fe17cf78fb48b7785e">folly::IOBuf::create</a></div><div class="ttdeci">static std::unique_ptr&lt; IOBuf &gt; create(std::size_t capacity)</div><div class="ttdef"><b>Definition:</b> <a href="IOBuf_8cpp_source.html#l00229">IOBuf.cpp:229</a></div></div>
<div class="ttc" id="classfizz_1_1server_1_1FizzServerContext_html_a6c90f0f0cbeadad7c7ca2dead061bfdc"><div class="ttname"><a href="classfizz_1_1server_1_1FizzServerContext.html#a6c90f0f0cbeadad7c7ca2dead061bfdc">fizz::server::FizzServerContext::getTicketCipher</a></div><div class="ttdeci">const TicketCipher * getTicketCipher() const </div><div class="ttdef"><b>Definition:</b> <a href="FizzServerContext_8h_source.html#l00153">FizzServerContext.h:153</a></div></div>
<div class="ttc" id="TimekeeperTest_8cpp_html_a562b4baa36dcf267f35a4ba4e0aef329"><div class="ttname"><a href="TimekeeperTest_8cpp.html#a562b4baa36dcf267f35a4ba4e0aef329">now</a></div><div class="ttdeci">std::chrono::steady_clock::time_point now()</div><div class="ttdef"><b>Definition:</b> <a href="TimekeeperTest_8cpp_source.html#l00031">TimekeeperTest.cpp:31</a></div></div>
<div class="ttc" id="namespacefolly_1_1gen_html_ac24ec252b1b738a40c274285527c193f"><div class="ttname"><a href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">folly::gen::move</a></div><div class="ttdeci">constexpr detail::Map&lt; Move &gt; move</div><div class="ttdef"><b>Definition:</b> <a href="Base-inl_8h_source.html#l02567">Base-inl.h:2567</a></div></div>
<div class="ttc" id="structfizz_1_1server_1_1ResumptionState_html_aefed07164d0fe2db7cd5e4a3424e5828"><div class="ttname"><a href="structfizz_1_1server_1_1ResumptionState.html#aefed07164d0fe2db7cd5e4a3424e5828">fizz::server::ResumptionState::alpn</a></div><div class="ttdeci">folly::Optional&lt; std::string &gt; alpn</div><div class="ttdef"><b>Definition:</b> <a href="ResumptionState_8h_source.html#l00026">ResumptionState.h:26</a></div></div>
<div class="ttc" id="structfizz_1_1server_1_1ResumptionState_html_a50b823b26e25f055b035a094e566aa8e"><div class="ttname"><a href="structfizz_1_1server_1_1ResumptionState.html#a50b823b26e25f055b035a094e566aa8e">fizz::server::ResumptionState::cipher</a></div><div class="ttdeci">CipherSuite cipher</div><div class="ttdef"><b>Definition:</b> <a href="ResumptionState_8h_source.html#l00021">ResumptionState.h:21</a></div></div>
<div class="ttc" id="structfizz_1_1server_1_1ResumptionState_html_a7c1e946dac60b43e69500231c329e896"><div class="ttname"><a href="structfizz_1_1server_1_1ResumptionState.html#a7c1e946dac60b43e69500231c329e896">fizz::server::ResumptionState::ticketIssueTime</a></div><div class="ttdeci">std::chrono::system_clock::time_point ticketIssueTime</div><div class="ttdef"><b>Definition:</b> <a href="ResumptionState_8h_source.html#l00028">ResumptionState.h:28</a></div></div>
<div class="ttc" id="classfizz_1_1server_1_1State_html_a2f0e0222e87bcc55c79949ff1c285e74"><div class="ttname"><a href="classfizz_1_1server_1_1State.html#a2f0e0222e87bcc55c79949ff1c285e74">fizz::server::State::keyScheduler</a></div><div class="ttdeci">KeyScheduler * keyScheduler() const </div><div class="ttdef"><b>Definition:</b> <a href="server_2State_8h_source.html#l00203">State.h:203</a></div></div>
<div class="ttc" id="TicketCodecTest_8cpp_html_a7093cc9e41a6fdad6b2f2aa9211604c6"><div class="ttname"><a href="TicketCodecTest_8cpp.html#a7093cc9e41a6fdad6b2f2aa9211604c6">ticket</a></div><div class="ttdeci">static constexpr StringPiece ticket</div><div class="ttdef"><b>Definition:</b> <a href="TicketCodecTest_8cpp_source.html#l00021">TicketCodecTest.cpp:21</a></div></div>
<div class="ttc" id="structfizz_1_1server_1_1ResumptionState_html_a04fb81b5278300c380db11d8fa660963"><div class="ttname"><a href="structfizz_1_1server_1_1ResumptionState.html#a04fb81b5278300c380db11d8fa660963">fizz::server::ResumptionState::resumptionSecret</a></div><div class="ttdeci">Buf resumptionSecret</div><div class="ttdef"><b>Definition:</b> <a href="ResumptionState_8h_source.html#l00022">ResumptionState.h:22</a></div></div>
<div class="ttc" id="classfizz_1_1server_1_1State_html_aa2b8c164f681e973104cc603451bc160"><div class="ttname"><a href="classfizz_1_1server_1_1State.html#aa2b8c164f681e973104cc603451bc160">fizz::server::State::executor</a></div><div class="ttdeci">folly::Executor * executor() const </div><div class="ttdef"><b>Definition:</b> <a href="server_2State_8h_source.html#l00076">State.h:76</a></div></div>
<div class="ttc" id="classfizz_1_1server_1_1FizzServerContext_html_aa4b538ee9c9b57485e77be5406cc41d7"><div class="ttname"><a href="classfizz_1_1server_1_1FizzServerContext.html#aa4b538ee9c9b57485e77be5406cc41d7">fizz::server::FizzServerContext::getFactory</a></div><div class="ttdeci">const Factory * getFactory() const </div><div class="ttdef"><b>Definition:</b> <a href="FizzServerContext_8h_source.html#l00258">FizzServerContext.h:258</a></div></div>
<div class="ttc" id="classfizz_1_1server_1_1State_html_aba356acdf1361c8c2d420f73d154fd1b"><div class="ttname"><a href="classfizz_1_1server_1_1State.html#aba356acdf1361c8c2d420f73d154fd1b">fizz::server::State::clientCert</a></div><div class="ttdeci">const std::shared_ptr&lt; const Cert &gt; &amp; clientCert() const </div><div class="ttdef"><b>Definition:</b> <a href="server_2State_8h_source.html#l00097">State.h:97</a></div></div>
<div class="ttc" id="classfizz_1_1server_1_1State_html_abd57b563417ef8c64787faa107986df4"><div class="ttname"><a href="classfizz_1_1server_1_1State.html#abd57b563417ef8c64787faa107986df4">fizz::server::State::writeRecordLayer</a></div><div class="ttdeci">const WriteRecordLayer * writeRecordLayer() const </div><div class="ttdef"><b>Definition:</b> <a href="server_2State_8h_source.html#l00223">State.h:223</a></div></div>
<div class="ttc" id="classfolly_1_1Optional_html"><div class="ttname"><a href="classfolly_1_1Optional.html">folly::Optional</a></div><div class="ttdef"><b>Definition:</b> <a href="Optional_8h_source.html#l00071">Optional.h:71</a></div></div>
<div class="ttc" id="classfizz_1_1KeyScheduler_html_aed6b06ff0879e332b49ba4afdc3d7e14"><div class="ttname"><a href="classfizz_1_1KeyScheduler.html#aed6b06ff0879e332b49ba4afdc3d7e14">fizz::KeyScheduler::getResumptionSecret</a></div><div class="ttdeci">virtual Buf getResumptionSecret(folly::ByteRange resumptionMasterSecret, folly::ByteRange ticketNonce) const </div><div class="ttdef"><b>Definition:</b> <a href="KeyScheduler_8cpp_source.html#l00204">KeyScheduler.cpp:204</a></div></div>
<div class="ttc" id="namespacefolly_html_a79a54cd1a19a22878c86be5f90a33643"><div class="ttname"><a href="namespacefolly.html#a79a54cd1a19a22878c86be5f90a33643">folly::range</a></div><div class="ttdeci">constexpr Range&lt; Iter &gt; range(Iter first, Iter last)</div><div class="ttdef"><b>Definition:</b> <a href="Range_8h_source.html#l01114">Range.h:1114</a></div></div>
<div class="ttc" id="classfizz_1_1server_1_1State_html_a42208b7a3e13eb577c4be3ee60157e21"><div class="ttname"><a href="classfizz_1_1server_1_1State.html#a42208b7a3e13eb577c4be3ee60157e21">fizz::server::State::pskType</a></div><div class="ttdeci">folly::Optional&lt; PskType &gt; pskType() const </div><div class="ttdef"><b>Definition:</b> <a href="server_2State_8h_source.html#l00133">State.h:133</a></div></div>
<div class="ttc" id="classfizz_1_1Factory_html_a91c485e751bcb67637ac432fa85d8628"><div class="ttname"><a href="classfizz_1_1Factory.html#a91c485e751bcb67637ac432fa85d8628">fizz::Factory::makeTicketAgeAdd</a></div><div class="ttdeci">virtual uint32_t makeTicketAgeAdd() const </div><div class="ttdef"><b>Definition:</b> <a href="Factory_8h_source.html#l00124">Factory.h:124</a></div></div>
<div class="ttc" id="classfizz_1_1server_1_1State_html_a7962de96de4592cafc3d67eb80b99f24"><div class="ttname"><a href="classfizz_1_1server_1_1State.html#a7962de96de4592cafc3d67eb80b99f24">fizz::server::State::context</a></div><div class="ttdeci">const FizzServerContext * context() const </div><div class="ttdef"><b>Definition:</b> <a href="server_2State_8h_source.html#l00083">State.h:83</a></div></div>
<div class="ttc" id="namespacefizz_html_af020f21a568ff86800e03d6ad2a9b84d"><div class="ttname"><a href="namespacefizz.html#af020f21a568ff86800e03d6ad2a9b84d">fizz::Buf</a></div><div class="ttdeci">std::unique_ptr&lt; folly::IOBuf &gt; Buf</div><div class="ttdef"><b>Definition:</b> <a href="fizz_2fizz_2record_2Types_8h_source.html#l00022">Types.h:22</a></div></div>
<div class="ttc" id="namespacefizz_html_af14fcb8cbbab3726a0922291cd13b4d1"><div class="ttname"><a href="namespacefizz.html#af14fcb8cbbab3726a0922291cd13b4d1">fizz::getRealDraftVersion</a></div><div class="ttdeci">ProtocolVersion getRealDraftVersion(ProtocolVersion version)</div><div class="ttdef"><b>Definition:</b> <a href="record_2Types_8cpp_source.html#l00016">Types.cpp:16</a></div></div>
<div class="ttc" id="classfizz_1_1server_1_1State_html_a82ac86ab1bdb1fa7b9193068ef9ac23c"><div class="ttname"><a href="classfizz_1_1server_1_1State.html#a82ac86ab1bdb1fa7b9193068ef9ac23c">fizz::server::State::alpn</a></div><div class="ttdeci">const folly::Optional&lt; std::string &gt; &amp; alpn() const </div><div class="ttdef"><b>Definition:</b> <a href="server_2State_8h_source.html#l00168">State.h:168</a></div></div>
<div class="ttc" id="structfizz_1_1server_1_1ResumptionState_html_a31e398490b8c135644179f80342036c1"><div class="ttname"><a href="structfizz_1_1server_1_1ResumptionState.html#a31e398490b8c135644179f80342036c1">fizz::server::ResumptionState::serverCert</a></div><div class="ttdeci">std::shared_ptr&lt; const Cert &gt; serverCert</div><div class="ttdef"><b>Definition:</b> <a href="ResumptionState_8h_source.html#l00023">ResumptionState.h:23</a></div></div>
<div class="ttc" id="classfolly_1_1IOBuf_html_aa1c4b32cfaa7c96d591d8ad5f5f7b959"><div class="ttname"><a href="classfolly_1_1IOBuf.html#aa1c4b32cfaa7c96d591d8ad5f5f7b959">folly::IOBuf::copyBuffer</a></div><div class="ttdeci">static std::unique_ptr&lt; IOBuf &gt; copyBuffer(const void *buf, std::size_t size, std::size_t headroom=0, std::size_t minTailroom=0)</div><div class="ttdef"><b>Definition:</b> <a href="IOBuf_8h_source.html#l01587">IOBuf.h:1587</a></div></div>
<div class="ttc" id="structfizz_1_1server_1_1ResumptionState_html_afcea3abc64bada5debb35ae6fd345195"><div class="ttname"><a href="structfizz_1_1server_1_1ResumptionState.html#afcea3abc64bada5debb35ae6fd345195">fizz::server::ResumptionState::clientCert</a></div><div class="ttdeci">std::shared_ptr&lt; const Cert &gt; clientCert</div><div class="ttdef"><b>Definition:</b> <a href="ResumptionState_8h_source.html#l00024">ResumptionState.h:24</a></div></div>
<div class="ttc" id="classfizz_1_1server_1_1State_html_a28d2e6fc53b9b3b099de87beac6fe634"><div class="ttname"><a href="classfizz_1_1server_1_1State.html#a28d2e6fc53b9b3b099de87beac6fe634">fizz::server::State::serverCert</a></div><div class="ttdeci">std::shared_ptr&lt; const Cert &gt; serverCert() const </div><div class="ttdef"><b>Definition:</b> <a href="server_2State_8h_source.html#l00090">State.h:90</a></div></div>
<div class="ttc" id="classfizz_1_1server_1_1State_html_a47aedc79b7c71d0b4632e5bf6da5b599"><div class="ttname"><a href="classfizz_1_1server_1_1State.html#a47aedc79b7c71d0b4632e5bf6da5b599">fizz::server::State::cipher</a></div><div class="ttdeci">folly::Optional&lt; CipherSuite &gt; cipher() const </div><div class="ttdef"><b>Definition:</b> <a href="server_2State_8h_source.html#l00111">State.h:111</a></div></div>
<div class="ttc" id="structfizz_1_1server_1_1ResumptionState_html"><div class="ttname"><a href="structfizz_1_1server_1_1ResumptionState.html">fizz::server::ResumptionState</a></div><div class="ttdef"><b>Definition:</b> <a href="ResumptionState_8h_source.html#l00019">ResumptionState.h:19</a></div></div>
<div class="ttc" id="structfizz_1_1server_1_1ResumptionState_html_a0f2b4be6606213767318229720c50b2d"><div class="ttname"><a href="structfizz_1_1server_1_1ResumptionState.html#a0f2b4be6606213767318229720c50b2d">fizz::server::ResumptionState::appToken</a></div><div class="ttdeci">Buf appToken</div><div class="ttdef"><b>Definition:</b> <a href="ResumptionState_8h_source.html#l00029">ResumptionState.h:29</a></div></div>
<div class="ttc" id="namespacefolly_html_ac22c63dbe5af3b0bedb0f21031691537"><div class="ttname"><a href="namespacefolly.html#ac22c63dbe5af3b0bedb0f21031691537">folly::none</a></div><div class="ttdeci">constexpr None none</div><div class="ttdef"><b>Definition:</b> <a href="Optional_8h_source.html#l00087">Optional.h:87</a></div></div>
<div class="ttc" id="namespacefizz_1_1sm_html_ae07a16d08f9254937d3fdcb4a52b5f19"><div class="ttname"><a href="namespacefizz_1_1sm.html#ae07a16d08f9254937d3fdcb4a52b5f19">fizz::sm::writeNewSessionTicket</a></div><div class="ttdeci">static WriteToSocket writeNewSessionTicket(const FizzServerContext &amp;context, const WriteRecordLayer &amp;recordLayer, std::chrono::seconds ticketLifetime, uint32_t ticketAgeAdd, Buf nonce, Buf ticket, ProtocolVersion version)</div><div class="ttdef"><b>Definition:</b> <a href="ServerProtocol_8cpp_source.html#l01614">ServerProtocol.cpp:1614</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a4800617fb250b2236b307edd74e971ae"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename ServerMessage &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static std::pair&lt;<a class="el" href="namespacefizz.html#a3a1cbf7ef22de4d4c5144b3090d7ebc1">ProtocolVersion</a>, <a class="el" href="namespacefizz.html#a23e4ec7baa80cc6f92fdbeadccf0d22e">CipherSuite</a>&gt; fizz::sm::getAndValidateVersionAndCipher </td>
          <td>(</td>
          <td class="paramtype">const ServerMessage &amp;&#160;</td>
          <td class="paramname"><em>msg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="namespacefizz.html#a3a1cbf7ef22de4d4c5144b3090d7ebc1">ProtocolVersion</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>supportedVersions</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="namespacefizz.html#a23e4ec7baa80cc6f92fdbeadccf0d22e">CipherSuite</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>supportedCiphers</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ClientProtocol_8cpp_source.html#l00689">689</a> of file <a class="el" href="ClientProtocol_8cpp_source.html">ClientProtocol.cpp</a>.</p>

<p>References <a class="el" href="namespacefizz.html#a147eec03bf3a9683f4e214820a1f758aa79db796776246d2c3aaca8b375e662c4">fizz::handshake_failure</a>, <a class="el" href="namespacefizz.html#a147eec03bf3a9683f4e214820a1f758aa0bb2e3cfaec11b1cd502d30d896c8b99">fizz::illegal_parameter</a>, <a class="el" href="namespacefizz.html#a147eec03bf3a9683f4e214820a1f758aaccc66c059398cf101d1811b511ebd46c">fizz::protocol_version</a>, <a class="el" href="namespacefizz.html#a3a1cbf7ef22de4d4c5144b3090d7ebc1a19640bc085d73d380771b141df331ae6">fizz::tls_1_2</a>, and <a class="el" href="client_2State_8cpp_source.html#l00016">fizz::toString()</a>.</p>

<p>Referenced by <a class="el" href="ClientProtocol_8cpp_source.html#l00733">negotiateParameters()</a>.</p>
<div class="fragment"><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;                                                    {</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;  <span class="keywordflow">if</span> (msg.legacy_version != ProtocolVersion::tls_1_2) {</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;    <span class="keywordflow">throw</span> FizzException(</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;        folly::to&lt;std::string&gt;(</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;            <span class="stringliteral">&quot;received server legacy version &quot;</span>, <a class="code" href="namespacefizz.html#a30b2fb43c8fa821c309a460ad8e0c16a">toString</a>(msg.legacy_version)),</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;        AlertDescription::protocol_version);</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;  }</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;  <span class="keywordflow">if</span> (msg.legacy_compression_method != 0x00) {</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;    <span class="keywordflow">throw</span> FizzException(</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;        <span class="stringliteral">&quot;compression method not null&quot;</span>, AlertDescription::illegal_parameter);</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;  }</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;  <span class="keyword">auto</span> supportedVersionsExt =</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;      getExtension&lt;ServerSupportedVersions&gt;(msg.extensions);</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;  <span class="keywordflow">if</span> (!supportedVersionsExt) {</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;    <span class="keywordflow">throw</span> FizzException(</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;        <span class="stringliteral">&quot;no supported versions in shlo&quot;</span>, AlertDescription::protocol_version);</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;  }</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;  <span class="keyword">auto</span> selectedVersion = supportedVersionsExt-&gt;selected_version;</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;  <span class="keyword">auto</span> selectedCipher = msg.cipher_suite;</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;  <span class="keywordflow">if</span> (std::find(</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;          supportedVersions.begin(),</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;          supportedVersions.end(),</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;          selectedVersion) == supportedVersions.end()) {</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;    <span class="keywordflow">throw</span> FizzException(</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;        <span class="stringliteral">&quot;received unsupported server version&quot;</span>,</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;        AlertDescription::protocol_version);</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;  }</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;  <span class="keywordflow">if</span> (std::find(</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;          supportedCiphers.begin(), supportedCiphers.end(), selectedCipher) ==</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;      supportedCiphers.end()) {</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;    <span class="keywordflow">throw</span> FizzException(</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;        <span class="stringliteral">&quot;server choose unsupported cipher suite&quot;</span>,</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;        AlertDescription::handshake_failure);</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;  }</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;  <span class="keywordflow">return</span> std::make_pair(selectedVersion, selectedCipher);</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;}</div><div class="ttc" id="namespacefizz_html_a30b2fb43c8fa821c309a460ad8e0c16a"><div class="ttname"><a href="namespacefizz.html#a30b2fb43c8fa821c309a460ad8e0c16a">fizz::toString</a></div><div class="ttdeci">folly::StringPiece toString(StateEnum state)</div><div class="ttdef"><b>Definition:</b> <a href="client_2State_8cpp_source.html#l00016">State.cpp:16</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a22670936c1c7049b8d2a5f9d01a12f8d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static std::tuple&lt;<a class="el" href="namespacefizz.html#af020f21a568ff86800e03d6ad2a9b84d">Buf</a>, <a class="el" href="classfolly_1_1Optional.html">folly::Optional</a>&lt;<a class="el" href="namespacefizz.html#aef5b19e8cb60e324e310f0a9f2afdd95">CertificateCompressionAlgorithm</a>&gt; &gt; fizz::sm::getCertificate </td>
          <td>(</td>
          <td class="paramtype">const std::shared_ptr&lt; const <a class="el" href="classfizz_1_1SelfCert.html">SelfCert</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>serverCert</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classfizz_1_1server_1_1FizzServerContext.html">FizzServerContext</a> &amp;&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structfizz_1_1ClientHello.html">ClientHello</a> &amp;&#160;</td>
          <td class="paramname"><em>chlo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classfizz_1_1HandshakeContext.html">HandshakeContext</a> &amp;&#160;</td>
          <td class="paramname"><em>handshakeContext</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ServerProtocol_8cpp_source.html#l00917">917</a> of file <a class="el" href="ServerProtocol_8cpp_source.html">ServerProtocol.cpp</a>.</p>

<p>References <a class="el" href="classfizz_1_1HandshakeContext.html#a5a9aa3245a54ccfec4a44bd2fdbd7ac8">fizz::HandshakeContext::appendToTranscript()</a>, <a class="el" href="HandshakeTypesTest_8cpp_source.html#l00071">encodedCertificate</a>, <a class="el" href="Types-inl_8h_source.html#l00515">fizz::encodeHandshake()</a>, <a class="el" href="fizz_2fizz_2record_2Types_8h_source.html#l00193">fizz::ClientHello::extensions</a>, <a class="el" href="FizzServerContext_8h_source.html#l00285">fizz::server::FizzServerContext::getSupportedCompressionAlgorithms()</a>, <a class="el" href="fizz_2build___2gtest_2src_2gtest_2googletest_2include_2gtest_2internal_2gtest-tuple_8h_source.html#l00675">std::tr1::make_tuple()</a>, <a class="el" href="Base-inl_8h_source.html#l02567">folly::gen::move</a>, and <a class="el" href="Negotiator_8h_source.html#l00022">fizz::server::negotiate()</a>.</p>

<p>Referenced by <a class="el" href="ServerProtocol_8cpp_source.html#l00953">getCertificateRequest()</a>.</p>
<div class="fragment"><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;                                        {</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;  <span class="comment">// Check for compression support first, and if so, send compressed.</span></div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;  <a class="code" href="namespacefizz.html#af020f21a568ff86800e03d6ad2a9b84d">Buf</a> <a class="code" href="HandshakeTypesTest_8cpp.html#ad898064a68eaf64682b194b245662fb6">encodedCertificate</a>;</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;  <a class="code" href="classfolly_1_1Optional.html">folly::Optional&lt;CertificateCompressionAlgorithm&gt;</a> algo;</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;  <span class="keyword">auto</span> compAlgos =</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;      getExtension&lt;CertificateCompressionAlgorithms&gt;(<a class="code" href="HandshakeTypesTest_8cpp.html#aba518b904616df44c3d7dfde825a4c54">chlo</a>.extensions);</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;  <span class="keywordflow">if</span> (compAlgos &amp;&amp; !context.<a class="code" href="classfizz_1_1server_1_1FizzServerContext.html#af0e34b0d60e71fa1b1c787a50768c2d9">getSupportedCompressionAlgorithms</a>().empty()) {</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;    algo = <a class="code" href="namespacefizz_1_1server.html#a8f9dd07383882fd187b1e9e86949fc49">negotiate</a>(</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;        context.<a class="code" href="classfizz_1_1server_1_1FizzServerContext.html#af0e34b0d60e71fa1b1c787a50768c2d9">getSupportedCompressionAlgorithms</a>(), compAlgos-&gt;algorithms);</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;  }</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;  <span class="keywordflow">if</span> (algo) {</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;    encodedCertificate = <a class="code" href="namespacefizz.html#a1fef0ecdfd4a6c07fd32b5dd0dcb2b23">encodeHandshake</a>(<a class="code" href="ClientProtocol_8cpp.html#ac2dc8f08e34c6a154ad8ff2f4266bf3c">serverCert</a>-&gt;getCompressedCert(*algo));</div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;    encodedCertificate = <a class="code" href="namespacefizz.html#a1fef0ecdfd4a6c07fd32b5dd0dcb2b23">encodeHandshake</a>(<a class="code" href="ClientProtocol_8cpp.html#ac2dc8f08e34c6a154ad8ff2f4266bf3c">serverCert</a>-&gt;getCertMessage());</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;  }</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;  handshakeContext.appendToTranscript(encodedCertificate);</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacestd_1_1tr1.html#af7e12a0f5b5791b5b7c49a5a17b85359">std::make_tuple</a>(<a class="code" href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">std::move</a>(encodedCertificate), <a class="code" href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">std::move</a>(algo));</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;}</div><div class="ttc" id="classfizz_1_1server_1_1FizzServerContext_html_af0e34b0d60e71fa1b1c787a50768c2d9"><div class="ttname"><a href="classfizz_1_1server_1_1FizzServerContext.html#af0e34b0d60e71fa1b1c787a50768c2d9">fizz::server::FizzServerContext::getSupportedCompressionAlgorithms</a></div><div class="ttdeci">const auto &amp; getSupportedCompressionAlgorithms() const </div><div class="ttdef"><b>Definition:</b> <a href="FizzServerContext_8h_source.html#l00285">FizzServerContext.h:285</a></div></div>
<div class="ttc" id="namespacefizz_html_a1fef0ecdfd4a6c07fd32b5dd0dcb2b23"><div class="ttname"><a href="namespacefizz.html#a1fef0ecdfd4a6c07fd32b5dd0dcb2b23">fizz::encodeHandshake</a></div><div class="ttdeci">Buf encodeHandshake(T &amp;&amp;handshakeMsg)</div><div class="ttdef"><b>Definition:</b> <a href="Types-inl_8h_source.html#l00515">Types-inl.h:515</a></div></div>
<div class="ttc" id="HandshakeTypesTest_8cpp_html_aba518b904616df44c3d7dfde825a4c54"><div class="ttname"><a href="HandshakeTypesTest_8cpp.html#aba518b904616df44c3d7dfde825a4c54">chlo</a></div><div class="ttdeci">static const std::string chlo</div><div class="ttdef"><b>Definition:</b> <a href="HandshakeTypesTest_8cpp_source.html#l00023">HandshakeTypesTest.cpp:23</a></div></div>
<div class="ttc" id="namespacefizz_1_1server_html_a8f9dd07383882fd187b1e9e86949fc49"><div class="ttname"><a href="namespacefizz_1_1server.html#a8f9dd07383882fd187b1e9e86949fc49">fizz::server::negotiate</a></div><div class="ttdeci">folly::Optional&lt; T &gt; negotiate(const std::vector&lt; std::vector&lt; T &gt;&gt; &amp;serverPref, const std::vector&lt; T &gt; &amp;clientPref)</div><div class="ttdef"><b>Definition:</b> <a href="Negotiator_8h_source.html#l00022">Negotiator.h:22</a></div></div>
<div class="ttc" id="namespacefolly_1_1gen_html_ac24ec252b1b738a40c274285527c193f"><div class="ttname"><a href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">folly::gen::move</a></div><div class="ttdeci">constexpr detail::Map&lt; Move &gt; move</div><div class="ttdef"><b>Definition:</b> <a href="Base-inl_8h_source.html#l02567">Base-inl.h:2567</a></div></div>
<div class="ttc" id="namespacestd_1_1tr1_html_af7e12a0f5b5791b5b7c49a5a17b85359"><div class="ttname"><a href="namespacestd_1_1tr1.html#af7e12a0f5b5791b5b7c49a5a17b85359">std::tr1::make_tuple</a></div><div class="ttdeci">tuple make_tuple()</div><div class="ttdef"><b>Definition:</b> <a href="fizz_2build___2gtest_2src_2gtest_2googletest_2include_2gtest_2internal_2gtest-tuple_8h_source.html#l00675">gtest-tuple.h:675</a></div></div>
<div class="ttc" id="HandshakeTypesTest_8cpp_html_ad898064a68eaf64682b194b245662fb6"><div class="ttname"><a href="HandshakeTypesTest_8cpp.html#ad898064a68eaf64682b194b245662fb6">encodedCertificate</a></div><div class="ttdeci">static const std::string encodedCertificate</div><div class="ttdef"><b>Definition:</b> <a href="HandshakeTypesTest_8cpp_source.html#l00071">HandshakeTypesTest.cpp:71</a></div></div>
<div class="ttc" id="classfolly_1_1Optional_html"><div class="ttname"><a href="classfolly_1_1Optional.html">folly::Optional&lt; CertificateCompressionAlgorithm &gt;</a></div></div>
<div class="ttc" id="ClientProtocol_8cpp_html_ac2dc8f08e34c6a154ad8ff2f4266bf3c"><div class="ttname"><a href="ClientProtocol_8cpp.html#ac2dc8f08e34c6a154ad8ff2f4266bf3c">serverCert</a></div><div class="ttdeci">std::shared_ptr&lt; const Cert &gt; serverCert</div><div class="ttdef"><b>Definition:</b> <a href="ClientProtocol_8cpp_source.html#l00779">ClientProtocol.cpp:779</a></div></div>
<div class="ttc" id="namespacefizz_html_af020f21a568ff86800e03d6ad2a9b84d"><div class="ttname"><a href="namespacefizz.html#af020f21a568ff86800e03d6ad2a9b84d">fizz::Buf</a></div><div class="ttdeci">std::unique_ptr&lt; folly::IOBuf &gt; Buf</div><div class="ttdef"><b>Definition:</b> <a href="fizz_2fizz_2record_2Types_8h_source.html#l00022">Types.h:22</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a1b7f9e7e89c473a5bcffee7965ce7b11"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="namespacefizz.html#af020f21a568ff86800e03d6ad2a9b84d">Buf</a> fizz::sm::getCertificateRequest </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="namespacefizz.html#a1410cf02b9d3a95b34f9dbf22d372749">SignatureScheme</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>acceptableSigSchemes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classfizz_1_1CertificateVerifier.html">CertificateVerifier</a> *const&#160;</td>
          <td class="paramname"><em>verifier</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classfizz_1_1HandshakeContext.html">HandshakeContext</a> &amp;&#160;</td>
          <td class="paramname"><em>handshakeContext</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ServerProtocol_8cpp_source.html#l00953">953</a> of file <a class="el" href="ServerProtocol_8cpp_source.html">ServerProtocol.cpp</a>.</p>

<p>References <a class="el" href="namespacefizz.html#a02f9d49d996b83310b2a38e93684c959a382ab522931673c11e398ead1b7b1678">fizz::Accepted</a>, <a class="el" href="namespacefizz_1_1server.html#ab796c23673942d9f8fdd74f8d33cb364a522baaea62adf4acfa588f742fbcb04e">fizz::server::AcceptingEarlyData</a>, <a class="el" href="server_2Actions_8h_source.html#l00057">fizz::server::detail::actions()</a>, <a class="el" href="ServerProtocol_8cpp_source.html#l00311">addHandshakeLogging()</a>, <a class="el" href="ExtensionsTest_8cpp_source.html#l00022">alpn</a>, <a class="el" href="IOBufQueue_8cpp_source.html#l00143">folly::IOBufQueue::append()</a>, <a class="el" href="classfizz_1_1HandshakeContext.html#a5a9aa3245a54ccfec4a44bd2fdbd7ac8">fizz::HandshakeContext::appendToTranscript()</a>, <a class="el" href="server_2State_8h_source.html#l00184">fizz::server::State::appTokenValidator()</a>, <a class="el" href="namespacefizz.html#a2d0a99663f1db37e8420c978fd7e8f94afc945c3d5cf8f14213002525c45a6fbb">fizz::AppTraffic</a>, <a class="el" href="FizzBaseTest_8cpp_source.html#l00030">fizz::test::appWrite()</a>, <a class="el" href="Params_8h_source.html#l00053">fizz::AppWrite::callback</a>, <a class="el" href="namespacefizz.html#a13f474ceeb2b16be9bd67bcba87d4334a812f1c86e37703e27ffb71caf6e6b70a">fizz::change_cipher_spec</a>, <a class="el" href="HandshakeTypesTest_8cpp_source.html#l00023">chlo</a>, <a class="el" href="ServerProtocol_8cpp_source.html#l00891">chooseCert()</a>, <a class="el" href="server_2State_8h_source.html#l00111">fizz::server::State::cipher()</a>, <a class="el" href="ClientProtocol_8cpp_source.html#l01006">cipher</a>, <a class="el" href="ClientProtocol_8cpp_source.html#l00780">clientCert</a>, <a class="el" href="namespacefizz.html#a9d0163dd2203bcf4649a864a2bde8343aa65ad49b67d44f90c54189480b7c4f17">fizz::ClientEarlyTraffic</a>, <a class="el" href="namespacefizz.html#abf02c5b776bf5134e4b766e77362aec3aa9c6951e44d00b50d6aa7c65a9570bf8">fizz::ClientHandshakeTraffic</a>, <a class="el" href="server_2Actions_8h_source.html#l00027">fizz::server::AttemptVersionFallback::clientHello</a>, <a class="el" href="WhenN-inl_8h_source.html#l00147">folly::fibers::collectAll()</a>, <a class="el" href="protocol_2Actions_8h_source.html#l00041">fizz::WriteToSocket::contents</a>, <a class="el" href="RecordLayer_8h_source.html#l00020">fizz::TLSContent::contentType</a>, <a class="el" href="server_2State_8h_source.html#l00083">fizz::server::State::context()</a>, <a class="el" href="IOBuf_8h_source.html#l01587">folly::IOBuf::copyBuffer()</a>, <a class="el" href="RecordLayer_8h_source.html#l00019">fizz::TLSContent::data</a>, <a class="el" href="Params_8h_source.html#l00054">fizz::AppWrite::data</a>, <a class="el" href="ServerProtocol_8cpp_source.html#l00659">doKex()</a>, <a class="el" href="namespacefizz.html#a2d0a99663f1db37e8420c978fd7e8f94a946fc6845f6e1bb20623d368b9bdb2b7">fizz::EarlyData</a>, <a class="el" href="server_2State_8h_source.html#l00154">fizz::server::State::earlyDataType()</a>, <a class="el" href="namespacefizz.html#a9d0163dd2203bcf4649a864a2bde8343a99b6ce1926735b666a7069a498d96207">fizz::EarlyExporter</a>, <a class="el" href="server_2State_8h_source.html#l00275">fizz::server::State::earlyExporterMasterSecret()</a>, <a class="el" href="IOBufQueue_8h_source.html#l00503">folly::IOBufQueue::empty()</a>, <a class="el" href="HandshakeTypesTest_8cpp_source.html#l00071">encodedCertificate</a>, <a class="el" href="HandshakeTypesTest_8cpp_source.html#l00082">encodedCertRequest</a>, <a class="el" href="extensions_2tokenbinding_2Types_8cpp_source.html#l00113">fizz::encodeExtension()</a>, <a class="el" href="Types-inl_8h_source.html#l00515">fizz::encodeHandshake()</a>, <a class="el" href="RecordLayer_8h_source.html#l00021">fizz::TLSContent::encryptionLevel</a>, <a class="el" href="namespacefizz.html#a1135430496a56ed55bdfc4a77ccb35fbaa721941f5b643b5e34853abce82db763">fizz::EndOfEarlyData</a>, <a class="el" href="server_2State_8h_source.html#l00076">fizz::server::State::executor()</a>, <a class="el" href="namespacefizz.html#ae69fe2de1c97b7bd063cd391a7e4a51ea2a7a3512c853695a21388f1d1fc9c8b8">fizz::ExporterMaster</a>, <a class="el" href="server_2State_8h_source.html#l00241">fizz::server::State::extensions()</a>, <a class="el" href="fizz_2fizz_2record_2Types_8h_source.html#l00254">fizz::CertificateRequest::extensions</a>, <a class="el" href="fizz_2fizz_2record_2Types_8h_source.html#l00059">fizz::FakeChangeCipherSpec</a>, <a class="el" href="Params_8h_source.html#l00055">fizz::AppWrite::flags</a>, <a class="el" href="FizzServerContext_8h_source.html#l00218">fizz::server::FizzServerContext::getAcceptEarlyData()</a>, <a class="el" href="ServerProtocol_8cpp_source.html#l00917">getCertificate()</a>, <a class="el" href="classfizz_1_1CertificateVerifier.html#ade183b450bfac3535f1b3fe07332ee17">fizz::CertificateVerifier::getCertificateRequestExtensions()</a>, <a class="el" href="ServerProtocol_8cpp_source.html#l00941">getCertificateVerify()</a>, <a class="el" href="FizzServerContext_8h_source.html#l00107">fizz::server::FizzServerContext::getClientAuthMode()</a>, <a class="el" href="FizzServerContext_8h_source.html#l00183">fizz::server::FizzServerContext::getClientCertVerifier()</a>, <a class="el" href="ServerProtocol_8cpp_source.html#l00778">getClockSkew()</a>, <a class="el" href="FizzServerContext_8h_source.html#l00229">fizz::server::FizzServerContext::getClockSkewTolerance()</a>, <a class="el" href="FizzServerContext_8h_source.html#l00164">fizz::server::FizzServerContext::getCookieCipher()</a>, <a class="el" href="CookieCipher_8cpp_source.html#l00079">fizz::server::getCookieState()</a>, <a class="el" href="ServerProtocol_8cpp_source.html#l00864">getEncryptedExt()</a>, <a class="el" href="classfizz_1_1ServerExtensions.html#aed4ac8968d484d7237b3d27463613727">fizz::ServerExtensions::getExtensions()</a>, <a class="el" href="FizzServerContext_8h_source.html#l00258">fizz::server::FizzServerContext::getFactory()</a>, <a class="el" href="Protocol_8h_source.html#l00033">fizz::Protocol::getFinished()</a>, <a class="el" href="ServerProtocol_8cpp_source.html#l00671">getHelloRetryRequest()</a>, <a class="el" href="record_2Types_8cpp_source.html#l00016">fizz::getRealDraftVersion()</a>, <a class="el" href="FizzServerContext_8h_source.html#l00232">fizz::server::FizzServerContext::getReplayCache()</a>, <a class="el" href="ServerProtocol_8cpp_source.html#l00484">getReplayCacheResult()</a>, <a class="el" href="ServerProtocol_8cpp_source.html#l00447">getResumptionState()</a>, <a class="el" href="ServerProtocol_8cpp_source.html#l00707">getServerHello()</a>, <a class="el" href="FizzServerContext_8h_source.html#l00066">fizz::server::FizzServerContext::getSupportedCiphers()</a>, <a class="el" href="FizzServerContext_8h_source.html#l00086">fizz::server::FizzServerContext::getSupportedGroups()</a>, <a class="el" href="FizzServerContext_8h_source.html#l00096">fizz::server::FizzServerContext::getSupportedPskModes()</a>, <a class="el" href="FizzServerContext_8h_source.html#l00076">fizz::server::FizzServerContext::getSupportedSigSchemes()</a>, <a class="el" href="FizzServerContext_8h_source.html#l00056">fizz::server::FizzServerContext::getSupportedVersions()</a>, <a class="el" href="FizzServerContext_8h_source.html#l00153">fizz::server::FizzServerContext::getTicketCipher()</a>, <a class="el" href="FizzServerContext_8h_source.html#l00119">fizz::server::FizzServerContext::getVersionFallbackEnabled()</a>, <a class="el" href="server_2State_8h_source.html#l00118">fizz::server::State::group()</a>, <a class="el" href="ClientProtocol_8cpp_source.html#l01007">group</a>, <a class="el" href="namespacefizz.html#a2d0a99663f1db37e8420c978fd7e8f94a7559811a22a9c4b79332bd85a197e4c5">fizz::Handshake</a>, <a class="el" href="server_2State_8h_source.html#l00310">fizz::server::State::handshakeContext()</a>, <a class="el" href="server_2State_8h_source.html#l00307">fizz::server::State::handshakeReadRecordLayer()</a>, <a class="el" href="fizz_2fizz_2record_2Types_8h_source.html#l00082">fizz::message_hash::hash</a>, <a class="el" href="RecordLayer_8cpp_source.html#l00151">fizz::ReadRecordLayer::hasUnparsedHandshakeData()</a>, <a class="el" href="Optional_8h_source.html#l00300">folly::Optional&lt; Value &gt;::hasValue()</a>, <a class="el" href="namespacefizz.html#a1135430496a56ed55bdfc4a77ccb35fba51ad30e8de321aca8d16fe7a2d9f62c5">fizz::HelloRetryRequest</a>, <a class="el" href="namespacefizz.html#a147eec03bf3a9683f4e214820a1f758aa0bb2e3cfaec11b1cd502d30d896c8b99">fizz::illegal_parameter</a>, <a class="el" href="server_2State_8h_source.html#l00147">fizz::server::State::keyExchangeType()</a>, <a class="el" href="Factory_8h_source.html#l00047">fizz::Factory::makeEncryptedReadRecordLayer()</a>, <a class="el" href="Factory_8h_source.html#l00052">fizz::Factory::makeEncryptedWriteRecordLayer()</a>, <a class="el" href="Factory_8h_source.html#l00076">fizz::Factory::makeHandshakeContext()</a>, <a class="el" href="Factory_8h_source.html#l00037">fizz::Factory::makePlaintextReadRecordLayer()</a>, <a class="el" href="Factory_8h_source.html#l00120">fizz::Factory::makeRandom()</a>, <a class="el" href="IOBufQueue_8h_source.html#l00459">folly::IOBufQueue::move()</a>, <a class="el" href="Base-inl_8h_source.html#l02567">folly::gen::move</a>, <a class="el" href="ServerProtocol_8cpp_source.html#l00756">negotiateAlpn()</a>, <a class="el" href="ServerProtocol_8cpp_source.html#l00514">negotiateCipher()</a>, <a class="el" href="ServerProtocol_8cpp_source.html#l00794">negotiateEarlyDataType()</a>, <a class="el" href="ServerProtocol_8cpp_source.html#l00617">negotiateGroup()</a>, <a class="el" href="ServerProtocol_8cpp_source.html#l00380">negotiateVersion()</a>, <a class="el" href="namespacefizz.html#a7935d663f79e6ee45ba86b8d3b4dad9aa6adf97f83acf6453d4a6a4b1070f3754">fizz::None</a>, <a class="el" href="namespacefizz_1_1server.html#afa366405c336894fd4a7f1c423ab7394a6adf97f83acf6453d4a6a4b1070f3754">fizz::server::None</a>, <a class="el" href="Optional_8h_source.html#l00087">folly::none</a>, <a class="el" href="ServerProtocol_8cpp_source.html#l00443">obfuscatedAge</a>, <a class="el" href="namespacefizz.html#a7935d663f79e6ee45ba86b8d3b4dad9aae04f1d94c053a439406ce62ba6f0ad41">fizz::OneRtt</a>, <a class="el" href="namespacefizz.html#a2d0a99663f1db37e8420c978fd7e8f94a798f266791eff3fab6a382c14e682900">fizz::Plaintext</a>, <a class="el" href="namespacefizz.html#a147eec03bf3a9683f4e214820a1f758aaccc66c059398cf101d1811b511ebd46c">fizz::protocol_version</a>, <a class="el" href="namespacefizz.html#a1e500492a0a0633f62bf1c3d4acea880a92c00e13fa82f0ca393f5b70a6128444">fizz::psk_ke</a>, <a class="el" href="ServerProtocol_8cpp_source.html#l00442">pskMode</a>, <a class="el" href="Range_8h_source.html#l01114">folly::range()</a>, <a class="el" href="server_2State_8h_source.html#l00213">fizz::server::State::readRecordLayer()</a>, <a class="el" href="namespacefizz.html#ab017b61ecd944032c374d31740161131ad37b1f6c0512e2118cee17fea015b699">fizz::Rejected</a>, <a class="el" href="server_2State_8h_source.html#l00161">fizz::server::State::replayCacheResult()</a>, <a class="el" href="FilePoller_8cpp_source.html#l00050">scheduler</a>, <a class="el" href="namespacefizz.html#aee6ee3a2361db233061763b5c5e63dc5a9aa1b03934893d7134a660af4204f2a9">fizz::Server</a>, <a class="el" href="namespacefizz.html#ad4370192b1570b3bd64f596f674f7637ac76ca33886b773a7e21838ad284d431f">fizz::ServerAppTraffic</a>, <a class="el" href="ClientProtocol_8cpp_source.html#l00779">serverCert</a>, <a class="el" href="namespacefizz.html#abf02c5b776bf5134e4b766e77362aec3aef232f5dac3b8f937342e396b0e102c7">fizz::ServerHandshakeTraffic</a>, <a class="el" href="Protocol_8h_source.html#l00020">fizz::Protocol::setAead()</a>, <a class="el" href="RecordLayer_8h_source.html#l00080">fizz::WriteRecordLayer::setProtocolVersion()</a>, <a class="el" href="ServerProtocol_8cpp_source.html#l00536">setupSchedulerAndContext()</a>, <a class="el" href="Poly_8h_source.html#l01165">folly::sig</a>, <a class="el" href="IOBufQueue_8h_source.html#l00428">folly::IOBufQueue::splitAtMost()</a>, <a class="el" href="Extensions_8h_source.html#l00017">fizz::SignatureAlgorithms::supported_signature_algorithms</a>, <a class="el" href="namespacefizz.html#a3a1cbf7ef22de4d4c5144b3090d7ebc1aafa659196b1c05be67f7495345e7d5a1">fizz::tls_1_3_20</a>, <a class="el" href="namespacefizz.html#a3a1cbf7ef22de4d4c5144b3090d7ebc1a8af2ff0742c817e40e459c759fc5a25b">fizz::tls_1_3_21</a>, <a class="el" href="client_2State_8cpp_source.html#l00016">fizz::toString()</a>, <a class="el" href="namespacefizz.html#a147eec03bf3a9683f4e214820a1f758aa597cfdb46675641f694b1f918760d432">fizz::unexpected_message</a>, <a class="el" href="ServerProtocol_8cpp_source.html#l00370">validateClientHello()</a>, <a class="el" href="ServerProtocol_8cpp_source.html#l00496">validateResumptionState()</a>, <a class="el" href="server_2State_8h_source.html#l00104">fizz::server::State::version()</a>, <a class="el" href="ClientProtocol_8cpp_source.html#l01005">version</a>, <a class="el" href="Future-inl_8h_source.html#l01024">folly::Future&lt; T &gt;::via()</a>, <a class="el" href="IOBuf_8cpp_source.html#l00353">folly::IOBuf::wrapBuffer()</a>, <a class="el" href="Types-inl_8h_source.html#l00112">fizz::detail::write()</a>, <a class="el" href="RecordLayer_8h_source.html#l00069">fizz::WriteRecordLayer::writeAppData()</a>, <a class="el" href="RecordLayer_8h_source.html#l00074">fizz::WriteRecordLayer::writeHandshake()</a>, <a class="el" href="PlaintextRecordLayer_8cpp_source.html#l00105">fizz::PlaintextWriteRecordLayer::writeInitialClientHello()</a>, and <a class="el" href="server_2State_8h_source.html#l00223">fizz::server::State::writeRecordLayer()</a>.</p>
<div class="fragment"><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;                                        {</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;  <a class="code" href="namespacefizz.html#a1135430496a56ed55bdfc4a77ccb35fbabb861a7fa47a1dbce10ce727453e054f">CertificateRequest</a> request;</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;  SignatureAlgorithms algos;</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;  algos.supported_signature_algorithms = acceptableSigSchemes;</div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;  request.extensions.push_back(<a class="code" href="namespacefizz.html#af6485298511d0a74eb07b27570e62378">encodeExtension</a>(<a class="code" href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">std::move</a>(algos)));</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;  <span class="keywordflow">if</span> (verifier) {</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;    <span class="keyword">auto</span> verifierExtensions = verifier-&gt;getCertificateRequestExtensions();</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; ext : verifierExtensions) {</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;      request.extensions.push_back(<a class="code" href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">std::move</a>(ext));</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;    }</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;  }</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;  <span class="keyword">auto</span> encodedCertificateRequest = <a class="code" href="namespacefizz.html#a1fef0ecdfd4a6c07fd32b5dd0dcb2b23">encodeHandshake</a>(<a class="code" href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">std::move</a>(request));</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;  handshakeContext.appendToTranscript(encodedCertificateRequest);</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;  <span class="keywordflow">return</span> encodedCertificateRequest;</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;}</div><div class="ttc" id="namespacefizz_html_a1fef0ecdfd4a6c07fd32b5dd0dcb2b23"><div class="ttname"><a href="namespacefizz.html#a1fef0ecdfd4a6c07fd32b5dd0dcb2b23">fizz::encodeHandshake</a></div><div class="ttdeci">Buf encodeHandshake(T &amp;&amp;handshakeMsg)</div><div class="ttdef"><b>Definition:</b> <a href="Types-inl_8h_source.html#l00515">Types-inl.h:515</a></div></div>
<div class="ttc" id="namespacefolly_1_1gen_html_ac24ec252b1b738a40c274285527c193f"><div class="ttname"><a href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">folly::gen::move</a></div><div class="ttdeci">constexpr detail::Map&lt; Move &gt; move</div><div class="ttdef"><b>Definition:</b> <a href="Base-inl_8h_source.html#l02567">Base-inl.h:2567</a></div></div>
<div class="ttc" id="namespacefizz_html_a1135430496a56ed55bdfc4a77ccb35fbabb861a7fa47a1dbce10ce727453e054f"><div class="ttname"><a href="namespacefizz.html#a1135430496a56ed55bdfc4a77ccb35fbabb861a7fa47a1dbce10ce727453e054f">fizz::Event::CertificateRequest</a></div></div>
<div class="ttc" id="namespacefizz_html_af6485298511d0a74eb07b27570e62378"><div class="ttname"><a href="namespacefizz.html#af6485298511d0a74eb07b27570e62378">fizz::encodeExtension</a></div><div class="ttdeci">Extension encodeExtension(const TokenBindingParameters &amp;params)</div><div class="ttdef"><b>Definition:</b> <a href="extensions_2tokenbinding_2Types_8cpp_source.html#l00113">Types.cpp:113</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ab9bb199543996f37302ae426666594c5"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="namespacefizz.html#af020f21a568ff86800e03d6ad2a9b84d">Buf</a> fizz::sm::getCertificateVerify </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespacefizz.html#a1410cf02b9d3a95b34f9dbf22d372749">SignatureScheme</a>&#160;</td>
          <td class="paramname"><em>sigScheme</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacefizz.html#af020f21a568ff86800e03d6ad2a9b84d">Buf</a>&#160;</td>
          <td class="paramname"><em>signature</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classfizz_1_1HandshakeContext.html">HandshakeContext</a> &amp;&#160;</td>
          <td class="paramname"><em>handshakeContext</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ServerProtocol_8cpp_source.html#l00941">941</a> of file <a class="el" href="ServerProtocol_8cpp_source.html">ServerProtocol.cpp</a>.</p>

<p>References <a class="el" href="fizz_2fizz_2record_2Types_8h_source.html#l00273">fizz::CertificateVerify::algorithm</a>, <a class="el" href="classfizz_1_1HandshakeContext.html#a5a9aa3245a54ccfec4a44bd2fdbd7ac8">fizz::HandshakeContext::appendToTranscript()</a>, <a class="el" href="Types-inl_8h_source.html#l00515">fizz::encodeHandshake()</a>, <a class="el" href="Base-inl_8h_source.html#l02567">folly::gen::move</a>, <a class="el" href="fizz_2fizz_2record_2Types_8h_source.html#l00274">fizz::CertificateVerify::signature</a>, and <a class="el" href="StlVectorTest_8cpp_source.html#l01475">verify()</a>.</p>

<p>Referenced by <a class="el" href="ServerProtocol_8cpp_source.html#l00953">getCertificateRequest()</a>.</p>
<div class="fragment"><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;                                        {</div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;  <a class="code" href="namespacefizz.html#a1135430496a56ed55bdfc4a77ccb35fba9827062845b39dfab4ecab4c13a6722a">CertificateVerify</a> <a class="code" href="StlVectorTest_8cpp.html#adc6d47ea22aa64c312b85e9178cfbfff">verify</a>;</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;  verify.algorithm = sigScheme;</div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;  verify.signature = <a class="code" href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">std::move</a>(signature);</div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;  <span class="keyword">auto</span> encodedCertificateVerify = <a class="code" href="namespacefizz.html#a1fef0ecdfd4a6c07fd32b5dd0dcb2b23">encodeHandshake</a>(<a class="code" href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">std::move</a>(verify));</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;  handshakeContext.appendToTranscript(encodedCertificateVerify);</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;  <span class="keywordflow">return</span> encodedCertificateVerify;</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;}</div><div class="ttc" id="namespacefizz_html_a1fef0ecdfd4a6c07fd32b5dd0dcb2b23"><div class="ttname"><a href="namespacefizz.html#a1fef0ecdfd4a6c07fd32b5dd0dcb2b23">fizz::encodeHandshake</a></div><div class="ttdeci">Buf encodeHandshake(T &amp;&amp;handshakeMsg)</div><div class="ttdef"><b>Definition:</b> <a href="Types-inl_8h_source.html#l00515">Types-inl.h:515</a></div></div>
<div class="ttc" id="StlVectorTest_8cpp_html_adc6d47ea22aa64c312b85e9178cfbfff"><div class="ttname"><a href="StlVectorTest_8cpp.html#adc6d47ea22aa64c312b85e9178cfbfff">verify</a></div><div class="ttdeci">void verify(int extras)</div><div class="ttdef"><b>Definition:</b> <a href="StlVectorTest_8cpp_source.html#l01475">StlVectorTest.cpp:1475</a></div></div>
<div class="ttc" id="namespacefolly_1_1gen_html_ac24ec252b1b738a40c274285527c193f"><div class="ttname"><a href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">folly::gen::move</a></div><div class="ttdeci">constexpr detail::Map&lt; Move &gt; move</div><div class="ttdef"><b>Definition:</b> <a href="Base-inl_8h_source.html#l02567">Base-inl.h:2567</a></div></div>
<div class="ttc" id="namespacefizz_html_a1135430496a56ed55bdfc4a77ccb35fba9827062845b39dfab4ecab4c13a6722a"><div class="ttname"><a href="namespacefizz.html#a1135430496a56ed55bdfc4a77ccb35fba9827062845b39dfab4ecab4c13a6722a">fizz::Event::CertificateVerify</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ae24c3ac85b6cdaac0fa07ac8b30f8ba3"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static std::tuple&lt; <a class="el" href="classfolly_1_1Optional.html">folly::Optional</a>&lt;<a class="el" href="namespacefizz.html#a1410cf02b9d3a95b34f9dbf22d372749">SignatureScheme</a>&gt;, std::shared_ptr&lt;const <a class="el" href="classfizz_1_1SelfCert.html">SelfCert</a>&gt; &gt; fizz::sm::getClientCert </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classfizz_1_1client_1_1State.html">State</a> &amp;&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="namespacefizz.html#a1410cf02b9d3a95b34f9dbf22d372749">SignatureScheme</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>schemes</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ClientProtocol_8cpp_source.html#l01278">1278</a> of file <a class="el" href="ClientProtocol_8cpp_source.html">ClientProtocol.cpp</a>.</p>

<p>References <a class="el" href="client_2Actions_8h_source.html#l00086">fizz::client::detail::actions()</a>, <a class="el" href="namespacefizz.html#a1135430496a56ed55bdfc4a77ccb35fbabb861a7fa47a1dbce10ce727453e054f">fizz::CertificateRequest</a>, <a class="el" href="client_2State_8h_source.html#l00092">fizz::client::State::clientAuthRequested()</a>, <a class="el" href="ClientProtocol_8cpp_source.html#l00780">clientCert</a>, <a class="el" href="client_2State_8h_source.html#l00070">fizz::client::State::context()</a>, <a class="el" href="namespacefizz_1_1client.html#a591ea099fd6d034227ea51623074beefaaf63847c3970c97e59978ef247286590">fizz::client::ExpectingCertificate</a>, <a class="el" href="FizzClientContext_8h_source.html#l00108">fizz::client::FizzClientContext::getClientCertificate()</a>, <a class="el" href="FizzClientContext_8h_source.html#l00054">fizz::client::FizzClientContext::getSupportedSigSchemes()</a>, <a class="el" href="client_2State_8h_source.html#l00376">fizz::client::State::handshakeContext()</a>, <a class="el" href="namespacefizz.html#a147eec03bf3a9683f4e214820a1f758aa0bb2e3cfaec11b1cd502d30d896c8b99">fizz::illegal_parameter</a>, <a class="el" href="fizz_2build___2gtest_2src_2gtest_2googletest_2include_2gtest_2internal_2gtest-tuple_8h_source.html#l00675">std::tr1::make_tuple()</a>, <a class="el" href="Base-inl_8h_source.html#l02567">folly::gen::move</a>, <a class="el" href="namespacefizz_1_1client.html#ae43634436661e274189397f450f3683ea0582823afddc13e15c6375c0acef68a8">fizz::client::RequestedNoMatch</a>, <a class="el" href="namespacefizz_1_1client.html#ae43634436661e274189397f450f3683ea7f8c0283f16925caed8e632086b81b9c">fizz::client::Sent</a>, and <a class="el" href="namespacefizz.html#a147eec03bf3a9683f4e214820a1f758aa597cfdb46675641f694b1f918760d432">fizz::unexpected_message</a>.</p>
<div class="fragment"><div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;                                                                             {</div><div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;  <a class="code" href="classfolly_1_1Optional.html">folly::Optional&lt;SignatureScheme&gt;</a> selectedScheme;</div><div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;  <span class="keyword">auto</span> <a class="code" href="ClientProtocol_8cpp.html#a8c2368a5617cb3b337189d0e0a741263">clientCert</a> = state.<a class="code" href="classfizz_1_1client_1_1State.html#ab64506205097dc5732753d70d9040449">context</a>()-&gt;<a class="code" href="classfizz_1_1client_1_1FizzClientContext.html#a9f634146fc11052946d6b2299b2aba3f">getClientCertificate</a>();</div><div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span>&amp; supportedSchemes = state.<a class="code" href="classfizz_1_1client_1_1State.html#ab64506205097dc5732753d70d9040449">context</a>()-&gt;<a class="code" href="classfizz_1_1client_1_1FizzClientContext.html#ad3ea61aff04d85d5d3417a29fbbc8d6a">getSupportedSigSchemes</a>();</div><div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;</div><div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="ClientProtocol_8cpp.html#a8c2368a5617cb3b337189d0e0a741263">clientCert</a>) {</div><div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> certSchemes = <a class="code" href="ClientProtocol_8cpp.html#a8c2368a5617cb3b337189d0e0a741263">clientCert</a>-&gt;getSigSchemes();</div><div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; scheme : supportedSchemes) {</div><div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;      <span class="keywordflow">if</span> (std::find(certSchemes.begin(), certSchemes.end(), scheme) !=</div><div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;              certSchemes.end() &amp;&amp;</div><div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;          std::find(schemes.begin(), schemes.end(), scheme) != schemes.end()) {</div><div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;        selectedScheme = scheme;</div><div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;      }</div><div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;    }</div><div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;</div><div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;    <span class="keywordflow">if</span> (!selectedScheme) {</div><div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;      VLOG(1) &lt;&lt; <span class="stringliteral">&quot;client cert/context doesn&#39;t support any signature algorithms &quot;</span></div><div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;              &lt;&lt; <span class="stringliteral">&quot;specified by the server&quot;</span>;</div><div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;    }</div><div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;  }</div><div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;</div><div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;  <span class="keywordflow">if</span> (!selectedScheme) {</div><div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;    <a class="code" href="ClientProtocol_8cpp.html#a8c2368a5617cb3b337189d0e0a741263">clientCert</a> = <span class="keyword">nullptr</span>;</div><div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;  }</div><div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;</div><div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacestd_1_1tr1.html#af7e12a0f5b5791b5b7c49a5a17b85359">std::make_tuple</a>(<a class="code" href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">std::move</a>(selectedScheme), <a class="code" href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">std::move</a>(<a class="code" href="ClientProtocol_8cpp.html#a8c2368a5617cb3b337189d0e0a741263">clientCert</a>));</div><div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;}</div><div class="ttc" id="namespacefolly_1_1gen_html_ac24ec252b1b738a40c274285527c193f"><div class="ttname"><a href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">folly::gen::move</a></div><div class="ttdeci">constexpr detail::Map&lt; Move &gt; move</div><div class="ttdef"><b>Definition:</b> <a href="Base-inl_8h_source.html#l02567">Base-inl.h:2567</a></div></div>
<div class="ttc" id="namespacestd_1_1tr1_html_af7e12a0f5b5791b5b7c49a5a17b85359"><div class="ttname"><a href="namespacestd_1_1tr1.html#af7e12a0f5b5791b5b7c49a5a17b85359">std::tr1::make_tuple</a></div><div class="ttdeci">tuple make_tuple()</div><div class="ttdef"><b>Definition:</b> <a href="fizz_2build___2gtest_2src_2gtest_2googletest_2include_2gtest_2internal_2gtest-tuple_8h_source.html#l00675">gtest-tuple.h:675</a></div></div>
<div class="ttc" id="classfolly_1_1Optional_html"><div class="ttname"><a href="classfolly_1_1Optional.html">folly::Optional&lt; SignatureScheme &gt;</a></div></div>
<div class="ttc" id="classfizz_1_1client_1_1FizzClientContext_html_ad3ea61aff04d85d5d3417a29fbbc8d6a"><div class="ttname"><a href="classfizz_1_1client_1_1FizzClientContext.html#ad3ea61aff04d85d5d3417a29fbbc8d6a">fizz::client::FizzClientContext::getSupportedSigSchemes</a></div><div class="ttdeci">const auto &amp; getSupportedSigSchemes() const </div><div class="ttdef"><b>Definition:</b> <a href="FizzClientContext_8h_source.html#l00054">FizzClientContext.h:54</a></div></div>
<div class="ttc" id="classfizz_1_1client_1_1State_html_ab64506205097dc5732753d70d9040449"><div class="ttname"><a href="classfizz_1_1client_1_1State.html#ab64506205097dc5732753d70d9040449">fizz::client::State::context</a></div><div class="ttdeci">const FizzClientContext * context() const </div><div class="ttdef"><b>Definition:</b> <a href="client_2State_8h_source.html#l00070">State.h:70</a></div></div>
<div class="ttc" id="ClientProtocol_8cpp_html_a8c2368a5617cb3b337189d0e0a741263"><div class="ttname"><a href="ClientProtocol_8cpp.html#a8c2368a5617cb3b337189d0e0a741263">clientCert</a></div><div class="ttdeci">std::shared_ptr&lt; const Cert &gt; clientCert</div><div class="ttdef"><b>Definition:</b> <a href="ClientProtocol_8cpp_source.html#l00780">ClientProtocol.cpp:780</a></div></div>
<div class="ttc" id="classfizz_1_1client_1_1FizzClientContext_html_a9f634146fc11052946d6b2299b2aba3f"><div class="ttname"><a href="classfizz_1_1client_1_1FizzClientContext.html#a9f634146fc11052946d6b2299b2aba3f">fizz::client::FizzClientContext::getClientCertificate</a></div><div class="ttdeci">const auto &amp; getClientCertificate() const </div><div class="ttdef"><b>Definition:</b> <a href="FizzClientContext_8h_source.html#l00108">FizzClientContext.h:108</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a633e0f785158f85ece0161e42edb81cb"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="structfizz_1_1ClientHello.html">ClientHello</a> fizz::sm::getClientHello </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classfizz_1_1Factory.html">Factory</a> &amp;&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespacefizz.html#a796015128e6988829a7719b9cb09749e">Random</a> &amp;&#160;</td>
          <td class="paramname"><em>random</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="namespacefizz.html#a23e4ec7baa80cc6f92fdbeadccf0d22e">CipherSuite</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>supportedCiphers</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="namespacefizz.html#a3a1cbf7ef22de4d4c5144b3090d7ebc1">ProtocolVersion</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>supportedVersions</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="namespacefizz.html#a11069edebaa08949c9a6696ef4bb85e2">NamedGroup</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>supportedGroups</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="PackedSyncPtrTest_8cpp.html#a2a761d9ec8bcdc907b3e45a3ba097c32">std::map</a>&lt; <a class="el" href="namespacefizz.html#a11069edebaa08949c9a6696ef4bb85e2">NamedGroup</a>, std::unique_ptr&lt; <a class="el" href="classfizz_1_1KeyExchange.html">KeyExchange</a> &gt;&gt; &amp;&#160;</td>
          <td class="paramname"><em>shares</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="namespacefizz.html#a1410cf02b9d3a95b34f9dbf22d372749">SignatureScheme</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>supportedSigSchemes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="namespacefizz.html#a1e500492a0a0633f62bf1c3d4acea880">PskKeyExchangeMode</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>supportedPskModes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classfolly_1_1Optional.html">folly::Optional</a>&lt; <a class="el" href="Conv_8cpp.html#ae1adbce218e7a9d09164012443191d24">std::string</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>hostname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="Conv_8cpp.html#ae1adbce218e7a9d09164012443191d24">std::string</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>supportedAlpns</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="namespacefizz.html#aef5b19e8cb60e324e310f0a9f2afdd95">CertificateCompressionAlgorithm</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>compressionAlgos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classfolly_1_1Optional.html">Optional</a>&lt; <a class="el" href="structfizz_1_1client_1_1EarlyDataParams.html">EarlyDataParams</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>earlyDataParams</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespacefizz.html#af020f21a568ff86800e03d6ad2a9b84d">Buf</a> &amp;&#160;</td>
          <td class="paramname"><em>legacySessionId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classfizz_1_1ClientExtensions.html">ClientExtensions</a> *&#160;</td>
          <td class="paramname"><em>extensions</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacefizz.html#af020f21a568ff86800e03d6ad2a9b84d">Buf</a>&#160;</td>
          <td class="paramname"><em>cookie</em> = <code><a class="el" href="http__parser__cpp_8cpp.html#ab979d9d4b4923f7c54d6caa6e1a61936">nullptr</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ClientProtocol_8cpp_source.html#l00333">333</a> of file <a class="el" href="ClientProtocol_8cpp_source.html">ClientProtocol.cpp</a>.</p>

<p>References <a class="el" href="Extensions_8h_source.html#l00143">fizz::CertificateCompressionAlgorithms::algorithms</a>, <a class="el" href="ExtensionsTest_8cpp_source.html#l00022">alpn</a>, <a class="el" href="HandshakeTypesTest_8cpp_source.html#l00023">chlo</a>, <a class="el" href="fizz_2fizz_2record_2Types_8h_source.html#l00191">fizz::ClientHello::cipher_suites</a>, <a class="el" href="Extensions_8h_source.html#l00034">fizz::ClientKeyShare::client_shares</a>, <a class="el" href="ExtensionsTest_8cpp_source.html#l00028">cookie</a>, <a class="el" href="Extensions_8h_source.html#l00088">fizz::Cookie::cookie</a>, <a class="el" href="IOBuf_8h_source.html#l01587">folly::IOBuf::copyBuffer()</a>, <a class="el" href="extensions_2tokenbinding_2Types_8cpp_source.html#l00113">fizz::encodeExtension()</a>, <a class="el" href="fizz_2fizz_2record_2Types_8h_source.html#l00193">fizz::ClientHello::extensions</a>, <a class="el" href="classfizz_1_1ClientExtensions.html#abbe437e9fae065090953e8bf75f06d3f">fizz::ClientExtensions::getClientHelloExtensions()</a>, <a class="el" href="Extensions_8h_source.html#l00029">fizz::KeyShareEntry::group</a>, <a class="el" href="Extensions_8h_source.html#l00124">fizz::ServerName::hostname</a>, <a class="el" href="Extensions_8h_source.html#l00030">fizz::KeyShareEntry::key_exchange</a>, <a class="el" href="fizz_2fizz_2record_2Types_8h_source.html#l00192">fizz::ClientHello::legacy_compression_methods</a>, <a class="el" href="fizz_2fizz_2record_2Types_8h_source.html#l00190">fizz::ClientHello::legacy_session_id</a>, <a class="el" href="fizz_2fizz_2record_2Types_8h_source.html#l00188">fizz::ClientHello::legacy_version</a>, <a class="el" href="Extensions_8h_source.html#l00105">fizz::PskKeyExchangeModes::modes</a>, <a class="el" href="Base-inl_8h_source.html#l02567">folly::gen::move</a>, <a class="el" href="Extensions_8h_source.html#l00111">fizz::ProtocolName::name</a>, <a class="el" href="Extensions_8h_source.html#l00023">fizz::SupportedGroups::named_group_list</a>, <a class="el" href="Extensions_8h_source.html#l00115">fizz::ProtocolNameList::protocol_name_list</a>, <a class="el" href="FBStringBenchmark_8cpp_source.html#l00042">random()</a>, <a class="el" href="fizz_2fizz_2record_2Types_8h_source.html#l00189">fizz::ClientHello::random</a>, <a class="el" href="Extensions_8h_source.html#l00128">fizz::ServerNameList::server_name_list</a>, <a class="el" href="share_8h_source.html#l00053">folly::pushmi::operators::share</a>, <a class="el" href="ExtensionsTest_8cpp_source.html#l00023">sni</a>, <a class="el" href="Extensions_8h_source.html#l00017">fizz::SignatureAlgorithms::supported_signature_algorithms</a>, <a class="el" href="namespacefizz.html#a3a1cbf7ef22de4d4c5144b3090d7ebc1a19640bc085d73d380771b141df331ae6">fizz::tls_1_2</a>, and <a class="el" href="Extensions_8h_source.html#l00093">fizz::SupportedVersions::versions</a>.</p>

<p>Referenced by <a class="el" href="ClientProtocol_8cpp_source.html#l00498">getEarlyDataParams()</a>, <a class="el" href="ClientProtocol_8cpp_source.html#l01036">getHrrKeyExchangers()</a>, and <a class="el" href="AeadCookieCipherTest_8cpp_source.html#l00072">fizz::server::test::TEST_F()</a>.</p>
<div class="fragment"><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;                          {</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;  <a class="code" href="namespacefizz.html#a1135430496a56ed55bdfc4a77ccb35fba6c9bc94067a94a346562a06539fc68c2">ClientHello</a> <a class="code" href="HandshakeTypesTest_8cpp.html#aba518b904616df44c3d7dfde825a4c54">chlo</a>;</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;  chlo.legacy_version = ProtocolVersion::tls_1_2;</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;  chlo.random = <a class="code" href="FBStringBenchmark_8cpp.html#a0f5dc778f46ef846ca354b005f6ff3f4">random</a>;</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;  chlo.legacy_session_id = legacySessionId-&gt;clone();</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;  chlo.cipher_suites = supportedCiphers;</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;  chlo.legacy_compression_methods.push_back(0x00);</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;  SupportedVersions versions;</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;  versions.versions = supportedVersions;</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;  chlo.extensions.push_back(<a class="code" href="namespacefizz.html#af6485298511d0a74eb07b27570e62378">encodeExtension</a>(<a class="code" href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">std::move</a>(versions)));</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;  SupportedGroups groups;</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;  groups.named_group_list = supportedGroups;</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;  chlo.extensions.push_back(<a class="code" href="namespacefizz.html#af6485298511d0a74eb07b27570e62378">encodeExtension</a>(<a class="code" href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">std::move</a>(groups)));</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;  ClientKeyShare keyShare;</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; <a class="code" href="namespacefolly_1_1pushmi_1_1operators.html#a3579d804a0ba5b8e323f96858f94c4e6">share</a> : shares) {</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    KeyShareEntry entry;</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    entry.group = <a class="code" href="namespacefolly_1_1pushmi_1_1operators.html#a3579d804a0ba5b8e323f96858f94c4e6">share</a>.first;</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    entry.key_exchange = <a class="code" href="namespacefolly_1_1pushmi_1_1operators.html#a3579d804a0ba5b8e323f96858f94c4e6">share</a>.second-&gt;getKeyShare();</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    keyShare.client_shares.push_back(<a class="code" href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">std::move</a>(entry));</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;  }</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;  chlo.extensions.push_back(<a class="code" href="namespacefizz.html#af6485298511d0a74eb07b27570e62378">encodeExtension</a>(<a class="code" href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">std::move</a>(keyShare)));</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;  SignatureAlgorithms sigAlgs;</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;  sigAlgs.supported_signature_algorithms = supportedSigSchemes;</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;  chlo.extensions.push_back(<a class="code" href="namespacefizz.html#af6485298511d0a74eb07b27570e62378">encodeExtension</a>(<a class="code" href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">std::move</a>(sigAlgs)));</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;  <span class="keywordflow">if</span> (hostname) {</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    ServerNameList <a class="code" href="ExtensionsTest_8cpp.html#add4169bd6ee9aa37de918700cbc2938f">sni</a>;</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    ServerName sn;</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    sn.hostname = <a class="code" href="classfolly_1_1IOBuf.html#aa1c4b32cfaa7c96d591d8ad5f5f7b959">folly::IOBuf::copyBuffer</a>(*hostname);</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    sni.server_name_list.push_back(<a class="code" href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">std::move</a>(sn));</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    chlo.extensions.push_back(<a class="code" href="namespacefizz.html#af6485298511d0a74eb07b27570e62378">encodeExtension</a>(<a class="code" href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">std::move</a>(sni)));</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;  }</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;  <span class="keywordflow">if</span> (!supportedAlpns.empty()) {</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    ProtocolNameList <a class="code" href="ExtensionsTest_8cpp.html#af3a28898b95e8b84c27bda7309ad2fd5">alpn</a>;</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; protoName : supportedAlpns) {</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;      ProtocolName proto;</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;      proto.name = <a class="code" href="classfolly_1_1IOBuf.html#aa1c4b32cfaa7c96d591d8ad5f5f7b959">folly::IOBuf::copyBuffer</a>(protoName);</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;      alpn.protocol_name_list.push_back(<a class="code" href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">std::move</a>(proto));</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    }</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    chlo.extensions.push_back(<a class="code" href="namespacefizz.html#af6485298511d0a74eb07b27570e62378">encodeExtension</a>(<a class="code" href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">std::move</a>(alpn)));</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;  }</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;  <span class="keywordflow">if</span> (!supportedPskModes.empty()) {</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    PskKeyExchangeModes modes;</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    modes.modes = supportedPskModes;</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    chlo.extensions.push_back(<a class="code" href="namespacefizz.html#af6485298511d0a74eb07b27570e62378">encodeExtension</a>(<a class="code" href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">std::move</a>(modes)));</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;  }</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;  <span class="keywordflow">if</span> (earlyDataParams) {</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    chlo.extensions.push_back(<a class="code" href="namespacefizz.html#af6485298511d0a74eb07b27570e62378">encodeExtension</a>(ClientEarlyData()));</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;  }</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="ExtensionsTest_8cpp.html#a47e68f25943ee47d7594c89d78fad4a6">cookie</a>) {</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    Cookie monster;</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    monster.cookie = <a class="code" href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">std::move</a>(<a class="code" href="ExtensionsTest_8cpp.html#a47e68f25943ee47d7594c89d78fad4a6">cookie</a>);</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    chlo.extensions.push_back(<a class="code" href="namespacefizz.html#af6485298511d0a74eb07b27570e62378">encodeExtension</a>(<a class="code" href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">std::move</a>(monster)));</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;  }</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;  <span class="keywordflow">if</span> (!compressionAlgos.empty()) {</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    CertificateCompressionAlgorithms algos;</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    algos.algorithms = compressionAlgos;</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    chlo.extensions.push_back(<a class="code" href="namespacefizz.html#af6485298511d0a74eb07b27570e62378">encodeExtension</a>(<a class="code" href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">std::move</a>(algos)));</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;  }</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;  <span class="keywordflow">if</span> (extensions) {</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    <span class="keyword">auto</span> additionalExtensions = extensions-&gt;getClientHelloExtensions();</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; ext : additionalExtensions) {</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;      chlo.extensions.push_back(<a class="code" href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">std::move</a>(ext));</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    }</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;  }</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="HandshakeTypesTest_8cpp.html#aba518b904616df44c3d7dfde825a4c54">chlo</a>;</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;}</div><div class="ttc" id="FBStringBenchmark_8cpp_html_a0f5dc778f46ef846ca354b005f6ff3f4"><div class="ttname"><a href="FBStringBenchmark_8cpp.html#a0f5dc778f46ef846ca354b005f6ff3f4">random</a></div><div class="ttdeci">Integral2 random(Integral1 low, Integral2 up)</div><div class="ttdef"><b>Definition:</b> <a href="FBStringBenchmark_8cpp_source.html#l00042">FBStringBenchmark.cpp:42</a></div></div>
<div class="ttc" id="HandshakeTypesTest_8cpp_html_aba518b904616df44c3d7dfde825a4c54"><div class="ttname"><a href="HandshakeTypesTest_8cpp.html#aba518b904616df44c3d7dfde825a4c54">chlo</a></div><div class="ttdeci">static const std::string chlo</div><div class="ttdef"><b>Definition:</b> <a href="HandshakeTypesTest_8cpp_source.html#l00023">HandshakeTypesTest.cpp:23</a></div></div>
<div class="ttc" id="namespacefolly_1_1pushmi_1_1operators_html_a3579d804a0ba5b8e323f96858f94c4e6"><div class="ttname"><a href="namespacefolly_1_1pushmi_1_1operators.html#a3579d804a0ba5b8e323f96858f94c4e6">folly::pushmi::operators::share</a></div><div class="ttdeci">PUSHMI_INLINE_VAR constexpr detail::share_fn&lt; TN... &gt; share</div><div class="ttdef"><b>Definition:</b> <a href="share_8h_source.html#l00053">share.h:53</a></div></div>
<div class="ttc" id="ExtensionsTest_8cpp_html_a47e68f25943ee47d7594c89d78fad4a6"><div class="ttname"><a href="ExtensionsTest_8cpp.html#a47e68f25943ee47d7594c89d78fad4a6">cookie</a></div><div class="ttdeci">StringPiece cookie</div><div class="ttdef"><b>Definition:</b> <a href="ExtensionsTest_8cpp_source.html#l00028">ExtensionsTest.cpp:28</a></div></div>
<div class="ttc" id="namespacefolly_1_1gen_html_ac24ec252b1b738a40c274285527c193f"><div class="ttname"><a href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">folly::gen::move</a></div><div class="ttdeci">constexpr detail::Map&lt; Move &gt; move</div><div class="ttdef"><b>Definition:</b> <a href="Base-inl_8h_source.html#l02567">Base-inl.h:2567</a></div></div>
<div class="ttc" id="ExtensionsTest_8cpp_html_af3a28898b95e8b84c27bda7309ad2fd5"><div class="ttname"><a href="ExtensionsTest_8cpp.html#af3a28898b95e8b84c27bda7309ad2fd5">alpn</a></div><div class="ttdeci">StringPiece alpn</div><div class="ttdef"><b>Definition:</b> <a href="ExtensionsTest_8cpp_source.html#l00022">ExtensionsTest.cpp:22</a></div></div>
<div class="ttc" id="ExtensionsTest_8cpp_html_add4169bd6ee9aa37de918700cbc2938f"><div class="ttname"><a href="ExtensionsTest_8cpp.html#add4169bd6ee9aa37de918700cbc2938f">sni</a></div><div class="ttdeci">StringPiece sni</div><div class="ttdef"><b>Definition:</b> <a href="ExtensionsTest_8cpp_source.html#l00023">ExtensionsTest.cpp:23</a></div></div>
<div class="ttc" id="namespacefizz_html_a1135430496a56ed55bdfc4a77ccb35fba6c9bc94067a94a346562a06539fc68c2"><div class="ttname"><a href="namespacefizz.html#a1135430496a56ed55bdfc4a77ccb35fba6c9bc94067a94a346562a06539fc68c2">fizz::Event::ClientHello</a></div></div>
<div class="ttc" id="namespacefizz_html_af6485298511d0a74eb07b27570e62378"><div class="ttname"><a href="namespacefizz.html#af6485298511d0a74eb07b27570e62378">fizz::encodeExtension</a></div><div class="ttdeci">Extension encodeExtension(const TokenBindingParameters &amp;params)</div><div class="ttdef"><b>Definition:</b> <a href="extensions_2tokenbinding_2Types_8cpp_source.html#l00113">Types.cpp:113</a></div></div>
<div class="ttc" id="classfolly_1_1IOBuf_html_aa1c4b32cfaa7c96d591d8ad5f5f7b959"><div class="ttname"><a href="classfolly_1_1IOBuf.html#aa1c4b32cfaa7c96d591d8ad5f5f7b959">folly::IOBuf::copyBuffer</a></div><div class="ttdeci">static std::unique_ptr&lt; IOBuf &gt; copyBuffer(const void *buf, std::size_t size, std::size_t headroom=0, std::size_t minTailroom=0)</div><div class="ttdef"><b>Definition:</b> <a href="IOBuf_8h_source.html#l01587">IOBuf.h:1587</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a708a6d968e319b72fe49694081ca74b0"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="classfolly_1_1Optional.html">Optional</a>&lt;std::chrono::milliseconds&gt; fizz::sm::getClockSkew </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classfolly_1_1Optional.html">Optional</a>&lt; <a class="el" href="structfizz_1_1server_1_1ResumptionState.html">ResumptionState</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>psk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classfolly_1_1Optional.html">Optional</a>&lt; <a class="el" href="ConstexprMathBenchmark_8cpp.html#a09a1e304d66d35dd47daffee9731edaa">uint32_t</a> &gt;&#160;</td>
          <td class="paramname"><em>obfuscatedAge</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ServerProtocol_8cpp_source.html#l00778">778</a> of file <a class="el" href="ServerProtocol_8cpp_source.html">ServerProtocol.cpp</a>.</p>

<p>References <a class="el" href="Optional_8h_source.html#l00087">folly::none</a>, <a class="el" href="TimekeeperTest_8cpp_source.html#l00031">now()</a>, <a class="el" href="ResumptionState_8h_source.html#l00027">fizz::server::ResumptionState::ticketAgeAdd</a>, and <a class="el" href="ResumptionState_8h_source.html#l00028">fizz::server::ResumptionState::ticketIssueTime</a>.</p>

<p>Referenced by <a class="el" href="ServerProtocol_8cpp_source.html#l00953">getCertificateRequest()</a>.</p>
<div class="fragment"><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;                                      {</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;  <span class="keywordflow">if</span> (!psk || !obfuscatedAge) {</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacefolly.html#ac22c63dbe5af3b0bedb0f21031691537">folly::none</a>;</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;  }</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;  <span class="keyword">auto</span> age = std::chrono::milliseconds(</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;      static_cast&lt;uint32_t&gt;(*obfuscatedAge - psk-&gt;<a class="code" href="structfizz_1_1server_1_1ResumptionState.html#a0ed761e91ea9e971fe08c56d86befd2a">ticketAgeAdd</a>));</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;  <span class="keyword">auto</span> expected = std::chrono::duration_cast&lt;std::chrono::milliseconds&gt;(</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;      <a class="code" href="TimekeeperTest_8cpp.html#a562b4baa36dcf267f35a4ba4e0aef329">std::chrono::system_clock::now</a>() - psk-&gt;<a class="code" href="structfizz_1_1server_1_1ResumptionState.html#a7c1e946dac60b43e69500231c329e896">ticketIssueTime</a>);</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;  <span class="keywordflow">return</span> std::chrono::milliseconds(age - expected);</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;}</div><div class="ttc" id="structfizz_1_1server_1_1ResumptionState_html_a0ed761e91ea9e971fe08c56d86befd2a"><div class="ttname"><a href="structfizz_1_1server_1_1ResumptionState.html#a0ed761e91ea9e971fe08c56d86befd2a">fizz::server::ResumptionState::ticketAgeAdd</a></div><div class="ttdeci">uint32_t ticketAgeAdd</div><div class="ttdef"><b>Definition:</b> <a href="ResumptionState_8h_source.html#l00027">ResumptionState.h:27</a></div></div>
<div class="ttc" id="TimekeeperTest_8cpp_html_a562b4baa36dcf267f35a4ba4e0aef329"><div class="ttname"><a href="TimekeeperTest_8cpp.html#a562b4baa36dcf267f35a4ba4e0aef329">now</a></div><div class="ttdeci">std::chrono::steady_clock::time_point now()</div><div class="ttdef"><b>Definition:</b> <a href="TimekeeperTest_8cpp_source.html#l00031">TimekeeperTest.cpp:31</a></div></div>
<div class="ttc" id="structfizz_1_1server_1_1ResumptionState_html_a7c1e946dac60b43e69500231c329e896"><div class="ttname"><a href="structfizz_1_1server_1_1ResumptionState.html#a7c1e946dac60b43e69500231c329e896">fizz::server::ResumptionState::ticketIssueTime</a></div><div class="ttdeci">std::chrono::system_clock::time_point ticketIssueTime</div><div class="ttdef"><b>Definition:</b> <a href="ResumptionState_8h_source.html#l00028">ResumptionState.h:28</a></div></div>
<div class="ttc" id="namespacefolly_html_ac22c63dbe5af3b0bedb0f21031691537"><div class="ttname"><a href="namespacefolly.html#ac22c63dbe5af3b0bedb0f21031691537">folly::none</a></div><div class="ttdeci">constexpr None none</div><div class="ttdef"><b>Definition:</b> <a href="Optional_8h_source.html#l00087">Optional.h:87</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a608010fb3d6c87adc53661b826d9d8ee"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="classfolly_1_1Optional.html">Optional</a>&lt;<a class="el" href="structfizz_1_1server_1_1CookieState.html">CookieState</a>&gt; fizz::sm::getCookieState </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structfizz_1_1ClientHello.html">ClientHello</a> &amp;&#160;</td>
          <td class="paramname"><em>chlo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacefizz.html#a3a1cbf7ef22de4d4c5144b3090d7ebc1">ProtocolVersion</a>&#160;</td>
          <td class="paramname"><em>version</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacefizz.html#a23e4ec7baa80cc6f92fdbeadccf0d22e">CipherSuite</a>&#160;</td>
          <td class="paramname"><em>cipher</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classfizz_1_1server_1_1CookieCipher.html">CookieCipher</a> *&#160;</td>
          <td class="paramname"><em>cookieCipher</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ServerProtocol_8cpp_source.html#l00394">394</a> of file <a class="el" href="ServerProtocol_8cpp_source.html">ServerProtocol.cpp</a>.</p>

<p>References <a class="el" href="classfizz_1_1server_1_1CookieCipher.html#a9893c8fdc1ad3c4515122956d115276e">fizz::server::CookieCipher::decrypt()</a>, <a class="el" href="namespacefizz.html#a147eec03bf3a9683f4e214820a1f758aae75cba472a2ac192de9a705aee85463e">fizz::decrypt_error</a>, <a class="el" href="fizz_2fizz_2record_2Types_8h_source.html#l00193">fizz::ClientHello::extensions</a>, <a class="el" href="ServerProtocol_8cpp_source.html#l00441">futureResState</a>, <a class="el" href="namespacefizz.html#a147eec03bf3a9683f4e214820a1f758aa79db796776246d2c3aaca8b375e662c4">fizz::handshake_failure</a>, <a class="el" href="Base-inl_8h_source.html#l02567">folly::gen::move</a>, <a class="el" href="Optional_8h_source.html#l00087">folly::none</a>, <a class="el" href="ServerProtocol_8cpp_source.html#l00443">obfuscatedAge</a>, <a class="el" href="namespacefizz.html#a147eec03bf3a9683f4e214820a1f758aaccc66c059398cf101d1811b511ebd46c">fizz::protocol_version</a>, <a class="el" href="ServerProtocol_8cpp_source.html#l00442">pskMode</a>, and <a class="el" href="namespacefizz.html#a147eec03bf3a9683f4e214820a1f758aa415fd1cf3c6858f0f7e2bd8094e49047">fizz::unsupported_extension</a>.</p>
<div class="fragment"><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;                                      {</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;  <span class="keyword">auto</span> cookieExt = getExtension&lt;Cookie&gt;(<a class="code" href="HandshakeTypesTest_8cpp.html#aba518b904616df44c3d7dfde825a4c54">chlo</a>.extensions);</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;  <span class="keywordflow">if</span> (!cookieExt) {</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacefolly.html#ac22c63dbe5af3b0bedb0f21031691537">folly::none</a>;</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;  }</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;  <span class="comment">// If the client sent a cookie we can&#39;t use we have to consider it a fatal</span></div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;  <span class="comment">// error since we can&#39;t reconstruct the handshake transcript.</span></div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;  <span class="keywordflow">if</span> (!cookieCipher) {</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    <span class="keywordflow">throw</span> FizzException(</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;        <span class="stringliteral">&quot;no cookie cipher&quot;</span>, AlertDescription::unsupported_extension);</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;  }</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;  <span class="keyword">auto</span> cookieState = cookieCipher-&gt;<a class="code" href="classfizz_1_1server_1_1CookieCipher.html#a9893c8fdc1ad3c4515122956d115276e">decrypt</a>(<a class="code" href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">std::move</a>(cookieExt-&gt;cookie));</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;  <span class="keywordflow">if</span> (!cookieState) {</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    <span class="keywordflow">throw</span> FizzException(</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;        <span class="stringliteral">&quot;could not decrypt cookie&quot;</span>, AlertDescription::decrypt_error);</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;  }</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;  <span class="keywordflow">if</span> (cookieState-&gt;version != <a class="code" href="ClientProtocol_8cpp.html#abe1b247743d4691ae90a9b12b08cc176">version</a>) {</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    <span class="keywordflow">throw</span> FizzException(</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;        <span class="stringliteral">&quot;version mismatch with cookie&quot;</span>, AlertDescription::protocol_version);</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;  }</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;  <span class="keywordflow">if</span> (cookieState-&gt;cipher != <a class="code" href="ClientProtocol_8cpp.html#aa7e60e524fbc7254437c13c7d22a9dfa">cipher</a>) {</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    <span class="keywordflow">throw</span> FizzException(</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;        <span class="stringliteral">&quot;cipher mismatch with cookie&quot;</span>, AlertDescription::handshake_failure);</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;  }</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;  <span class="keywordflow">return</span> cookieState;</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;}</div><div class="ttc" id="HandshakeTypesTest_8cpp_html_aba518b904616df44c3d7dfde825a4c54"><div class="ttname"><a href="HandshakeTypesTest_8cpp.html#aba518b904616df44c3d7dfde825a4c54">chlo</a></div><div class="ttdeci">static const std::string chlo</div><div class="ttdef"><b>Definition:</b> <a href="HandshakeTypesTest_8cpp_source.html#l00023">HandshakeTypesTest.cpp:23</a></div></div>
<div class="ttc" id="namespacefolly_1_1gen_html_ac24ec252b1b738a40c274285527c193f"><div class="ttname"><a href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">folly::gen::move</a></div><div class="ttdeci">constexpr detail::Map&lt; Move &gt; move</div><div class="ttdef"><b>Definition:</b> <a href="Base-inl_8h_source.html#l02567">Base-inl.h:2567</a></div></div>
<div class="ttc" id="classfizz_1_1server_1_1CookieCipher_html_a9893c8fdc1ad3c4515122956d115276e"><div class="ttname"><a href="classfizz_1_1server_1_1CookieCipher.html#a9893c8fdc1ad3c4515122956d115276e">fizz::server::CookieCipher::decrypt</a></div><div class="ttdeci">virtual folly::Optional&lt; CookieState &gt; decrypt(Buf) const =0</div></div>
<div class="ttc" id="ClientProtocol_8cpp_html_aa7e60e524fbc7254437c13c7d22a9dfa"><div class="ttname"><a href="ClientProtocol_8cpp.html#aa7e60e524fbc7254437c13c7d22a9dfa">cipher</a></div><div class="ttdeci">CipherSuite cipher</div><div class="ttdef"><b>Definition:</b> <a href="ClientProtocol_8cpp_source.html#l01006">ClientProtocol.cpp:1006</a></div></div>
<div class="ttc" id="ClientProtocol_8cpp_html_abe1b247743d4691ae90a9b12b08cc176"><div class="ttname"><a href="ClientProtocol_8cpp.html#abe1b247743d4691ae90a9b12b08cc176">version</a></div><div class="ttdeci">ProtocolVersion version</div><div class="ttdef"><b>Definition:</b> <a href="ClientProtocol_8cpp_source.html#l01005">ClientProtocol.cpp:1005</a></div></div>
<div class="ttc" id="namespacefolly_html_ac22c63dbe5af3b0bedb0f21031691537"><div class="ttname"><a href="namespacefolly.html#ac22c63dbe5af3b0bedb0f21031691537">folly::none</a></div><div class="ttdeci">constexpr None none</div><div class="ttdef"><b>Definition:</b> <a href="Optional_8h_source.html#l00087">Optional.h:87</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a5762d174435b87040bb9e13f3aad652c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="classfolly_1_1Optional.html">Optional</a>&lt;<a class="el" href="structfizz_1_1client_1_1EarlyDataParams.html">EarlyDataParams</a>&gt; fizz::sm::getEarlyDataParams </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classfizz_1_1client_1_1FizzClientContext.html">FizzClientContext</a> &amp;&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classfolly_1_1Optional.html">Optional</a>&lt; <a class="el" href="structfizz_1_1client_1_1CachedPsk.html">CachedPsk</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>psk</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ClientProtocol_8cpp_source.html#l00498">498</a> of file <a class="el" href="ClientProtocol_8cpp_source.html">ClientProtocol.cpp</a>.</p>

<p>References <a class="el" href="client_2Actions_8h_source.html#l00086">fizz::client::detail::actions()</a>, <a class="el" href="PskCache_8h_source.html#l00032">fizz::client::CachedPsk::alpn</a>, <a class="el" href="client_2State_8h_source.html#l00054">fizz::client::EarlyDataParams::alpn</a>, <a class="el" href="namespacefizz.html#a02f9d49d996b83310b2a38e93684c959ac52c6eeafe7207599f51d08a22226ca8">fizz::Attempted</a>, <a class="el" href="HandshakeTypesTest_8cpp_source.html#l00023">chlo</a>, <a class="el" href="PskCache_8h_source.html#l00026">fizz::client::CachedPsk::cipher</a>, <a class="el" href="client_2State_8h_source.html#l00051">fizz::client::EarlyDataParams::cipher</a>, <a class="el" href="PskCache_8h_source.html#l00029">fizz::client::CachedPsk::clientCert</a>, <a class="el" href="client_2State_8h_source.html#l00053">fizz::client::EarlyDataParams::clientCert</a>, <a class="el" href="namespacefizz.html#a9d0163dd2203bcf4649a864a2bde8343aa65ad49b67d44f90c54189480b7c4f17">fizz::ClientEarlyTraffic</a>, <a class="el" href="NetOps_8cpp_source.html#l00094">folly::netops::connect()</a>, <a class="el" href="protocol_2Actions_8h_source.html#l00041">fizz::WriteToSocket::contents</a>, <a class="el" href="fizz_2build___2CMakeCache_8txt_source.html#l00563">context</a>, <a class="el" href="IOBuf_8h_source.html#l01587">folly::IOBuf::copyBuffer()</a>, <a class="el" href="IOBuf_8cpp_source.html#l00229">folly::IOBuf::create()</a>, <a class="el" href="namespacefizz.html#a2d0a99663f1db37e8420c978fd7e8f94a946fc6845f6e1bb20623d368b9bdb2b7">fizz::EarlyData</a>, <a class="el" href="client_2State_8h_source.html#l00163">fizz::client::State::earlyDataParams()</a>, <a class="el" href="namespacefizz.html#a9d0163dd2203bcf4649a864a2bde8343a99b6ce1926735b666a7069a498d96207">fizz::EarlyExporter</a>, <a class="el" href="client_2State_8h_source.html#l00254">fizz::client::State::earlyWriteRecordLayer()</a>, <a class="el" href="ClientProtocol_8cpp_source.html#l00452">encodeAndAddBinders()</a>, <a class="el" href="Types-inl_8h_source.html#l00515">fizz::encodeHandshake()</a>, <a class="el" href="ClientProtocol_8cpp_source.html#l00333">getClientHello()</a>, <a class="el" href="ClientProtocol_8cpp_source.html#l00321">getKeyExchangers()</a>, <a class="el" href="FizzClientContext_8h_source.html#l00146">fizz::client::FizzClientContext::getSendEarlyData()</a>, <a class="el" href="FizzClientContext_8h_source.html#l00097">fizz::client::FizzClientContext::getSupportedAlpns()</a>, <a class="el" href="PskCache_8h_source.html#l00027">fizz::client::CachedPsk::group</a>, <a class="el" href="PskCache_8h_source.html#l00031">fizz::client::CachedPsk::maxEarlyDataSize</a>, <a class="el" href="client_2Actions_8h_source.html#l00034">fizz::client::ReportEarlyHandshakeSuccess::maxEarlyDataSize</a>, <a class="el" href="Base-inl_8h_source.html#l02567">folly::gen::move</a>, <a class="el" href="Optional_8h_source.html#l00087">folly::none</a>, <a class="el" href="namespacefizz.html#ab017b61ecd944032c374d31740161131aa65db4b39dd3b01787474dcdb81af5f0">fizz::NotAttempted</a>, <a class="el" href="FlatCombiningTest_8cpp_source.html#l00094">params</a>, <a class="el" href="namespacefizz.html#aa3a52f2e1d30e609c80fb3b50f641463a3466c6cb0b39a09c99318891dd818fdb">fizz::pre_shared_key</a>, <a class="el" href="FBStringBenchmark_8cpp_source.html#l00042">random()</a>, <a class="el" href="Range_8h_source.html#l01114">folly::range()</a>, <a class="el" href="PskCache_8h_source.html#l00028">fizz::client::CachedPsk::serverCert</a>, <a class="el" href="client_2State_8h_source.html#l00052">fizz::client::EarlyDataParams::serverCert</a>, <a class="el" href="Protocol_8h_source.html#l00020">fizz::Protocol::setAead()</a>, <a class="el" href="ExtensionsTest_8cpp_source.html#l00023">sni</a>, <a class="el" href="ClientProtocol_8cpp_source.html#l00290">validatePsk()</a>, <a class="el" href="PskCache_8h_source.html#l00025">fizz::client::CachedPsk::version</a>, <a class="el" href="client_2State_8h_source.html#l00050">fizz::client::EarlyDataParams::version</a>, and <a class="el" href="Types-inl_8h_source.html#l00112">fizz::detail::write()</a>.</p>

<p>Referenced by <a class="el" href="ClientProtocolTest_8cpp_source.html#l00173">fizz::client::test::ClientProtocolTest::setupExpectingEncryptedExtensionsEarlySent()</a>, and <a class="el" href="AsyncFizzClientTest_8cpp_source.html#l00494">fizz::client::test::TEST_F()</a>.</p>
<div class="fragment"><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;                                    {</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;  <span class="keywordflow">if</span> (!context.<a class="code" href="classfizz_1_1client_1_1FizzClientContext.html#a391a91320ca3d5509d91bc08cf0956bf">getSendEarlyData</a>()) {</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacefolly.html#ac22c63dbe5af3b0bedb0f21031691537">folly::none</a>;</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;  }</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;  <span class="keywordflow">if</span> (!psk || psk-&gt;<a class="code" href="structfizz_1_1client_1_1CachedPsk.html#a6a8c78804547733872dd80ecee702fe9">maxEarlyDataSize</a> == 0) {</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacefolly.html#ac22c63dbe5af3b0bedb0f21031691537">folly::none</a>;</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;  }</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;  <span class="keywordflow">if</span> (psk-&gt;<a class="code" href="structfizz_1_1client_1_1CachedPsk.html#a298dd2eaa94b274e11027b8dff916cb3">alpn</a> &amp;&amp;</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;      std::find(</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;          context.<a class="code" href="classfizz_1_1client_1_1FizzClientContext.html#af203459d6d308e18bab61e97962fe010">getSupportedAlpns</a>().begin(),</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;          context.<a class="code" href="classfizz_1_1client_1_1FizzClientContext.html#af203459d6d308e18bab61e97962fe010">getSupportedAlpns</a>().end(),</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;          *psk-&gt;<a class="code" href="structfizz_1_1client_1_1CachedPsk.html#a298dd2eaa94b274e11027b8dff916cb3">alpn</a>) == context.<a class="code" href="classfizz_1_1client_1_1FizzClientContext.html#af203459d6d308e18bab61e97962fe010">getSupportedAlpns</a>().end()) {</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacefolly.html#ac22c63dbe5af3b0bedb0f21031691537">folly::none</a>;</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;  }</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;  <a class="code" href="structfizz_1_1client_1_1EarlyDataParams.html">EarlyDataParams</a> <a class="code" href="FlatCombiningTest_8cpp.html#a36eef2a02e164255f9d34e465f82e0ef">params</a>;</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;  params.<a class="code" href="structfizz_1_1client_1_1EarlyDataParams.html#a24e1ab233c2e857951d9f53ace9b81d9">version</a> = psk-&gt;<a class="code" href="structfizz_1_1client_1_1CachedPsk.html#a6c1b9e185150a9f7b6f936bae46d99d5">version</a>;</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;  params.<a class="code" href="structfizz_1_1client_1_1EarlyDataParams.html#a884fe9a35271f2c31b20878ded093613">cipher</a> = psk-&gt;<a class="code" href="structfizz_1_1client_1_1CachedPsk.html#a55c60a4fa67edda2eb54998c4271eff7">cipher</a>;</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;  params.<a class="code" href="structfizz_1_1client_1_1EarlyDataParams.html#a6e93ab9f1a7dfbd14c5bfe671cccbf53">serverCert</a> = psk-&gt;<a class="code" href="structfizz_1_1client_1_1CachedPsk.html#a96c28b3fd66ae10faba00a1fa07f010e">serverCert</a>;</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;  params.<a class="code" href="structfizz_1_1client_1_1EarlyDataParams.html#af8431e3a41e757209a23867a281d3c7d">clientCert</a> = psk-&gt;<a class="code" href="structfizz_1_1client_1_1CachedPsk.html#a7d7b3690317bbf19576582a09e9acf31">clientCert</a>;</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;  params.<a class="code" href="structfizz_1_1client_1_1EarlyDataParams.html#adf496e4e8e2e8fc4dbf898adfd4598c1">alpn</a> = psk-&gt;<a class="code" href="structfizz_1_1client_1_1CachedPsk.html#a298dd2eaa94b274e11027b8dff916cb3">alpn</a>;</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">std::move</a>(params);</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;}</div><div class="ttc" id="structfizz_1_1client_1_1EarlyDataParams_html_a6e93ab9f1a7dfbd14c5bfe671cccbf53"><div class="ttname"><a href="structfizz_1_1client_1_1EarlyDataParams.html#a6e93ab9f1a7dfbd14c5bfe671cccbf53">fizz::client::EarlyDataParams::serverCert</a></div><div class="ttdeci">std::shared_ptr&lt; const Cert &gt; serverCert</div><div class="ttdef"><b>Definition:</b> <a href="client_2State_8h_source.html#l00052">State.h:52</a></div></div>
<div class="ttc" id="structfizz_1_1client_1_1CachedPsk_html_a7d7b3690317bbf19576582a09e9acf31"><div class="ttname"><a href="structfizz_1_1client_1_1CachedPsk.html#a7d7b3690317bbf19576582a09e9acf31">fizz::client::CachedPsk::clientCert</a></div><div class="ttdeci">std::shared_ptr&lt; const Cert &gt; clientCert</div><div class="ttdef"><b>Definition:</b> <a href="PskCache_8h_source.html#l00029">PskCache.h:29</a></div></div>
<div class="ttc" id="classfizz_1_1client_1_1FizzClientContext_html_a391a91320ca3d5509d91bc08cf0956bf"><div class="ttname"><a href="classfizz_1_1client_1_1FizzClientContext.html#a391a91320ca3d5509d91bc08cf0956bf">fizz::client::FizzClientContext::getSendEarlyData</a></div><div class="ttdeci">bool getSendEarlyData() const </div><div class="ttdef"><b>Definition:</b> <a href="FizzClientContext_8h_source.html#l00146">FizzClientContext.h:146</a></div></div>
<div class="ttc" id="classfizz_1_1client_1_1FizzClientContext_html_af203459d6d308e18bab61e97962fe010"><div class="ttname"><a href="classfizz_1_1client_1_1FizzClientContext.html#af203459d6d308e18bab61e97962fe010">fizz::client::FizzClientContext::getSupportedAlpns</a></div><div class="ttdeci">const auto &amp; getSupportedAlpns() const </div><div class="ttdef"><b>Definition:</b> <a href="FizzClientContext_8h_source.html#l00097">FizzClientContext.h:97</a></div></div>
<div class="ttc" id="structfizz_1_1client_1_1CachedPsk_html_a298dd2eaa94b274e11027b8dff916cb3"><div class="ttname"><a href="structfizz_1_1client_1_1CachedPsk.html#a298dd2eaa94b274e11027b8dff916cb3">fizz::client::CachedPsk::alpn</a></div><div class="ttdeci">folly::Optional&lt; std::string &gt; alpn</div><div class="ttdef"><b>Definition:</b> <a href="PskCache_8h_source.html#l00032">PskCache.h:32</a></div></div>
<div class="ttc" id="namespacefolly_1_1gen_html_ac24ec252b1b738a40c274285527c193f"><div class="ttname"><a href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">folly::gen::move</a></div><div class="ttdeci">constexpr detail::Map&lt; Move &gt; move</div><div class="ttdef"><b>Definition:</b> <a href="Base-inl_8h_source.html#l02567">Base-inl.h:2567</a></div></div>
<div class="ttc" id="structfizz_1_1client_1_1EarlyDataParams_html_a884fe9a35271f2c31b20878ded093613"><div class="ttname"><a href="structfizz_1_1client_1_1EarlyDataParams.html#a884fe9a35271f2c31b20878ded093613">fizz::client::EarlyDataParams::cipher</a></div><div class="ttdeci">CipherSuite cipher</div><div class="ttdef"><b>Definition:</b> <a href="client_2State_8h_source.html#l00051">State.h:51</a></div></div>
<div class="ttc" id="structfizz_1_1client_1_1EarlyDataParams_html_af8431e3a41e757209a23867a281d3c7d"><div class="ttname"><a href="structfizz_1_1client_1_1EarlyDataParams.html#af8431e3a41e757209a23867a281d3c7d">fizz::client::EarlyDataParams::clientCert</a></div><div class="ttdeci">std::shared_ptr&lt; const Cert &gt; clientCert</div><div class="ttdef"><b>Definition:</b> <a href="client_2State_8h_source.html#l00053">State.h:53</a></div></div>
<div class="ttc" id="structfizz_1_1client_1_1CachedPsk_html_a6c1b9e185150a9f7b6f936bae46d99d5"><div class="ttname"><a href="structfizz_1_1client_1_1CachedPsk.html#a6c1b9e185150a9f7b6f936bae46d99d5">fizz::client::CachedPsk::version</a></div><div class="ttdeci">ProtocolVersion version</div><div class="ttdef"><b>Definition:</b> <a href="PskCache_8h_source.html#l00025">PskCache.h:25</a></div></div>
<div class="ttc" id="structfizz_1_1client_1_1EarlyDataParams_html"><div class="ttname"><a href="structfizz_1_1client_1_1EarlyDataParams.html">fizz::client::EarlyDataParams</a></div><div class="ttdef"><b>Definition:</b> <a href="client_2State_8h_source.html#l00049">State.h:49</a></div></div>
<div class="ttc" id="FlatCombiningTest_8cpp_html_a36eef2a02e164255f9d34e465f82e0ef"><div class="ttname"><a href="FlatCombiningTest_8cpp.html#a36eef2a02e164255f9d34e465f82e0ef">params</a></div><div class="ttdeci">constexpr Params params[]</div><div class="ttdef"><b>Definition:</b> <a href="FlatCombiningTest_8cpp_source.html#l00094">FlatCombiningTest.cpp:94</a></div></div>
<div class="ttc" id="structfizz_1_1client_1_1CachedPsk_html_a96c28b3fd66ae10faba00a1fa07f010e"><div class="ttname"><a href="structfizz_1_1client_1_1CachedPsk.html#a96c28b3fd66ae10faba00a1fa07f010e">fizz::client::CachedPsk::serverCert</a></div><div class="ttdeci">std::shared_ptr&lt; const Cert &gt; serverCert</div><div class="ttdef"><b>Definition:</b> <a href="PskCache_8h_source.html#l00028">PskCache.h:28</a></div></div>
<div class="ttc" id="structfizz_1_1client_1_1EarlyDataParams_html_adf496e4e8e2e8fc4dbf898adfd4598c1"><div class="ttname"><a href="structfizz_1_1client_1_1EarlyDataParams.html#adf496e4e8e2e8fc4dbf898adfd4598c1">fizz::client::EarlyDataParams::alpn</a></div><div class="ttdeci">folly::Optional&lt; std::string &gt; alpn</div><div class="ttdef"><b>Definition:</b> <a href="client_2State_8h_source.html#l00054">State.h:54</a></div></div>
<div class="ttc" id="structfizz_1_1client_1_1CachedPsk_html_a55c60a4fa67edda2eb54998c4271eff7"><div class="ttname"><a href="structfizz_1_1client_1_1CachedPsk.html#a55c60a4fa67edda2eb54998c4271eff7">fizz::client::CachedPsk::cipher</a></div><div class="ttdeci">CipherSuite cipher</div><div class="ttdef"><b>Definition:</b> <a href="PskCache_8h_source.html#l00026">PskCache.h:26</a></div></div>
<div class="ttc" id="structfizz_1_1client_1_1CachedPsk_html_a6a8c78804547733872dd80ecee702fe9"><div class="ttname"><a href="structfizz_1_1client_1_1CachedPsk.html#a6a8c78804547733872dd80ecee702fe9">fizz::client::CachedPsk::maxEarlyDataSize</a></div><div class="ttdeci">uint32_t maxEarlyDataSize</div><div class="ttdef"><b>Definition:</b> <a href="PskCache_8h_source.html#l00031">PskCache.h:31</a></div></div>
<div class="ttc" id="structfizz_1_1client_1_1EarlyDataParams_html_a24e1ab233c2e857951d9f53ace9b81d9"><div class="ttname"><a href="structfizz_1_1client_1_1EarlyDataParams.html#a24e1ab233c2e857951d9f53ace9b81d9">fizz::client::EarlyDataParams::version</a></div><div class="ttdeci">ProtocolVersion version</div><div class="ttdef"><b>Definition:</b> <a href="client_2State_8h_source.html#l00050">State.h:50</a></div></div>
<div class="ttc" id="namespacefolly_html_ac22c63dbe5af3b0bedb0f21031691537"><div class="ttname"><a href="namespacefolly.html#ac22c63dbe5af3b0bedb0f21031691537">folly::none</a></div><div class="ttdeci">constexpr None none</div><div class="ttdef"><b>Definition:</b> <a href="Optional_8h_source.html#l00087">Optional.h:87</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a302eababdc4104e4730008e945c20537"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="namespacefizz.html#af020f21a568ff86800e03d6ad2a9b84d">Buf</a> fizz::sm::getEncryptedExt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfizz_1_1HandshakeContext.html">HandshakeContext</a> &amp;&#160;</td>
          <td class="paramname"><em>handshakeContext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classfolly_1_1Optional.html">folly::Optional</a>&lt; <a class="el" href="Conv_8cpp.html#ae1adbce218e7a9d09164012443191d24">std::string</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>selectedAlpn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacefizz.html#a02f9d49d996b83310b2a38e93684c959">EarlyDataType</a>&#160;</td>
          <td class="paramname"><em>earlyData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="structfizz_1_1Extension.html">Extension</a> &gt;&#160;</td>
          <td class="paramname"><em>otherExtensions</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ServerProtocol_8cpp_source.html#l00864">864</a> of file <a class="el" href="ServerProtocol_8cpp_source.html">ServerProtocol.cpp</a>.</p>

<p>References <a class="el" href="namespacefizz.html#a02f9d49d996b83310b2a38e93684c959a382ab522931673c11e398ead1b7b1678">fizz::Accepted</a>, <a class="el" href="ExtensionsTest_8cpp_source.html#l00022">alpn</a>, <a class="el" href="classfizz_1_1HandshakeContext.html#a5a9aa3245a54ccfec4a44bd2fdbd7ac8">fizz::HandshakeContext::appendToTranscript()</a>, <a class="el" href="IOBuf_8h_source.html#l01587">folly::IOBuf::copyBuffer()</a>, <a class="el" href="extensions_2tokenbinding_2Types_8cpp_source.html#l00113">fizz::encodeExtension()</a>, <a class="el" href="fizz_2fizz_2record_2Types_8h_source.html#l00228">fizz::EncryptedExtensions::extensions</a>, <a class="el" href="Base-inl_8h_source.html#l02567">folly::gen::move</a>, <a class="el" href="Extensions_8h_source.html#l00111">fizz::ProtocolName::name</a>, and <a class="el" href="Extensions_8h_source.html#l00115">fizz::ProtocolNameList::protocol_name_list</a>.</p>

<p>Referenced by <a class="el" href="ServerProtocol_8cpp_source.html#l00953">getCertificateRequest()</a>.</p>
<div class="fragment"><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;                                          {</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;  <a class="code" href="namespacefizz.html#a1135430496a56ed55bdfc4a77ccb35fbaf36aecb2d027d9ed8fc384235422899f">EncryptedExtensions</a> encryptedExt;</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;  <span class="keywordflow">if</span> (selectedAlpn) {</div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;    ProtocolNameList <a class="code" href="ExtensionsTest_8cpp.html#af3a28898b95e8b84c27bda7309ad2fd5">alpn</a>;</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;    ProtocolName protocol;</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;    protocol.name = <a class="code" href="classfolly_1_1IOBuf.html#aa1c4b32cfaa7c96d591d8ad5f5f7b959">folly::IOBuf::copyBuffer</a>(*selectedAlpn);</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;    alpn.protocol_name_list.push_back(<a class="code" href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">std::move</a>(protocol));</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;    encryptedExt.extensions.push_back(<a class="code" href="namespacefizz.html#af6485298511d0a74eb07b27570e62378">encodeExtension</a>(<a class="code" href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">std::move</a>(alpn)));</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;  }</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;  <span class="keywordflow">if</span> (earlyData == EarlyDataType::Accepted) {</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;    encryptedExt.extensions.push_back(<a class="code" href="namespacefizz.html#af6485298511d0a74eb07b27570e62378">encodeExtension</a>(ServerEarlyData()));</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;  }</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; ext : otherExtensions) {</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;    encryptedExt.extensions.push_back(<a class="code" href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">std::move</a>(ext));</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;  }</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;  <span class="keyword">auto</span> encodedEncryptedExt =</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;      encodeHandshake&lt;EncryptedExtensions&gt;(<a class="code" href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">std::move</a>(encryptedExt));</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;  handshakeContext.appendToTranscript(encodedEncryptedExt);</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;  <span class="keywordflow">return</span> encodedEncryptedExt;</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;}</div><div class="ttc" id="namespacefolly_1_1gen_html_ac24ec252b1b738a40c274285527c193f"><div class="ttname"><a href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">folly::gen::move</a></div><div class="ttdeci">constexpr detail::Map&lt; Move &gt; move</div><div class="ttdef"><b>Definition:</b> <a href="Base-inl_8h_source.html#l02567">Base-inl.h:2567</a></div></div>
<div class="ttc" id="ExtensionsTest_8cpp_html_af3a28898b95e8b84c27bda7309ad2fd5"><div class="ttname"><a href="ExtensionsTest_8cpp.html#af3a28898b95e8b84c27bda7309ad2fd5">alpn</a></div><div class="ttdeci">StringPiece alpn</div><div class="ttdef"><b>Definition:</b> <a href="ExtensionsTest_8cpp_source.html#l00022">ExtensionsTest.cpp:22</a></div></div>
<div class="ttc" id="namespacefizz_html_a1135430496a56ed55bdfc4a77ccb35fbaf36aecb2d027d9ed8fc384235422899f"><div class="ttname"><a href="namespacefizz.html#a1135430496a56ed55bdfc4a77ccb35fbaf36aecb2d027d9ed8fc384235422899f">fizz::Event::EncryptedExtensions</a></div></div>
<div class="ttc" id="namespacefizz_html_af6485298511d0a74eb07b27570e62378"><div class="ttname"><a href="namespacefizz.html#af6485298511d0a74eb07b27570e62378">fizz::encodeExtension</a></div><div class="ttdeci">Extension encodeExtension(const TokenBindingParameters &amp;params)</div><div class="ttdef"><b>Definition:</b> <a href="extensions_2tokenbinding_2Types_8cpp_source.html#l00113">Types.cpp:113</a></div></div>
<div class="ttc" id="classfolly_1_1IOBuf_html_aa1c4b32cfaa7c96d591d8ad5f5f7b959"><div class="ttname"><a href="classfolly_1_1IOBuf.html#aa1c4b32cfaa7c96d591d8ad5f5f7b959">folly::IOBuf::copyBuffer</a></div><div class="ttdeci">static std::unique_ptr&lt; IOBuf &gt; copyBuffer(const void *buf, std::size_t size, std::size_t headroom=0, std::size_t minTailroom=0)</div><div class="ttdef"><b>Definition:</b> <a href="IOBuf_8h_source.html#l01587">IOBuf.h:1587</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a624d6a233df96caa433238b479494b9f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="namespacefizz.html#af020f21a568ff86800e03d6ad2a9b84d">Buf</a> fizz::sm::getHelloRetryRequest </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespacefizz.html#a3a1cbf7ef22de4d4c5144b3090d7ebc1">ProtocolVersion</a>&#160;</td>
          <td class="paramname"><em>version</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacefizz.html#a23e4ec7baa80cc6f92fdbeadccf0d22e">CipherSuite</a>&#160;</td>
          <td class="paramname"><em>cipher</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacefizz.html#a11069edebaa08949c9a6696ef4bb85e2">NamedGroup</a>&#160;</td>
          <td class="paramname"><em>group</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacefizz.html#af020f21a568ff86800e03d6ad2a9b84d">Buf</a>&#160;</td>
          <td class="paramname"><em>legacySessionId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classfizz_1_1HandshakeContext.html">HandshakeContext</a> &amp;&#160;</td>
          <td class="paramname"><em>handshakeContext</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ServerProtocol_8cpp_source.html#l00671">671</a> of file <a class="el" href="ServerProtocol_8cpp_source.html">ServerProtocol.cpp</a>.</p>

<p>References <a class="el" href="classfizz_1_1HandshakeContext.html#a5a9aa3245a54ccfec4a44bd2fdbd7ac8">fizz::HandshakeContext::appendToTranscript()</a>, <a class="el" href="ClientProtocol_8cpp_source.html#l01006">cipher</a>, <a class="el" href="fizz_2fizz_2record_2Types_8h_source.html#l00216">fizz::HelloRetryRequest::cipher_suite</a>, <a class="el" href="extensions_2tokenbinding_2Types_8cpp_source.html#l00113">fizz::encodeExtension()</a>, <a class="el" href="Types-inl_8h_source.html#l00515">fizz::encodeHandshake()</a>, <a class="el" href="fizz_2fizz_2record_2Types_8h_source.html#l00218">fizz::HelloRetryRequest::extensions</a>, <a class="el" href="record_2Types_8cpp_source.html#l00016">fizz::getRealDraftVersion()</a>, <a class="el" href="ClientProtocol_8cpp_source.html#l01007">group</a>, <a class="el" href="fizz_2fizz_2record_2Types_8h_source.html#l00215">fizz::HelloRetryRequest::legacy_session_id_echo</a>, <a class="el" href="fizz_2fizz_2record_2Types_8h_source.html#l00210">fizz::HelloRetryRequest::legacy_version</a>, <a class="el" href="Base-inl_8h_source.html#l02567">folly::gen::move</a>, <a class="el" href="Extensions_8h_source.html#l00050">fizz::HelloRetryRequestKeyShare::preDraft23</a>, <a class="el" href="Extensions_8h_source.html#l00048">fizz::HelloRetryRequestKeyShare::selected_group</a>, <a class="el" href="Extensions_8h_source.html#l00099">fizz::ServerSupportedVersions::selected_version</a>, <a class="el" href="namespacefizz.html#a3a1cbf7ef22de4d4c5144b3090d7ebc1a19640bc085d73d380771b141df331ae6">fizz::tls_1_2</a>, <a class="el" href="namespacefizz.html#a3a1cbf7ef22de4d4c5144b3090d7ebc1aafa659196b1c05be67f7495345e7d5a1">fizz::tls_1_3_20</a>, <a class="el" href="namespacefizz.html#a3a1cbf7ef22de4d4c5144b3090d7ebc1a8af2ff0742c817e40e459c759fc5a25b">fizz::tls_1_3_21</a>, <a class="el" href="namespacefizz.html#a3a1cbf7ef22de4d4c5144b3090d7ebc1ac6930c4fdd481d3a41608d66beb5e309">fizz::tls_1_3_22</a>, and <a class="el" href="ClientProtocol_8cpp_source.html#l01005">version</a>.</p>

<p>Referenced by <a class="el" href="ServerProtocol_8cpp_source.html#l00953">getCertificateRequest()</a>.</p>
<div class="fragment"><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;                                        {</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;  <a class="code" href="namespacefizz.html#af020f21a568ff86800e03d6ad2a9b84d">Buf</a> encodedHelloRetryRequest;</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;  <span class="keyword">auto</span> realVersion = <a class="code" href="namespacefizz.html#af14fcb8cbbab3726a0922291cd13b4d1">getRealDraftVersion</a>(<a class="code" href="ClientProtocol_8cpp.html#abe1b247743d4691ae90a9b12b08cc176">version</a>);</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;  <span class="keywordflow">if</span> (realVersion == ProtocolVersion::tls_1_3_20 ||</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;      realVersion == ProtocolVersion::tls_1_3_21) {</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;    <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;pre-22 HRR&quot;</span>);</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;  }</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;  <a class="code" href="namespacefizz.html#a1135430496a56ed55bdfc4a77ccb35fba51ad30e8de321aca8d16fe7a2d9f62c5">HelloRetryRequest</a> hrr;</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;  hrr.legacy_version = ProtocolVersion::tls_1_2;</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;  hrr.legacy_session_id_echo = <a class="code" href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">std::move</a>(legacySessionId);</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;  hrr.cipher_suite = <a class="code" href="ClientProtocol_8cpp.html#aa7e60e524fbc7254437c13c7d22a9dfa">cipher</a>;</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;  ServerSupportedVersions versionExt;</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;  versionExt.selected_version = <a class="code" href="ClientProtocol_8cpp.html#abe1b247743d4691ae90a9b12b08cc176">version</a>;</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;  hrr.extensions.push_back(<a class="code" href="namespacefizz.html#af6485298511d0a74eb07b27570e62378">encodeExtension</a>(<a class="code" href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">std::move</a>(versionExt)));</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;  HelloRetryRequestKeyShare keyShare;</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;  <span class="keywordflow">if</span> (realVersion == ProtocolVersion::tls_1_3_20 ||</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;      realVersion == ProtocolVersion::tls_1_3_21 ||</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;      realVersion == ProtocolVersion::tls_1_3_22) {</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;    keyShare.preDraft23 = <span class="keyword">true</span>;</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;  }</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;  keyShare.selected_group = <a class="code" href="ClientProtocol_8cpp.html#a100fbfdcc383ea1165570b83a874c0e0">group</a>;</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;  hrr.extensions.push_back(<a class="code" href="namespacefizz.html#af6485298511d0a74eb07b27570e62378">encodeExtension</a>(<a class="code" href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">std::move</a>(keyShare)));</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;  encodedHelloRetryRequest = <a class="code" href="namespacefizz.html#a1fef0ecdfd4a6c07fd32b5dd0dcb2b23">encodeHandshake</a>(<a class="code" href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">std::move</a>(hrr));</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;  handshakeContext.appendToTranscript(encodedHelloRetryRequest);</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;  <span class="keywordflow">return</span> encodedHelloRetryRequest;</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;}</div><div class="ttc" id="namespacefizz_html_a1fef0ecdfd4a6c07fd32b5dd0dcb2b23"><div class="ttname"><a href="namespacefizz.html#a1fef0ecdfd4a6c07fd32b5dd0dcb2b23">fizz::encodeHandshake</a></div><div class="ttdeci">Buf encodeHandshake(T &amp;&amp;handshakeMsg)</div><div class="ttdef"><b>Definition:</b> <a href="Types-inl_8h_source.html#l00515">Types-inl.h:515</a></div></div>
<div class="ttc" id="namespacefolly_1_1gen_html_ac24ec252b1b738a40c274285527c193f"><div class="ttname"><a href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">folly::gen::move</a></div><div class="ttdeci">constexpr detail::Map&lt; Move &gt; move</div><div class="ttdef"><b>Definition:</b> <a href="Base-inl_8h_source.html#l02567">Base-inl.h:2567</a></div></div>
<div class="ttc" id="ClientProtocol_8cpp_html_aa7e60e524fbc7254437c13c7d22a9dfa"><div class="ttname"><a href="ClientProtocol_8cpp.html#aa7e60e524fbc7254437c13c7d22a9dfa">cipher</a></div><div class="ttdeci">CipherSuite cipher</div><div class="ttdef"><b>Definition:</b> <a href="ClientProtocol_8cpp_source.html#l01006">ClientProtocol.cpp:1006</a></div></div>
<div class="ttc" id="namespacefizz_html_a1135430496a56ed55bdfc4a77ccb35fba51ad30e8de321aca8d16fe7a2d9f62c5"><div class="ttname"><a href="namespacefizz.html#a1135430496a56ed55bdfc4a77ccb35fba51ad30e8de321aca8d16fe7a2d9f62c5">fizz::Event::HelloRetryRequest</a></div></div>
<div class="ttc" id="ClientProtocol_8cpp_html_abe1b247743d4691ae90a9b12b08cc176"><div class="ttname"><a href="ClientProtocol_8cpp.html#abe1b247743d4691ae90a9b12b08cc176">version</a></div><div class="ttdeci">ProtocolVersion version</div><div class="ttdef"><b>Definition:</b> <a href="ClientProtocol_8cpp_source.html#l01005">ClientProtocol.cpp:1005</a></div></div>
<div class="ttc" id="ClientProtocol_8cpp_html_a100fbfdcc383ea1165570b83a874c0e0"><div class="ttname"><a href="ClientProtocol_8cpp.html#a100fbfdcc383ea1165570b83a874c0e0">group</a></div><div class="ttdeci">Optional&lt; NamedGroup &gt; group</div><div class="ttdef"><b>Definition:</b> <a href="ClientProtocol_8cpp_source.html#l01007">ClientProtocol.cpp:1007</a></div></div>
<div class="ttc" id="namespacefizz_html_af020f21a568ff86800e03d6ad2a9b84d"><div class="ttname"><a href="namespacefizz.html#af020f21a568ff86800e03d6ad2a9b84d">fizz::Buf</a></div><div class="ttdeci">std::unique_ptr&lt; folly::IOBuf &gt; Buf</div><div class="ttdef"><b>Definition:</b> <a href="fizz_2fizz_2record_2Types_8h_source.html#l00022">Types.h:22</a></div></div>
<div class="ttc" id="namespacefizz_html_af14fcb8cbbab3726a0922291cd13b4d1"><div class="ttname"><a href="namespacefizz.html#af14fcb8cbbab3726a0922291cd13b4d1">fizz::getRealDraftVersion</a></div><div class="ttdeci">ProtocolVersion getRealDraftVersion(ProtocolVersion version)</div><div class="ttdef"><b>Definition:</b> <a href="record_2Types_8cpp_source.html#l00016">Types.cpp:16</a></div></div>
<div class="ttc" id="namespacefizz_html_af6485298511d0a74eb07b27570e62378"><div class="ttname"><a href="namespacefizz.html#af6485298511d0a74eb07b27570e62378">fizz::encodeExtension</a></div><div class="ttdeci">Extension encodeExtension(const TokenBindingParameters &amp;params)</div><div class="ttdef"><b>Definition:</b> <a href="extensions_2tokenbinding_2Types_8cpp_source.html#l00113">Types.cpp:113</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ad45aca895afa36167103c8ead0047667"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="PackedSyncPtrTest_8cpp.html#a2a761d9ec8bcdc907b3e45a3ba097c32">std::map</a>&lt;<a class="el" href="namespacefizz.html#a11069edebaa08949c9a6696ef4bb85e2">NamedGroup</a>, std::unique_ptr&lt;<a class="el" href="classfizz_1_1KeyExchange.html">KeyExchange</a>&gt; &gt; fizz::sm::getHrrKeyExchangers </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classfizz_1_1Factory.html">Factory</a> &amp;&#160;</td>
          <td class="paramname"><em>factory</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="PackedSyncPtrTest_8cpp.html#a2a761d9ec8bcdc907b3e45a3ba097c32">std::map</a>&lt; <a class="el" href="namespacefizz.html#a11069edebaa08949c9a6696ef4bb85e2">NamedGroup</a>, std::unique_ptr&lt; <a class="el" href="classfizz_1_1KeyExchange.html">KeyExchange</a> &gt;&gt;&#160;</td>
          <td class="paramname"><em>previous</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classfolly_1_1Optional.html">Optional</a>&lt; <a class="el" href="namespacefizz.html#a11069edebaa08949c9a6696ef4bb85e2">NamedGroup</a> &gt;&#160;</td>
          <td class="paramname"><em>negotiatedGroup</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ClientProtocol_8cpp_source.html#l01036">1036</a> of file <a class="el" href="ClientProtocol_8cpp_source.html">ClientProtocol.cpp</a>.</p>

<p>References <a class="el" href="client_2Actions_8h_source.html#l00086">fizz::client::detail::actions()</a>, <a class="el" href="namespacefizz.html#a02f9d49d996b83310b2a38e93684c959ac52c6eeafe7207599f51d08a22226ca8">fizz::Attempted</a>, <a class="el" href="client_2State_8h_source.html#l00336">fizz::client::State::attemptedPsk()</a>, <a class="el" href="namespacefizz.html#a13f474ceeb2b16be9bd67bcba87d4334a812f1c86e37703e27ffb71caf6e6b70a">fizz::change_cipher_spec</a>, <a class="el" href="Protocol_8h_source.html#l00050">fizz::Protocol::checkAllowedExtensions()</a>, <a class="el" href="HandshakeTypesTest_8cpp_source.html#l00023">chlo</a>, <a class="el" href="client_2State_8h_source.html#l00113">fizz::client::State::cipher()</a>, <a class="el" href="ClientProtocol_8cpp_source.html#l01006">cipher</a>, <a class="el" href="client_2State_8h_source.html#l00200">fizz::client::State::clientRandom()</a>, <a class="el" href="protocol_2Actions_8h_source.html#l00041">fizz::WriteToSocket::contents</a>, <a class="el" href="RecordLayer_8h_source.html#l00020">fizz::TLSContent::contentType</a>, <a class="el" href="client_2State_8h_source.html#l00070">fizz::client::State::context()</a>, <a class="el" href="ExtensionsTest_8cpp_source.html#l00028">cookie</a>, <a class="el" href="RecordLayer_8h_source.html#l00019">fizz::TLSContent::data</a>, <a class="el" href="client_2State_8h_source.html#l00156">fizz::client::State::earlyDataType()</a>, <a class="el" href="client_2State_8h_source.html#l00254">fizz::client::State::earlyWriteRecordLayer()</a>, <a class="el" href="ClientProtocol_8cpp_source.html#l00452">encodeAndAddBinders()</a>, <a class="el" href="client_2State_8h_source.html#l00263">fizz::client::State::encodedClientHello()</a>, <a class="el" href="Types-inl_8h_source.html#l00515">fizz::encodeHandshake()</a>, <a class="el" href="RecordLayer_8h_source.html#l00021">fizz::TLSContent::encryptionLevel</a>, <a class="el" href="namespacefizz_1_1client.html#a591ea099fd6d034227ea51623074beefa694a09f52cda0be4b0b114d49a5f7fb5">fizz::client::ExpectingServerHello</a>, <a class="el" href="client_2State_8h_source.html#l00344">fizz::client::State::extensions()</a>, <a class="el" href="fizz_2fizz_2record_2Types_8h_source.html#l00059">fizz::FakeChangeCipherSpec</a>, <a class="el" href="ClientProtocol_8cpp_source.html#l00333">getClientHello()</a>, <a class="el" href="FizzClientContext_8h_source.html#l00158">fizz::client::FizzClientContext::getCompatibilityMode()</a>, <a class="el" href="FizzClientContext_8h_source.html#l00169">fizz::client::FizzClientContext::getFactory()</a>, <a class="el" href="protocol_2Types_8cpp_source.html#l00013">fizz::getHashFunction()</a>, <a class="el" href="ClientProtocol_8cpp_source.html#l00321">getKeyExchangers()</a>, <a class="el" href="FizzClientContext_8h_source.html#l00097">fizz::client::FizzClientContext::getSupportedAlpns()</a>, <a class="el" href="FizzClientContext_8h_source.html#l00186">fizz::client::FizzClientContext::getSupportedCertDecompressionAlgorithms()</a>, <a class="el" href="FizzClientContext_8h_source.html#l00043">fizz::client::FizzClientContext::getSupportedCiphers()</a>, <a class="el" href="FizzClientContext_8h_source.html#l00065">fizz::client::FizzClientContext::getSupportedGroups()</a>, <a class="el" href="FizzClientContext_8h_source.html#l00086">fizz::client::FizzClientContext::getSupportedPskModes()</a>, <a class="el" href="FizzClientContext_8h_source.html#l00054">fizz::client::FizzClientContext::getSupportedSigSchemes()</a>, <a class="el" href="FizzClientContext_8h_source.html#l00032">fizz::client::FizzClientContext::getSupportedVersions()</a>, <a class="el" href="ClientProtocol_8cpp_source.html#l01007">group</a>, <a class="el" href="client_2State_8h_source.html#l00376">fizz::client::State::handshakeContext()</a>, <a class="el" href="fizz_2fizz_2record_2Types_8h_source.html#l00082">fizz::message_hash::hash</a>, <a class="el" href="Optional_8h_source.html#l00300">folly::Optional&lt; Value &gt;::hasValue()</a>, <a class="el" href="namespacefizz.html#a1135430496a56ed55bdfc4a77ccb35fba51ad30e8de321aca8d16fe7a2d9f62c5">fizz::HelloRetryRequest</a>, <a class="el" href="namespacefizz.html#a147eec03bf3a9683f4e214820a1f758aa0bb2e3cfaec11b1cd502d30d896c8b99">fizz::illegal_parameter</a>, <a class="el" href="client_2State_8h_source.html#l00464">fizz::client::State::keyExchangers()</a>, <a class="el" href="client_2State_8h_source.html#l00149">fizz::client::State::keyExchangeType()</a>, <a class="el" href="client_2State_8h_source.html#l00208">fizz::client::State::legacySessionId()</a>, <a class="el" href="Factory_8h_source.html#l00076">fizz::Factory::makeHandshakeContext()</a>, <a class="el" href="Factory_8h_source.html#l00056">fizz::Factory::makeKeyScheduler()</a>, <a class="el" href="Base-inl_8h_source.html#l02567">folly::gen::move</a>, <a class="el" href="ClientProtocol_8cpp_source.html#l01011">negotiateParameters()</a>, <a class="el" href="Optional_8h_source.html#l00087">folly::none</a>, <a class="el" href="namespacefizz.html#a2d0a99663f1db37e8420c978fd7e8f94a798f266791eff3fab6a382c14e682900">fizz::Plaintext</a>, <a class="el" href="namespacefizz.html#aa3a52f2e1d30e609c80fb3b50f641463a3466c6cb0b39a09c99318891dd818fdb">fizz::pre_shared_key</a>, <a class="el" href="namespacefizz.html#ab017b61ecd944032c374d31740161131ad37b1f6c0512e2118cee17fea015b699">fizz::Rejected</a>, <a class="el" href="client_2State_8h_source.html#l00273">fizz::client::State::requestedExtensions()</a>, <a class="el" href="client_2State_8h_source.html#l00215">fizz::client::State::sentCCS()</a>, <a class="el" href="client_2State_8h_source.html#l00177">fizz::client::State::sni()</a>, <a class="el" href="namespacefizz.html#a147eec03bf3a9683f4e214820a1f758aa597cfdb46675641f694b1f918760d432">fizz::unexpected_message</a>, <a class="el" href="client_2State_8h_source.html#l00106">fizz::client::State::version()</a>, <a class="el" href="ClientProtocol_8cpp_source.html#l01005">version</a>, <a class="el" href="IOBuf_8cpp_source.html#l00353">folly::IOBuf::wrapBuffer()</a>, <a class="el" href="RecordLayer_8h_source.html#l00074">fizz::WriteRecordLayer::writeHandshake()</a>, and <a class="el" href="client_2State_8h_source.html#l00245">fizz::client::State::writeRecordLayer()</a>.</p>
<div class="fragment"><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;                                          {</div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;  <span class="keywordflow">if</span> (negotiatedGroup) {</div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;    <span class="keywordflow">if</span> (previous.find(*negotiatedGroup) != previous.end()) {</div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;      <span class="keywordflow">throw</span> FizzException(</div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;          <span class="stringliteral">&quot;hrr selected already-sent group&quot;</span>,</div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;          AlertDescription::illegal_parameter);</div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;    }</div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacefizz_1_1sm.html#a2b0f26d2057cd4dc981188cb5b15c436">getKeyExchangers</a>(factory, {*negotiatedGroup});</div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;    <span class="keywordflow">return</span> previous;</div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;  }</div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;}</div><div class="ttc" id="namespacefizz_1_1sm_html_a2b0f26d2057cd4dc981188cb5b15c436"><div class="ttname"><a href="namespacefizz_1_1sm.html#a2b0f26d2057cd4dc981188cb5b15c436">fizz::sm::getKeyExchangers</a></div><div class="ttdeci">static std::map&lt; NamedGroup, std::unique_ptr&lt; KeyExchange &gt; &gt; getKeyExchangers(const Factory &amp;factory, const std::vector&lt; NamedGroup &gt; &amp;groups)</div><div class="ttdef"><b>Definition:</b> <a href="ClientProtocol_8cpp_source.html#l00321">ClientProtocol.cpp:321</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a2b0f26d2057cd4dc981188cb5b15c436"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="PackedSyncPtrTest_8cpp.html#a2a761d9ec8bcdc907b3e45a3ba097c32">std::map</a>&lt;<a class="el" href="namespacefizz.html#a11069edebaa08949c9a6696ef4bb85e2">NamedGroup</a>, std::unique_ptr&lt;<a class="el" href="classfizz_1_1KeyExchange.html">KeyExchange</a>&gt; &gt; fizz::sm::getKeyExchangers </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classfizz_1_1Factory.html">Factory</a> &amp;&#160;</td>
          <td class="paramname"><em>factory</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="namespacefizz.html#a11069edebaa08949c9a6696ef4bb85e2">NamedGroup</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>groups</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ClientProtocol_8cpp_source.html#l00321">321</a> of file <a class="el" href="ClientProtocol_8cpp_source.html">ClientProtocol.cpp</a>.</p>

<p>References <a class="el" href="ClientProtocol_8cpp_source.html#l01007">group</a>, <a class="el" href="Factory_8h_source.html#l00090">fizz::Factory::makeKeyExchange()</a>, and <a class="el" href="Base-inl_8h_source.html#l02567">folly::gen::move</a>.</p>

<p>Referenced by <a class="el" href="ClientProtocol_8cpp_source.html#l00498">getEarlyDataParams()</a>, and <a class="el" href="ClientProtocol_8cpp_source.html#l01036">getHrrKeyExchangers()</a>.</p>
<div class="fragment"><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;                                         {</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;  std::map&lt;NamedGroup, std::unique_ptr&lt;KeyExchange&gt;&gt; keyExchangers;</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code" href="ClientProtocol_8cpp.html#a100fbfdcc383ea1165570b83a874c0e0">group</a> : groups) {</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    <span class="keyword">auto</span> kex = factory.makeKeyExchange(<a class="code" href="ClientProtocol_8cpp.html#a100fbfdcc383ea1165570b83a874c0e0">group</a>);</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    kex-&gt;generateKeyPair();</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    keyExchangers.emplace(<a class="code" href="ClientProtocol_8cpp.html#a100fbfdcc383ea1165570b83a874c0e0">group</a>, <a class="code" href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">std::move</a>(kex));</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;  }</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;  <span class="keywordflow">return</span> keyExchangers;</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;}</div><div class="ttc" id="namespacefolly_1_1gen_html_ac24ec252b1b738a40c274285527c193f"><div class="ttname"><a href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">folly::gen::move</a></div><div class="ttdeci">constexpr detail::Map&lt; Move &gt; move</div><div class="ttdef"><b>Definition:</b> <a href="Base-inl_8h_source.html#l02567">Base-inl.h:2567</a></div></div>
<div class="ttc" id="ClientProtocol_8cpp_html_a100fbfdcc383ea1165570b83a874c0e0"><div class="ttname"><a href="ClientProtocol_8cpp.html#a100fbfdcc383ea1165570b83a874c0e0">group</a></div><div class="ttdeci">Optional&lt; NamedGroup &gt; group</div><div class="ttdef"><b>Definition:</b> <a href="ClientProtocol_8cpp_source.html#l01007">ClientProtocol.cpp:1007</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a03235ecab0fc70d5d39d17ac34a651b9"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="ConstexprMathBenchmark_8cpp.html#a09a1e304d66d35dd47daffee9731edaa">uint32_t</a> fizz::sm::getMaxEarlyDataSize </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structfizz_1_1NewSessionTicket.html">NewSessionTicket</a> &amp;&#160;</td>
          <td class="paramname"><em>nst</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ClientProtocol_8cpp_source.html#l01661">1661</a> of file <a class="el" href="ClientProtocol_8cpp_source.html">ClientProtocol.cpp</a>.</p>

<p>References <a class="el" href="client_2Actions_8h_source.html#l00086">fizz::client::detail::actions()</a>, <a class="el" href="PskCache_8h_source.html#l00032">fizz::client::CachedPsk::alpn</a>, <a class="el" href="client_2State_8h_source.html#l00170">fizz::client::State::alpn()</a>, <a class="el" href="namespacefizz.html#a2d0a99663f1db37e8420c978fd7e8f94afc945c3d5cf8f14213002525c45a6fbb">fizz::AppTraffic</a>, <a class="el" href="FizzBaseTest_8cpp_source.html#l00030">fizz::test::appWrite()</a>, <a class="el" href="Params_8h_source.html#l00053">fizz::AppWrite::callback</a>, <a class="el" href="PskCache_8h_source.html#l00026">fizz::client::CachedPsk::cipher</a>, <a class="el" href="client_2State_8h_source.html#l00113">fizz::client::State::cipher()</a>, <a class="el" href="namespacefizz.html#ad4370192b1570b3bd64f596f674f7637a252f4f2f302b23186cf414bb5b0625c5">fizz::ClientAppTraffic</a>, <a class="el" href="PskCache_8h_source.html#l00029">fizz::client::CachedPsk::clientCert</a>, <a class="el" href="client_2State_8h_source.html#l00084">fizz::client::State::clientCert()</a>, <a class="el" href="KeyScheduler_8cpp_source.html#l00090">fizz::KeyScheduler::clientKeyUpdate()</a>, <a class="el" href="protocol_2Actions_8h_source.html#l00041">fizz::WriteToSocket::contents</a>, <a class="el" href="client_2State_8h_source.html#l00070">fizz::client::State::context()</a>, <a class="el" href="Params_8h_source.html#l00054">fizz::AppWrite::data</a>, <a class="el" href="fizz_2fizz_2record_2Types_8h_source.html#l00289">fizz::NewSessionTicket::extensions</a>, <a class="el" href="Params_8h_source.html#l00055">fizz::AppWrite::flags</a>, <a class="el" href="FizzClientContext_8h_source.html#l00169">fizz::client::FizzClientContext::getFactory()</a>, <a class="el" href="Protocol_8h_source.html#l00044">fizz::Protocol::getKeyUpdated()</a>, <a class="el" href="KeyScheduler_8cpp_source.html#l00204">fizz::KeyScheduler::getResumptionSecret()</a>, <a class="el" href="KeyScheduler_8cpp_source.html#l00114">fizz::KeyScheduler::getSecret()</a>, <a class="el" href="PskCache_8h_source.html#l00027">fizz::client::CachedPsk::group</a>, <a class="el" href="client_2State_8h_source.html#l00120">fizz::client::State::group()</a>, <a class="el" href="RecordLayer_8cpp_source.html#l00151">fizz::ReadRecordLayer::hasUnparsedHandshakeData()</a>, <a class="el" href="client_2State_8h_source.html#l00225">fizz::client::State::keyScheduler()</a>, <a class="el" href="Factory_8h_source.html#l00047">fizz::Factory::makeEncryptedReadRecordLayer()</a>, <a class="el" href="Factory_8h_source.html#l00052">fizz::Factory::makeEncryptedWriteRecordLayer()</a>, <a class="el" href="PskCache_8h_source.html#l00031">fizz::client::CachedPsk::maxEarlyDataSize</a>, <a class="el" href="Base-inl_8h_source.html#l02567">folly::gen::move</a>, <a class="el" href="TimekeeperTest_8cpp_source.html#l00031">now()</a>, <a class="el" href="HandshakeTypesTest_8cpp_source.html#l00077">nst</a>, <a class="el" href="PskCache_8h_source.html#l00021">fizz::client::CachedPsk::psk</a>, <a class="el" href="client_2Actions_8h_source.html#l00067">fizz::client::NewCachedPsk::psk</a>, <a class="el" href="Range_8h_source.html#l01114">folly::range()</a>, <a class="el" href="client_2State_8h_source.html#l00235">fizz::client::State::readRecordLayer()</a>, <a class="el" href="namespacefizz.html#ab017b61ecd944032c374d31740161131a1b90141a36c2700b5ee94efc22355acd">fizz::Resumption</a>, <a class="el" href="client_2State_8h_source.html#l00301">fizz::client::State::resumptionSecret()</a>, <a class="el" href="PskCache_8h_source.html#l00022">fizz::client::CachedPsk::secret</a>, <a class="el" href="namespacefizz.html#ad4370192b1570b3bd64f596f674f7637ac76ca33886b773a7e21838ad284d431f">fizz::ServerAppTraffic</a>, <a class="el" href="PskCache_8h_source.html#l00028">fizz::client::CachedPsk::serverCert</a>, <a class="el" href="client_2State_8h_source.html#l00077">fizz::client::State::serverCert()</a>, <a class="el" href="KeyScheduler_8cpp_source.html#l00102">fizz::KeyScheduler::serverKeyUpdate()</a>, <a class="el" href="Protocol_8h_source.html#l00020">fizz::Protocol::setAead()</a>, <a class="el" href="Conv_8cpp_source.html#l00212">string</a>, <a class="el" href="PskCache_8h_source.html#l00034">fizz::client::CachedPsk::ticketAgeAdd</a>, <a class="el" href="PskCache_8h_source.html#l00036">fizz::client::CachedPsk::ticketExpirationTime</a>, <a class="el" href="PskCache_8h_source.html#l00035">fizz::client::CachedPsk::ticketIssueTime</a>, <a class="el" href="PskCache_8h_source.html#l00023">fizz::client::CachedPsk::type</a>, <a class="el" href="namespacefizz.html#a147eec03bf3a9683f4e214820a1f758aa597cfdb46675641f694b1f918760d432">fizz::unexpected_message</a>, <a class="el" href="namespacefizz.html#a6c5782b80a0dbe87cbce3552227f4a7cabe584adbdeda9ac61783941f5a72060f">fizz::update_not_requested</a>, <a class="el" href="PskCache_8h_source.html#l00025">fizz::client::CachedPsk::version</a>, <a class="el" href="client_2State_8h_source.html#l00106">fizz::client::State::version()</a>, <a class="el" href="Types-inl_8h_source.html#l00112">fizz::detail::write()</a>, <a class="el" href="RecordLayer_8h_source.html#l00069">fizz::WriteRecordLayer::writeAppData()</a>, <a class="el" href="RecordLayer_8h_source.html#l00074">fizz::WriteRecordLayer::writeHandshake()</a>, and <a class="el" href="client_2State_8h_source.html#l00245">fizz::client::State::writeRecordLayer()</a>.</p>
<div class="fragment"><div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;                                                                 {</div><div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;  <span class="keyword">auto</span> earlyData = getExtension&lt;TicketEarlyData&gt;(<a class="code" href="HandshakeTypesTest_8cpp.html#a4a94a2c9d0b18e88889a8d7fcf70d170">nst</a>.extensions);</div><div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;  <span class="keywordflow">if</span> (earlyData) {</div><div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;    <span class="keywordflow">return</span> earlyData-&gt;max_early_data_size;</div><div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;  }</div><div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;}</div><div class="ttc" id="HandshakeTypesTest_8cpp_html_a4a94a2c9d0b18e88889a8d7fcf70d170"><div class="ttname"><a href="HandshakeTypesTest_8cpp.html#a4a94a2c9d0b18e88889a8d7fcf70d170">nst</a></div><div class="ttdeci">static const std::string nst</div><div class="ttdef"><b>Definition:</b> <a href="HandshakeTypesTest_8cpp_source.html#l00077">HandshakeTypesTest.cpp:77</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a59b0297c4633d263313e4447852413fc"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="structfizz_1_1ClientPresharedKey.html">ClientPresharedKey</a> fizz::sm::getPskExtension </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structfizz_1_1client_1_1CachedPsk.html">CachedPsk</a> &amp;&#160;</td>
          <td class="paramname"><em>psk</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ClientProtocol_8cpp_source.html#l00427">427</a> of file <a class="el" href="ClientProtocol_8cpp_source.html">ClientProtocol.cpp</a>.</p>

<p>References <a class="el" href="Extensions_8h_source.html#l00060">fizz::PskBinder::binder</a>, <a class="el" href="Extensions_8h_source.html#l00065">fizz::ClientPresharedKey::binders</a>, <a class="el" href="PskCache_8h_source.html#l00026">fizz::client::CachedPsk::cipher</a>, <a class="el" href="IOBuf_8h_source.html#l01587">folly::IOBuf::copyBuffer()</a>, <a class="el" href="fizz_2build___2gtest_2src_2gtest_2googlemock_2test_2gmock__stress__test_8cc_source.html#l00176">count</a>, <a class="el" href="IOBuf_8cpp_source.html#l00229">folly::IOBuf::create()</a>, <a class="el" href="protocol_2Types_8cpp_source.html#l00013">fizz::getHashFunction()</a>, <a class="el" href="protocol_2Types_8cpp_source.html#l00025">fizz::getHashSize()</a>, <a class="el" href="Extensions_8h_source.html#l00064">fizz::ClientPresharedKey::identities</a>, <a class="el" href="Base-inl_8h_source.html#l02567">folly::gen::move</a>, <a class="el" href="TimekeeperTest_8cpp_source.html#l00031">now()</a>, <a class="el" href="Extensions_8h_source.html#l00056">fizz::PskIdentity::obfuscated_ticket_age</a>, <a class="el" href="PskCache_8h_source.html#l00021">fizz::client::CachedPsk::psk</a>, <a class="el" href="Extensions_8h_source.html#l00055">fizz::PskIdentity::psk_identity</a>, <a class="el" href="PskCache_8h_source.html#l00034">fizz::client::CachedPsk::ticketAgeAdd</a>, and <a class="el" href="PskCache_8h_source.html#l00035">fizz::client::CachedPsk::ticketIssueTime</a>.</p>

<p>Referenced by <a class="el" href="ClientProtocol_8cpp_source.html#l00452">encodeAndAddBinders()</a>.</p>
<div class="fragment"><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;                                                                {</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;  ClientPresharedKey pskExt;</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;  PskIdentity ident;</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;  ident.psk_identity = <a class="code" href="classfolly_1_1IOBuf.html#aa1c4b32cfaa7c96d591d8ad5f5f7b959">folly::IOBuf::copyBuffer</a>(psk.<a class="code" href="structfizz_1_1client_1_1CachedPsk.html#a6eb73e9b327b7060e64f5fb730ffce0d">psk</a>);</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;  ident.obfuscated_ticket_age =</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;      std::chrono::duration_cast&lt;std::chrono::milliseconds&gt;(</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;          <a class="code" href="TimekeeperTest_8cpp.html#a562b4baa36dcf267f35a4ba4e0aef329">std::chrono::system_clock::now</a>() - psk.<a class="code" href="structfizz_1_1client_1_1CachedPsk.html#a8d4baca813f1a42cdb22c35063b856ba">ticketIssueTime</a>)</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;          .<a class="code" href="fizz_2build___2gtest_2src_2gtest_2googlemock_2test_2gmock__stress__test_8cc.html#afd9db40e3361ae09188795e8cbe19752">count</a>();</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;  ident.obfuscated_ticket_age += psk.<a class="code" href="structfizz_1_1client_1_1CachedPsk.html#ae959c1bbe9e0b5b584e8789ddf3e5c48">ticketAgeAdd</a>;</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;  pskExt.identities.push_back(<a class="code" href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">std::move</a>(ident));</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;  PskBinder binder;</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;  <span class="keywordtype">size_t</span> binderSize = <a class="code" href="namespacefizz.html#a98eb75b57ca4caf4999a3f1a3cc5f388">getHashSize</a>(<a class="code" href="namespacefizz.html#a59cb5b362db9a10553246368f7615128">getHashFunction</a>(psk.<a class="code" href="structfizz_1_1client_1_1CachedPsk.html#a55c60a4fa67edda2eb54998c4271eff7">cipher</a>));</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;  binder.binder = <a class="code" href="classfolly_1_1IOBuf.html#a744f20ec9d0829fe17cf78fb48b7785e">folly::IOBuf::create</a>(binderSize);</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;  memset(binder.binder-&gt;writableData(), 0, binderSize);</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;  binder.binder-&gt;append(binderSize);</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;  pskExt.binders.push_back(<a class="code" href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">std::move</a>(binder));</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;  <span class="keywordflow">return</span> pskExt;</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;}</div><div class="ttc" id="structfizz_1_1client_1_1CachedPsk_html_a6eb73e9b327b7060e64f5fb730ffce0d"><div class="ttname"><a href="structfizz_1_1client_1_1CachedPsk.html#a6eb73e9b327b7060e64f5fb730ffce0d">fizz::client::CachedPsk::psk</a></div><div class="ttdeci">std::string psk</div><div class="ttdef"><b>Definition:</b> <a href="PskCache_8h_source.html#l00021">PskCache.h:21</a></div></div>
<div class="ttc" id="structfizz_1_1client_1_1CachedPsk_html_a8d4baca813f1a42cdb22c35063b856ba"><div class="ttname"><a href="structfizz_1_1client_1_1CachedPsk.html#a8d4baca813f1a42cdb22c35063b856ba">fizz::client::CachedPsk::ticketIssueTime</a></div><div class="ttdeci">std::chrono::system_clock::time_point ticketIssueTime</div><div class="ttdef"><b>Definition:</b> <a href="PskCache_8h_source.html#l00035">PskCache.h:35</a></div></div>
<div class="ttc" id="classfolly_1_1IOBuf_html_a744f20ec9d0829fe17cf78fb48b7785e"><div class="ttname"><a href="classfolly_1_1IOBuf.html#a744f20ec9d0829fe17cf78fb48b7785e">folly::IOBuf::create</a></div><div class="ttdeci">static std::unique_ptr&lt; IOBuf &gt; create(std::size_t capacity)</div><div class="ttdef"><b>Definition:</b> <a href="IOBuf_8cpp_source.html#l00229">IOBuf.cpp:229</a></div></div>
<div class="ttc" id="namespacefizz_html_a98eb75b57ca4caf4999a3f1a3cc5f388"><div class="ttname"><a href="namespacefizz.html#a98eb75b57ca4caf4999a3f1a3cc5f388">fizz::getHashSize</a></div><div class="ttdeci">size_t getHashSize(HashFunction hash)</div><div class="ttdef"><b>Definition:</b> <a href="protocol_2Types_8cpp_source.html#l00025">Types.cpp:25</a></div></div>
<div class="ttc" id="structfizz_1_1client_1_1CachedPsk_html_ae959c1bbe9e0b5b584e8789ddf3e5c48"><div class="ttname"><a href="structfizz_1_1client_1_1CachedPsk.html#ae959c1bbe9e0b5b584e8789ddf3e5c48">fizz::client::CachedPsk::ticketAgeAdd</a></div><div class="ttdeci">uint32_t ticketAgeAdd</div><div class="ttdef"><b>Definition:</b> <a href="PskCache_8h_source.html#l00034">PskCache.h:34</a></div></div>
<div class="ttc" id="namespacefolly_1_1gen_html_ac24ec252b1b738a40c274285527c193f"><div class="ttname"><a href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">folly::gen::move</a></div><div class="ttdeci">constexpr detail::Map&lt; Move &gt; move</div><div class="ttdef"><b>Definition:</b> <a href="Base-inl_8h_source.html#l02567">Base-inl.h:2567</a></div></div>
<div class="ttc" id="TimekeeperTest_8cpp_html_a562b4baa36dcf267f35a4ba4e0aef329"><div class="ttname"><a href="TimekeeperTest_8cpp.html#a562b4baa36dcf267f35a4ba4e0aef329">now</a></div><div class="ttdeci">std::chrono::steady_clock::time_point now()</div><div class="ttdef"><b>Definition:</b> <a href="TimekeeperTest_8cpp_source.html#l00031">TimekeeperTest.cpp:31</a></div></div>
<div class="ttc" id="namespacefizz_html_a59cb5b362db9a10553246368f7615128"><div class="ttname"><a href="namespacefizz.html#a59cb5b362db9a10553246368f7615128">fizz::getHashFunction</a></div><div class="ttdeci">HashFunction getHashFunction(CipherSuite cipher)</div><div class="ttdef"><b>Definition:</b> <a href="protocol_2Types_8cpp_source.html#l00013">Types.cpp:13</a></div></div>
<div class="ttc" id="fizz_2build___2gtest_2src_2gtest_2googlemock_2test_2gmock__stress__test_8cc_html_afd9db40e3361ae09188795e8cbe19752"><div class="ttname"><a href="fizz_2build___2gtest_2src_2gtest_2googlemock_2test_2gmock__stress__test_8cc.html#afd9db40e3361ae09188795e8cbe19752">count</a></div><div class="ttdeci">int * count</div><div class="ttdef"><b>Definition:</b> <a href="fizz_2build___2gtest_2src_2gtest_2googlemock_2test_2gmock__stress__test_8cc_source.html#l00176">gmock_stress_test.cc:176</a></div></div>
<div class="ttc" id="structfizz_1_1client_1_1CachedPsk_html_a55c60a4fa67edda2eb54998c4271eff7"><div class="ttname"><a href="structfizz_1_1client_1_1CachedPsk.html#a55c60a4fa67edda2eb54998c4271eff7">fizz::client::CachedPsk::cipher</a></div><div class="ttdeci">CipherSuite cipher</div><div class="ttdef"><b>Definition:</b> <a href="PskCache_8h_source.html#l00026">PskCache.h:26</a></div></div>
<div class="ttc" id="classfolly_1_1IOBuf_html_aa1c4b32cfaa7c96d591d8ad5f5f7b959"><div class="ttname"><a href="classfolly_1_1IOBuf.html#aa1c4b32cfaa7c96d591d8ad5f5f7b959">folly::IOBuf::copyBuffer</a></div><div class="ttdeci">static std::unique_ptr&lt; IOBuf &gt; copyBuffer(const void *buf, std::size_t size, std::size_t headroom=0, std::size_t minTailroom=0)</div><div class="ttdef"><b>Definition:</b> <a href="IOBuf_8h_source.html#l01587">IOBuf.h:1587</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ae567083a18954a26954cf2cdd6dd815c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classfolly_1_1Future.html">Future</a>&lt;<a class="el" href="namespacefizz_1_1server.html#a55ad2ae3bd23edb629aaf3638e973963">ReplayCacheResult</a>&gt; fizz::sm::getReplayCacheResult </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structfizz_1_1ClientHello.html">ClientHello</a> &amp;&#160;</td>
          <td class="paramname"><em>chlo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>zeroRttEnabled</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classfizz_1_1server_1_1ReplayCache.html">ReplayCache</a> *&#160;</td>
          <td class="paramname"><em>replayCache</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ServerProtocol_8cpp_source.html#l00484">484</a> of file <a class="el" href="ServerProtocol_8cpp_source.html">ServerProtocol.cpp</a>.</p>

<p>References <a class="el" href="classfizz_1_1server_1_1ReplayCache.html#a8f2783ac18f9f2ab655dc0f7a1995f98">fizz::server::ReplayCache::check()</a>, <a class="el" href="fizz_2fizz_2record_2Types_8h_source.html#l00193">fizz::ClientHello::extensions</a>, <a class="el" href="ReplayCache_8h_source.html#l00018">fizz::server::NotChecked</a>, <a class="el" href="fizz_2fizz_2record_2Types_8h_source.html#l00189">fizz::ClientHello::random</a>, and <a class="el" href="Range_8h_source.html#l01114">folly::range()</a>.</p>

<p>Referenced by <a class="el" href="ServerProtocol_8cpp_source.html#l00953">getCertificateRequest()</a>.</p>
<div class="fragment"><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;                              {</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;  <span class="keywordflow">if</span> (!zeroRttEnabled || !replayCache ||</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;      !getExtension&lt;ClientEarlyData&gt;(<a class="code" href="HandshakeTypesTest_8cpp.html#aba518b904616df44c3d7dfde825a4c54">chlo</a>.extensions)) {</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacefizz_1_1server.html#a55ad2ae3bd23edb629aaf3638e973963a7c36084db59ebb629ff71c19cbf1de55">ReplayCacheResult::NotChecked</a>;</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;  }</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;  <span class="keywordflow">return</span> replayCache-&gt;<a class="code" href="classfizz_1_1server_1_1ReplayCache.html#a8f2783ac18f9f2ab655dc0f7a1995f98">check</a>(<a class="code" href="namespacefolly.html#a79a54cd1a19a22878c86be5f90a33643">folly::range</a>(<a class="code" href="HandshakeTypesTest_8cpp.html#aba518b904616df44c3d7dfde825a4c54">chlo</a>.random));</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;}</div><div class="ttc" id="HandshakeTypesTest_8cpp_html_aba518b904616df44c3d7dfde825a4c54"><div class="ttname"><a href="HandshakeTypesTest_8cpp.html#aba518b904616df44c3d7dfde825a4c54">chlo</a></div><div class="ttdeci">static const std::string chlo</div><div class="ttdef"><b>Definition:</b> <a href="HandshakeTypesTest_8cpp_source.html#l00023">HandshakeTypesTest.cpp:23</a></div></div>
<div class="ttc" id="classfizz_1_1server_1_1ReplayCache_html_a8f2783ac18f9f2ab655dc0f7a1995f98"><div class="ttname"><a href="classfizz_1_1server_1_1ReplayCache.html#a8f2783ac18f9f2ab655dc0f7a1995f98">fizz::server::ReplayCache::check</a></div><div class="ttdeci">virtual folly::Future&lt; ReplayCacheResult &gt; check(folly::ByteRange identifier)=0</div></div>
<div class="ttc" id="namespacefolly_html_a79a54cd1a19a22878c86be5f90a33643"><div class="ttname"><a href="namespacefolly.html#a79a54cd1a19a22878c86be5f90a33643">folly::range</a></div><div class="ttdeci">constexpr Range&lt; Iter &gt; range(Iter first, Iter last)</div><div class="ttdef"><b>Definition:</b> <a href="Range_8h_source.html#l01114">Range.h:1114</a></div></div>
<div class="ttc" id="namespacefizz_1_1server_html_a55ad2ae3bd23edb629aaf3638e973963a7c36084db59ebb629ff71c19cbf1de55"><div class="ttname"><a href="namespacefizz_1_1server.html#a55ad2ae3bd23edb629aaf3638e973963a7c36084db59ebb629ff71c19cbf1de55">fizz::server::NotChecked</a></div><div class="ttdef"><b>Definition:</b> <a href="ReplayCache_8h_source.html#l00018">ReplayCache.h:18</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a81231a44af952737bf3919482b887313"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static ResumptionStateResult fizz::sm::getResumptionState </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structfizz_1_1ClientHello.html">ClientHello</a> &amp;&#160;</td>
          <td class="paramname"><em>chlo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classfizz_1_1server_1_1TicketCipher.html">TicketCipher</a> *&#160;</td>
          <td class="paramname"><em>ticketCipher</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="namespacefizz.html#a1e500492a0a0633f62bf1c3d4acea880">PskKeyExchangeMode</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>supportedModes</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ServerProtocol_8cpp_source.html#l00447">447</a> of file <a class="el" href="ServerProtocol_8cpp_source.html">ServerProtocol.cpp</a>.</p>

<p>References <a class="el" href="classfizz_1_1server_1_1TicketCipher.html#a87f1abbf817f08c827e83e3ba1a3aa1b">fizz::server::TicketCipher::decrypt()</a>, <a class="el" href="fizz_2fizz_2record_2Types_8h_source.html#l00193">fizz::ClientHello::extensions</a>, <a class="el" href="ServerProtocol_8cpp_source.html#l00030">kPskIndex</a>, <a class="el" href="namespacefizz.html#a147eec03bf3a9683f4e214820a1f758aac3adda9630b39fc3300eb2f1aa7209ed">fizz::missing_extension</a>, <a class="el" href="Negotiator_8h_source.html#l00022">fizz::server::negotiate()</a>, <a class="el" href="Optional_8h_source.html#l00087">folly::none</a>, <a class="el" href="namespacefizz.html#ab017b61ecd944032c374d31740161131aa65db4b39dd3b01787474dcdb81af5f0">fizz::NotAttempted</a>, <a class="el" href="namespacefizz.html#ab017b61ecd944032c374d31740161131a9ed2d871602556951e39f3cebd08d6cb">fizz::NotSupported</a>, <a class="el" href="ServerProtocol_8cpp_source.html#l00442">pskMode</a>, and <a class="el" href="namespacefizz.html#ab017b61ecd944032c374d31740161131ad37b1f6c0512e2118cee17fea015b699">fizz::Rejected</a>.</p>

<p>Referenced by <a class="el" href="ServerProtocol_8cpp_source.html#l00953">getCertificateRequest()</a>.</p>
<div class="fragment"><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;                                                         {</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;  <span class="keyword">auto</span> psks = getExtension&lt;ClientPresharedKey&gt;(<a class="code" href="HandshakeTypesTest_8cpp.html#aba518b904616df44c3d7dfde825a4c54">chlo</a>.extensions);</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;  <span class="keyword">auto</span> clientModes = getExtension&lt;PskKeyExchangeModes&gt;(<a class="code" href="HandshakeTypesTest_8cpp.html#aba518b904616df44c3d7dfde825a4c54">chlo</a>.extensions);</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;  <span class="keywordflow">if</span> (psks &amp;&amp; !clientModes) {</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    <span class="keywordflow">throw</span> FizzException(<span class="stringliteral">&quot;no psk modes&quot;</span>, AlertDescription::missing_extension);</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;  }</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;  <a class="code" href="classfolly_1_1Optional.html">Optional&lt;PskKeyExchangeMode&gt;</a> <a class="code" href="ServerProtocol_8cpp.html#a55d064cc01f7c337fa3a7bac402fac4a">pskMode</a>;</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;  <span class="keywordflow">if</span> (clientModes) {</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    pskMode = <a class="code" href="namespacefizz_1_1server.html#a8f9dd07383882fd187b1e9e86949fc49">negotiate</a>(supportedModes, clientModes-&gt;modes);</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;  }</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;  <span class="keywordflow">if</span> (!psks &amp;&amp; !pskMode) {</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    <span class="keywordflow">return</span> ResumptionStateResult(</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;        std::make_pair(PskType::NotSupported, <a class="code" href="namespacefolly.html#ac22c63dbe5af3b0bedb0f21031691537">folly::none</a>));</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!psks || psks-&gt;identities.size() &lt;= <a class="code" href="ServerProtocol_8cpp.html#a8424c6daed1be1dfdd8665333379ee23">kPskIndex</a>) {</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    <span class="keywordflow">return</span> ResumptionStateResult(</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;        std::make_pair(PskType::NotAttempted, <a class="code" href="namespacefolly.html#ac22c63dbe5af3b0bedb0f21031691537">folly::none</a>));</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!ticketCipher) {</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    VLOG(8) &lt;&lt; <span class="stringliteral">&quot;No ticket cipher, rejecting PSK.&quot;</span>;</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    <span class="keywordflow">return</span> ResumptionStateResult(</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;        std::make_pair(PskType::Rejected, <a class="code" href="namespacefolly.html#ac22c63dbe5af3b0bedb0f21031691537">folly::none</a>));</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!pskMode) {</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    VLOG(8) &lt;&lt; <span class="stringliteral">&quot;No psk mode match, rejecting PSK.&quot;</span>;</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    <span class="keywordflow">return</span> ResumptionStateResult(</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;        std::make_pair(PskType::Rejected, <a class="code" href="namespacefolly.html#ac22c63dbe5af3b0bedb0f21031691537">folly::none</a>));</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; ident = psks-&gt;identities[<a class="code" href="ServerProtocol_8cpp.html#a8424c6daed1be1dfdd8665333379ee23">kPskIndex</a>].psk_identity;</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    <span class="keywordflow">return</span> ResumptionStateResult(</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;        ticketCipher-&gt;<a class="code" href="classfizz_1_1server_1_1TicketCipher.html#a87f1abbf817f08c827e83e3ba1a3aa1b">decrypt</a>(ident-&gt;clone()),</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;        pskMode,</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;        psks-&gt;identities[<a class="code" href="ServerProtocol_8cpp.html#a8424c6daed1be1dfdd8665333379ee23">kPskIndex</a>].obfuscated_ticket_age);</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;  }</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;}</div><div class="ttc" id="HandshakeTypesTest_8cpp_html_aba518b904616df44c3d7dfde825a4c54"><div class="ttname"><a href="HandshakeTypesTest_8cpp.html#aba518b904616df44c3d7dfde825a4c54">chlo</a></div><div class="ttdeci">static const std::string chlo</div><div class="ttdef"><b>Definition:</b> <a href="HandshakeTypesTest_8cpp_source.html#l00023">HandshakeTypesTest.cpp:23</a></div></div>
<div class="ttc" id="namespacefizz_1_1server_html_a8f9dd07383882fd187b1e9e86949fc49"><div class="ttname"><a href="namespacefizz_1_1server.html#a8f9dd07383882fd187b1e9e86949fc49">fizz::server::negotiate</a></div><div class="ttdeci">folly::Optional&lt; T &gt; negotiate(const std::vector&lt; std::vector&lt; T &gt;&gt; &amp;serverPref, const std::vector&lt; T &gt; &amp;clientPref)</div><div class="ttdef"><b>Definition:</b> <a href="Negotiator_8h_source.html#l00022">Negotiator.h:22</a></div></div>
<div class="ttc" id="ServerProtocol_8cpp_html_a8424c6daed1be1dfdd8665333379ee23"><div class="ttname"><a href="ServerProtocol_8cpp.html#a8424c6daed1be1dfdd8665333379ee23">kPskIndex</a></div><div class="ttdeci">static constexpr uint16_t kPskIndex</div><div class="ttdef"><b>Definition:</b> <a href="ServerProtocol_8cpp_source.html#l00030">ServerProtocol.cpp:30</a></div></div>
<div class="ttc" id="classfizz_1_1server_1_1TicketCipher_html_a87f1abbf817f08c827e83e3ba1a3aa1b"><div class="ttname"><a href="classfizz_1_1server_1_1TicketCipher.html#a87f1abbf817f08c827e83e3ba1a3aa1b">fizz::server::TicketCipher::decrypt</a></div><div class="ttdeci">virtual folly::Future&lt; std::pair&lt; PskType, folly::Optional&lt; ResumptionState &gt; &gt; &gt; decrypt(std::unique_ptr&lt; folly::IOBuf &gt; encryptedTicket) const =0</div></div>
<div class="ttc" id="classfolly_1_1Optional_html"><div class="ttname"><a href="classfolly_1_1Optional.html">folly::Optional</a></div><div class="ttdef"><b>Definition:</b> <a href="Optional_8h_source.html#l00071">Optional.h:71</a></div></div>
<div class="ttc" id="ServerProtocol_8cpp_html_a55d064cc01f7c337fa3a7bac402fac4a"><div class="ttname"><a href="ServerProtocol_8cpp.html#a55d064cc01f7c337fa3a7bac402fac4a">pskMode</a></div><div class="ttdeci">Optional&lt; PskKeyExchangeMode &gt; pskMode</div><div class="ttdef"><b>Definition:</b> <a href="ServerProtocol_8cpp_source.html#l00442">ServerProtocol.cpp:442</a></div></div>
<div class="ttc" id="namespacefolly_html_ac22c63dbe5af3b0bedb0f21031691537"><div class="ttname"><a href="namespacefolly.html#ac22c63dbe5af3b0bedb0f21031691537">folly::none</a></div><div class="ttdeci">constexpr None none</div><div class="ttdef"><b>Definition:</b> <a href="Optional_8h_source.html#l00087">Optional.h:87</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="affbeb1f8646bca9434a62803e100adfa"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="namespacefizz.html#af020f21a568ff86800e03d6ad2a9b84d">Buf</a> fizz::sm::getServerHello </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespacefizz.html#a3a1cbf7ef22de4d4c5144b3090d7ebc1">ProtocolVersion</a>&#160;</td>
          <td class="paramname"><em>version</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacefizz.html#a796015128e6988829a7719b9cb09749e">Random</a>&#160;</td>
          <td class="paramname"><em>random</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacefizz.html#a23e4ec7baa80cc6f92fdbeadccf0d22e">CipherSuite</a>&#160;</td>
          <td class="paramname"><em>cipher</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>psk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classfolly_1_1Optional.html">Optional</a>&lt; <a class="el" href="namespacefizz.html#a11069edebaa08949c9a6696ef4bb85e2">NamedGroup</a> &gt;&#160;</td>
          <td class="paramname"><em>group</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classfolly_1_1Optional.html">Optional</a>&lt; <a class="el" href="namespacefizz.html#af020f21a568ff86800e03d6ad2a9b84d">Buf</a> &gt;&#160;</td>
          <td class="paramname"><em>serverShare</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacefizz.html#af020f21a568ff86800e03d6ad2a9b84d">Buf</a>&#160;</td>
          <td class="paramname"><em>legacy_session_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classfizz_1_1HandshakeContext.html">HandshakeContext</a> &amp;&#160;</td>
          <td class="paramname"><em>handshakeContext</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ServerProtocol_8cpp_source.html#l00707">707</a> of file <a class="el" href="ServerProtocol_8cpp_source.html">ServerProtocol.cpp</a>.</p>

<p>References <a class="el" href="classfizz_1_1HandshakeContext.html#a5a9aa3245a54ccfec4a44bd2fdbd7ac8">fizz::HandshakeContext::appendToTranscript()</a>, <a class="el" href="ClientProtocol_8cpp_source.html#l01006">cipher</a>, <a class="el" href="fizz_2fizz_2record_2Types_8h_source.html#l00203">fizz::ServerHello::cipher_suite</a>, <a class="el" href="extensions_2tokenbinding_2Types_8cpp_source.html#l00113">fizz::encodeExtension()</a>, <a class="el" href="Types-inl_8h_source.html#l00515">fizz::encodeHandshake()</a>, <a class="el" href="fizz_2fizz_2record_2Types_8h_source.html#l00205">fizz::ServerHello::extensions</a>, <a class="el" href="record_2Types_8cpp_source.html#l00016">fizz::getRealDraftVersion()</a>, <a class="el" href="Extensions_8h_source.html#l00029">fizz::KeyShareEntry::group</a>, <a class="el" href="ClientProtocol_8cpp_source.html#l01007">group</a>, <a class="el" href="Extensions_8h_source.html#l00030">fizz::KeyShareEntry::key_exchange</a>, <a class="el" href="ServerProtocol_8cpp_source.html#l00030">kPskIndex</a>, <a class="el" href="fizz_2fizz_2record_2Types_8h_source.html#l00202">fizz::ServerHello::legacy_session_id_echo</a>, <a class="el" href="fizz_2fizz_2record_2Types_8h_source.html#l00198">fizz::ServerHello::legacy_version</a>, <a class="el" href="Base-inl_8h_source.html#l02567">folly::gen::move</a>, <a class="el" href="Extensions_8h_source.html#l00043">fizz::ServerKeyShare::preDraft23</a>, <a class="el" href="fizz_2fizz_2record_2Types_8h_source.html#l00199">fizz::ServerHello::random</a>, <a class="el" href="Extensions_8h_source.html#l00070">fizz::ServerPresharedKey::selected_identity</a>, <a class="el" href="Extensions_8h_source.html#l00099">fizz::ServerSupportedVersions::selected_version</a>, <a class="el" href="Extensions_8h_source.html#l00041">fizz::ServerKeyShare::server_share</a>, <a class="el" href="namespacefizz.html#a3a1cbf7ef22de4d4c5144b3090d7ebc1a19640bc085d73d380771b141df331ae6">fizz::tls_1_2</a>, <a class="el" href="namespacefizz.html#a3a1cbf7ef22de4d4c5144b3090d7ebc1aafa659196b1c05be67f7495345e7d5a1">fizz::tls_1_3_20</a>, <a class="el" href="namespacefizz.html#a3a1cbf7ef22de4d4c5144b3090d7ebc1a8af2ff0742c817e40e459c759fc5a25b">fizz::tls_1_3_21</a>, <a class="el" href="namespacefizz.html#a3a1cbf7ef22de4d4c5144b3090d7ebc1ac6930c4fdd481d3a41608d66beb5e309">fizz::tls_1_3_22</a>, and <a class="el" href="ClientProtocol_8cpp_source.html#l01005">version</a>.</p>

<p>Referenced by <a class="el" href="ServerProtocol_8cpp_source.html#l00953">getCertificateRequest()</a>.</p>
<div class="fragment"><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;                                        {</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;  <a class="code" href="namespacefizz.html#a1135430496a56ed55bdfc4a77ccb35fbae9540adbf7cbc0f41bcadaedcd0aba77">ServerHello</a> serverHello;</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;  <span class="keyword">auto</span> realVersion = <a class="code" href="namespacefizz.html#af14fcb8cbbab3726a0922291cd13b4d1">getRealDraftVersion</a>(<a class="code" href="ClientProtocol_8cpp.html#abe1b247743d4691ae90a9b12b08cc176">version</a>);</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;  <span class="keywordflow">if</span> (realVersion == ProtocolVersion::tls_1_3_20 ||</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;      realVersion == ProtocolVersion::tls_1_3_21) {</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;    serverHello.legacy_version = <a class="code" href="ClientProtocol_8cpp.html#abe1b247743d4691ae90a9b12b08cc176">version</a>;</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;    serverHello.legacy_version = ProtocolVersion::tls_1_2;</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;    ServerSupportedVersions versionExt;</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;    versionExt.selected_version = <a class="code" href="ClientProtocol_8cpp.html#abe1b247743d4691ae90a9b12b08cc176">version</a>;</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;    serverHello.extensions.push_back(<a class="code" href="namespacefizz.html#af6485298511d0a74eb07b27570e62378">encodeExtension</a>(<a class="code" href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">std::move</a>(versionExt)));</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;    serverHello.legacy_session_id_echo = <a class="code" href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">std::move</a>(legacy_session_id);</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;  }</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;  serverHello.random = <a class="code" href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">std::move</a>(random);</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;  serverHello.cipher_suite = <a class="code" href="ClientProtocol_8cpp.html#aa7e60e524fbc7254437c13c7d22a9dfa">cipher</a>;</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;  <span class="keywordflow">if</span> (group) {</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;    ServerKeyShare serverKeyShare;</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;    serverKeyShare.server_share.group = *<a class="code" href="ClientProtocol_8cpp.html#a100fbfdcc383ea1165570b83a874c0e0">group</a>;</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;    serverKeyShare.server_share.key_exchange = <a class="code" href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">std::move</a>(*serverShare);</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;    <span class="keywordflow">if</span> (realVersion == ProtocolVersion::tls_1_3_20 ||</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;        realVersion == ProtocolVersion::tls_1_3_21 ||</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;        realVersion == ProtocolVersion::tls_1_3_22) {</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;      serverKeyShare.preDraft23 = <span class="keyword">true</span>;</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;    }</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;    serverHello.extensions.push_back(</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;        <a class="code" href="namespacefizz.html#af6485298511d0a74eb07b27570e62378">encodeExtension</a>(<a class="code" href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">std::move</a>(serverKeyShare)));</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;  }</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;  <span class="keywordflow">if</span> (psk) {</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;    ServerPresharedKey serverPsk;</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;    serverPsk.selected_identity = <a class="code" href="ServerProtocol_8cpp.html#a8424c6daed1be1dfdd8665333379ee23">kPskIndex</a>;</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;    serverHello.extensions.push_back(<a class="code" href="namespacefizz.html#af6485298511d0a74eb07b27570e62378">encodeExtension</a>(<a class="code" href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">std::move</a>(serverPsk)));</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;  }</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;  <span class="keyword">auto</span> encodedServerHello = <a class="code" href="namespacefizz.html#a1fef0ecdfd4a6c07fd32b5dd0dcb2b23">encodeHandshake</a>(<a class="code" href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">std::move</a>(serverHello));</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;  handshakeContext.appendToTranscript(encodedServerHello);</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;  <span class="keywordflow">return</span> encodedServerHello;</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;}</div><div class="ttc" id="namespacefizz_html_a1fef0ecdfd4a6c07fd32b5dd0dcb2b23"><div class="ttname"><a href="namespacefizz.html#a1fef0ecdfd4a6c07fd32b5dd0dcb2b23">fizz::encodeHandshake</a></div><div class="ttdeci">Buf encodeHandshake(T &amp;&amp;handshakeMsg)</div><div class="ttdef"><b>Definition:</b> <a href="Types-inl_8h_source.html#l00515">Types-inl.h:515</a></div></div>
<div class="ttc" id="namespacefolly_1_1gen_html_ac24ec252b1b738a40c274285527c193f"><div class="ttname"><a href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">folly::gen::move</a></div><div class="ttdeci">constexpr detail::Map&lt; Move &gt; move</div><div class="ttdef"><b>Definition:</b> <a href="Base-inl_8h_source.html#l02567">Base-inl.h:2567</a></div></div>
<div class="ttc" id="ServerProtocol_8cpp_html_a8424c6daed1be1dfdd8665333379ee23"><div class="ttname"><a href="ServerProtocol_8cpp.html#a8424c6daed1be1dfdd8665333379ee23">kPskIndex</a></div><div class="ttdeci">static constexpr uint16_t kPskIndex</div><div class="ttdef"><b>Definition:</b> <a href="ServerProtocol_8cpp_source.html#l00030">ServerProtocol.cpp:30</a></div></div>
<div class="ttc" id="ClientProtocol_8cpp_html_aa7e60e524fbc7254437c13c7d22a9dfa"><div class="ttname"><a href="ClientProtocol_8cpp.html#aa7e60e524fbc7254437c13c7d22a9dfa">cipher</a></div><div class="ttdeci">CipherSuite cipher</div><div class="ttdef"><b>Definition:</b> <a href="ClientProtocol_8cpp_source.html#l01006">ClientProtocol.cpp:1006</a></div></div>
<div class="ttc" id="ClientProtocol_8cpp_html_abe1b247743d4691ae90a9b12b08cc176"><div class="ttname"><a href="ClientProtocol_8cpp.html#abe1b247743d4691ae90a9b12b08cc176">version</a></div><div class="ttdeci">ProtocolVersion version</div><div class="ttdef"><b>Definition:</b> <a href="ClientProtocol_8cpp_source.html#l01005">ClientProtocol.cpp:1005</a></div></div>
<div class="ttc" id="ClientProtocol_8cpp_html_a100fbfdcc383ea1165570b83a874c0e0"><div class="ttname"><a href="ClientProtocol_8cpp.html#a100fbfdcc383ea1165570b83a874c0e0">group</a></div><div class="ttdeci">Optional&lt; NamedGroup &gt; group</div><div class="ttdef"><b>Definition:</b> <a href="ClientProtocol_8cpp_source.html#l01007">ClientProtocol.cpp:1007</a></div></div>
<div class="ttc" id="namespacefizz_html_a1135430496a56ed55bdfc4a77ccb35fbae9540adbf7cbc0f41bcadaedcd0aba77"><div class="ttname"><a href="namespacefizz.html#a1135430496a56ed55bdfc4a77ccb35fbae9540adbf7cbc0f41bcadaedcd0aba77">fizz::Event::ServerHello</a></div></div>
<div class="ttc" id="namespacefizz_html_af14fcb8cbbab3726a0922291cd13b4d1"><div class="ttname"><a href="namespacefizz.html#af14fcb8cbbab3726a0922291cd13b4d1">fizz::getRealDraftVersion</a></div><div class="ttdeci">ProtocolVersion getRealDraftVersion(ProtocolVersion version)</div><div class="ttdef"><b>Definition:</b> <a href="record_2Types_8cpp_source.html#l00016">Types.cpp:16</a></div></div>
<div class="ttc" id="namespacefizz_html_af6485298511d0a74eb07b27570e62378"><div class="ttname"><a href="namespacefizz.html#af6485298511d0a74eb07b27570e62378">fizz::encodeExtension</a></div><div class="ttdeci">Extension encodeExtension(const TokenBindingParameters &amp;params)</div><div class="ttdef"><b>Definition:</b> <a href="extensions_2tokenbinding_2Types_8cpp_source.html#l00113">Types.cpp:113</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a515b52bb842b6ab525b35577dbf5f978"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="namespacefizz_1_1client.html#a006e2e73a7a79d2e74d951b5ca583ce0">MutateState</a> fizz::sm::handleCertMsg </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classfizz_1_1client_1_1State.html">State</a> &amp;&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structfizz_1_1CertificateMsg.html">CertificateMsg</a>&#160;</td>
          <td class="paramname"><em>certMsg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classfolly_1_1Optional.html">folly::Optional</a>&lt; <a class="el" href="namespacefizz.html#aef5b19e8cb60e324e310f0a9f2afdd95">CertificateCompressionAlgorithm</a> &gt;&#160;</td>
          <td class="paramname"><em>algo</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ClientProtocol_8cpp_source.html#l01353">1353</a> of file <a class="el" href="ClientProtocol_8cpp_source.html">ClientProtocol.cpp</a>.</p>

<p>References <a class="el" href="namespacefizz.html#a02f9d49d996b83310b2a38e93684c959a382ab522931673c11e398ead1b7b1678">fizz::Accepted</a>, <a class="el" href="client_2Actions_8h_source.html#l00086">fizz::client::detail::actions()</a>, <a class="el" href="fizz_2fizz_2record_2Types_8h_source.html#l00273">fizz::CertificateVerify::algorithm</a>, <a class="el" href="namespacefizz.html#a2d0a99663f1db37e8420c978fd7e8f94afc945c3d5cf8f14213002525c45a6fbb">fizz::AppTraffic</a>, <a class="el" href="namespacefizz.html#a147eec03bf3a9683f4e214820a1f758aaa122ea521767a141ab57b4d536bd096b">fizz::bad_certificate</a>, <a class="el" href="namespacefizz.html#a147eec03bf3a9683f4e214820a1f758aa8fd1a30f4f67f92962d89771ec9d47af">fizz::bad_record_mac</a>, <a class="el" href="fizz_2fizz_2record_2Types_8h_source.html#l00239">fizz::CertificateMsg::certificate_list</a>, <a class="el" href="fizz_2fizz_2record_2Types_8h_source.html#l00238">fizz::CertificateMsg::certificate_request_context</a>, <a class="el" href="namespacefizz.html#a1135430496a56ed55bdfc4a77ccb35fba9827062845b39dfab4ecab4c13a6722a">fizz::CertificateVerify</a>, <a class="el" href="namespacefizz.html#a13f474ceeb2b16be9bd67bcba87d4334a812f1c86e37703e27ffb71caf6e6b70a">fizz::change_cipher_spec</a>, <a class="el" href="client_2State_8h_source.html#l00113">fizz::client::State::cipher()</a>, <a class="el" href="KeyScheduler_8cpp_source.html#l00085">fizz::KeyScheduler::clearMasterSecret()</a>, <a class="el" href="namespacefizz.html#ac1a57c6c1e0a9f90d1777788a3b513b9a577d7068826de925ea2aec01dbadf5e4">fizz::Client</a>, <a class="el" href="namespacefizz.html#ad4370192b1570b3bd64f596f674f7637a252f4f2f302b23186cf414bb5b0625c5">fizz::ClientAppTraffic</a>, <a class="el" href="client_2State_8h_source.html#l00092">fizz::client::State::clientAuthRequested()</a>, <a class="el" href="client_2State_8h_source.html#l00099">fizz::client::State::clientAuthSigScheme()</a>, <a class="el" href="client_2State_8h_source.html#l00084">fizz::client::State::clientCert()</a>, <a class="el" href="ClientProtocol_8cpp_source.html#l00780">clientCert</a>, <a class="el" href="client_2State_8h_source.html#l00283">fizz::client::State::clientHandshakeSecret()</a>, <a class="el" href="namespacefizz.html#a1135430496a56ed55bdfc4a77ccb35fba3f5a8d119f352c5d1814151dae409dfc">fizz::CompressedCertificate</a>, <a class="el" href="RecordLayer_8h_source.html#l00020">fizz::TLSContent::contentType</a>, <a class="el" href="client_2State_8h_source.html#l00070">fizz::client::State::context()</a>, <a class="el" href="IOBuf_8h_source.html#l01587">folly::IOBuf::copyBuffer()</a>, <a class="el" href="RecordLayer_8h_source.html#l00019">fizz::TLSContent::data</a>, <a class="el" href="KeyScheduler_8cpp_source.html#l00075">fizz::KeyScheduler::deriveAppTrafficSecrets()</a>, <a class="el" href="KeyScheduler_8cpp_source.html#l00064">fizz::KeyScheduler::deriveMasterSecret()</a>, <a class="el" href="client_2Actions_8h_source.html#l00045">fizz::client::ReportHandshakeSuccess::earlyDataAccepted</a>, <a class="el" href="client_2State_8h_source.html#l00156">fizz::client::State::earlyDataType()</a>, <a class="el" href="client_2State_8h_source.html#l00254">fizz::client::State::earlyWriteRecordLayer()</a>, <a class="el" href="HandshakeTypesTest_8cpp_source.html#l00074">encodedCertVerify</a>, <a class="el" href="Types-inl_8h_source.html#l00515">fizz::encodeHandshake()</a>, <a class="el" href="RecordLayer_8h_source.html#l00021">fizz::TLSContent::encryptionLevel</a>, <a class="el" href="Utils_8cpp_source.html#l00031">fizz::CryptoUtils::equal()</a>, <a class="el" href="namespacefizz_1_1client.html#a591ea099fd6d034227ea51623074beefaaf63847c3970c97e59978ef247286590">fizz::client::ExpectingCertificate</a>, <a class="el" href="namespacefizz_1_1client.html#a591ea099fd6d034227ea51623074beefa10442ba0695d86de1da950031278053a">fizz::client::ExpectingCertificateVerify</a>, <a class="el" href="namespacefizz.html#ae69fe2de1c97b7bd063cd391a7e4a51ea2a7a3512c853695a21388f1d1fc9c8b8">fizz::ExporterMaster</a>, <a class="el" href="client_2State_8h_source.html#l00327">fizz::client::State::exporterMasterSecret()</a>, <a class="el" href="fizz_2fizz_2record_2Types_8h_source.html#l00059">fizz::FakeChangeCipherSpec</a>, <a class="el" href="namespacefizz.html#a5ab3664effa8057a21f4da0194485acdaa5d7ceb2c59b8cee46c2953fec9abc19">fizz::finished</a>, <a class="el" href="FizzClientContext_8h_source.html#l00198">fizz::client::FizzClientContext::getCertDecompressorForAlgorithm()</a>, <a class="el" href="FizzClientContext_8h_source.html#l00158">fizz::client::FizzClientContext::getCompatibilityMode()</a>, <a class="el" href="FizzClientContext_8h_source.html#l00169">fizz::client::FizzClientContext::getFactory()</a>, <a class="el" href="Protocol_8h_source.html#l00033">fizz::Protocol::getFinished()</a>, <a class="el" href="KeyScheduler_8cpp_source.html#l00114">fizz::KeyScheduler::getSecret()</a>, <a class="el" href="FizzClientContext_8h_source.html#l00186">fizz::client::FizzClientContext::getSupportedCertDecompressionAlgorithms()</a>, <a class="el" href="FizzClientContext_8h_source.html#l00054">fizz::client::FizzClientContext::getSupportedSigSchemes()</a>, <a class="el" href="client_2State_8h_source.html#l00376">fizz::client::State::handshakeContext()</a>, <a class="el" href="RecordLayer_8cpp_source.html#l00151">fizz::ReadRecordLayer::hasUnparsedHandshakeData()</a>, <a class="el" href="namespacefizz.html#a147eec03bf3a9683f4e214820a1f758aa0bb2e3cfaec11b1cd502d30d896c8b99">fizz::illegal_parameter</a>, <a class="el" href="client_2State_8h_source.html#l00225">fizz::client::State::keyScheduler()</a>, <a class="el" href="Factory_8h_source.html#l00047">fizz::Factory::makeEncryptedReadRecordLayer()</a>, <a class="el" href="Factory_8h_source.html#l00052">fizz::Factory::makeEncryptedWriteRecordLayer()</a>, <a class="el" href="Factory_8h_source.html#l00128">fizz::Factory::makePeerCert()</a>, <a class="el" href="Base-inl_8h_source.html#l02567">folly::gen::move</a>, <a class="el" href="Optional_8h_source.html#l00087">folly::none</a>, <a class="el" href="namespacefizz_1_1client.html#ae43634436661e274189397f450f3683eac534a66e591207038fe31a2a9e0164b7">fizz::client::NotRequested</a>, <a class="el" href="namespacefizz.html#a2d0a99663f1db37e8420c978fd7e8f94a798f266791eff3fab6a382c14e682900">fizz::Plaintext</a>, <a class="el" href="Range_8h_source.html#l01114">folly::range()</a>, <a class="el" href="client_2State_8h_source.html#l00235">fizz::client::State::readRecordLayer()</a>, <a class="el" href="namespacefizz_1_1client.html#ae43634436661e274189397f450f3683ea0582823afddc13e15c6375c0acef68a8">fizz::client::RequestedNoMatch</a>, <a class="el" href="namespacefizz.html#ae69fe2de1c97b7bd063cd391a7e4a51eafab34e2e31ec8ab3e5973580d4a3eea6">fizz::ResumptionMaster</a>, <a class="el" href="client_2State_8h_source.html#l00301">fizz::client::State::resumptionSecret()</a>, <a class="el" href="client_2State_8h_source.html#l00320">fizz::client::State::selectedClientCert()</a>, <a class="el" href="namespacefizz_1_1client.html#ae43634436661e274189397f450f3683ea7f8c0283f16925caed8e632086b81b9c">fizz::client::Sent</a>, <a class="el" href="client_2State_8h_source.html#l00215">fizz::client::State::sentCCS()</a>, <a class="el" href="namespacefizz.html#aee6ee3a2361db233061763b5c5e63dc5a9aa1b03934893d7134a660af4204f2a9">fizz::Server</a>, <a class="el" href="namespacefizz.html#ad4370192b1570b3bd64f596f674f7637ac76ca33886b773a7e21838ad284d431f">fizz::ServerAppTraffic</a>, <a class="el" href="ClientProtocol_8cpp_source.html#l00779">serverCert</a>, <a class="el" href="client_2State_8h_source.html#l00292">fizz::client::State::serverHandshakeSecret()</a>, <a class="el" href="Protocol_8h_source.html#l00020">fizz::Protocol::setAead()</a>, <a class="el" href="fizz_2fizz_2record_2Types_8h_source.html#l00274">fizz::CertificateVerify::signature</a>, <a class="el" href="namespacefizz_1_1client.html#ae43634436661e274189397f450f3683ea7bf2d26eab899c413218b729d4d914b7">fizz::client::Stored</a>, <a class="el" href="client_2State_8cpp_source.html#l00016">fizz::toString()</a>, <a class="el" href="namespacefizz.html#a147eec03bf3a9683f4e214820a1f758aa597cfdb46675641f694b1f918760d432">fizz::unexpected_message</a>, <a class="el" href="client_2State_8h_source.html#l00310">fizz::client::State::unverifiedCertChain()</a>, <a class="el" href="Optional_8h_source.html#l00330">folly::Optional&lt; Value &gt;::value_or()</a>, <a class="el" href="client_2State_8h_source.html#l00193">fizz::client::State::verifier()</a>, <a class="el" href="classfizz_1_1CertificateVerifier.html#a584a7c5454abf5988befca0ea1c51198">fizz::CertificateVerifier::verify()</a>, <a class="el" href="StlVectorTest_8cpp_source.html#l01475">verify()</a>, <a class="el" href="client_2State_8h_source.html#l00106">fizz::client::State::version()</a>, <a class="el" href="IOBuf_8cpp_source.html#l00353">folly::IOBuf::wrapBuffer()</a>, <a class="el" href="RecordLayer_8h_source.html#l00074">fizz::WriteRecordLayer::writeHandshake()</a>, and <a class="el" href="client_2State_8h_source.html#l00245">fizz::client::State::writeRecordLayer()</a>.</p>
<div class="fragment"><div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;                                                         {</div><div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;  <span class="keywordflow">if</span> (!certMsg.certificate_request_context-&gt;empty()) {</div><div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;    <span class="keywordflow">throw</span> FizzException(</div><div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;        <span class="stringliteral">&quot;certificate request context must be empty&quot;</span>,</div><div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;        AlertDescription::illegal_parameter);</div><div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;  }</div><div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;</div><div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;  std::vector&lt;std::shared_ptr&lt;const PeerCert&gt;&gt; serverCerts;</div><div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; certEntry : certMsg.certificate_list) {</div><div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;    <span class="comment">// We don&#39;t request any certificate-related extensions</span></div><div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;    <span class="keywordflow">if</span> (!certEntry.extensions.empty()) {</div><div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;      <span class="keywordflow">throw</span> FizzException(</div><div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;          <span class="stringliteral">&quot;certificate extensions must be empty&quot;</span>,</div><div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;          AlertDescription::illegal_parameter);</div><div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;    }</div><div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;</div><div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;    serverCerts.emplace_back(state.<a class="code" href="classfizz_1_1client_1_1State.html#ab64506205097dc5732753d70d9040449">context</a>()-&gt;<a class="code" href="classfizz_1_1client_1_1FizzClientContext.html#a106e3d423e88a6d29c184b51a1f03360">getFactory</a>()-&gt;<a class="code" href="classfizz_1_1Factory.html#a71bd97b5a4f3baa737d6aaf610cb9c6a">makePeerCert</a>(</div><div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;        <a class="code" href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">std::move</a>(certEntry.cert_data)));</div><div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;  }</div><div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;</div><div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;  <span class="keywordflow">if</span> (serverCerts.empty()) {</div><div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;    <span class="keywordflow">throw</span> FizzException(</div><div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;        <span class="stringliteral">&quot;no certificates received&quot;</span>, AlertDescription::illegal_parameter);</div><div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;  }</div><div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;</div><div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;  <a class="code" href="namespacefizz_1_1client.html#ae43634436661e274189397f450f3683e">ClientAuthType</a> authType =</div><div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;      state.<a class="code" href="classfizz_1_1client_1_1State.html#a9f8a522db37a4af6d8657545ac4b3624">clientAuthRequested</a>().<a class="code" href="classfolly_1_1Optional.html#a3b9821dde9565651713c0013da729ae3">value_or</a>(ClientAuthType::NotRequested);</div><div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;</div><div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;  <span class="keywordflow">return</span> [unverifiedCertChain = <a class="code" href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">std::move</a>(serverCerts),</div><div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;          authType,</div><div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;          compAlgo = <a class="code" href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">std::move</a>(algo)](<a class="code" href="classfizz_1_1client_1_1State.html">State</a>&amp; newState) <span class="keyword">mutable</span> {</div><div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;    newState.unverifiedCertChain() = <a class="code" href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">std::move</a>(unverifiedCertChain);</div><div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;    newState.clientAuthRequested() = authType;</div><div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;    newState.serverCertCompAlgo() = <a class="code" href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">std::move</a>(compAlgo);</div><div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;  };</div><div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;}</div><div class="ttc" id="namespacefizz_1_1client_html_ae43634436661e274189397f450f3683e"><div class="ttname"><a href="namespacefizz_1_1client.html#ae43634436661e274189397f450f3683e">fizz::client::ClientAuthType</a></div><div class="ttdeci">ClientAuthType</div><div class="ttdef"><b>Definition:</b> <a href="client_2State_8h_source.html#l00042">State.h:42</a></div></div>
<div class="ttc" id="namespacefolly_1_1gen_html_ac24ec252b1b738a40c274285527c193f"><div class="ttname"><a href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">folly::gen::move</a></div><div class="ttdeci">constexpr detail::Map&lt; Move &gt; move</div><div class="ttdef"><b>Definition:</b> <a href="Base-inl_8h_source.html#l02567">Base-inl.h:2567</a></div></div>
<div class="ttc" id="classfizz_1_1client_1_1FizzClientContext_html_a106e3d423e88a6d29c184b51a1f03360"><div class="ttname"><a href="classfizz_1_1client_1_1FizzClientContext.html#a106e3d423e88a6d29c184b51a1f03360">fizz::client::FizzClientContext::getFactory</a></div><div class="ttdeci">const Factory * getFactory() const </div><div class="ttdef"><b>Definition:</b> <a href="FizzClientContext_8h_source.html#l00169">FizzClientContext.h:169</a></div></div>
<div class="ttc" id="classfizz_1_1Factory_html_a71bd97b5a4f3baa737d6aaf610cb9c6a"><div class="ttname"><a href="classfizz_1_1Factory.html#a71bd97b5a4f3baa737d6aaf610cb9c6a">fizz::Factory::makePeerCert</a></div><div class="ttdeci">virtual std::shared_ptr&lt; PeerCert &gt; makePeerCert(Buf certData) const </div><div class="ttdef"><b>Definition:</b> <a href="Factory_8h_source.html#l00128">Factory.h:128</a></div></div>
<div class="ttc" id="classfolly_1_1Optional_html_a3b9821dde9565651713c0013da729ae3"><div class="ttname"><a href="classfolly_1_1Optional.html#a3b9821dde9565651713c0013da729ae3">folly::Optional::value_or</a></div><div class="ttdeci">FOLLY_CPP14_CONSTEXPR Value value_or(U &amp;&amp;dflt) const &amp;</div><div class="ttdef"><b>Definition:</b> <a href="Optional_8h_source.html#l00330">Optional.h:330</a></div></div>
<div class="ttc" id="classfizz_1_1client_1_1State_html"><div class="ttname"><a href="classfizz_1_1client_1_1State.html">fizz::client::State</a></div><div class="ttdef"><b>Definition:</b> <a href="client_2State_8h_source.html#l00058">State.h:58</a></div></div>
<div class="ttc" id="classfizz_1_1client_1_1State_html_ab64506205097dc5732753d70d9040449"><div class="ttname"><a href="classfizz_1_1client_1_1State.html#ab64506205097dc5732753d70d9040449">fizz::client::State::context</a></div><div class="ttdeci">const FizzClientContext * context() const </div><div class="ttdef"><b>Definition:</b> <a href="client_2State_8h_source.html#l00070">State.h:70</a></div></div>
<div class="ttc" id="classfizz_1_1client_1_1State_html_a9f8a522db37a4af6d8657545ac4b3624"><div class="ttname"><a href="classfizz_1_1client_1_1State.html#a9f8a522db37a4af6d8657545ac4b3624">fizz::client::State::clientAuthRequested</a></div><div class="ttdeci">folly::Optional&lt; ClientAuthType &gt; clientAuthRequested() const </div><div class="ttdef"><b>Definition:</b> <a href="client_2State_8h_source.html#l00092">State.h:92</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a44019a7df397aaed71a2cd2880d7fb72"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="namespacefizz_1_1client.html#ae137a3bcd5e2f1dd0f85cae406ef34d0">Actions</a> fizz::sm::handleEarlyAppWrite </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classfizz_1_1client_1_1State.html">State</a> &amp;&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structfizz_1_1EarlyAppWrite.html">EarlyAppWrite</a>&#160;</td>
          <td class="paramname"><em>appWrite</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ClientProtocol_8cpp_source.html#l01801">1801</a> of file <a class="el" href="ClientProtocol_8cpp_source.html">ClientProtocol.cpp</a>.</p>

<p>References <a class="el" href="namespacefizz.html#a02f9d49d996b83310b2a38e93684c959a382ab522931673c11e398ead1b7b1678">fizz::Accepted</a>, <a class="el" href="client_2Actions_8h_source.html#l00086">fizz::client::detail::actions()</a>, <a class="el" href="FizzBaseTest_8cpp_source.html#l00030">fizz::test::appWrite()</a>, <a class="el" href="namespacefizz.html#a02f9d49d996b83310b2a38e93684c959ac52c6eeafe7207599f51d08a22226ca8">fizz::Attempted</a>, <a class="el" href="protocol_2Actions_8h_source.html#l00037">fizz::WriteToSocket::callback</a>, <a class="el" href="Params_8h_source.html#l00047">fizz::EarlyAppWrite::callback</a>, <a class="el" href="Params_8h_source.html#l00053">fizz::AppWrite::callback</a>, <a class="el" href="namespacefizz.html#a13f474ceeb2b16be9bd67bcba87d4334a812f1c86e37703e27ffb71caf6e6b70a">fizz::change_cipher_spec</a>, <a class="el" href="protocol_2Actions_8h_source.html#l00041">fizz::WriteToSocket::contents</a>, <a class="el" href="RecordLayer_8h_source.html#l00020">fizz::TLSContent::contentType</a>, <a class="el" href="client_2State_8h_source.html#l00070">fizz::client::State::context()</a>, <a class="el" href="RecordLayer_8h_source.html#l00019">fizz::TLSContent::data</a>, <a class="el" href="Params_8h_source.html#l00048">fizz::EarlyAppWrite::data</a>, <a class="el" href="Params_8h_source.html#l00054">fizz::AppWrite::data</a>, <a class="el" href="namespacefizz.html#a1135430496a56ed55bdfc4a77ccb35fba47a1bca7303595211ec9f86e386b364f">fizz::EarlyAppWrite</a>, <a class="el" href="client_2State_8h_source.html#l00156">fizz::client::State::earlyDataType()</a>, <a class="el" href="client_2State_8h_source.html#l00254">fizz::client::State::earlyWriteRecordLayer()</a>, <a class="el" href="RecordLayer_8h_source.html#l00021">fizz::TLSContent::encryptionLevel</a>, <a class="el" href="namespacefizz_1_1client.html#a591ea099fd6d034227ea51623074beefaaf63847c3970c97e59978ef247286590">fizz::client::ExpectingCertificate</a>, <a class="el" href="namespacefizz_1_1client.html#a591ea099fd6d034227ea51623074beefa10442ba0695d86de1da950031278053a">fizz::client::ExpectingCertificateVerify</a>, <a class="el" href="namespacefizz_1_1client.html#a591ea099fd6d034227ea51623074beefa1a4abde81c2d1d60784c8f0ab634cd1a">fizz::client::ExpectingEncryptedExtensions</a>, <a class="el" href="namespacefizz_1_1client.html#a591ea099fd6d034227ea51623074beefa694a09f52cda0be4b0b114d49a5f7fb5">fizz::client::ExpectingServerHello</a>, <a class="el" href="fizz_2fizz_2record_2Types_8h_source.html#l00059">fizz::FakeChangeCipherSpec</a>, <a class="el" href="protocol_2Actions_8h_source.html#l00043">fizz::WriteToSocket::flags</a>, <a class="el" href="Params_8h_source.html#l00049">fizz::EarlyAppWrite::flags</a>, <a class="el" href="Params_8h_source.html#l00055">fizz::AppWrite::flags</a>, <a class="el" href="FizzClientContext_8h_source.html#l00158">fizz::client::FizzClientContext::getCompatibilityMode()</a>, <a class="el" href="ClientProtocol_8cpp_source.html#l01791">ignoreEarlyAppWrite()</a>, <a class="el" href="Base-inl_8h_source.html#l02567">folly::gen::move</a>, <a class="el" href="Optional_8h_source.html#l00087">folly::none</a>, <a class="el" href="namespacefizz.html#ab017b61ecd944032c374d31740161131aa65db4b39dd3b01787474dcdb81af5f0">fizz::NotAttempted</a>, <a class="el" href="namespacefizz.html#a2d0a99663f1db37e8420c978fd7e8f94a798f266791eff3fab6a382c14e682900">fizz::Plaintext</a>, <a class="el" href="namespacefizz.html#ab017b61ecd944032c374d31740161131ad37b1f6c0512e2118cee17fea015b699">fizz::Rejected</a>, <a class="el" href="client_2State_8h_source.html#l00215">fizz::client::State::sentCCS()</a>, <a class="el" href="IOBuf_8cpp_source.html#l00353">folly::IOBuf::wrapBuffer()</a>, <a class="el" href="Types-inl_8h_source.html#l00112">fizz::detail::write()</a>, <a class="el" href="RecordLayer_8h_source.html#l00069">fizz::WriteRecordLayer::writeAppData()</a>, and <a class="el" href="client_2State_8h_source.html#l00245">fizz::client::State::writeRecordLayer()</a>.</p>
<div class="fragment"><div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;                                                                               {</div><div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;  <span class="keywordflow">switch</span> (*state.<a class="code" href="classfizz_1_1client_1_1State.html#aaa4275baaf693dc7ecfe3f8a50083fd4">earlyDataType</a>()) {</div><div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;    <span class="keywordflow">case</span> EarlyDataType::NotAttempted:</div><div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;      <span class="keywordflow">throw</span> FizzException(<span class="stringliteral">&quot;invalid early write&quot;</span>, <a class="code" href="namespacefolly.html#ac22c63dbe5af3b0bedb0f21031691537">folly::none</a>);</div><div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;    <span class="keywordflow">case</span> EarlyDataType::Rejected:</div><div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="namespacefizz_1_1sm.html#a33ca709a3c063053fe765502ae066942">ignoreEarlyAppWrite</a>(state, <a class="code" href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">std::move</a>(<a class="code" href="namespacefizz_1_1test.html#a258fa99971c7fed8b9cde43e332b04df">appWrite</a>));</div><div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;    <span class="keywordflow">case</span> EarlyDataType::Attempted:</div><div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;    <span class="keywordflow">case</span> EarlyDataType::Accepted: {</div><div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;      WriteToSocket <a class="code" href="namespacefizz_1_1detail.html#a40ead2543c07ad500214ec9dd760b706">write</a>;</div><div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;      write.callback = <a class="code" href="namespacefizz_1_1test.html#a258fa99971c7fed8b9cde43e332b04df">appWrite</a>.<a class="code" href="structfizz_1_1AppWrite.html#aff79d0f8118bfd9196f0d25aa440ac38">callback</a>;</div><div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;      write.flags = <a class="code" href="namespacefizz_1_1test.html#a258fa99971c7fed8b9cde43e332b04df">appWrite</a>.<a class="code" href="structfizz_1_1AppWrite.html#a098d95d0e711a21e215f9866788a1632">flags</a>;</div><div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;      <span class="keyword">auto</span> appData =</div><div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;          state.<a class="code" href="classfizz_1_1client_1_1State.html#a196ddcdf47fe65c8b79db938bc1dd949">earlyWriteRecordLayer</a>()-&gt;<a class="code" href="classfizz_1_1WriteRecordLayer.html#a06ca0f1f8a66d4872bc71534399781a8">writeAppData</a>(<a class="code" href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">std::move</a>(<a class="code" href="namespacefizz_1_1test.html#a258fa99971c7fed8b9cde43e332b04df">appWrite</a>.<a class="code" href="structfizz_1_1AppWrite.html#ab1c367859a543bcf1048826da3c40706">data</a>));</div><div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;</div><div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;      <span class="keywordflow">if</span> (!state.<a class="code" href="classfizz_1_1client_1_1State.html#ae34e82960a724098c520313280546876">sentCCS</a>() &amp;&amp; state.<a class="code" href="classfizz_1_1client_1_1State.html#ab64506205097dc5732753d70d9040449">context</a>()-&gt;<a class="code" href="classfizz_1_1client_1_1FizzClientContext.html#a3831bcc2e12cbfbde9af675c45eaa8ce">getCompatibilityMode</a>()) {</div><div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;        TLSContent writeCCS;</div><div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;        writeCCS.<a class="code" href="structfizz_1_1TLSContent.html#ad60233202d6a6f824ca0b1fc67daa18b">data</a> = <a class="code" href="classfolly_1_1IOBuf.html#a354ecb1fb5f80e8d0006cf0e74307b63">folly::IOBuf::wrapBuffer</a>(<a class="code" href="namespacefizz.html#a841b6441baa40b9f04e53fe0ca39a446">FakeChangeCipherSpec</a>);</div><div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;        writeCCS.contentType = ContentType::change_cipher_spec;</div><div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;        writeCCS.encryptionLevel = EncryptionLevel::Plaintext;</div><div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;        write.contents.emplace_back(<a class="code" href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">std::move</a>(writeCCS));</div><div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;        write.contents.emplace_back(<a class="code" href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">std::move</a>(appData));</div><div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="namespacefizz_1_1client_1_1detail.html#ae6d7424f1231a60a5dfa15fb736885b8">actions</a>(</div><div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;            [](<a class="code" href="classfizz_1_1client_1_1State.html">State</a>&amp; newState) { newState.<a class="code" href="classfizz_1_1client_1_1State.html#ae34e82960a724098c520313280546876">sentCCS</a>() = <span class="keyword">true</span>; },</div><div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;            <a class="code" href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">std::move</a>(write));</div><div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;        write.contents.emplace_back(<a class="code" href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">std::move</a>(appData));</div><div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="namespacefizz_1_1client_1_1detail.html#ae6d7424f1231a60a5dfa15fb736885b8">actions</a>(<a class="code" href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">std::move</a>(write));</div><div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;      }</div><div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;    }</div><div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;  }</div><div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;  LOG(FATAL) &lt;&lt; <span class="stringliteral">&quot;Bad EarlyDataType&quot;</span>;</div><div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;}</div><div class="ttc" id="structfizz_1_1TLSContent_html_ad60233202d6a6f824ca0b1fc67daa18b"><div class="ttname"><a href="structfizz_1_1TLSContent.html#ad60233202d6a6f824ca0b1fc67daa18b">fizz::TLSContent::data</a></div><div class="ttdeci">Buf data</div><div class="ttdef"><b>Definition:</b> <a href="RecordLayer_8h_source.html#l00019">RecordLayer.h:19</a></div></div>
<div class="ttc" id="namespacefizz_1_1sm_html_a33ca709a3c063053fe765502ae066942"><div class="ttname"><a href="namespacefizz_1_1sm.html#a33ca709a3c063053fe765502ae066942">fizz::sm::ignoreEarlyAppWrite</a></div><div class="ttdeci">static Actions ignoreEarlyAppWrite(const State &amp;state, EarlyAppWrite write)</div><div class="ttdef"><b>Definition:</b> <a href="ClientProtocol_8cpp_source.html#l01791">ClientProtocol.cpp:1791</a></div></div>
<div class="ttc" id="namespacefizz_1_1detail_html_a40ead2543c07ad500214ec9dd760b706"><div class="ttname"><a href="namespacefizz_1_1detail.html#a40ead2543c07ad500214ec9dd760b706">fizz::detail::write</a></div><div class="ttdeci">void write(const T &amp;in, folly::io::Appender &amp;appender)</div><div class="ttdef"><b>Definition:</b> <a href="Types-inl_8h_source.html#l00112">Types-inl.h:112</a></div></div>
<div class="ttc" id="classfizz_1_1client_1_1State_html_aaa4275baaf693dc7ecfe3f8a50083fd4"><div class="ttname"><a href="classfizz_1_1client_1_1State.html#aaa4275baaf693dc7ecfe3f8a50083fd4">fizz::client::State::earlyDataType</a></div><div class="ttdeci">folly::Optional&lt; EarlyDataType &gt; earlyDataType() const </div><div class="ttdef"><b>Definition:</b> <a href="client_2State_8h_source.html#l00156">State.h:156</a></div></div>
<div class="ttc" id="classfolly_1_1IOBuf_html_a354ecb1fb5f80e8d0006cf0e74307b63"><div class="ttname"><a href="classfolly_1_1IOBuf.html#a354ecb1fb5f80e8d0006cf0e74307b63">folly::IOBuf::wrapBuffer</a></div><div class="ttdeci">static std::unique_ptr&lt; IOBuf &gt; wrapBuffer(const void *buf, std::size_t capacity)</div><div class="ttdef"><b>Definition:</b> <a href="IOBuf_8cpp_source.html#l00353">IOBuf.cpp:353</a></div></div>
<div class="ttc" id="namespacefolly_1_1gen_html_ac24ec252b1b738a40c274285527c193f"><div class="ttname"><a href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">folly::gen::move</a></div><div class="ttdeci">constexpr detail::Map&lt; Move &gt; move</div><div class="ttdef"><b>Definition:</b> <a href="Base-inl_8h_source.html#l02567">Base-inl.h:2567</a></div></div>
<div class="ttc" id="namespacefizz_1_1test_html_a258fa99971c7fed8b9cde43e332b04df"><div class="ttname"><a href="namespacefizz_1_1test.html#a258fa99971c7fed8b9cde43e332b04df">fizz::test::appWrite</a></div><div class="ttdeci">static AppWrite appWrite(const std::string &amp;str)</div><div class="ttdef"><b>Definition:</b> <a href="FizzBaseTest_8cpp_source.html#l00030">FizzBaseTest.cpp:30</a></div></div>
<div class="ttc" id="namespacefizz_html_a841b6441baa40b9f04e53fe0ca39a446"><div class="ttname"><a href="namespacefizz.html#a841b6441baa40b9f04e53fe0ca39a446">fizz::FakeChangeCipherSpec</a></div><div class="ttdeci">constexpr folly::StringPiece FakeChangeCipherSpec</div><div class="ttdef"><b>Definition:</b> <a href="fizz_2fizz_2record_2Types_8h_source.html#l00059">Types.h:59</a></div></div>
<div class="ttc" id="classfizz_1_1client_1_1FizzClientContext_html_a3831bcc2e12cbfbde9af675c45eaa8ce"><div class="ttname"><a href="classfizz_1_1client_1_1FizzClientContext.html#a3831bcc2e12cbfbde9af675c45eaa8ce">fizz::client::FizzClientContext::getCompatibilityMode</a></div><div class="ttdeci">bool getCompatibilityMode() const </div><div class="ttdef"><b>Definition:</b> <a href="FizzClientContext_8h_source.html#l00158">FizzClientContext.h:158</a></div></div>
<div class="ttc" id="namespacefizz_1_1client_1_1detail_html_ae6d7424f1231a60a5dfa15fb736885b8"><div class="ttname"><a href="namespacefizz_1_1client_1_1detail.html#ae6d7424f1231a60a5dfa15fb736885b8">fizz::client::detail::actions</a></div><div class="ttdeci">Actions actions(Args &amp;&amp;...act)</div><div class="ttdef"><b>Definition:</b> <a href="client_2Actions_8h_source.html#l00086">Actions.h:86</a></div></div>
<div class="ttc" id="classfizz_1_1client_1_1State_html"><div class="ttname"><a href="classfizz_1_1client_1_1State.html">fizz::client::State</a></div><div class="ttdef"><b>Definition:</b> <a href="client_2State_8h_source.html#l00058">State.h:58</a></div></div>
<div class="ttc" id="classfizz_1_1client_1_1State_html_ae34e82960a724098c520313280546876"><div class="ttname"><a href="classfizz_1_1client_1_1State.html#ae34e82960a724098c520313280546876">fizz::client::State::sentCCS</a></div><div class="ttdeci">bool sentCCS() const </div><div class="ttdef"><b>Definition:</b> <a href="client_2State_8h_source.html#l00215">State.h:215</a></div></div>
<div class="ttc" id="classfizz_1_1client_1_1State_html_ab64506205097dc5732753d70d9040449"><div class="ttname"><a href="classfizz_1_1client_1_1State.html#ab64506205097dc5732753d70d9040449">fizz::client::State::context</a></div><div class="ttdeci">const FizzClientContext * context() const </div><div class="ttdef"><b>Definition:</b> <a href="client_2State_8h_source.html#l00070">State.h:70</a></div></div>
<div class="ttc" id="classfizz_1_1WriteRecordLayer_html_a06ca0f1f8a66d4872bc71534399781a8"><div class="ttname"><a href="classfizz_1_1WriteRecordLayer.html#a06ca0f1f8a66d4872bc71534399781a8">fizz::WriteRecordLayer::writeAppData</a></div><div class="ttdeci">TLSContent writeAppData(std::unique_ptr&lt; folly::IOBuf &gt; &amp;&amp;appData) const </div><div class="ttdef"><b>Definition:</b> <a href="RecordLayer_8h_source.html#l00069">RecordLayer.h:69</a></div></div>
<div class="ttc" id="classfizz_1_1client_1_1State_html_a196ddcdf47fe65c8b79db938bc1dd949"><div class="ttname"><a href="classfizz_1_1client_1_1State.html#a196ddcdf47fe65c8b79db938bc1dd949">fizz::client::State::earlyWriteRecordLayer</a></div><div class="ttdeci">const WriteRecordLayer * earlyWriteRecordLayer() const </div><div class="ttdef"><b>Definition:</b> <a href="client_2State_8h_source.html#l00254">State.h:254</a></div></div>
<div class="ttc" id="structfizz_1_1AppWrite_html_ab1c367859a543bcf1048826da3c40706"><div class="ttname"><a href="structfizz_1_1AppWrite.html#ab1c367859a543bcf1048826da3c40706">fizz::AppWrite::data</a></div><div class="ttdeci">std::unique_ptr&lt; folly::IOBuf &gt; data</div><div class="ttdef"><b>Definition:</b> <a href="Params_8h_source.html#l00054">Params.h:54</a></div></div>
<div class="ttc" id="namespacefolly_html_ac22c63dbe5af3b0bedb0f21031691537"><div class="ttname"><a href="namespacefolly.html#ac22c63dbe5af3b0bedb0f21031691537">folly::none</a></div><div class="ttdeci">constexpr None none</div><div class="ttdef"><b>Definition:</b> <a href="Optional_8h_source.html#l00087">Optional.h:87</a></div></div>
<div class="ttc" id="structfizz_1_1AppWrite_html_a098d95d0e711a21e215f9866788a1632"><div class="ttname"><a href="structfizz_1_1AppWrite.html#a098d95d0e711a21e215f9866788a1632">fizz::AppWrite::flags</a></div><div class="ttdeci">folly::WriteFlags flags</div><div class="ttdef"><b>Definition:</b> <a href="Params_8h_source.html#l00055">Params.h:55</a></div></div>
<div class="ttc" id="structfizz_1_1AppWrite_html_aff79d0f8118bfd9196f0d25aa440ac38"><div class="ttname"><a href="structfizz_1_1AppWrite.html#aff79d0f8118bfd9196f0d25aa440ac38">fizz::AppWrite::callback</a></div><div class="ttdeci">folly::AsyncTransportWrapper::WriteCallback * callback</div><div class="ttdef"><b>Definition:</b> <a href="Params_8h_source.html#l00053">Params.h:53</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a33ca709a3c063053fe765502ae066942"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="namespacefizz_1_1client.html#ae137a3bcd5e2f1dd0f85cae406ef34d0">Actions</a> fizz::sm::ignoreEarlyAppWrite </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classfizz_1_1client_1_1State.html">State</a> &amp;&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structfizz_1_1EarlyAppWrite.html">EarlyAppWrite</a>&#160;</td>
          <td class="paramname"><em>write</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ClientProtocol_8cpp_source.html#l01791">1791</a> of file <a class="el" href="ClientProtocol_8cpp_source.html">ClientProtocol.cpp</a>.</p>

<p>References <a class="el" href="client_2Actions_8h_source.html#l00086">fizz::client::detail::actions()</a>, <a class="el" href="client_2State_8h_source.html#l00156">fizz::client::State::earlyDataType()</a>, <a class="el" href="Base-inl_8h_source.html#l02567">folly::gen::move</a>, <a class="el" href="Optional_8h_source.html#l00087">folly::none</a>, <a class="el" href="namespacefizz.html#ab017b61ecd944032c374d31740161131ad37b1f6c0512e2118cee17fea015b699">fizz::Rejected</a>, and <a class="el" href="client_2Actions_8h_source.html#l00058">fizz::client::ReportEarlyWriteFailed::write</a>.</p>

<p>Referenced by <a class="el" href="ClientProtocol_8cpp_source.html#l01801">handleEarlyAppWrite()</a>.</p>
<div class="fragment"><div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;                                                                            {</div><div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;  <span class="keywordflow">if</span> (*state.<a class="code" href="classfizz_1_1client_1_1State.html#aaa4275baaf693dc7ecfe3f8a50083fd4">earlyDataType</a>() != EarlyDataType::Rejected) {</div><div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;    <span class="keywordflow">throw</span> FizzException(<span class="stringliteral">&quot;ignoring valid early write&quot;</span>, <a class="code" href="namespacefolly.html#ac22c63dbe5af3b0bedb0f21031691537">folly::none</a>);</div><div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;  }</div><div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;</div><div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;  <a class="code" href="structfizz_1_1client_1_1ReportEarlyWriteFailed.html">ReportEarlyWriteFailed</a> failedWrite;</div><div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;  failedWrite.<a class="code" href="structfizz_1_1client_1_1ReportEarlyWriteFailed.html#ac6250bca78bc9c042fdd0f53301b3ab3">write</a> = <a class="code" href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">std::move</a>(<a class="code" href="namespacefizz_1_1detail.html#a40ead2543c07ad500214ec9dd760b706">write</a>);</div><div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacefizz_1_1client_1_1detail.html#ae6d7424f1231a60a5dfa15fb736885b8">actions</a>(<a class="code" href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">std::move</a>(failedWrite));</div><div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;}</div><div class="ttc" id="namespacefizz_1_1detail_html_a40ead2543c07ad500214ec9dd760b706"><div class="ttname"><a href="namespacefizz_1_1detail.html#a40ead2543c07ad500214ec9dd760b706">fizz::detail::write</a></div><div class="ttdeci">void write(const T &amp;in, folly::io::Appender &amp;appender)</div><div class="ttdef"><b>Definition:</b> <a href="Types-inl_8h_source.html#l00112">Types-inl.h:112</a></div></div>
<div class="ttc" id="classfizz_1_1client_1_1State_html_aaa4275baaf693dc7ecfe3f8a50083fd4"><div class="ttname"><a href="classfizz_1_1client_1_1State.html#aaa4275baaf693dc7ecfe3f8a50083fd4">fizz::client::State::earlyDataType</a></div><div class="ttdeci">folly::Optional&lt; EarlyDataType &gt; earlyDataType() const </div><div class="ttdef"><b>Definition:</b> <a href="client_2State_8h_source.html#l00156">State.h:156</a></div></div>
<div class="ttc" id="namespacefolly_1_1gen_html_ac24ec252b1b738a40c274285527c193f"><div class="ttname"><a href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">folly::gen::move</a></div><div class="ttdeci">constexpr detail::Map&lt; Move &gt; move</div><div class="ttdef"><b>Definition:</b> <a href="Base-inl_8h_source.html#l02567">Base-inl.h:2567</a></div></div>
<div class="ttc" id="structfizz_1_1client_1_1ReportEarlyWriteFailed_html"><div class="ttname"><a href="structfizz_1_1client_1_1ReportEarlyWriteFailed.html">fizz::client::ReportEarlyWriteFailed</a></div><div class="ttdef"><b>Definition:</b> <a href="client_2Actions_8h_source.html#l00057">Actions.h:57</a></div></div>
<div class="ttc" id="structfizz_1_1client_1_1ReportEarlyWriteFailed_html_ac6250bca78bc9c042fdd0f53301b3ab3"><div class="ttname"><a href="structfizz_1_1client_1_1ReportEarlyWriteFailed.html#ac6250bca78bc9c042fdd0f53301b3ab3">fizz::client::ReportEarlyWriteFailed::write</a></div><div class="ttdeci">EarlyAppWrite write</div><div class="ttdef"><b>Definition:</b> <a href="client_2Actions_8h_source.html#l00058">Actions.h:58</a></div></div>
<div class="ttc" id="namespacefizz_1_1client_1_1detail_html_ae6d7424f1231a60a5dfa15fb736885b8"><div class="ttname"><a href="namespacefizz_1_1client_1_1detail.html#ae6d7424f1231a60a5dfa15fb736885b8">fizz::client::detail::actions</a></div><div class="ttdeci">Actions actions(Args &amp;&amp;...act)</div><div class="ttdef"><b>Definition:</b> <a href="client_2Actions_8h_source.html#l00086">Actions.h:86</a></div></div>
<div class="ttc" id="namespacefolly_html_ac22c63dbe5af3b0bedb0f21031691537"><div class="ttname"><a href="namespacefolly.html#ac22c63dbe5af3b0bedb0f21031691537">folly::none</a></div><div class="ttdeci">constexpr None none</div><div class="ttdef"><b>Definition:</b> <a href="Optional_8h_source.html#l00087">Optional.h:87</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ac1a5cc121e01d7f131286dcdc299a030"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="classfolly_1_1Optional.html">Optional</a>&lt;<a class="el" href="Conv_8cpp.html#ae1adbce218e7a9d09164012443191d24">std::string</a>&gt; fizz::sm::negotiateAlpn </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structfizz_1_1ClientHello.html">ClientHello</a> &amp;&#160;</td>
          <td class="paramname"><em>chlo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classfolly_1_1Optional.html">folly::Optional</a>&lt; <a class="el" href="Conv_8cpp.html#ae1adbce218e7a9d09164012443191d24">std::string</a> &gt;&#160;</td>
          <td class="paramname"><em>zeroRttAlpn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classfizz_1_1server_1_1FizzServerContext.html">FizzServerContext</a> &amp;&#160;</td>
          <td class="paramname"><em>context</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ServerProtocol_8cpp_source.html#l00756">756</a> of file <a class="el" href="ServerProtocol_8cpp_source.html">ServerProtocol.cpp</a>.</p>

<p>References <a class="el" href="fizz_2fizz_2record_2Types_8h_source.html#l00193">fizz::ClientHello::extensions</a>, and <a class="el" href="FizzServerContext_8h_source.html#l00134">fizz::server::FizzServerContext::negotiateAlpn()</a>.</p>

<p>Referenced by <a class="el" href="ServerProtocol_8cpp_source.html#l00953">getCertificateRequest()</a>.</p>
<div class="fragment"><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;                                      {</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;  <span class="keyword">auto</span> ext = getExtension&lt;ProtocolNameList&gt;(<a class="code" href="HandshakeTypesTest_8cpp.html#aba518b904616df44c3d7dfde825a4c54">chlo</a>.extensions);</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;  std::vector&lt;std::string&gt; clientProtocols;</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;  <span class="keywordflow">if</span> (ext) {</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; protocol : ext-&gt;protocol_name_list) {</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;      clientProtocols.push_back(protocol.name-&gt;moveToFbString().toStdString());</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;    }</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;    VLOG(6) &lt;&lt; <span class="stringliteral">&quot;Client did not send ALPN extension&quot;</span>;</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;  }</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;  <span class="keyword">auto</span> selected = context.<a class="code" href="classfizz_1_1server_1_1FizzServerContext.html#a7c4a0c601342bdc3ddc9301ed44ab84e">negotiateAlpn</a>(clientProtocols, zeroRttAlpn);</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;  <span class="keywordflow">if</span> (!selected) {</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;    VLOG(6) &lt;&lt; <span class="stringliteral">&quot;ALPN mismatch&quot;</span>;</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;    VLOG(6) &lt;&lt; <span class="stringliteral">&quot;ALPN: &quot;</span> &lt;&lt; *selected;</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;  }</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;  <span class="keywordflow">return</span> selected;</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;}</div><div class="ttc" id="HandshakeTypesTest_8cpp_html_aba518b904616df44c3d7dfde825a4c54"><div class="ttname"><a href="HandshakeTypesTest_8cpp.html#aba518b904616df44c3d7dfde825a4c54">chlo</a></div><div class="ttdeci">static const std::string chlo</div><div class="ttdef"><b>Definition:</b> <a href="HandshakeTypesTest_8cpp_source.html#l00023">HandshakeTypesTest.cpp:23</a></div></div>
<div class="ttc" id="classfizz_1_1server_1_1FizzServerContext_html_a7c4a0c601342bdc3ddc9301ed44ab84e"><div class="ttname"><a href="classfizz_1_1server_1_1FizzServerContext.html#a7c4a0c601342bdc3ddc9301ed44ab84e">fizz::server::FizzServerContext::negotiateAlpn</a></div><div class="ttdeci">folly::Optional&lt; std::string &gt; negotiateAlpn(const std::vector&lt; std::string &gt; &amp;clientProtocols, const folly::Optional&lt; std::string &gt; &amp;zeroRttAlpn) const </div><div class="ttdef"><b>Definition:</b> <a href="FizzServerContext_8h_source.html#l00134">FizzServerContext.h:134</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="af3f48f3974ff4da2a63e3673866610b5"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="namespacefizz.html#a23e4ec7baa80cc6f92fdbeadccf0d22e">CipherSuite</a> fizz::sm::negotiateCipher </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structfizz_1_1ClientHello.html">ClientHello</a> &amp;&#160;</td>
          <td class="paramname"><em>chlo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::vector&lt; <a class="el" href="namespacefizz.html#a23e4ec7baa80cc6f92fdbeadccf0d22e">CipherSuite</a> &gt;&gt; &amp;&#160;</td>
          <td class="paramname"><em>supportedCiphers</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ServerProtocol_8cpp_source.html#l00514">514</a> of file <a class="el" href="ServerProtocol_8cpp_source.html">ServerProtocol.cpp</a>.</p>

<p>References <a class="el" href="ClientProtocol_8cpp_source.html#l01006">cipher</a>, <a class="el" href="fizz_2fizz_2record_2Types_8h_source.html#l00191">fizz::ClientHello::cipher_suites</a>, <a class="el" href="namespacefizz.html#a147eec03bf3a9683f4e214820a1f758aa79db796776246d2c3aaca8b375e662c4">fizz::handshake_failure</a>, and <a class="el" href="Negotiator_8h_source.html#l00022">fizz::server::negotiate()</a>.</p>

<p>Referenced by <a class="el" href="ServerProtocol_8cpp_source.html#l00953">getCertificateRequest()</a>.</p>
<div class="fragment"><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;                                                               {</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;  <span class="keyword">auto</span> <a class="code" href="ClientProtocol_8cpp.html#aa7e60e524fbc7254437c13c7d22a9dfa">cipher</a> = <a class="code" href="namespacefizz_1_1server.html#a8f9dd07383882fd187b1e9e86949fc49">negotiate</a>(supportedCiphers, <a class="code" href="HandshakeTypesTest_8cpp.html#aba518b904616df44c3d7dfde825a4c54">chlo</a>.cipher_suites);</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="ClientProtocol_8cpp.html#aa7e60e524fbc7254437c13c7d22a9dfa">cipher</a>) {</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    <span class="keywordflow">throw</span> FizzException(<span class="stringliteral">&quot;no cipher match&quot;</span>, AlertDescription::handshake_failure);</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;  }</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;  <span class="keywordflow">return</span> *<a class="code" href="ClientProtocol_8cpp.html#aa7e60e524fbc7254437c13c7d22a9dfa">cipher</a>;</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;}</div><div class="ttc" id="HandshakeTypesTest_8cpp_html_aba518b904616df44c3d7dfde825a4c54"><div class="ttname"><a href="HandshakeTypesTest_8cpp.html#aba518b904616df44c3d7dfde825a4c54">chlo</a></div><div class="ttdeci">static const std::string chlo</div><div class="ttdef"><b>Definition:</b> <a href="HandshakeTypesTest_8cpp_source.html#l00023">HandshakeTypesTest.cpp:23</a></div></div>
<div class="ttc" id="namespacefizz_1_1server_html_a8f9dd07383882fd187b1e9e86949fc49"><div class="ttname"><a href="namespacefizz_1_1server.html#a8f9dd07383882fd187b1e9e86949fc49">fizz::server::negotiate</a></div><div class="ttdeci">folly::Optional&lt; T &gt; negotiate(const std::vector&lt; std::vector&lt; T &gt;&gt; &amp;serverPref, const std::vector&lt; T &gt; &amp;clientPref)</div><div class="ttdef"><b>Definition:</b> <a href="Negotiator_8h_source.html#l00022">Negotiator.h:22</a></div></div>
<div class="ttc" id="ClientProtocol_8cpp_html_aa7e60e524fbc7254437c13c7d22a9dfa"><div class="ttname"><a href="ClientProtocol_8cpp.html#aa7e60e524fbc7254437c13c7d22a9dfa">cipher</a></div><div class="ttdeci">CipherSuite cipher</div><div class="ttdef"><b>Definition:</b> <a href="ClientProtocol_8cpp_source.html#l01006">ClientProtocol.cpp:1006</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ac3e04624bd83db69e7ec28bed6fcfa4b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="namespacefizz.html#a02f9d49d996b83310b2a38e93684c959">EarlyDataType</a> fizz::sm::negotiateEarlyDataType </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>acceptEarlyData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structfizz_1_1ClientHello.html">ClientHello</a> &amp;&#160;</td>
          <td class="paramname"><em>chlo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classfolly_1_1Optional.html">Optional</a>&lt; <a class="el" href="structfizz_1_1server_1_1ResumptionState.html">ResumptionState</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>psk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacefizz.html#a23e4ec7baa80cc6f92fdbeadccf0d22e">CipherSuite</a>&#160;</td>
          <td class="paramname"><em>cipher</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classfolly_1_1Optional.html">Optional</a>&lt; <a class="el" href="namespacefizz.html#a7935d663f79e6ee45ba86b8d3b4dad9a">KeyExchangeType</a> &gt;&#160;</td>
          <td class="paramname"><em>keyExchangeType</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classfolly_1_1Optional.html">Optional</a>&lt; <a class="el" href="structfizz_1_1server_1_1CookieState.html">CookieState</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>cookieState</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classfolly_1_1Optional.html">Optional</a>&lt; <a class="el" href="Conv_8cpp.html#ae1adbce218e7a9d09164012443191d24">std::string</a> &gt;&#160;</td>
          <td class="paramname"><em>alpn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacefizz_1_1server.html#a55ad2ae3bd23edb629aaf3638e973963">ReplayCacheResult</a>&#160;</td>
          <td class="paramname"><em>replayCacheResult</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classfolly_1_1Optional.html">Optional</a>&lt; std::chrono::milliseconds &gt;&#160;</td>
          <td class="paramname"><em>clockSkew</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structfizz_1_1server_1_1ClockSkewTolerance.html">ClockSkewTolerance</a>&#160;</td>
          <td class="paramname"><em>clockSkewTolerance</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classfizz_1_1server_1_1AppTokenValidator.html">AppTokenValidator</a> *&#160;</td>
          <td class="paramname"><em>appTokenValidator</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ServerProtocol_8cpp_source.html#l00794">794</a> of file <a class="el" href="ServerProtocol_8cpp_source.html">ServerProtocol.cpp</a>.</p>

<p>References <a class="el" href="namespacefizz.html#a02f9d49d996b83310b2a38e93684c959a382ab522931673c11e398ead1b7b1678">fizz::Accepted</a>, <a class="el" href="FizzServerContext_8h_source.html#l00036">fizz::server::ClockSkewTolerance::after</a>, <a class="el" href="ResumptionState_8h_source.html#l00026">fizz::server::ResumptionState::alpn</a>, <a class="el" href="FizzServerContext_8h_source.html#l00035">fizz::server::ClockSkewTolerance::before</a>, <a class="el" href="ResumptionState_8h_source.html#l00021">fizz::server::ResumptionState::cipher</a>, <a class="el" href="fizz_2fizz_2record_2Types_8h_source.html#l00193">fizz::ClientHello::extensions</a>, <a class="el" href="namespacefizz.html#a1135430496a56ed55bdfc4a77ccb35fba51ad30e8de321aca8d16fe7a2d9f62c5">fizz::HelloRetryRequest</a>, <a class="el" href="namespacefizz.html#ab017b61ecd944032c374d31740161131aa65db4b39dd3b01787474dcdb81af5f0">fizz::NotAttempted</a>, <a class="el" href="ReplayCache_8h_source.html#l00019">fizz::server::NotReplay</a>, <a class="el" href="namespacefizz.html#ab017b61ecd944032c374d31740161131ad37b1f6c0512e2118cee17fea015b699">fizz::Rejected</a>, and <a class="el" href="classfizz_1_1server_1_1AppTokenValidator.html#a89a05968eaaa358b467ec0924fe88521">fizz::server::AppTokenValidator::validate()</a>.</p>

<p>Referenced by <a class="el" href="ServerProtocol_8cpp_source.html#l00953">getCertificateRequest()</a>.</p>
<div class="fragment"><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;                                                {</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;  <span class="keywordflow">if</span> (!getExtension&lt;ClientEarlyData&gt;(<a class="code" href="HandshakeTypesTest_8cpp.html#aba518b904616df44c3d7dfde825a4c54">chlo</a>.extensions)) {</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;    <span class="keywordflow">return</span> EarlyDataType::NotAttempted;</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;  }</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;  <span class="keywordflow">if</span> (!acceptEarlyData) {</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;    VLOG(5) &lt;&lt; <span class="stringliteral">&quot;Rejecting early data: disabled&quot;</span>;</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;    <span class="keywordflow">return</span> EarlyDataType::Rejected;</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;  }</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;  <span class="keywordflow">if</span> (!psk) {</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;    VLOG(5) &lt;&lt; <span class="stringliteral">&quot;Rejected early data: psk rejected&quot;</span>;</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;    <span class="keywordflow">return</span> EarlyDataType::Rejected;</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;  }</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;  <span class="keywordflow">if</span> (psk-&gt;<a class="code" href="structfizz_1_1server_1_1ResumptionState.html#a50b823b26e25f055b035a094e566aa8e">cipher</a> != <a class="code" href="ClientProtocol_8cpp.html#aa7e60e524fbc7254437c13c7d22a9dfa">cipher</a>) {</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;    VLOG(5) &lt;&lt; <span class="stringliteral">&quot;Rejected early data: cipher mismatch&quot;</span>;</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;    <span class="keywordflow">return</span> EarlyDataType::Rejected;</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;  }</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;  <span class="keywordflow">if</span> (psk-&gt;<a class="code" href="structfizz_1_1server_1_1ResumptionState.html#aefed07164d0fe2db7cd5e4a3424e5828">alpn</a> != alpn) {</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;    VLOG(5) &lt;&lt; <span class="stringliteral">&quot;Rejecting early data: alpn mismatch&quot;</span>;</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;    <span class="keywordflow">return</span> EarlyDataType::Rejected;</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;  }</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;  <span class="keywordflow">if</span> (keyExchangeType &amp;&amp;</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;      *keyExchangeType == KeyExchangeType::HelloRetryRequest) {</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;    VLOG(5) &lt;&lt; <span class="stringliteral">&quot;Rejecting early data: HelloRetryRequest&quot;</span>;</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;    <span class="keywordflow">return</span> EarlyDataType::Rejected;</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;  }</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;  <span class="keywordflow">if</span> (cookieState) {</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;    VLOG(5) &lt;&lt; <span class="stringliteral">&quot;Rejecting early data: Cookie&quot;</span>;</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;    <span class="keywordflow">return</span> EarlyDataType::Rejected;</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;  }</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;  <span class="keywordflow">if</span> (replayCacheResult != <a class="code" href="namespacefizz_1_1server.html#a55ad2ae3bd23edb629aaf3638e973963acdc46a0a83a54a55ee97cbf55d098085">ReplayCacheResult::NotReplay</a>) {</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;    VLOG(5) &lt;&lt; <span class="stringliteral">&quot;Rejecting early data: replay&quot;</span>;</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;    <span class="keywordflow">return</span> EarlyDataType::Rejected;</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;  }</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;  <span class="keywordflow">if</span> (!clockSkew || *clockSkew &lt; clockSkewTolerance.<a class="code" href="structfizz_1_1server_1_1ClockSkewTolerance.html#a1d0dfd49359d02599a88dbf02f58a5ef">before</a> ||</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;      *clockSkew &gt; clockSkewTolerance.<a class="code" href="structfizz_1_1server_1_1ClockSkewTolerance.html#ac55186f831f56bf4ce51779512f85ec2">after</a>) {</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;    VLOG(5) &lt;&lt; <span class="stringliteral">&quot;Rejecting early data: clock skew clockSkew=&quot;</span></div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;            &lt;&lt; (clockSkew ? folly::to&lt;std::string&gt;(clockSkew-&gt;count())</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;                          : <span class="stringliteral">&quot;(none)&quot;</span>)</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;            &lt;&lt; <span class="stringliteral">&quot; toleranceBefore=&quot;</span> &lt;&lt; clockSkewTolerance.<a class="code" href="structfizz_1_1server_1_1ClockSkewTolerance.html#a1d0dfd49359d02599a88dbf02f58a5ef">before</a>.count()</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;            &lt;&lt; <span class="stringliteral">&quot; toleranceAfter=&quot;</span> &lt;&lt; clockSkewTolerance.<a class="code" href="structfizz_1_1server_1_1ClockSkewTolerance.html#ac55186f831f56bf4ce51779512f85ec2">after</a>.count();</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;    <span class="keywordflow">return</span> EarlyDataType::Rejected;</div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;  }</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;  <span class="keywordflow">if</span> (appTokenValidator &amp;&amp; !appTokenValidator-&gt;<a class="code" href="classfizz_1_1server_1_1AppTokenValidator.html#a89a05968eaaa358b467ec0924fe88521">validate</a>(*psk)) {</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;    VLOG(5) &lt;&lt; <span class="stringliteral">&quot;Rejecting early data: invalid app token&quot;</span>;</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;    <span class="keywordflow">return</span> EarlyDataType::Rejected;</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;  }</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;  <span class="keywordflow">return</span> EarlyDataType::Accepted;</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;}</div><div class="ttc" id="HandshakeTypesTest_8cpp_html_aba518b904616df44c3d7dfde825a4c54"><div class="ttname"><a href="HandshakeTypesTest_8cpp.html#aba518b904616df44c3d7dfde825a4c54">chlo</a></div><div class="ttdeci">static const std::string chlo</div><div class="ttdef"><b>Definition:</b> <a href="HandshakeTypesTest_8cpp_source.html#l00023">HandshakeTypesTest.cpp:23</a></div></div>
<div class="ttc" id="structfizz_1_1server_1_1ResumptionState_html_aefed07164d0fe2db7cd5e4a3424e5828"><div class="ttname"><a href="structfizz_1_1server_1_1ResumptionState.html#aefed07164d0fe2db7cd5e4a3424e5828">fizz::server::ResumptionState::alpn</a></div><div class="ttdeci">folly::Optional&lt; std::string &gt; alpn</div><div class="ttdef"><b>Definition:</b> <a href="ResumptionState_8h_source.html#l00026">ResumptionState.h:26</a></div></div>
<div class="ttc" id="namespacefizz_1_1server_html_a55ad2ae3bd23edb629aaf3638e973963acdc46a0a83a54a55ee97cbf55d098085"><div class="ttname"><a href="namespacefizz_1_1server.html#a55ad2ae3bd23edb629aaf3638e973963acdc46a0a83a54a55ee97cbf55d098085">fizz::server::NotReplay</a></div><div class="ttdef"><b>Definition:</b> <a href="ReplayCache_8h_source.html#l00019">ReplayCache.h:19</a></div></div>
<div class="ttc" id="structfizz_1_1server_1_1ResumptionState_html_a50b823b26e25f055b035a094e566aa8e"><div class="ttname"><a href="structfizz_1_1server_1_1ResumptionState.html#a50b823b26e25f055b035a094e566aa8e">fizz::server::ResumptionState::cipher</a></div><div class="ttdeci">CipherSuite cipher</div><div class="ttdef"><b>Definition:</b> <a href="ResumptionState_8h_source.html#l00021">ResumptionState.h:21</a></div></div>
<div class="ttc" id="classfizz_1_1server_1_1AppTokenValidator_html_a89a05968eaaa358b467ec0924fe88521"><div class="ttname"><a href="classfizz_1_1server_1_1AppTokenValidator.html#a89a05968eaaa358b467ec0924fe88521">fizz::server::AppTokenValidator::validate</a></div><div class="ttdeci">virtual bool validate(const ResumptionState &amp;) const =0</div></div>
<div class="ttc" id="ClientProtocol_8cpp_html_aa7e60e524fbc7254437c13c7d22a9dfa"><div class="ttname"><a href="ClientProtocol_8cpp.html#aa7e60e524fbc7254437c13c7d22a9dfa">cipher</a></div><div class="ttdeci">CipherSuite cipher</div><div class="ttdef"><b>Definition:</b> <a href="ClientProtocol_8cpp_source.html#l01006">ClientProtocol.cpp:1006</a></div></div>
<div class="ttc" id="structfizz_1_1server_1_1ClockSkewTolerance_html_ac55186f831f56bf4ce51779512f85ec2"><div class="ttname"><a href="structfizz_1_1server_1_1ClockSkewTolerance.html#ac55186f831f56bf4ce51779512f85ec2">fizz::server::ClockSkewTolerance::after</a></div><div class="ttdeci">std::chrono::milliseconds after</div><div class="ttdef"><b>Definition:</b> <a href="FizzServerContext_8h_source.html#l00036">FizzServerContext.h:36</a></div></div>
<div class="ttc" id="structfizz_1_1server_1_1ClockSkewTolerance_html_a1d0dfd49359d02599a88dbf02f58a5ef"><div class="ttname"><a href="structfizz_1_1server_1_1ClockSkewTolerance.html#a1d0dfd49359d02599a88dbf02f58a5ef">fizz::server::ClockSkewTolerance::before</a></div><div class="ttdeci">std::chrono::milliseconds before</div><div class="ttdef"><b>Definition:</b> <a href="FizzServerContext_8h_source.html#l00035">FizzServerContext.h:35</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a6195470e66b28f21de9c1a35cc0ff8cf"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static std::tuple&lt;<a class="el" href="namespacefizz.html#a11069edebaa08949c9a6696ef4bb85e2">NamedGroup</a>, <a class="el" href="classfolly_1_1Optional.html">Optional</a>&lt;<a class="el" href="namespacefizz.html#af020f21a568ff86800e03d6ad2a9b84d">Buf</a>&gt; &gt; fizz::sm::negotiateGroup </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespacefizz.html#a3a1cbf7ef22de4d4c5144b3090d7ebc1">ProtocolVersion</a>&#160;</td>
          <td class="paramname"><em>version</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structfizz_1_1ClientHello.html">ClientHello</a> &amp;&#160;</td>
          <td class="paramname"><em>chlo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="namespacefizz.html#a11069edebaa08949c9a6696ef4bb85e2">NamedGroup</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>supportedGroups</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ServerProtocol_8cpp_source.html#l00617">617</a> of file <a class="el" href="ServerProtocol_8cpp_source.html">ServerProtocol.cpp</a>.</p>

<p>References <a class="el" href="fizz_2fizz_2record_2Types_8h_source.html#l00193">fizz::ClientHello::extensions</a>, <a class="el" href="record_2Types_8cpp_source.html#l00016">fizz::getRealDraftVersion()</a>, <a class="el" href="ClientProtocol_8cpp_source.html#l01007">group</a>, <a class="el" href="namespacefizz.html#a147eec03bf3a9683f4e214820a1f758aa79db796776246d2c3aaca8b375e662c4">fizz::handshake_failure</a>, <a class="el" href="namespacefizz.html#a147eec03bf3a9683f4e214820a1f758aa0bb2e3cfaec11b1cd502d30d896c8b99">fizz::illegal_parameter</a>, <a class="el" href="fizz_2build___2gtest_2src_2gtest_2googletest_2include_2gtest_2internal_2gtest-tuple_8h_source.html#l00675">std::tr1::make_tuple()</a>, <a class="el" href="namespacefizz.html#a147eec03bf3a9683f4e214820a1f758aac3adda9630b39fc3300eb2f1aa7209ed">fizz::missing_extension</a>, <a class="el" href="Negotiator_8h_source.html#l00022">fizz::server::negotiate()</a>, <a class="el" href="Optional_8h_source.html#l00087">folly::none</a>, <a class="el" href="share_8h_source.html#l00053">folly::pushmi::operators::share</a>, <a class="el" href="namespacefizz.html#a3a1cbf7ef22de4d4c5144b3090d7ebc1aafa659196b1c05be67f7495345e7d5a1">fizz::tls_1_3_20</a>, <a class="el" href="namespacefizz.html#a3a1cbf7ef22de4d4c5144b3090d7ebc1a8af2ff0742c817e40e459c759fc5a25b">fizz::tls_1_3_21</a>, <a class="el" href="namespacefizz.html#a3a1cbf7ef22de4d4c5144b3090d7ebc1ac6930c4fdd481d3a41608d66beb5e309">fizz::tls_1_3_22</a>, and <a class="el" href="ServerProtocol_8cpp_source.html#l00604">validateGroups()</a>.</p>

<p>Referenced by <a class="el" href="ServerProtocol_8cpp_source.html#l00953">getCertificateRequest()</a>.</p>
<div class="fragment"><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;                                                  {</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;  <span class="keyword">auto</span> groups = getExtension&lt;SupportedGroups&gt;(<a class="code" href="HandshakeTypesTest_8cpp.html#aba518b904616df44c3d7dfde825a4c54">chlo</a>.extensions);</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;  <span class="keywordflow">if</span> (!groups) {</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;    <span class="keywordflow">throw</span> FizzException(<span class="stringliteral">&quot;no named groups&quot;</span>, AlertDescription::missing_extension);</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;  }</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;  <span class="keyword">auto</span> <a class="code" href="ClientProtocol_8cpp.html#a100fbfdcc383ea1165570b83a874c0e0">group</a> = <a class="code" href="namespacefizz_1_1server.html#a8f9dd07383882fd187b1e9e86949fc49">negotiate</a>(supportedGroups, groups-&gt;named_group_list);</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="ClientProtocol_8cpp.html#a100fbfdcc383ea1165570b83a874c0e0">group</a>) {</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;    <span class="keywordflow">throw</span> FizzException(<span class="stringliteral">&quot;no group match&quot;</span>, AlertDescription::handshake_failure);</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;  }</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;  <span class="keyword">auto</span> clientShares = getExtension&lt;ClientKeyShare&gt;(<a class="code" href="HandshakeTypesTest_8cpp.html#aba518b904616df44c3d7dfde825a4c54">chlo</a>.extensions);</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;  <span class="keywordflow">if</span> (!clientShares) {</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;    <span class="keywordflow">throw</span> FizzException(</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;        <span class="stringliteral">&quot;no client shares&quot;</span>, AlertDescription::missing_extension);</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;  }</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;  <span class="keyword">auto</span> realVersion = <a class="code" href="namespacefizz.html#af14fcb8cbbab3726a0922291cd13b4d1">getRealDraftVersion</a>(<a class="code" href="ClientProtocol_8cpp.html#abe1b247743d4691ae90a9b12b08cc176">version</a>);</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;  <span class="keywordflow">if</span> (realVersion == ProtocolVersion::tls_1_3_20 ||</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;      realVersion == ProtocolVersion::tls_1_3_21 ||</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;      realVersion == ProtocolVersion::tls_1_3_22) {</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;    <span class="keywordflow">if</span> (!clientShares-&gt;preDraft23) {</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;      <span class="keywordflow">throw</span> FizzException(</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;          <span class="stringliteral">&quot;post-23 client share&quot;</span>, AlertDescription::illegal_parameter);</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;    }</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;    <span class="keywordflow">if</span> (clientShares-&gt;preDraft23) {</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;      <span class="keywordflow">throw</span> FizzException(</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;          <span class="stringliteral">&quot;pre-23 client share&quot;</span>, AlertDescription::illegal_parameter);</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;    }</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;  }</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;  <a class="code" href="namespacefizz_1_1sm.html#a44ac44fa0698a8dc734362655b93098b">validateGroups</a>(clientShares-&gt;client_shares);</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; <a class="code" href="namespacefolly_1_1pushmi_1_1operators.html#a3579d804a0ba5b8e323f96858f94c4e6">share</a> : clientShares-&gt;client_shares) {</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacefolly_1_1pushmi_1_1operators.html#a3579d804a0ba5b8e323f96858f94c4e6">share</a>.group == *<a class="code" href="ClientProtocol_8cpp.html#a100fbfdcc383ea1165570b83a874c0e0">group</a>) {</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="namespacestd_1_1tr1.html#af7e12a0f5b5791b5b7c49a5a17b85359">std::make_tuple</a>(*<a class="code" href="ClientProtocol_8cpp.html#a100fbfdcc383ea1165570b83a874c0e0">group</a>, <a class="code" href="namespacefolly_1_1pushmi_1_1operators.html#a3579d804a0ba5b8e323f96858f94c4e6">share</a>.key_exchange-&gt;clone());</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;    }</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;  }</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacestd_1_1tr1.html#af7e12a0f5b5791b5b7c49a5a17b85359">std::make_tuple</a>(*<a class="code" href="ClientProtocol_8cpp.html#a100fbfdcc383ea1165570b83a874c0e0">group</a>, <a class="code" href="namespacefolly.html#ac22c63dbe5af3b0bedb0f21031691537">folly::none</a>);</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;}</div><div class="ttc" id="HandshakeTypesTest_8cpp_html_aba518b904616df44c3d7dfde825a4c54"><div class="ttname"><a href="HandshakeTypesTest_8cpp.html#aba518b904616df44c3d7dfde825a4c54">chlo</a></div><div class="ttdeci">static const std::string chlo</div><div class="ttdef"><b>Definition:</b> <a href="HandshakeTypesTest_8cpp_source.html#l00023">HandshakeTypesTest.cpp:23</a></div></div>
<div class="ttc" id="namespacefolly_1_1pushmi_1_1operators_html_a3579d804a0ba5b8e323f96858f94c4e6"><div class="ttname"><a href="namespacefolly_1_1pushmi_1_1operators.html#a3579d804a0ba5b8e323f96858f94c4e6">folly::pushmi::operators::share</a></div><div class="ttdeci">PUSHMI_INLINE_VAR constexpr detail::share_fn&lt; TN... &gt; share</div><div class="ttdef"><b>Definition:</b> <a href="share_8h_source.html#l00053">share.h:53</a></div></div>
<div class="ttc" id="namespacefizz_1_1sm_html_a44ac44fa0698a8dc734362655b93098b"><div class="ttname"><a href="namespacefizz_1_1sm.html#a44ac44fa0698a8dc734362655b93098b">fizz::sm::validateGroups</a></div><div class="ttdeci">static void validateGroups(const std::vector&lt; KeyShareEntry &gt; &amp;client_shares)</div><div class="ttdef"><b>Definition:</b> <a href="ServerProtocol_8cpp_source.html#l00604">ServerProtocol.cpp:604</a></div></div>
<div class="ttc" id="namespacefizz_1_1server_html_a8f9dd07383882fd187b1e9e86949fc49"><div class="ttname"><a href="namespacefizz_1_1server.html#a8f9dd07383882fd187b1e9e86949fc49">fizz::server::negotiate</a></div><div class="ttdeci">folly::Optional&lt; T &gt; negotiate(const std::vector&lt; std::vector&lt; T &gt;&gt; &amp;serverPref, const std::vector&lt; T &gt; &amp;clientPref)</div><div class="ttdef"><b>Definition:</b> <a href="Negotiator_8h_source.html#l00022">Negotiator.h:22</a></div></div>
<div class="ttc" id="namespacestd_1_1tr1_html_af7e12a0f5b5791b5b7c49a5a17b85359"><div class="ttname"><a href="namespacestd_1_1tr1.html#af7e12a0f5b5791b5b7c49a5a17b85359">std::tr1::make_tuple</a></div><div class="ttdeci">tuple make_tuple()</div><div class="ttdef"><b>Definition:</b> <a href="fizz_2build___2gtest_2src_2gtest_2googletest_2include_2gtest_2internal_2gtest-tuple_8h_source.html#l00675">gtest-tuple.h:675</a></div></div>
<div class="ttc" id="ClientProtocol_8cpp_html_abe1b247743d4691ae90a9b12b08cc176"><div class="ttname"><a href="ClientProtocol_8cpp.html#abe1b247743d4691ae90a9b12b08cc176">version</a></div><div class="ttdeci">ProtocolVersion version</div><div class="ttdef"><b>Definition:</b> <a href="ClientProtocol_8cpp_source.html#l01005">ClientProtocol.cpp:1005</a></div></div>
<div class="ttc" id="ClientProtocol_8cpp_html_a100fbfdcc383ea1165570b83a874c0e0"><div class="ttname"><a href="ClientProtocol_8cpp.html#a100fbfdcc383ea1165570b83a874c0e0">group</a></div><div class="ttdeci">Optional&lt; NamedGroup &gt; group</div><div class="ttdef"><b>Definition:</b> <a href="ClientProtocol_8cpp_source.html#l01007">ClientProtocol.cpp:1007</a></div></div>
<div class="ttc" id="namespacefizz_html_af14fcb8cbbab3726a0922291cd13b4d1"><div class="ttname"><a href="namespacefizz.html#af14fcb8cbbab3726a0922291cd13b4d1">fizz::getRealDraftVersion</a></div><div class="ttdeci">ProtocolVersion getRealDraftVersion(ProtocolVersion version)</div><div class="ttdef"><b>Definition:</b> <a href="record_2Types_8cpp_source.html#l00016">Types.cpp:16</a></div></div>
<div class="ttc" id="namespacefolly_html_ac22c63dbe5af3b0bedb0f21031691537"><div class="ttname"><a href="namespacefolly.html#ac22c63dbe5af3b0bedb0f21031691537">folly::none</a></div><div class="ttdeci">constexpr None none</div><div class="ttdef"><b>Definition:</b> <a href="Optional_8h_source.html#l00087">Optional.h:87</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a070457422b5607a9c4e9ad6e9852fc0a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static auto fizz::sm::negotiateParameters </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structfizz_1_1ServerHello.html">ServerHello</a> &amp;&#160;</td>
          <td class="paramname"><em>shlo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="namespacefizz.html#a3a1cbf7ef22de4d4c5144b3090d7ebc1">ProtocolVersion</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>supportedVersions</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="namespacefizz.html#a23e4ec7baa80cc6f92fdbeadccf0d22e">CipherSuite</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>supportedCiphers</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="PackedSyncPtrTest_8cpp.html#a2a761d9ec8bcdc907b3e45a3ba097c32">std::map</a>&lt; <a class="el" href="namespacefizz.html#a11069edebaa08949c9a6696ef4bb85e2">NamedGroup</a>, std::unique_ptr&lt; <a class="el" href="classfizz_1_1KeyExchange.html">KeyExchange</a> &gt;&gt; &amp;&#160;</td>
          <td class="paramname"><em>keyExchangers</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ClientProtocol_8cpp_source.html#l00733">733</a> of file <a class="el" href="ClientProtocol_8cpp_source.html">ClientProtocol.cpp</a>.</p>

<p>References <a class="el" href="ClientProtocol_8cpp_source.html#l01006">cipher</a>, <a class="el" href="Utility_8h_source.html#l00120">folly::exchange()</a>, <a class="el" href="fizz_2fizz_2record_2Types_8h_source.html#l00205">fizz::ServerHello::extensions</a>, <a class="el" href="ClientProtocol_8cpp_source.html#l00689">getAndValidateVersionAndCipher()</a>, <a class="el" href="namespacefizz.html#a147eec03bf3a9683f4e214820a1f758aa79db796776246d2c3aaca8b375e662c4">fizz::handshake_failure</a>, <a class="el" href="fizz_2build___2gtest_2src_2gtest_2googletest_2include_2gtest_2internal_2gtest-tuple_8h_source.html#l00675">std::tr1::make_tuple()</a>, <a class="el" href="Base-inl_8h_source.html#l02567">folly::gen::move</a>, and <a class="el" href="ClientProtocol_8cpp_source.html#l01005">version</a>.</p>
<div class="fragment"><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;                                                                         {</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;  <a class="code" href="namespacefizz.html#a3a1cbf7ef22de4d4c5144b3090d7ebc1">ProtocolVersion</a> <a class="code" href="ClientProtocol_8cpp.html#abe1b247743d4691ae90a9b12b08cc176">version</a>;</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;  <a class="code" href="namespacefizz.html#a23e4ec7baa80cc6f92fdbeadccf0d22e">CipherSuite</a> <a class="code" href="ClientProtocol_8cpp.html#aa7e60e524fbc7254437c13c7d22a9dfa">cipher</a>;</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;  std::tie(version, cipher) =</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;      <a class="code" href="namespacefizz_1_1sm.html#a4800617fb250b2236b307edd74e971ae">getAndValidateVersionAndCipher</a>(shlo, supportedVersions, supportedCiphers);</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;  <a class="code" href="classfolly_1_1Optional.html">Optional&lt;std::tuple&lt;NamedGroup, Buf, const KeyExchange*&gt;</a>&gt; <a class="code" href="namespacefolly.html#ab192e7aacc86b36de9b85fa7c16c3f5b">exchange</a>;</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span> serverShare = getExtension&lt;ServerKeyShare&gt;(shlo.extensions);</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;  <span class="keywordflow">if</span> (serverShare) {</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;    <span class="keyword">auto</span> kex = keyExchangers.find(serverShare-&gt;server_share.group);</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;    <span class="keywordflow">if</span> (kex == keyExchangers.end()) {</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;      <span class="keywordflow">throw</span> FizzException(</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;          <span class="stringliteral">&quot;server choose unsupported group&quot;</span>,</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;          AlertDescription::handshake_failure);</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;    }</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;    exchange = <a class="code" href="namespacestd_1_1tr1.html#af7e12a0f5b5791b5b7c49a5a17b85359">std::make_tuple</a>(</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;        serverShare-&gt;server_share.group,</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;        serverShare-&gt;server_share.key_exchange-&gt;clone(),</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;        kex-&gt;second.get());</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;  }</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacestd_1_1tr1.html#af7e12a0f5b5791b5b7c49a5a17b85359">std::make_tuple</a>(version, cipher, <a class="code" href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">std::move</a>(exchange));</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;}</div><div class="ttc" id="namespacefizz_1_1sm_html_a4800617fb250b2236b307edd74e971ae"><div class="ttname"><a href="namespacefizz_1_1sm.html#a4800617fb250b2236b307edd74e971ae">fizz::sm::getAndValidateVersionAndCipher</a></div><div class="ttdeci">static std::pair&lt; ProtocolVersion, CipherSuite &gt; getAndValidateVersionAndCipher(const ServerMessage &amp;msg, const std::vector&lt; ProtocolVersion &gt; &amp;supportedVersions, const std::vector&lt; CipherSuite &gt; &amp;supportedCiphers)</div><div class="ttdef"><b>Definition:</b> <a href="ClientProtocol_8cpp_source.html#l00689">ClientProtocol.cpp:689</a></div></div>
<div class="ttc" id="namespacefolly_1_1gen_html_ac24ec252b1b738a40c274285527c193f"><div class="ttname"><a href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">folly::gen::move</a></div><div class="ttdeci">constexpr detail::Map&lt; Move &gt; move</div><div class="ttdef"><b>Definition:</b> <a href="Base-inl_8h_source.html#l02567">Base-inl.h:2567</a></div></div>
<div class="ttc" id="namespacefizz_html_a23e4ec7baa80cc6f92fdbeadccf0d22e"><div class="ttname"><a href="namespacefizz.html#a23e4ec7baa80cc6f92fdbeadccf0d22e">fizz::CipherSuite</a></div><div class="ttdeci">CipherSuite</div><div class="ttdef"><b>Definition:</b> <a href="fizz_2fizz_2record_2Types_8h_source.html#l00153">Types.h:153</a></div></div>
<div class="ttc" id="namespacestd_1_1tr1_html_af7e12a0f5b5791b5b7c49a5a17b85359"><div class="ttname"><a href="namespacestd_1_1tr1.html#af7e12a0f5b5791b5b7c49a5a17b85359">std::tr1::make_tuple</a></div><div class="ttdeci">tuple make_tuple()</div><div class="ttdef"><b>Definition:</b> <a href="fizz_2build___2gtest_2src_2gtest_2googletest_2include_2gtest_2internal_2gtest-tuple_8h_source.html#l00675">gtest-tuple.h:675</a></div></div>
<div class="ttc" id="ClientProtocol_8cpp_html_aa7e60e524fbc7254437c13c7d22a9dfa"><div class="ttname"><a href="ClientProtocol_8cpp.html#aa7e60e524fbc7254437c13c7d22a9dfa">cipher</a></div><div class="ttdeci">CipherSuite cipher</div><div class="ttdef"><b>Definition:</b> <a href="ClientProtocol_8cpp_source.html#l01006">ClientProtocol.cpp:1006</a></div></div>
<div class="ttc" id="namespacefizz_html_a3a1cbf7ef22de4d4c5144b3090d7ebc1"><div class="ttname"><a href="namespacefizz.html#a3a1cbf7ef22de4d4c5144b3090d7ebc1">fizz::ProtocolVersion</a></div><div class="ttdeci">ProtocolVersion</div><div class="ttdef"><b>Definition:</b> <a href="fizz_2fizz_2record_2Types_8h_source.html#l00024">Types.h:24</a></div></div>
<div class="ttc" id="ClientProtocol_8cpp_html_abe1b247743d4691ae90a9b12b08cc176"><div class="ttname"><a href="ClientProtocol_8cpp.html#abe1b247743d4691ae90a9b12b08cc176">version</a></div><div class="ttdeci">ProtocolVersion version</div><div class="ttdef"><b>Definition:</b> <a href="ClientProtocol_8cpp_source.html#l01005">ClientProtocol.cpp:1005</a></div></div>
<div class="ttc" id="classfolly_1_1Optional_html"><div class="ttname"><a href="classfolly_1_1Optional.html">folly::Optional</a></div><div class="ttdef"><b>Definition:</b> <a href="Optional_8h_source.html#l00071">Optional.h:71</a></div></div>
<div class="ttc" id="namespacefolly_html_ab192e7aacc86b36de9b85fa7c16c3f5b"><div class="ttname"><a href="namespacefolly.html#ab192e7aacc86b36de9b85fa7c16c3f5b">folly::exchange</a></div><div class="ttdeci">T exchange(T &amp;obj, U &amp;&amp;new_value)</div><div class="ttdef"><b>Definition:</b> <a href="Utility_8h_source.html#l00120">Utility.h:120</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ad2722bea5d78fbf97e0c336dca94412b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static HrrParams fizz::sm::negotiateParameters </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structfizz_1_1HelloRetryRequest.html">HelloRetryRequest</a> &amp;&#160;</td>
          <td class="paramname"><em>hrr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="namespacefizz.html#a3a1cbf7ef22de4d4c5144b3090d7ebc1">ProtocolVersion</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>supportedVersions</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="namespacefizz.html#a23e4ec7baa80cc6f92fdbeadccf0d22e">CipherSuite</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>supportedCiphers</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="namespacefizz.html#a11069edebaa08949c9a6696ef4bb85e2">NamedGroup</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>supportedGroups</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ClientProtocol_8cpp_source.html#l01011">1011</a> of file <a class="el" href="ClientProtocol_8cpp_source.html">ClientProtocol.cpp</a>.</p>

<p>References <a class="el" href="fizz_2fizz_2record_2Types_8h_source.html#l00218">fizz::HelloRetryRequest::extensions</a>, <a class="el" href="ClientProtocol_8cpp_source.html#l00689">getAndValidateVersionAndCipher()</a>, and <a class="el" href="namespacefizz.html#a147eec03bf3a9683f4e214820a1f758aa79db796776246d2c3aaca8b375e662c4">fizz::handshake_failure</a>.</p>

<p>Referenced by <a class="el" href="ClientProtocol_8cpp_source.html#l01036">getHrrKeyExchangers()</a>, and <a class="el" href="ClientProtocol_8cpp_source.html#l00794">negotiatePsk()</a>.</p>
<div class="fragment"><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;                                                  {</div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;  HrrParams negotiated;</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;  std::tie(negotiated.version, negotiated.cipher) =</div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;      <a class="code" href="namespacefizz_1_1sm.html#a4800617fb250b2236b307edd74e971ae">getAndValidateVersionAndCipher</a>(hrr, supportedVersions, supportedCiphers);</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;  <span class="keyword">auto</span> keyShare = getExtension&lt;HelloRetryRequestKeyShare&gt;(hrr.extensions);</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;  <span class="keywordflow">if</span> (keyShare) {</div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;    <span class="keywordflow">if</span> (std::find(</div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;            supportedGroups.begin(),</div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;            supportedGroups.end(),</div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;            keyShare-&gt;selected_group) == supportedGroups.end()) {</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;      <span class="keywordflow">throw</span> FizzException(</div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;          <span class="stringliteral">&quot;server choose unsupported group in hrr&quot;</span>,</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;          AlertDescription::handshake_failure);</div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;    }</div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;    negotiated.group = keyShare-&gt;selected_group;</div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;  }</div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;</div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;  <span class="keywordflow">return</span> negotiated;</div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;}</div><div class="ttc" id="namespacefizz_1_1sm_html_a4800617fb250b2236b307edd74e971ae"><div class="ttname"><a href="namespacefizz_1_1sm.html#a4800617fb250b2236b307edd74e971ae">fizz::sm::getAndValidateVersionAndCipher</a></div><div class="ttdeci">static std::pair&lt; ProtocolVersion, CipherSuite &gt; getAndValidateVersionAndCipher(const ServerMessage &amp;msg, const std::vector&lt; ProtocolVersion &gt; &amp;supportedVersions, const std::vector&lt; CipherSuite &gt; &amp;supportedCiphers)</div><div class="ttdef"><b>Definition:</b> <a href="ClientProtocol_8cpp_source.html#l00689">ClientProtocol.cpp:689</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aeaa892397a583ac5f45f11fac85f35c5"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static NegotiatedPsk fizz::sm::negotiatePsk </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="namespacefizz.html#a1e500492a0a0633f62bf1c3d4acea880">PskKeyExchangeMode</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>supportedPskModes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classfolly_1_1Optional.html">folly::Optional</a>&lt; <a class="el" href="structfizz_1_1client_1_1CachedPsk.html">CachedPsk</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>attemptedPsk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structfizz_1_1ServerHello.html">ServerHello</a> &amp;&#160;</td>
          <td class="paramname"><em>shlo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacefizz.html#a3a1cbf7ef22de4d4c5144b3090d7ebc1">ProtocolVersion</a>&#160;</td>
          <td class="paramname"><em>version</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacefizz.html#a23e4ec7baa80cc6f92fdbeadccf0d22e">CipherSuite</a>&#160;</td>
          <td class="paramname"><em>cipher</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>hasExchange</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ClientProtocol_8cpp_source.html#l00794">794</a> of file <a class="el" href="ClientProtocol_8cpp_source.html">ClientProtocol.cpp</a>.</p>

<p>References <a class="el" href="client_2Actions_8h_source.html#l00086">fizz::client::detail::actions()</a>, <a class="el" href="client_2State_8h_source.html#l00336">fizz::client::State::attemptedPsk()</a>, <a class="el" href="Protocol_8h_source.html#l00050">fizz::Protocol::checkAllowedExtensions()</a>, <a class="el" href="PskCache_8h_source.html#l00026">fizz::client::CachedPsk::cipher</a>, <a class="el" href="ClientProtocol_8cpp_source.html#l01006">cipher</a>, <a class="el" href="PskCache_8h_source.html#l00029">fizz::client::CachedPsk::clientCert</a>, <a class="el" href="ClientProtocol_8cpp_source.html#l00780">clientCert</a>, <a class="el" href="namespacefizz.html#abf02c5b776bf5134e4b766e77362aec3aa9c6951e44d00b50d6aa7c65a9570bf8">fizz::ClientHandshakeTraffic</a>, <a class="el" href="client_2State_8h_source.html#l00070">fizz::client::State::context()</a>, <a class="el" href="IOBuf_8h_source.html#l01587">folly::IOBuf::copyBuffer()</a>, <a class="el" href="client_2State_8h_source.html#l00263">fizz::client::State::encodedClientHello()</a>, <a class="el" href="Utility_8h_source.html#l00120">folly::exchange()</a>, <a class="el" href="fizz_2fizz_2record_2Types_8h_source.html#l00205">fizz::ServerHello::extensions</a>, <a class="el" href="classfizz_1_1KeyExchange.html#a25f6a20504d944b29012d79837c8c5ef">fizz::KeyExchange::generateSharedSecret()</a>, <a class="el" href="FizzClientContext_8h_source.html#l00169">fizz::client::FizzClientContext::getFactory()</a>, <a class="el" href="protocol_2Types_8cpp_source.html#l00013">fizz::getHashFunction()</a>, <a class="el" href="FizzClientContext_8h_source.html#l00043">fizz::client::FizzClientContext::getSupportedCiphers()</a>, <a class="el" href="FizzClientContext_8h_source.html#l00086">fizz::client::FizzClientContext::getSupportedPskModes()</a>, <a class="el" href="FizzClientContext_8h_source.html#l00032">fizz::client::FizzClientContext::getSupportedVersions()</a>, <a class="el" href="ClientProtocol_8cpp_source.html#l01007">group</a>, <a class="el" href="namespacefizz.html#a2d0a99663f1db37e8420c978fd7e8f94a7559811a22a9c4b79332bd85a197e4c5">fizz::Handshake</a>, <a class="el" href="namespacefizz.html#a147eec03bf3a9683f4e214820a1f758aa79db796776246d2c3aaca8b375e662c4">fizz::handshake_failure</a>, <a class="el" href="client_2State_8h_source.html#l00376">fizz::client::State::handshakeContext()</a>, <a class="el" href="RecordLayer_8cpp_source.html#l00151">fizz::ReadRecordLayer::hasUnparsedHandshakeData()</a>, <a class="el" href="Optional_8h_source.html#l00300">folly::Optional&lt; Value &gt;::hasValue()</a>, <a class="el" href="namespacefizz.html#a147eec03bf3a9683f4e214820a1f758aa0bb2e3cfaec11b1cd502d30d896c8b99">fizz::illegal_parameter</a>, <a class="el" href="client_2State_8h_source.html#l00464">fizz::client::State::keyExchangers()</a>, <a class="el" href="client_2State_8h_source.html#l00149">fizz::client::State::keyExchangeType()</a>, <a class="el" href="client_2State_8h_source.html#l00208">fizz::client::State::legacySessionId()</a>, <a class="el" href="Factory_8h_source.html#l00047">fizz::Factory::makeEncryptedReadRecordLayer()</a>, <a class="el" href="Factory_8h_source.html#l00052">fizz::Factory::makeEncryptedWriteRecordLayer()</a>, <a class="el" href="Factory_8h_source.html#l00076">fizz::Factory::makeHandshakeContext()</a>, <a class="el" href="Factory_8h_source.html#l00056">fizz::Factory::makeKeyScheduler()</a>, <a class="el" href="ClientProtocol_8cpp_source.html#l00778">mode</a>, <a class="el" href="Base-inl_8h_source.html#l02567">folly::gen::move</a>, <a class="el" href="ClientProtocol_8cpp_source.html#l01011">negotiateParameters()</a>, <a class="el" href="namespacefizz.html#a7935d663f79e6ee45ba86b8d3b4dad9aa6adf97f83acf6453d4a6a4b1070f3754">fizz::None</a>, <a class="el" href="namespacefizz.html#ab017b61ecd944032c374d31740161131aa65db4b39dd3b01787474dcdb81af5f0">fizz::NotAttempted</a>, <a class="el" href="namespacefizz_1_1client.html#ae43634436661e274189397f450f3683eac534a66e591207038fe31a2a9e0164b7">fizz::client::NotRequested</a>, <a class="el" href="namespacefizz.html#ab017b61ecd944032c374d31740161131a9ed2d871602556951e39f3cebd08d6cb">fizz::NotSupported</a>, <a class="el" href="namespacefizz.html#a7935d663f79e6ee45ba86b8d3b4dad9aae04f1d94c053a439406ce62ba6f0ad41">fizz::OneRtt</a>, <a class="el" href="namespacefizz.html#a1e500492a0a0633f62bf1c3d4acea880a5bb3e4520fae3c9cdf66a9e9fab18d09">fizz::psk_dhe_ke</a>, <a class="el" href="namespacefizz.html#a1e500492a0a0633f62bf1c3d4acea880a92c00e13fa82f0ca393f5b70a6128444">fizz::psk_ke</a>, <a class="el" href="ServerProtocol_8cpp_source.html#l00442">pskMode</a>, <a class="el" href="Range_8h_source.html#l01114">folly::range()</a>, <a class="el" href="client_2State_8h_source.html#l00235">fizz::client::State::readRecordLayer()</a>, <a class="el" href="namespacefizz.html#ab017b61ecd944032c374d31740161131ad37b1f6c0512e2118cee17fea015b699">fizz::Rejected</a>, <a class="el" href="client_2State_8h_source.html#l00273">fizz::client::State::requestedExtensions()</a>, <a class="el" href="FilePoller_8cpp_source.html#l00050">scheduler</a>, <a class="el" href="PskCache_8h_source.html#l00028">fizz::client::CachedPsk::serverCert</a>, <a class="el" href="ClientProtocol_8cpp_source.html#l00779">serverCert</a>, <a class="el" href="namespacefizz.html#abf02c5b776bf5134e4b766e77362aec3aef232f5dac3b8f937342e396b0e102c7">fizz::ServerHandshakeTraffic</a>, <a class="el" href="Protocol_8h_source.html#l00020">fizz::Protocol::setAead()</a>, <a class="el" href="namespacefizz_1_1client.html#ae43634436661e274189397f450f3683ea7bf2d26eab899c413218b729d4d914b7">fizz::client::Stored</a>, <a class="el" href="PskCache_8h_source.html#l00023">fizz::client::CachedPsk::type</a>, <a class="el" href="namespacefizz.html#a147eec03bf3a9683f4e214820a1f758aa597cfdb46675641f694b1f918760d432">fizz::unexpected_message</a>, <a class="el" href="ClientProtocol_8cpp_source.html#l00761">validateNegotiationConsistency()</a>, <a class="el" href="PskCache_8h_source.html#l00025">fizz::client::CachedPsk::version</a>, and <a class="el" href="ClientProtocol_8cpp_source.html#l01005">version</a>.</p>
<div class="fragment"><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;                      {</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;  <span class="keyword">auto</span> serverPsk = getExtension&lt;ServerPresharedKey&gt;(shlo.extensions);</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;  <span class="keywordflow">if</span> (!attemptedPsk) {</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;    <span class="keywordflow">if</span> (serverPsk) {</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;      <span class="keywordflow">throw</span> FizzException(</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;          <span class="stringliteral">&quot;server accepted unattempted psk&quot;</span>,</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;          AlertDescription::illegal_parameter);</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!supportedPskModes.empty()) {</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;      <span class="keywordflow">return</span> NegotiatedPsk(PskType::NotAttempted);</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;      <span class="keywordflow">return</span> NegotiatedPsk(PskType::NotSupported);</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;    }</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;    <span class="keywordflow">if</span> (!serverPsk) {</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;      <span class="keywordflow">return</span> NegotiatedPsk(PskType::Rejected);</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;    }</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;    <span class="keywordflow">if</span> (serverPsk-&gt;selected_identity != 0) {</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;      <span class="keywordflow">throw</span> FizzException(</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;          <span class="stringliteral">&quot;server accepted non-0 psk&quot;</span>, AlertDescription::illegal_parameter);</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;    }</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="ClientProtocol_8cpp.html#abe1b247743d4691ae90a9b12b08cc176">version</a> != attemptedPsk-&gt;<a class="code" href="structfizz_1_1client_1_1CachedPsk.html#a6c1b9e185150a9f7b6f936bae46d99d5">version</a>) {</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;      <span class="keywordflow">throw</span> FizzException(</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;          <span class="stringliteral">&quot;different version in psk&quot;</span>, AlertDescription::handshake_failure);</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;    }</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacefizz.html#a59cb5b362db9a10553246368f7615128">getHashFunction</a>(<a class="code" href="ClientProtocol_8cpp.html#aa7e60e524fbc7254437c13c7d22a9dfa">cipher</a>) != <a class="code" href="namespacefizz.html#a59cb5b362db9a10553246368f7615128">getHashFunction</a>(attemptedPsk-&gt;<a class="code" href="structfizz_1_1client_1_1CachedPsk.html#a55c60a4fa67edda2eb54998c4271eff7">cipher</a>)) {</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;      <span class="keywordflow">throw</span> FizzException(</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;          <span class="stringliteral">&quot;incompatible cipher in psk&quot;</span>, AlertDescription::handshake_failure);</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;    }</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;    <a class="code" href="namespacefizz.html#a1e500492a0a0633f62bf1c3d4acea880">PskKeyExchangeMode</a> <a class="code" href="ClientProtocol_8cpp.html#a2338bdb38c880ef36a2a26fa841e20b5">mode</a> = hasExchange ? PskKeyExchangeMode::psk_dhe_ke</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;                                          : PskKeyExchangeMode::psk_ke;</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;    <span class="keywordflow">if</span> (std::find(supportedPskModes.begin(), supportedPskModes.end(), <a class="code" href="ClientProtocol_8cpp.html#a2338bdb38c880ef36a2a26fa841e20b5">mode</a>) ==</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;        supportedPskModes.end()) {</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;      <span class="keywordflow">throw</span> FizzException(</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;          <span class="stringliteral">&quot;server choose unsupported psk mode&quot;</span>,</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;          AlertDescription::handshake_failure);</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;    }</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;    <span class="keywordflow">return</span> NegotiatedPsk(</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;        attemptedPsk-&gt;<a class="code" href="structfizz_1_1client_1_1CachedPsk.html#a985bf605b72a739c181a6de5ec506d1f">type</a>,</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;        mode,</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;        attemptedPsk-&gt;<a class="code" href="structfizz_1_1client_1_1CachedPsk.html#a96c28b3fd66ae10faba00a1fa07f010e">serverCert</a>,</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;        attemptedPsk-&gt;<a class="code" href="structfizz_1_1client_1_1CachedPsk.html#a7d7b3690317bbf19576582a09e9acf31">clientCert</a>);</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;  }</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;}</div><div class="ttc" id="structfizz_1_1client_1_1CachedPsk_html_a7d7b3690317bbf19576582a09e9acf31"><div class="ttname"><a href="structfizz_1_1client_1_1CachedPsk.html#a7d7b3690317bbf19576582a09e9acf31">fizz::client::CachedPsk::clientCert</a></div><div class="ttdeci">std::shared_ptr&lt; const Cert &gt; clientCert</div><div class="ttdef"><b>Definition:</b> <a href="PskCache_8h_source.html#l00029">PskCache.h:29</a></div></div>
<div class="ttc" id="ClientProtocol_8cpp_html_aa7e60e524fbc7254437c13c7d22a9dfa"><div class="ttname"><a href="ClientProtocol_8cpp.html#aa7e60e524fbc7254437c13c7d22a9dfa">cipher</a></div><div class="ttdeci">CipherSuite cipher</div><div class="ttdef"><b>Definition:</b> <a href="ClientProtocol_8cpp_source.html#l01006">ClientProtocol.cpp:1006</a></div></div>
<div class="ttc" id="structfizz_1_1client_1_1CachedPsk_html_a6c1b9e185150a9f7b6f936bae46d99d5"><div class="ttname"><a href="structfizz_1_1client_1_1CachedPsk.html#a6c1b9e185150a9f7b6f936bae46d99d5">fizz::client::CachedPsk::version</a></div><div class="ttdeci">ProtocolVersion version</div><div class="ttdef"><b>Definition:</b> <a href="PskCache_8h_source.html#l00025">PskCache.h:25</a></div></div>
<div class="ttc" id="ClientProtocol_8cpp_html_a2338bdb38c880ef36a2a26fa841e20b5"><div class="ttname"><a href="ClientProtocol_8cpp.html#a2338bdb38c880ef36a2a26fa841e20b5">mode</a></div><div class="ttdeci">folly::Optional&lt; PskKeyExchangeMode &gt; mode</div><div class="ttdef"><b>Definition:</b> <a href="ClientProtocol_8cpp_source.html#l00778">ClientProtocol.cpp:778</a></div></div>
<div class="ttc" id="namespacefizz_html_a59cb5b362db9a10553246368f7615128"><div class="ttname"><a href="namespacefizz.html#a59cb5b362db9a10553246368f7615128">fizz::getHashFunction</a></div><div class="ttdeci">HashFunction getHashFunction(CipherSuite cipher)</div><div class="ttdef"><b>Definition:</b> <a href="protocol_2Types_8cpp_source.html#l00013">Types.cpp:13</a></div></div>
<div class="ttc" id="ClientProtocol_8cpp_html_abe1b247743d4691ae90a9b12b08cc176"><div class="ttname"><a href="ClientProtocol_8cpp.html#abe1b247743d4691ae90a9b12b08cc176">version</a></div><div class="ttdeci">ProtocolVersion version</div><div class="ttdef"><b>Definition:</b> <a href="ClientProtocol_8cpp_source.html#l01005">ClientProtocol.cpp:1005</a></div></div>
<div class="ttc" id="structfizz_1_1client_1_1CachedPsk_html_a96c28b3fd66ae10faba00a1fa07f010e"><div class="ttname"><a href="structfizz_1_1client_1_1CachedPsk.html#a96c28b3fd66ae10faba00a1fa07f010e">fizz::client::CachedPsk::serverCert</a></div><div class="ttdeci">std::shared_ptr&lt; const Cert &gt; serverCert</div><div class="ttdef"><b>Definition:</b> <a href="PskCache_8h_source.html#l00028">PskCache.h:28</a></div></div>
<div class="ttc" id="structfizz_1_1client_1_1CachedPsk_html_a55c60a4fa67edda2eb54998c4271eff7"><div class="ttname"><a href="structfizz_1_1client_1_1CachedPsk.html#a55c60a4fa67edda2eb54998c4271eff7">fizz::client::CachedPsk::cipher</a></div><div class="ttdeci">CipherSuite cipher</div><div class="ttdef"><b>Definition:</b> <a href="PskCache_8h_source.html#l00026">PskCache.h:26</a></div></div>
<div class="ttc" id="namespacefizz_html_a1e500492a0a0633f62bf1c3d4acea880"><div class="ttname"><a href="namespacefizz.html#a1e500492a0a0633f62bf1c3d4acea880">fizz::PskKeyExchangeMode</a></div><div class="ttdeci">PskKeyExchangeMode</div><div class="ttdef"><b>Definition:</b> <a href="fizz_2fizz_2record_2Types_8h_source.html#l00163">Types.h:163</a></div></div>
<div class="ttc" id="structfizz_1_1client_1_1CachedPsk_html_a985bf605b72a739c181a6de5ec506d1f"><div class="ttname"><a href="structfizz_1_1client_1_1CachedPsk.html#a985bf605b72a739c181a6de5ec506d1f">fizz::client::CachedPsk::type</a></div><div class="ttdeci">PskType type</div><div class="ttdef"><b>Definition:</b> <a href="PskCache_8h_source.html#l00023">PskCache.h:23</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ae1ce9840b6e7d93711ece74877e28dbe"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="classfolly_1_1Optional.html">Optional</a>&lt;<a class="el" href="namespacefizz.html#a3a1cbf7ef22de4d4c5144b3090d7ebc1">ProtocolVersion</a>&gt; fizz::sm::negotiateVersion </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structfizz_1_1ClientHello.html">ClientHello</a> &amp;&#160;</td>
          <td class="paramname"><em>chlo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="namespacefizz.html#a3a1cbf7ef22de4d4c5144b3090d7ebc1">ProtocolVersion</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>versions</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ServerProtocol_8cpp_source.html#l00380">380</a> of file <a class="el" href="ServerProtocol_8cpp_source.html">ServerProtocol.cpp</a>.</p>

<p>References <a class="el" href="fizz_2fizz_2record_2Types_8h_source.html#l00193">fizz::ClientHello::extensions</a>, <a class="el" href="Negotiator_8h_source.html#l00022">fizz::server::negotiate()</a>, <a class="el" href="Optional_8h_source.html#l00087">folly::none</a>, and <a class="el" href="ClientProtocol_8cpp_source.html#l01005">version</a>.</p>

<p>Referenced by <a class="el" href="ServerProtocol_8cpp_source.html#l00953">getCertificateRequest()</a>.</p>
<div class="fragment"><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;                                                {</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span>&amp; clientVersions = getExtension&lt;SupportedVersions&gt;(<a class="code" href="HandshakeTypesTest_8cpp.html#aba518b904616df44c3d7dfde825a4c54">chlo</a>.extensions);</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;  <span class="keywordflow">if</span> (!clientVersions) {</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacefolly.html#ac22c63dbe5af3b0bedb0f21031691537">folly::none</a>;</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;  }</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;  <span class="keyword">auto</span> <a class="code" href="ClientProtocol_8cpp.html#abe1b247743d4691ae90a9b12b08cc176">version</a> = <a class="code" href="namespacefizz_1_1server.html#a8f9dd07383882fd187b1e9e86949fc49">negotiate</a>(versions, clientVersions-&gt;versions);</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="ClientProtocol_8cpp.html#abe1b247743d4691ae90a9b12b08cc176">version</a>) {</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacefolly.html#ac22c63dbe5af3b0bedb0f21031691537">folly::none</a>;</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;  }</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="ClientProtocol_8cpp.html#abe1b247743d4691ae90a9b12b08cc176">version</a>;</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;}</div><div class="ttc" id="HandshakeTypesTest_8cpp_html_aba518b904616df44c3d7dfde825a4c54"><div class="ttname"><a href="HandshakeTypesTest_8cpp.html#aba518b904616df44c3d7dfde825a4c54">chlo</a></div><div class="ttdeci">static const std::string chlo</div><div class="ttdef"><b>Definition:</b> <a href="HandshakeTypesTest_8cpp_source.html#l00023">HandshakeTypesTest.cpp:23</a></div></div>
<div class="ttc" id="namespacefizz_1_1server_html_a8f9dd07383882fd187b1e9e86949fc49"><div class="ttname"><a href="namespacefizz_1_1server.html#a8f9dd07383882fd187b1e9e86949fc49">fizz::server::negotiate</a></div><div class="ttdeci">folly::Optional&lt; T &gt; negotiate(const std::vector&lt; std::vector&lt; T &gt;&gt; &amp;serverPref, const std::vector&lt; T &gt; &amp;clientPref)</div><div class="ttdef"><b>Definition:</b> <a href="Negotiator_8h_source.html#l00022">Negotiator.h:22</a></div></div>
<div class="ttc" id="ClientProtocol_8cpp_html_abe1b247743d4691ae90a9b12b08cc176"><div class="ttname"><a href="ClientProtocol_8cpp.html#abe1b247743d4691ae90a9b12b08cc176">version</a></div><div class="ttdeci">ProtocolVersion version</div><div class="ttdef"><b>Definition:</b> <a href="ClientProtocol_8cpp_source.html#l01005">ClientProtocol.cpp:1005</a></div></div>
<div class="ttc" id="namespacefolly_html_ac22c63dbe5af3b0bedb0f21031691537"><div class="ttname"><a href="namespacefolly.html#ac22c63dbe5af3b0bedb0f21031691537">folly::none</a></div><div class="ttdeci">constexpr None none</div><div class="ttdef"><b>Definition:</b> <a href="Optional_8h_source.html#l00087">Optional.h:87</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aa59e947e9834b14d1ba7100c475c307e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static std:: <a class="el" href="structpair.html">pair</a>&lt;std::unique_ptr&lt;<a class="el" href="classfizz_1_1KeyScheduler.html">KeyScheduler</a>&gt;, std::unique_ptr&lt;<a class="el" href="classfizz_1_1HandshakeContext.html">HandshakeContext</a>&gt; &gt; fizz::sm::setupSchedulerAndContext </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classfizz_1_1Factory.html">Factory</a> &amp;&#160;</td>
          <td class="paramname"><em>factory</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacefizz.html#a23e4ec7baa80cc6f92fdbeadccf0d22e">CipherSuite</a>&#160;</td>
          <td class="paramname"><em>cipher</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structfizz_1_1ClientHello.html">ClientHello</a> &amp;&#160;</td>
          <td class="paramname"><em>chlo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classfolly_1_1Optional.html">Optional</a>&lt; <a class="el" href="structfizz_1_1server_1_1ResumptionState.html">ResumptionState</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>resState</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classfolly_1_1Optional.html">Optional</a>&lt; <a class="el" href="structfizz_1_1server_1_1CookieState.html">CookieState</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>cookieState</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacefizz.html#ab017b61ecd944032c374d31740161131">PskType</a>&#160;</td>
          <td class="paramname"><em>pskType</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::unique_ptr&lt; <a class="el" href="classfizz_1_1HandshakeContext.html">HandshakeContext</a> &gt;&#160;</td>
          <td class="paramname"><em>handshakeContext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacefizz.html#a3a1cbf7ef22de4d4c5144b3090d7ebc1">ProtocolVersion</a>&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ServerProtocol_8cpp_source.html#l00536">536</a> of file <a class="el" href="ServerProtocol_8cpp_source.html">ServerProtocol.cpp</a>.</p>

<p>References <a class="el" href="IOBufQueue_8cpp_source.html#l00143">folly::IOBufQueue::append()</a>, <a class="el" href="namespacefizz.html#a147eec03bf3a9683f4e214820a1f758aa8fd1a30f4f67f92962d89771ec9d47af">fizz::bad_record_mac</a>, <a class="el" href="IOBufQueue_8h_source.html#l00083">folly::IOBufQueue::cacheChainLength()</a>, <a class="el" href="IOBufQueue_8h_source.html#l00492">folly::IOBufQueue::chainLength()</a>, <a class="el" href="CookieCipher_8h_source.html#l00022">fizz::server::CookieState::chloHash</a>, <a class="el" href="CookieCipher_8h_source.html#l00019">fizz::server::CookieState::cipher</a>, <a class="el" href="ExtensionsTest_8cpp_source.html#l00028">cookie</a>, <a class="el" href="Types-inl_8h_source.html#l00515">fizz::encodeHandshake()</a>, <a class="el" href="Utils_8cpp_source.html#l00031">fizz::CryptoUtils::equal()</a>, <a class="el" href="fizz_2fizz_2record_2Types_8h_source.html#l00193">fizz::ClientHello::extensions</a>, <a class="el" href="namespacefizz.html#ab017b61ecd944032c374d31740161131ab206a1b4ea1097761f78e8876f6da779">fizz::External</a>, <a class="el" href="namespacefizz.html#a9d0163dd2203bcf4649a864a2bde8343af4382706ea7c944a59d51f78de085266">fizz::ExternalPskBinder</a>, <a class="el" href="Extensions-inl_8h_source.html#l00354">fizz::getBinderLength()</a>, <a class="el" href="CookieCipher_8cpp_source.html#l00018">fizz::server::getStatelessHelloRetryRequest()</a>, <a class="el" href="CookieCipher_8h_source.html#l00020">fizz::server::CookieState::group</a>, <a class="el" href="fizz_2fizz_2record_2Types_8h_source.html#l00082">fizz::message_hash::hash</a>, <a class="el" href="namespacefizz.html#a147eec03bf3a9683f4e214820a1f758aa0bb2e3cfaec11b1cd502d30d896c8b99">fizz::illegal_parameter</a>, <a class="el" href="ServerProtocol_8cpp_source.html#l00030">kPskIndex</a>, <a class="el" href="Factory_8h_source.html#l00076">fizz::Factory::makeHandshakeContext()</a>, <a class="el" href="Factory_8h_source.html#l00056">fizz::Factory::makeKeyScheduler()</a>, <a class="el" href="IOBufQueue_8h_source.html#l00459">folly::IOBufQueue::move()</a>, <a class="el" href="Base-inl_8h_source.html#l02567">folly::gen::move</a>, <a class="el" href="fizz_2fizz_2record_2Types_8h_source.html#l00092">fizz::HandshakeStruct&lt; e, t &gt;::originalEncoding</a>, <a class="el" href="Range_8h_source.html#l01114">folly::range()</a>, <a class="el" href="namespacefizz.html#a9d0163dd2203bcf4649a864a2bde8343a34513d7b3f018af52652c52974627e63">fizz::ResumptionPskBinder</a>, <a class="el" href="ResumptionState_8h_source.html#l00022">fizz::server::ResumptionState::resumptionSecret</a>, <a class="el" href="FilePoller_8cpp_source.html#l00050">scheduler</a>, <a class="el" href="IOBufQueue_8h_source.html#l00420">folly::IOBufQueue::split()</a>, and <a class="el" href="CookieCipher_8h_source.html#l00018">fizz::server::CookieState::version</a>.</p>

<p>Referenced by <a class="el" href="ServerProtocol_8cpp_source.html#l00953">getCertificateRequest()</a>.</p>
<div class="fragment"><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;                           {</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;  <span class="keyword">auto</span> <a class="code" href="FilePoller_8cpp.html#af8aa2314425a86a160127ccd900704f8">scheduler</a> = factory.makeKeyScheduler(<a class="code" href="ClientProtocol_8cpp.html#aa7e60e524fbc7254437c13c7d22a9dfa">cipher</a>);</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;  <span class="keywordflow">if</span> (cookieState) {</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    <span class="keywordflow">if</span> (handshakeContext) {</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;      <span class="keywordflow">throw</span> FizzException(</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;          <span class="stringliteral">&quot;cookie after statefull hrr&quot;</span>, AlertDescription::illegal_parameter);</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;    }</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    handshakeContext = factory.makeHandshakeContext(<a class="code" href="ClientProtocol_8cpp.html#aa7e60e524fbc7254437c13c7d22a9dfa">cipher</a>);</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    <a class="code" href="namespacefizz.html#a5ab3664effa8057a21f4da0194485acdaffc3e2e829ba6973450e8abad9499764">message_hash</a> chloHash;</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;    chloHash.hash = cookieState-&gt;<a class="code" href="structfizz_1_1server_1_1CookieState.html#a6d390bcf7c41762ffe9e8cdcf4cae995">chloHash</a>-&gt;clone();</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    handshakeContext-&gt;appendToTranscript(<a class="code" href="namespacefizz.html#a1fef0ecdfd4a6c07fd32b5dd0dcb2b23">encodeHandshake</a>(<a class="code" href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">std::move</a>(chloHash)));</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    <span class="keyword">auto</span> <a class="code" href="ExtensionsTest_8cpp.html#a47e68f25943ee47d7594c89d78fad4a6">cookie</a> = getExtension&lt;Cookie&gt;(<a class="code" href="HandshakeTypesTest_8cpp.html#aba518b904616df44c3d7dfde825a4c54">chlo</a>.extensions);</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    handshakeContext-&gt;appendToTranscript(<a class="code" href="namespacefizz_1_1server.html#a24939c7c0379ab233cb67f147cb617b6">getStatelessHelloRetryRequest</a>(</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;        cookieState-&gt;<a class="code" href="structfizz_1_1server_1_1CookieState.html#a242036a47957669401a608480ff83b18">version</a>,</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;        cookieState-&gt;<a class="code" href="structfizz_1_1server_1_1CookieState.html#a82290aacd66622815dca9f18f09516f0">cipher</a>,</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;        cookieState-&gt;<a class="code" href="structfizz_1_1server_1_1CookieState.html#aa55ee77436ce3c8342ffd3dc110dc74d">group</a>,</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;        <a class="code" href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">std::move</a>(<a class="code" href="ExtensionsTest_8cpp.html#a47e68f25943ee47d7594c89d78fad4a6">cookie</a>-&gt;cookie)));</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!handshakeContext) {</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    handshakeContext = factory.makeHandshakeContext(<a class="code" href="ClientProtocol_8cpp.html#aa7e60e524fbc7254437c13c7d22a9dfa">cipher</a>);</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;  }</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;  <span class="keywordflow">if</span> (resState) {</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    <a class="code" href="FilePoller_8cpp.html#af8aa2314425a86a160127ccd900704f8">scheduler</a>-&gt;deriveEarlySecret(resState-&gt;<a class="code" href="structfizz_1_1server_1_1ResumptionState.html#a04fb81b5278300c380db11d8fa660963">resumptionSecret</a>-&gt;coalesce());</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;    <span class="keyword">auto</span> binderKey = <a class="code" href="FilePoller_8cpp.html#af8aa2314425a86a160127ccd900704f8">scheduler</a>-&gt;getSecret(</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;        pskType == PskType::External ? EarlySecrets::ExternalPskBinder</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;                                     : EarlySecrets::ResumptionPskBinder,</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;        handshakeContext-&gt;getBlankContext());</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;    <a class="code" href="classfolly_1_1IOBufQueue.html">folly::IOBufQueue</a> chloQueue(<a class="code" href="classfolly_1_1IOBufQueue.html#a5c33b90ce5e034f00043394564f295da">folly::IOBufQueue::cacheChainLength</a>());</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    chloQueue.append((*<a class="code" href="HandshakeTypesTest_8cpp.html#aba518b904616df44c3d7dfde825a4c54">chlo</a>.originalEncoding)-&gt;clone());</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    <span class="keyword">auto</span> chloPrefix =</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;        chloQueue.split(chloQueue.chainLength() - <a class="code" href="namespacefizz.html#aebe96b30473a27e492b63cb870a9695d">getBinderLength</a>(<a class="code" href="HandshakeTypesTest_8cpp.html#aba518b904616df44c3d7dfde825a4c54">chlo</a>));</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;    handshakeContext-&gt;appendToTranscript(chloPrefix);</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; psks = getExtension&lt;ClientPresharedKey&gt;(<a class="code" href="HandshakeTypesTest_8cpp.html#aba518b904616df44c3d7dfde825a4c54">chlo</a>.extensions);</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;    <span class="keywordflow">if</span> (!psks || psks-&gt;binders.size() &lt;= <a class="code" href="ServerProtocol_8cpp.html#a8424c6daed1be1dfdd8665333379ee23">kPskIndex</a>) {</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;      <span class="keywordflow">throw</span> FizzException(<span class="stringliteral">&quot;no binders&quot;</span>, AlertDescription::illegal_parameter);</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;    }</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    <span class="keyword">auto</span> expectedBinder =</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;        handshakeContext-&gt;getFinishedData(<a class="code" href="namespacefolly.html#a79a54cd1a19a22878c86be5f90a33643">folly::range</a>(binderKey));</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;    <span class="keywordflow">if</span> (!CryptoUtils::equal(</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;            expectedBinder-&gt;coalesce(),</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;            psks-&gt;binders[<a class="code" href="ServerProtocol_8cpp.html#a8424c6daed1be1dfdd8665333379ee23">kPskIndex</a>].binder-&gt;coalesce())) {</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;      <span class="keywordflow">throw</span> FizzException(</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;          <span class="stringliteral">&quot;binder does not match&quot;</span>, AlertDescription::bad_record_mac);</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;    }</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;    handshakeContext-&gt;appendToTranscript(chloQueue.move());</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    <span class="keywordflow">return</span> std::make_pair(<a class="code" href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">std::move</a>(<a class="code" href="FilePoller_8cpp.html#af8aa2314425a86a160127ccd900704f8">scheduler</a>), <a class="code" href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">std::move</a>(handshakeContext));</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;    handshakeContext-&gt;appendToTranscript(*<a class="code" href="HandshakeTypesTest_8cpp.html#aba518b904616df44c3d7dfde825a4c54">chlo</a>.originalEncoding);</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;    <span class="keywordflow">return</span> std::make_pair(<a class="code" href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">std::move</a>(<a class="code" href="FilePoller_8cpp.html#af8aa2314425a86a160127ccd900704f8">scheduler</a>), <a class="code" href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">std::move</a>(handshakeContext));</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;  }</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;}</div><div class="ttc" id="namespacefizz_1_1server_html_a24939c7c0379ab233cb67f147cb617b6"><div class="ttname"><a href="namespacefizz_1_1server.html#a24939c7c0379ab233cb67f147cb617b6">fizz::server::getStatelessHelloRetryRequest</a></div><div class="ttdeci">Buf getStatelessHelloRetryRequest(ProtocolVersion version, CipherSuite cipher, folly::Optional&lt; NamedGroup &gt; group, Buf cookie)</div><div class="ttdef"><b>Definition:</b> <a href="CookieCipher_8cpp_source.html#l00018">CookieCipher.cpp:18</a></div></div>
<div class="ttc" id="namespacefizz_html_a1fef0ecdfd4a6c07fd32b5dd0dcb2b23"><div class="ttname"><a href="namespacefizz.html#a1fef0ecdfd4a6c07fd32b5dd0dcb2b23">fizz::encodeHandshake</a></div><div class="ttdeci">Buf encodeHandshake(T &amp;&amp;handshakeMsg)</div><div class="ttdef"><b>Definition:</b> <a href="Types-inl_8h_source.html#l00515">Types-inl.h:515</a></div></div>
<div class="ttc" id="namespacefizz_html_aebe96b30473a27e492b63cb870a9695d"><div class="ttname"><a href="namespacefizz.html#aebe96b30473a27e492b63cb870a9695d">fizz::getBinderLength</a></div><div class="ttdeci">size_t getBinderLength(const ClientHello &amp;chlo)</div><div class="ttdef"><b>Definition:</b> <a href="Extensions-inl_8h_source.html#l00354">Extensions-inl.h:354</a></div></div>
<div class="ttc" id="HandshakeTypesTest_8cpp_html_aba518b904616df44c3d7dfde825a4c54"><div class="ttname"><a href="HandshakeTypesTest_8cpp.html#aba518b904616df44c3d7dfde825a4c54">chlo</a></div><div class="ttdeci">static const std::string chlo</div><div class="ttdef"><b>Definition:</b> <a href="HandshakeTypesTest_8cpp_source.html#l00023">HandshakeTypesTest.cpp:23</a></div></div>
<div class="ttc" id="ExtensionsTest_8cpp_html_a47e68f25943ee47d7594c89d78fad4a6"><div class="ttname"><a href="ExtensionsTest_8cpp.html#a47e68f25943ee47d7594c89d78fad4a6">cookie</a></div><div class="ttdeci">StringPiece cookie</div><div class="ttdef"><b>Definition:</b> <a href="ExtensionsTest_8cpp_source.html#l00028">ExtensionsTest.cpp:28</a></div></div>
<div class="ttc" id="namespacefolly_1_1gen_html_ac24ec252b1b738a40c274285527c193f"><div class="ttname"><a href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">folly::gen::move</a></div><div class="ttdeci">constexpr detail::Map&lt; Move &gt; move</div><div class="ttdef"><b>Definition:</b> <a href="Base-inl_8h_source.html#l02567">Base-inl.h:2567</a></div></div>
<div class="ttc" id="FilePoller_8cpp_html_af8aa2314425a86a160127ccd900704f8"><div class="ttname"><a href="FilePoller_8cpp.html#af8aa2314425a86a160127ccd900704f8">scheduler</a></div><div class="ttdeci">std::shared_ptr&lt; folly::FunctionScheduler &gt; scheduler</div><div class="ttdef"><b>Definition:</b> <a href="FilePoller_8cpp_source.html#l00050">FilePoller.cpp:50</a></div></div>
<div class="ttc" id="ServerProtocol_8cpp_html_a8424c6daed1be1dfdd8665333379ee23"><div class="ttname"><a href="ServerProtocol_8cpp.html#a8424c6daed1be1dfdd8665333379ee23">kPskIndex</a></div><div class="ttdeci">static constexpr uint16_t kPskIndex</div><div class="ttdef"><b>Definition:</b> <a href="ServerProtocol_8cpp_source.html#l00030">ServerProtocol.cpp:30</a></div></div>
<div class="ttc" id="ClientProtocol_8cpp_html_aa7e60e524fbc7254437c13c7d22a9dfa"><div class="ttname"><a href="ClientProtocol_8cpp.html#aa7e60e524fbc7254437c13c7d22a9dfa">cipher</a></div><div class="ttdeci">CipherSuite cipher</div><div class="ttdef"><b>Definition:</b> <a href="ClientProtocol_8cpp_source.html#l01006">ClientProtocol.cpp:1006</a></div></div>
<div class="ttc" id="structfizz_1_1server_1_1ResumptionState_html_a04fb81b5278300c380db11d8fa660963"><div class="ttname"><a href="structfizz_1_1server_1_1ResumptionState.html#a04fb81b5278300c380db11d8fa660963">fizz::server::ResumptionState::resumptionSecret</a></div><div class="ttdeci">Buf resumptionSecret</div><div class="ttdef"><b>Definition:</b> <a href="ResumptionState_8h_source.html#l00022">ResumptionState.h:22</a></div></div>
<div class="ttc" id="classfolly_1_1IOBufQueue_html_a5c33b90ce5e034f00043394564f295da"><div class="ttname"><a href="classfolly_1_1IOBufQueue.html#a5c33b90ce5e034f00043394564f295da">folly::IOBufQueue::cacheChainLength</a></div><div class="ttdeci">static Options cacheChainLength()</div><div class="ttdef"><b>Definition:</b> <a href="IOBufQueue_8h_source.html#l00083">IOBufQueue.h:83</a></div></div>
<div class="ttc" id="namespacefolly_html_a79a54cd1a19a22878c86be5f90a33643"><div class="ttname"><a href="namespacefolly.html#a79a54cd1a19a22878c86be5f90a33643">folly::range</a></div><div class="ttdeci">constexpr Range&lt; Iter &gt; range(Iter first, Iter last)</div><div class="ttdef"><b>Definition:</b> <a href="Range_8h_source.html#l01114">Range.h:1114</a></div></div>
<div class="ttc" id="classfolly_1_1IOBufQueue_html"><div class="ttname"><a href="classfolly_1_1IOBufQueue.html">folly::IOBufQueue</a></div><div class="ttdef"><b>Definition:</b> <a href="IOBufQueue_8h_source.html#l00035">IOBufQueue.h:35</a></div></div>
<div class="ttc" id="structfizz_1_1server_1_1CookieState_html_a6d390bcf7c41762ffe9e8cdcf4cae995"><div class="ttname"><a href="structfizz_1_1server_1_1CookieState.html#a6d390bcf7c41762ffe9e8cdcf4cae995">fizz::server::CookieState::chloHash</a></div><div class="ttdeci">Buf chloHash</div><div class="ttdef"><b>Definition:</b> <a href="CookieCipher_8h_source.html#l00022">CookieCipher.h:22</a></div></div>
<div class="ttc" id="structfizz_1_1server_1_1CookieState_html_a242036a47957669401a608480ff83b18"><div class="ttname"><a href="structfizz_1_1server_1_1CookieState.html#a242036a47957669401a608480ff83b18">fizz::server::CookieState::version</a></div><div class="ttdeci">ProtocolVersion version</div><div class="ttdef"><b>Definition:</b> <a href="CookieCipher_8h_source.html#l00018">CookieCipher.h:18</a></div></div>
<div class="ttc" id="structfizz_1_1server_1_1CookieState_html_aa55ee77436ce3c8342ffd3dc110dc74d"><div class="ttname"><a href="structfizz_1_1server_1_1CookieState.html#aa55ee77436ce3c8342ffd3dc110dc74d">fizz::server::CookieState::group</a></div><div class="ttdeci">folly::Optional&lt; NamedGroup &gt; group</div><div class="ttdef"><b>Definition:</b> <a href="CookieCipher_8h_source.html#l00020">CookieCipher.h:20</a></div></div>
<div class="ttc" id="structfizz_1_1server_1_1CookieState_html_a82290aacd66622815dca9f18f09516f0"><div class="ttname"><a href="structfizz_1_1server_1_1CookieState.html#a82290aacd66622815dca9f18f09516f0">fizz::server::CookieState::cipher</a></div><div class="ttdeci">CipherSuite cipher</div><div class="ttdef"><b>Definition:</b> <a href="CookieCipher_8h_source.html#l00019">CookieCipher.h:19</a></div></div>
<div class="ttc" id="namespacefizz_html_a5ab3664effa8057a21f4da0194485acdaffc3e2e829ba6973450e8abad9499764"><div class="ttname"><a href="namespacefizz.html#a5ab3664effa8057a21f4da0194485acdaffc3e2e829ba6973450e8abad9499764">fizz::HandshakeType::message_hash</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aaf0120204069cbc65af5c150e792c7f0"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void fizz::sm::validateAcceptedEarly </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classfizz_1_1client_1_1State.html">State</a> &amp;&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classfolly_1_1Optional.html">Optional</a>&lt; <a class="el" href="Conv_8cpp.html#ae1adbce218e7a9d09164012443191d24">std::string</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>alpn</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ClientProtocol_8cpp_source.html#l01179">1179</a> of file <a class="el" href="ClientProtocol_8cpp_source.html">ClientProtocol.cpp</a>.</p>

<p>References <a class="el" href="namespacefizz.html#a02f9d49d996b83310b2a38e93684c959a382ab522931673c11e398ead1b7b1678">fizz::Accepted</a>, <a class="el" href="client_2Actions_8h_source.html#l00086">fizz::client::detail::actions()</a>, <a class="el" href="ExtensionsTest_8cpp_source.html#l00022">alpn</a>, <a class="el" href="namespacefizz.html#a02f9d49d996b83310b2a38e93684c959ac52c6eeafe7207599f51d08a22226ca8">fizz::Attempted</a>, <a class="el" href="client_2State_8h_source.html#l00336">fizz::client::State::attemptedPsk()</a>, <a class="el" href="Protocol_8h_source.html#l00050">fizz::Protocol::checkAllowedExtensions()</a>, <a class="el" href="client_2State_8h_source.html#l00113">fizz::client::State::cipher()</a>, <a class="el" href="client_2State_8h_source.html#l00070">fizz::client::State::context()</a>, <a class="el" href="client_2State_8h_source.html#l00163">fizz::client::State::earlyDataParams()</a>, <a class="el" href="client_2State_8h_source.html#l00156">fizz::client::State::earlyDataType()</a>, <a class="el" href="client_2State_8h_source.html#l00254">fizz::client::State::earlyWriteRecordLayer()</a>, <a class="el" href="namespacefizz.html#a1135430496a56ed55bdfc4a77ccb35fbaf36aecb2d027d9ed8fc384235422899f">fizz::EncryptedExtensions</a>, <a class="el" href="namespacefizz_1_1client.html#a591ea099fd6d034227ea51623074beefa1a4abde81c2d1d60784c8f0ab634cd1a">fizz::client::ExpectingEncryptedExtensions</a>, <a class="el" href="client_2State_8h_source.html#l00344">fizz::client::State::extensions()</a>, <a class="el" href="FizzClientContext_8h_source.html#l00097">fizz::client::FizzClientContext::getSupportedAlpns()</a>, <a class="el" href="client_2State_8h_source.html#l00376">fizz::client::State::handshakeContext()</a>, <a class="el" href="namespacefizz.html#a147eec03bf3a9683f4e214820a1f758aa0bb2e3cfaec11b1cd502d30d896c8b99">fizz::illegal_parameter</a>, <a class="el" href="Base-inl_8h_source.html#l02567">folly::gen::move</a>, <a class="el" href="Optional_8h_source.html#l00087">folly::none</a>, <a class="el" href="classfizz_1_1ClientExtensions.html#a7aeafedce4891e4963a853c2f9c8bf1b">fizz::ClientExtensions::onEncryptedExtensions()</a>, <a class="el" href="FlatCombiningTest_8cpp_source.html#l00094">params</a>, <a class="el" href="client_2State_8h_source.html#l00135">fizz::client::State::pskType()</a>, <a class="el" href="namespacefizz.html#ab017b61ecd944032c374d31740161131ad37b1f6c0512e2118cee17fea015b699">fizz::Rejected</a>, <a class="el" href="client_2State_8h_source.html#l00273">fizz::client::State::requestedExtensions()</a>, and <a class="el" href="client_2State_8h_source.html#l00077">fizz::client::State::serverCert()</a>.</p>
<div class="fragment"><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;                                     {</div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span>&amp; <a class="code" href="FlatCombiningTest_8cpp.html#a36eef2a02e164255f9d34e465f82e0ef">params</a> = state.<a class="code" href="classfizz_1_1client_1_1State.html#af90526b217a0e49b68adb2f5df83cd2e">earlyDataParams</a>();</div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;</div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;  <span class="keywordflow">if</span> (!state.<a class="code" href="classfizz_1_1client_1_1State.html#a39ea8f52cfd6e9185a50a0f78d7c11d9">attemptedPsk</a>() || state.<a class="code" href="classfizz_1_1client_1_1State.html#ac3228691ffeb81b23f26f6a524d00f3e">pskType</a>() == PskType::Rejected ||</div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;      !<a class="code" href="FlatCombiningTest_8cpp.html#a36eef2a02e164255f9d34e465f82e0ef">params</a>) {</div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;    <span class="keywordflow">throw</span> FizzException(</div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;        <span class="stringliteral">&quot;early accepted without psk&quot;</span>, AlertDescription::illegal_parameter);</div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;  }</div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;</div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="FlatCombiningTest_8cpp.html#a36eef2a02e164255f9d34e465f82e0ef">params</a>-&gt;cipher != state.<a class="code" href="classfizz_1_1client_1_1State.html#a0436d6ac09e1a5ef3ffd61ef9a205d21">cipher</a>()) {</div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;    <span class="keywordflow">throw</span> FizzException(</div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;        <span class="stringliteral">&quot;early accepted with different cipher&quot;</span>,</div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;        AlertDescription::illegal_parameter);</div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;  }</div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;</div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="FlatCombiningTest_8cpp.html#a36eef2a02e164255f9d34e465f82e0ef">params</a>-&gt;alpn != alpn) {</div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;    <span class="keywordflow">throw</span> FizzException(</div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;        <span class="stringliteral">&quot;early accepted with different alpn&quot;</span>,</div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;        AlertDescription::illegal_parameter);</div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;  }</div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;</div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;  <span class="keywordflow">if</span> (!state.<a class="code" href="classfizz_1_1client_1_1State.html#a196ddcdf47fe65c8b79db938bc1dd949">earlyWriteRecordLayer</a>()) {</div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;    <span class="keywordflow">throw</span> FizzException(</div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;        <span class="stringliteral">&quot;no early record layer&quot;</span>, AlertDescription::illegal_parameter);</div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;  }</div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;}</div><div class="ttc" id="classfizz_1_1client_1_1State_html_a0436d6ac09e1a5ef3ffd61ef9a205d21"><div class="ttname"><a href="classfizz_1_1client_1_1State.html#a0436d6ac09e1a5ef3ffd61ef9a205d21">fizz::client::State::cipher</a></div><div class="ttdeci">folly::Optional&lt; CipherSuite &gt; cipher() const </div><div class="ttdef"><b>Definition:</b> <a href="client_2State_8h_source.html#l00113">State.h:113</a></div></div>
<div class="ttc" id="FlatCombiningTest_8cpp_html_a36eef2a02e164255f9d34e465f82e0ef"><div class="ttname"><a href="FlatCombiningTest_8cpp.html#a36eef2a02e164255f9d34e465f82e0ef">params</a></div><div class="ttdeci">constexpr Params params[]</div><div class="ttdef"><b>Definition:</b> <a href="FlatCombiningTest_8cpp_source.html#l00094">FlatCombiningTest.cpp:94</a></div></div>
<div class="ttc" id="classfizz_1_1client_1_1State_html_af90526b217a0e49b68adb2f5df83cd2e"><div class="ttname"><a href="classfizz_1_1client_1_1State.html#af90526b217a0e49b68adb2f5df83cd2e">fizz::client::State::earlyDataParams</a></div><div class="ttdeci">const folly::Optional&lt; EarlyDataParams &gt; &amp; earlyDataParams() const </div><div class="ttdef"><b>Definition:</b> <a href="client_2State_8h_source.html#l00163">State.h:163</a></div></div>
<div class="ttc" id="classfizz_1_1client_1_1State_html_ac3228691ffeb81b23f26f6a524d00f3e"><div class="ttname"><a href="classfizz_1_1client_1_1State.html#ac3228691ffeb81b23f26f6a524d00f3e">fizz::client::State::pskType</a></div><div class="ttdeci">folly::Optional&lt; PskType &gt; pskType() const </div><div class="ttdef"><b>Definition:</b> <a href="client_2State_8h_source.html#l00135">State.h:135</a></div></div>
<div class="ttc" id="classfizz_1_1client_1_1State_html_a196ddcdf47fe65c8b79db938bc1dd949"><div class="ttname"><a href="classfizz_1_1client_1_1State.html#a196ddcdf47fe65c8b79db938bc1dd949">fizz::client::State::earlyWriteRecordLayer</a></div><div class="ttdeci">const WriteRecordLayer * earlyWriteRecordLayer() const </div><div class="ttdef"><b>Definition:</b> <a href="client_2State_8h_source.html#l00254">State.h:254</a></div></div>
<div class="ttc" id="classfizz_1_1client_1_1State_html_a39ea8f52cfd6e9185a50a0f78d7c11d9"><div class="ttname"><a href="classfizz_1_1client_1_1State.html#a39ea8f52cfd6e9185a50a0f78d7c11d9">fizz::client::State::attemptedPsk</a></div><div class="ttdeci">const folly::Optional&lt; CachedPsk &gt; &amp; attemptedPsk() const </div><div class="ttdef"><b>Definition:</b> <a href="client_2State_8h_source.html#l00336">State.h:336</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a13d2556838d260066a8ff5c2a12da30a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void fizz::sm::validateClientHello </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structfizz_1_1ClientHello.html">ClientHello</a> &amp;&#160;</td>
          <td class="paramname"><em>chlo</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ServerProtocol_8cpp_source.html#l00370">370</a> of file <a class="el" href="ServerProtocol_8cpp_source.html">ServerProtocol.cpp</a>.</p>

<p>References <a class="el" href="Protocol_8h_source.html#l00117">fizz::Protocol::checkDuplicateExtensions()</a>, <a class="el" href="fizz_2fizz_2record_2Types_8h_source.html#l00193">fizz::ClientHello::extensions</a>, <a class="el" href="namespacefizz.html#a147eec03bf3a9683f4e214820a1f758aa0bb2e3cfaec11b1cd502d30d896c8b99">fizz::illegal_parameter</a>, and <a class="el" href="fizz_2fizz_2record_2Types_8h_source.html#l00192">fizz::ClientHello::legacy_compression_methods</a>.</p>

<p>Referenced by <a class="el" href="ServerProtocol_8cpp_source.html#l00953">getCertificateRequest()</a>.</p>
<div class="fragment"><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;                                                         {</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="HandshakeTypesTest_8cpp.html#aba518b904616df44c3d7dfde825a4c54">chlo</a>.legacy_compression_methods.size() != 1 ||</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;      <a class="code" href="HandshakeTypesTest_8cpp.html#aba518b904616df44c3d7dfde825a4c54">chlo</a>.legacy_compression_methods.front() != 0x00) {</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    <span class="keywordflow">throw</span> FizzException(</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;        <span class="stringliteral">&quot;client compression methods not exactly NULL&quot;</span>,</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;        AlertDescription::illegal_parameter);</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;  }</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;  Protocol::checkDuplicateExtensions(<a class="code" href="HandshakeTypesTest_8cpp.html#aba518b904616df44c3d7dfde825a4c54">chlo</a>.extensions);</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;}</div><div class="ttc" id="HandshakeTypesTest_8cpp_html_aba518b904616df44c3d7dfde825a4c54"><div class="ttname"><a href="HandshakeTypesTest_8cpp.html#aba518b904616df44c3d7dfde825a4c54">chlo</a></div><div class="ttdeci">static const std::string chlo</div><div class="ttdef"><b>Definition:</b> <a href="HandshakeTypesTest_8cpp_source.html#l00023">HandshakeTypesTest.cpp:23</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a44ac44fa0698a8dc734362655b93098b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void fizz::sm::validateGroups </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="structfizz_1_1KeyShareEntry.html">KeyShareEntry</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>client_shares</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ServerProtocol_8cpp_source.html#l00604">604</a> of file <a class="el" href="ServerProtocol_8cpp_source.html">ServerProtocol.cpp</a>.</p>

<p>References <a class="el" href="namespacefizz.html#a147eec03bf3a9683f4e214820a1f758aa0bb2e3cfaec11b1cd502d30d896c8b99">fizz::illegal_parameter</a>, and <a class="el" href="share_8h_source.html#l00053">folly::pushmi::operators::share</a>.</p>

<p>Referenced by <a class="el" href="ServerProtocol_8cpp_source.html#l00617">negotiateGroup()</a>.</p>
<div class="fragment"><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;                                                                          {</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;  std::set&lt;NamedGroup&gt; setOfNamedGroups;</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; <a class="code" href="namespacefolly_1_1pushmi_1_1operators.html#a3579d804a0ba5b8e323f96858f94c4e6">share</a> : client_shares) {</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;    <span class="keywordflow">if</span> (setOfNamedGroups.find(<a class="code" href="namespacefolly_1_1pushmi_1_1operators.html#a3579d804a0ba5b8e323f96858f94c4e6">share</a>.group) != setOfNamedGroups.end()) {</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;      <span class="keywordflow">throw</span> FizzException(</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;          <span class="stringliteral">&quot;duplicate client key share&quot;</span>, AlertDescription::illegal_parameter);</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;    }</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;    setOfNamedGroups.insert(<a class="code" href="namespacefolly_1_1pushmi_1_1operators.html#a3579d804a0ba5b8e323f96858f94c4e6">share</a>.group);</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;  }</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;}</div><div class="ttc" id="namespacefolly_1_1pushmi_1_1operators_html_a3579d804a0ba5b8e323f96858f94c4e6"><div class="ttname"><a href="namespacefolly_1_1pushmi_1_1operators.html#a3579d804a0ba5b8e323f96858f94c4e6">folly::pushmi::operators::share</a></div><div class="ttdeci">PUSHMI_INLINE_VAR constexpr detail::share_fn&lt; TN... &gt; share</div><div class="ttdef"><b>Definition:</b> <a href="share_8h_source.html#l00053">share.h:53</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a2c68fb59aedcda5ae05c736113c37577"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void fizz::sm::validateNegotiationConsistency </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classfizz_1_1client_1_1State.html">State</a> &amp;&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacefizz.html#a3a1cbf7ef22de4d4c5144b3090d7ebc1">ProtocolVersion</a>&#160;</td>
          <td class="paramname"><em>version</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacefizz.html#a23e4ec7baa80cc6f92fdbeadccf0d22e">CipherSuite</a>&#160;</td>
          <td class="paramname"><em>cipher</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ClientProtocol_8cpp_source.html#l00761">761</a> of file <a class="el" href="ClientProtocol_8cpp_source.html">ClientProtocol.cpp</a>.</p>

<p>References <a class="el" href="client_2State_8h_source.html#l00113">fizz::client::State::cipher()</a>, <a class="el" href="ClientProtocol_8cpp_source.html#l01006">cipher</a>, <a class="el" href="namespacefizz.html#a147eec03bf3a9683f4e214820a1f758aa79db796776246d2c3aaca8b375e662c4">fizz::handshake_failure</a>, <a class="el" href="client_2State_8h_source.html#l00106">fizz::client::State::version()</a>, and <a class="el" href="ClientProtocol_8cpp_source.html#l01005">version</a>.</p>

<p>Referenced by <a class="el" href="ClientProtocol_8cpp_source.html#l00794">negotiatePsk()</a>.</p>
<div class="fragment"><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;                        {</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;  <span class="keywordflow">if</span> (state.<a class="code" href="classfizz_1_1client_1_1State.html#a44fe82258a4b27c96a77746ce19e8d70">version</a>() &amp;&amp; *state.<a class="code" href="classfizz_1_1client_1_1State.html#a44fe82258a4b27c96a77746ce19e8d70">version</a>() != <a class="code" href="ClientProtocol_8cpp.html#abe1b247743d4691ae90a9b12b08cc176">version</a>) {</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;    <span class="keywordflow">throw</span> FizzException(</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;        <span class="stringliteral">&quot;version does not match&quot;</span>, AlertDescription::handshake_failure);</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;  }</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;  <span class="keywordflow">if</span> (state.<a class="code" href="classfizz_1_1client_1_1State.html#a0436d6ac09e1a5ef3ffd61ef9a205d21">cipher</a>() &amp;&amp; *state.<a class="code" href="classfizz_1_1client_1_1State.html#a0436d6ac09e1a5ef3ffd61ef9a205d21">cipher</a>() != <a class="code" href="ClientProtocol_8cpp.html#aa7e60e524fbc7254437c13c7d22a9dfa">cipher</a>) {</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;    <span class="keywordflow">throw</span> FizzException(</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;        <span class="stringliteral">&quot;cipher does not match&quot;</span>, AlertDescription::handshake_failure);</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;  }</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;}</div><div class="ttc" id="classfizz_1_1client_1_1State_html_a44fe82258a4b27c96a77746ce19e8d70"><div class="ttname"><a href="classfizz_1_1client_1_1State.html#a44fe82258a4b27c96a77746ce19e8d70">fizz::client::State::version</a></div><div class="ttdeci">folly::Optional&lt; ProtocolVersion &gt; version() const </div><div class="ttdef"><b>Definition:</b> <a href="client_2State_8h_source.html#l00106">State.h:106</a></div></div>
<div class="ttc" id="ClientProtocol_8cpp_html_aa7e60e524fbc7254437c13c7d22a9dfa"><div class="ttname"><a href="ClientProtocol_8cpp.html#aa7e60e524fbc7254437c13c7d22a9dfa">cipher</a></div><div class="ttdeci">CipherSuite cipher</div><div class="ttdef"><b>Definition:</b> <a href="ClientProtocol_8cpp_source.html#l01006">ClientProtocol.cpp:1006</a></div></div>
<div class="ttc" id="classfizz_1_1client_1_1State_html_a0436d6ac09e1a5ef3ffd61ef9a205d21"><div class="ttname"><a href="classfizz_1_1client_1_1State.html#a0436d6ac09e1a5ef3ffd61ef9a205d21">fizz::client::State::cipher</a></div><div class="ttdeci">folly::Optional&lt; CipherSuite &gt; cipher() const </div><div class="ttdef"><b>Definition:</b> <a href="client_2State_8h_source.html#l00113">State.h:113</a></div></div>
<div class="ttc" id="ClientProtocol_8cpp_html_abe1b247743d4691ae90a9b12b08cc176"><div class="ttname"><a href="ClientProtocol_8cpp.html#abe1b247743d4691ae90a9b12b08cc176">version</a></div><div class="ttdeci">ProtocolVersion version</div><div class="ttdef"><b>Definition:</b> <a href="ClientProtocol_8cpp_source.html#l01005">ClientProtocol.cpp:1005</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a533ed96916e1921378aae2c32071d0dc"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="classfolly_1_1Optional.html">folly::Optional</a>&lt;<a class="el" href="structfizz_1_1client_1_1CachedPsk.html">CachedPsk</a>&gt; fizz::sm::validatePsk </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classfizz_1_1client_1_1FizzClientContext.html">FizzClientContext</a> &amp;&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classfolly_1_1Optional.html">folly::Optional</a>&lt; <a class="el" href="structfizz_1_1client_1_1CachedPsk.html">CachedPsk</a> &gt;&#160;</td>
          <td class="paramname"><em>psk</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ClientProtocol_8cpp_source.html#l00290">290</a> of file <a class="el" href="ClientProtocol_8cpp_source.html">ClientProtocol.cpp</a>.</p>

<p>References <a class="el" href="PskCache_8h_source.html#l00026">fizz::client::CachedPsk::cipher</a>, <a class="el" href="FizzClientContext_8h_source.html#l00043">fizz::client::FizzClientContext::getSupportedCiphers()</a>, <a class="el" href="FizzClientContext_8h_source.html#l00032">fizz::client::FizzClientContext::getSupportedVersions()</a>, <a class="el" href="Optional_8h_source.html#l00087">folly::none</a>, <a class="el" href="TimekeeperTest_8cpp_source.html#l00031">now()</a>, <a class="el" href="PskCache_8h_source.html#l00036">fizz::client::CachedPsk::ticketExpirationTime</a>, <a class="el" href="client_2State_8cpp_source.html#l00016">fizz::toString()</a>, and <a class="el" href="PskCache_8h_source.html#l00025">fizz::client::CachedPsk::version</a>.</p>

<p>Referenced by <a class="el" href="ClientProtocol_8cpp_source.html#l00498">getEarlyDataParams()</a>.</p>
<div class="fragment"><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;                                  {</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;  <span class="keywordflow">if</span> (!psk) {</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacefolly.html#ac22c63dbe5af3b0bedb0f21031691537">folly::none</a>;</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;  }</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="TimekeeperTest_8cpp.html#a562b4baa36dcf267f35a4ba4e0aef329">std::chrono::system_clock::now</a>() &gt; psk-&gt;<a class="code" href="structfizz_1_1client_1_1CachedPsk.html#a695cbcfe703eda369b2f8e31237a5f22">ticketExpirationTime</a>) {</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    VLOG(1) &lt;&lt; <span class="stringliteral">&quot;Ignoring expired cached psk&quot;</span>;</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacefolly.html#ac22c63dbe5af3b0bedb0f21031691537">folly::none</a>;</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;  }</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;  <span class="keywordflow">if</span> (std::find(</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;          context.<a class="code" href="classfizz_1_1client_1_1FizzClientContext.html#a6746aee08e7f0b06063da6594f8e428f">getSupportedVersions</a>().begin(),</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;          context.<a class="code" href="classfizz_1_1client_1_1FizzClientContext.html#a6746aee08e7f0b06063da6594f8e428f">getSupportedVersions</a>().end(),</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;          psk-&gt;<a class="code" href="structfizz_1_1client_1_1CachedPsk.html#a6c1b9e185150a9f7b6f936bae46d99d5">version</a>) == context.<a class="code" href="classfizz_1_1client_1_1FizzClientContext.html#a6746aee08e7f0b06063da6594f8e428f">getSupportedVersions</a>().end()) {</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    VLOG(1) &lt;&lt; <span class="stringliteral">&quot;Ignoring cached psk with protocol version &quot;</span></div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;            &lt;&lt; <a class="code" href="namespacefizz.html#a30b2fb43c8fa821c309a460ad8e0c16a">toString</a>(psk-&gt;<a class="code" href="structfizz_1_1client_1_1CachedPsk.html#a6c1b9e185150a9f7b6f936bae46d99d5">version</a>);</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacefolly.html#ac22c63dbe5af3b0bedb0f21031691537">folly::none</a>;</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;  }</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;  <span class="keywordflow">if</span> (std::find(</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;          context.<a class="code" href="classfizz_1_1client_1_1FizzClientContext.html#a09d1b68756b02c0111d8b676238715a7">getSupportedCiphers</a>().begin(),</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;          context.<a class="code" href="classfizz_1_1client_1_1FizzClientContext.html#a09d1b68756b02c0111d8b676238715a7">getSupportedCiphers</a>().end(),</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;          psk-&gt;<a class="code" href="structfizz_1_1client_1_1CachedPsk.html#a55c60a4fa67edda2eb54998c4271eff7">cipher</a>) == context.<a class="code" href="classfizz_1_1client_1_1FizzClientContext.html#a09d1b68756b02c0111d8b676238715a7">getSupportedCiphers</a>().end()) {</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    VLOG(1) &lt;&lt; <span class="stringliteral">&quot;Ignoring cached psk with cipher &quot;</span> &lt;&lt; <a class="code" href="namespacefizz.html#a30b2fb43c8fa821c309a460ad8e0c16a">toString</a>(psk-&gt;<a class="code" href="structfizz_1_1client_1_1CachedPsk.html#a55c60a4fa67edda2eb54998c4271eff7">cipher</a>);</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacefolly.html#ac22c63dbe5af3b0bedb0f21031691537">folly::none</a>;</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;  }</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  <span class="keywordflow">return</span> psk;</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;}</div><div class="ttc" id="namespacefizz_html_a30b2fb43c8fa821c309a460ad8e0c16a"><div class="ttname"><a href="namespacefizz.html#a30b2fb43c8fa821c309a460ad8e0c16a">fizz::toString</a></div><div class="ttdeci">folly::StringPiece toString(StateEnum state)</div><div class="ttdef"><b>Definition:</b> <a href="client_2State_8cpp_source.html#l00016">State.cpp:16</a></div></div>
<div class="ttc" id="classfizz_1_1client_1_1FizzClientContext_html_a6746aee08e7f0b06063da6594f8e428f"><div class="ttname"><a href="classfizz_1_1client_1_1FizzClientContext.html#a6746aee08e7f0b06063da6594f8e428f">fizz::client::FizzClientContext::getSupportedVersions</a></div><div class="ttdeci">const auto &amp; getSupportedVersions() const </div><div class="ttdef"><b>Definition:</b> <a href="FizzClientContext_8h_source.html#l00032">FizzClientContext.h:32</a></div></div>
<div class="ttc" id="TimekeeperTest_8cpp_html_a562b4baa36dcf267f35a4ba4e0aef329"><div class="ttname"><a href="TimekeeperTest_8cpp.html#a562b4baa36dcf267f35a4ba4e0aef329">now</a></div><div class="ttdeci">std::chrono::steady_clock::time_point now()</div><div class="ttdef"><b>Definition:</b> <a href="TimekeeperTest_8cpp_source.html#l00031">TimekeeperTest.cpp:31</a></div></div>
<div class="ttc" id="structfizz_1_1client_1_1CachedPsk_html_a6c1b9e185150a9f7b6f936bae46d99d5"><div class="ttname"><a href="structfizz_1_1client_1_1CachedPsk.html#a6c1b9e185150a9f7b6f936bae46d99d5">fizz::client::CachedPsk::version</a></div><div class="ttdeci">ProtocolVersion version</div><div class="ttdef"><b>Definition:</b> <a href="PskCache_8h_source.html#l00025">PskCache.h:25</a></div></div>
<div class="ttc" id="classfizz_1_1client_1_1FizzClientContext_html_a09d1b68756b02c0111d8b676238715a7"><div class="ttname"><a href="classfizz_1_1client_1_1FizzClientContext.html#a09d1b68756b02c0111d8b676238715a7">fizz::client::FizzClientContext::getSupportedCiphers</a></div><div class="ttdeci">const auto &amp; getSupportedCiphers() const </div><div class="ttdef"><b>Definition:</b> <a href="FizzClientContext_8h_source.html#l00043">FizzClientContext.h:43</a></div></div>
<div class="ttc" id="structfizz_1_1client_1_1CachedPsk_html_a55c60a4fa67edda2eb54998c4271eff7"><div class="ttname"><a href="structfizz_1_1client_1_1CachedPsk.html#a55c60a4fa67edda2eb54998c4271eff7">fizz::client::CachedPsk::cipher</a></div><div class="ttdeci">CipherSuite cipher</div><div class="ttdef"><b>Definition:</b> <a href="PskCache_8h_source.html#l00026">PskCache.h:26</a></div></div>
<div class="ttc" id="structfizz_1_1client_1_1CachedPsk_html_a695cbcfe703eda369b2f8e31237a5f22"><div class="ttname"><a href="structfizz_1_1client_1_1CachedPsk.html#a695cbcfe703eda369b2f8e31237a5f22">fizz::client::CachedPsk::ticketExpirationTime</a></div><div class="ttdeci">std::chrono::system_clock::time_point ticketExpirationTime</div><div class="ttdef"><b>Definition:</b> <a href="PskCache_8h_source.html#l00036">PskCache.h:36</a></div></div>
<div class="ttc" id="namespacefolly_html_ac22c63dbe5af3b0bedb0f21031691537"><div class="ttname"><a href="namespacefolly.html#ac22c63dbe5af3b0bedb0f21031691537">folly::none</a></div><div class="ttdeci">constexpr None none</div><div class="ttdef"><b>Definition:</b> <a href="Optional_8h_source.html#l00087">Optional.h:87</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a3c78fa192ff6b42a7b1a79ab5cf4e380"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool fizz::sm::validateResumptionState </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structfizz_1_1server_1_1ResumptionState.html">ResumptionState</a> &amp;&#160;</td>
          <td class="paramname"><em>resState</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacefizz.html#a1e500492a0a0633f62bf1c3d4acea880">PskKeyExchangeMode</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacefizz.html#a3a1cbf7ef22de4d4c5144b3090d7ebc1">ProtocolVersion</a>&#160;</td>
          <td class="paramname"><em>version</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacefizz.html#a23e4ec7baa80cc6f92fdbeadccf0d22e">CipherSuite</a>&#160;</td>
          <td class="paramname"><em>cipher</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ServerProtocol_8cpp_source.html#l00496">496</a> of file <a class="el" href="ServerProtocol_8cpp_source.html">ServerProtocol.cpp</a>.</p>

<p>References <a class="el" href="ResumptionState_8h_source.html#l00021">fizz::server::ResumptionState::cipher</a>, <a class="el" href="protocol_2Types_8cpp_source.html#l00013">fizz::getHashFunction()</a>, and <a class="el" href="ResumptionState_8h_source.html#l00020">fizz::server::ResumptionState::version</a>.</p>

<p>Referenced by <a class="el" href="ServerProtocol_8cpp_source.html#l00953">getCertificateRequest()</a>.</p>
<div class="fragment"><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;                        {</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;  <span class="keywordflow">if</span> (resState.<a class="code" href="structfizz_1_1server_1_1ResumptionState.html#a4fdbac16786dcbb33ccf0980d97f784e">version</a> != <a class="code" href="ClientProtocol_8cpp.html#abe1b247743d4691ae90a9b12b08cc176">version</a>) {</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    VLOG(8) &lt;&lt; <span class="stringliteral">&quot;Protocol version mismatch, rejecting PSK.&quot;</span>;</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;  }</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacefizz.html#a59cb5b362db9a10553246368f7615128">getHashFunction</a>(resState.<a class="code" href="structfizz_1_1server_1_1ResumptionState.html#a50b823b26e25f055b035a094e566aa8e">cipher</a>) != <a class="code" href="namespacefizz.html#a59cb5b362db9a10553246368f7615128">getHashFunction</a>(<a class="code" href="ClientProtocol_8cpp.html#aa7e60e524fbc7254437c13c7d22a9dfa">cipher</a>)) {</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    VLOG(8) &lt;&lt; <span class="stringliteral">&quot;Hash mismatch, rejecting PSK.&quot;</span>;</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;  }</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;}</div><div class="ttc" id="structfizz_1_1server_1_1ResumptionState_html_a4fdbac16786dcbb33ccf0980d97f784e"><div class="ttname"><a href="structfizz_1_1server_1_1ResumptionState.html#a4fdbac16786dcbb33ccf0980d97f784e">fizz::server::ResumptionState::version</a></div><div class="ttdeci">ProtocolVersion version</div><div class="ttdef"><b>Definition:</b> <a href="ResumptionState_8h_source.html#l00020">ResumptionState.h:20</a></div></div>
<div class="ttc" id="structfizz_1_1server_1_1ResumptionState_html_a50b823b26e25f055b035a094e566aa8e"><div class="ttname"><a href="structfizz_1_1server_1_1ResumptionState.html#a50b823b26e25f055b035a094e566aa8e">fizz::server::ResumptionState::cipher</a></div><div class="ttdeci">CipherSuite cipher</div><div class="ttdef"><b>Definition:</b> <a href="ResumptionState_8h_source.html#l00021">ResumptionState.h:21</a></div></div>
<div class="ttc" id="ClientProtocol_8cpp_html_aa7e60e524fbc7254437c13c7d22a9dfa"><div class="ttname"><a href="ClientProtocol_8cpp.html#aa7e60e524fbc7254437c13c7d22a9dfa">cipher</a></div><div class="ttdeci">CipherSuite cipher</div><div class="ttdef"><b>Definition:</b> <a href="ClientProtocol_8cpp_source.html#l01006">ClientProtocol.cpp:1006</a></div></div>
<div class="ttc" id="namespacefizz_html_a59cb5b362db9a10553246368f7615128"><div class="ttname"><a href="namespacefizz.html#a59cb5b362db9a10553246368f7615128">fizz::getHashFunction</a></div><div class="ttdeci">HashFunction getHashFunction(CipherSuite cipher)</div><div class="ttdef"><b>Definition:</b> <a href="protocol_2Types_8cpp_source.html#l00013">Types.cpp:13</a></div></div>
<div class="ttc" id="ClientProtocol_8cpp_html_abe1b247743d4691ae90a9b12b08cc176"><div class="ttname"><a href="ClientProtocol_8cpp.html#abe1b247743d4691ae90a9b12b08cc176">version</a></div><div class="ttdeci">ProtocolVersion version</div><div class="ttdef"><b>Definition:</b> <a href="ClientProtocol_8cpp_source.html#l01005">ClientProtocol.cpp:1005</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ae07a16d08f9254937d3fdcb4a52b5f19"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="structfizz_1_1WriteToSocket.html">WriteToSocket</a> fizz::sm::writeNewSessionTicket </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classfizz_1_1server_1_1FizzServerContext.html">FizzServerContext</a> &amp;&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classfizz_1_1WriteRecordLayer.html">WriteRecordLayer</a> &amp;&#160;</td>
          <td class="paramname"><em>recordLayer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::chrono::seconds&#160;</td>
          <td class="paramname"><em>ticketLifetime</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ConstexprMathBenchmark_8cpp.html#a09a1e304d66d35dd47daffee9731edaa">uint32_t</a>&#160;</td>
          <td class="paramname"><em>ticketAgeAdd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacefizz.html#af020f21a568ff86800e03d6ad2a9b84d">Buf</a>&#160;</td>
          <td class="paramname"><em>nonce</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacefizz.html#af020f21a568ff86800e03d6ad2a9b84d">Buf</a>&#160;</td>
          <td class="paramname"><em>ticket</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacefizz.html#a3a1cbf7ef22de4d4c5144b3090d7ebc1">ProtocolVersion</a>&#160;</td>
          <td class="paramname"><em>version</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ServerProtocol_8cpp_source.html#l01614">1614</a> of file <a class="el" href="ServerProtocol_8cpp_source.html">ServerProtocol.cpp</a>.</p>

<p>References <a class="el" href="protocol_2Actions_8h_source.html#l00041">fizz::WriteToSocket::contents</a>, <a class="el" href="extensions_2tokenbinding_2Types_8cpp_source.html#l00113">fizz::encodeExtension()</a>, <a class="el" href="Types-inl_8h_source.html#l00515">fizz::encodeHandshake()</a>, <a class="el" href="fizz_2fizz_2record_2Types_8h_source.html#l00289">fizz::NewSessionTicket::extensions</a>, <a class="el" href="FizzServerContext_8h_source.html#l00218">fizz::server::FizzServerContext::getAcceptEarlyData()</a>, <a class="el" href="FizzServerContext_8h_source.html#l00248">fizz::server::FizzServerContext::getMaxEarlyDataSize()</a>, <a class="el" href="Extensions_8h_source.html#l00083">fizz::TicketEarlyData::max_early_data_size</a>, <a class="el" href="Base-inl_8h_source.html#l02567">folly::gen::move</a>, <a class="el" href="HandshakeTypesTest_8cpp_source.html#l00077">nst</a>, <a class="el" href="fizz_2fizz_2record_2Types_8h_source.html#l00288">fizz::NewSessionTicket::ticket</a>, <a class="el" href="fizz_2fizz_2record_2Types_8h_source.html#l00285">fizz::NewSessionTicket::ticket_age_add</a>, <a class="el" href="fizz_2fizz_2record_2Types_8h_source.html#l00284">fizz::NewSessionTicket::ticket_lifetime</a>, <a class="el" href="fizz_2fizz_2record_2Types_8h_source.html#l00287">fizz::NewSessionTicket::ticket_nonce</a>, and <a class="el" href="RecordLayer_8h_source.html#l00074">fizz::WriteRecordLayer::writeHandshake()</a>.</p>

<p>Referenced by <a class="el" href="ServerProtocol_8cpp_source.html#l01641">generateTicket()</a>.</p>
<div class="fragment"><div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;                             {</div><div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;  <a class="code" href="namespacefizz.html#a1135430496a56ed55bdfc4a77ccb35fbae94ec29c1c92594130e418b7d1972cda">NewSessionTicket</a> <a class="code" href="HandshakeTypesTest_8cpp.html#a4a94a2c9d0b18e88889a8d7fcf70d170">nst</a>;</div><div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;  nst.ticket_lifetime = ticketLifetime.count();</div><div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;  nst.ticket_age_add = ticketAgeAdd;</div><div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;  nst.ticket_nonce = <a class="code" href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">std::move</a>(nonce);</div><div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;  nst.ticket = <a class="code" href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">std::move</a>(<a class="code" href="TicketCodecTest_8cpp.html#a7093cc9e41a6fdad6b2f2aa9211604c6">ticket</a>);</div><div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;</div><div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;  <span class="keywordflow">if</span> (context.<a class="code" href="classfizz_1_1server_1_1FizzServerContext.html#ab66bdd2ab784b01b791a1489bf5908bf">getAcceptEarlyData</a>(<a class="code" href="ClientProtocol_8cpp.html#abe1b247743d4691ae90a9b12b08cc176">version</a>)) {</div><div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;    TicketEarlyData early;</div><div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;    early.max_early_data_size = context.<a class="code" href="classfizz_1_1server_1_1FizzServerContext.html#aac58beace597438f3e8b0555081264ba">getMaxEarlyDataSize</a>();</div><div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;    nst.extensions.push_back(<a class="code" href="namespacefizz.html#af6485298511d0a74eb07b27570e62378">encodeExtension</a>(<a class="code" href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">std::move</a>(early)));</div><div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;  }</div><div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;</div><div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;  <span class="keyword">auto</span> encodedNst = <a class="code" href="namespacefizz.html#a1fef0ecdfd4a6c07fd32b5dd0dcb2b23">encodeHandshake</a>(<a class="code" href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">std::move</a>(nst));</div><div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;  WriteToSocket nstWrite;</div><div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;  nstWrite.contents.emplace_back(</div><div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;      recordLayer.writeHandshake(<a class="code" href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">std::move</a>(encodedNst)));</div><div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;  <span class="keywordflow">return</span> nstWrite;</div><div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;}</div><div class="ttc" id="classfizz_1_1server_1_1FizzServerContext_html_aac58beace597438f3e8b0555081264ba"><div class="ttname"><a href="classfizz_1_1server_1_1FizzServerContext.html#aac58beace597438f3e8b0555081264ba">fizz::server::FizzServerContext::getMaxEarlyDataSize</a></div><div class="ttdeci">uint32_t getMaxEarlyDataSize() const </div><div class="ttdef"><b>Definition:</b> <a href="FizzServerContext_8h_source.html#l00248">FizzServerContext.h:248</a></div></div>
<div class="ttc" id="namespacefizz_html_a1fef0ecdfd4a6c07fd32b5dd0dcb2b23"><div class="ttname"><a href="namespacefizz.html#a1fef0ecdfd4a6c07fd32b5dd0dcb2b23">fizz::encodeHandshake</a></div><div class="ttdeci">Buf encodeHandshake(T &amp;&amp;handshakeMsg)</div><div class="ttdef"><b>Definition:</b> <a href="Types-inl_8h_source.html#l00515">Types-inl.h:515</a></div></div>
<div class="ttc" id="namespacefolly_1_1gen_html_ac24ec252b1b738a40c274285527c193f"><div class="ttname"><a href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">folly::gen::move</a></div><div class="ttdeci">constexpr detail::Map&lt; Move &gt; move</div><div class="ttdef"><b>Definition:</b> <a href="Base-inl_8h_source.html#l02567">Base-inl.h:2567</a></div></div>
<div class="ttc" id="TicketCodecTest_8cpp_html_a7093cc9e41a6fdad6b2f2aa9211604c6"><div class="ttname"><a href="TicketCodecTest_8cpp.html#a7093cc9e41a6fdad6b2f2aa9211604c6">ticket</a></div><div class="ttdeci">static constexpr StringPiece ticket</div><div class="ttdef"><b>Definition:</b> <a href="TicketCodecTest_8cpp_source.html#l00021">TicketCodecTest.cpp:21</a></div></div>
<div class="ttc" id="ClientProtocol_8cpp_html_abe1b247743d4691ae90a9b12b08cc176"><div class="ttname"><a href="ClientProtocol_8cpp.html#abe1b247743d4691ae90a9b12b08cc176">version</a></div><div class="ttdeci">ProtocolVersion version</div><div class="ttdef"><b>Definition:</b> <a href="ClientProtocol_8cpp_source.html#l01005">ClientProtocol.cpp:1005</a></div></div>
<div class="ttc" id="classfizz_1_1server_1_1FizzServerContext_html_ab66bdd2ab784b01b791a1489bf5908bf"><div class="ttname"><a href="classfizz_1_1server_1_1FizzServerContext.html#ab66bdd2ab784b01b791a1489bf5908bf">fizz::server::FizzServerContext::getAcceptEarlyData</a></div><div class="ttdeci">bool getAcceptEarlyData(ProtocolVersion version) const </div><div class="ttdef"><b>Definition:</b> <a href="FizzServerContext_8h_source.html#l00218">FizzServerContext.h:218</a></div></div>
<div class="ttc" id="HandshakeTypesTest_8cpp_html_a4a94a2c9d0b18e88889a8d7fcf70d170"><div class="ttname"><a href="HandshakeTypesTest_8cpp.html#a4a94a2c9d0b18e88889a8d7fcf70d170">nst</a></div><div class="ttdeci">static const std::string nst</div><div class="ttdef"><b>Definition:</b> <a href="HandshakeTypesTest_8cpp_source.html#l00077">HandshakeTypesTest.cpp:77</a></div></div>
<div class="ttc" id="namespacefizz_html_af6485298511d0a74eb07b27570e62378"><div class="ttname"><a href="namespacefizz.html#af6485298511d0a74eb07b27570e62378">fizz::encodeExtension</a></div><div class="ttdeci">Extension encodeExtension(const TokenBindingParameters &amp;params)</div><div class="ttdef"><b>Definition:</b> <a href="extensions_2tokenbinding_2Types_8cpp_source.html#l00113">Types.cpp:113</a></div></div>
<div class="ttc" id="namespacefizz_html_a1135430496a56ed55bdfc4a77ccb35fbae94ec29c1c92594130e418b7d1972cda"><div class="ttname"><a href="namespacefizz.html#a1135430496a56ed55bdfc4a77ccb35fbae94ec29c1c92594130e418b7d1972cda">fizz::Event::NewSessionTicket</a></div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacefizz.html">fizz</a></li><li class="navelem"><a class="el" href="namespacefizz_1_1sm.html">sm</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
