<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>proxygen: folly::JemallocHugePageAllocator Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">proxygen
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('classfolly_1_1JemallocHugePageAllocator.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pri-static-attribs">Static Private Attributes</a> &#124;
<a href="classfolly_1_1JemallocHugePageAllocator-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">folly::JemallocHugePageAllocator Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="JemallocHugePageAllocator_8h_source.html">JemallocHugePageAllocator.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:a7ac19b5d88a4b9eb6be37202e94fb461"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfolly_1_1JemallocHugePageAllocator.html#a7ac19b5d88a4b9eb6be37202e94fb461">init</a> (int nr_pages)</td></tr>
<tr class="separator:a7ac19b5d88a4b9eb6be37202e94fb461"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a0540ec53114608cc50b5eb2692142e"><td class="memItemLeft" align="right" valign="top">static void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfolly_1_1JemallocHugePageAllocator.html#a8a0540ec53114608cc50b5eb2692142e">allocate</a> (size_t <a class="el" href="namespacefolly.html#a0606ba855bcb96a1673880aa3b404993">size</a>)</td></tr>
<tr class="separator:a8a0540ec53114608cc50b5eb2692142e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e924bef48e8d7471ed908560f06312d"><td class="memItemLeft" align="right" valign="top">static void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfolly_1_1JemallocHugePageAllocator.html#a4e924bef48e8d7471ed908560f06312d">reallocate</a> (void *p, size_t <a class="el" href="namespacefolly.html#a0606ba855bcb96a1673880aa3b404993">size</a>)</td></tr>
<tr class="separator:a4e924bef48e8d7471ed908560f06312d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a19764ca5b900be0b0ad7600dd9efe93f"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfolly_1_1JemallocHugePageAllocator.html#a19764ca5b900be0b0ad7600dd9efe93f">deallocate</a> (void *p, size_t=0)</td></tr>
<tr class="separator:a19764ca5b900be0b0ad7600dd9efe93f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f98cb36be5bd97f6a59d4f484cf03d8"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfolly_1_1JemallocHugePageAllocator.html#a2f98cb36be5bd97f6a59d4f484cf03d8">initialized</a> ()</td></tr>
<tr class="separator:a2f98cb36be5bd97f6a59d4f484cf03d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a14c7fa2c1fab94c134d523e7babc96e6"><td class="memItemLeft" align="right" valign="top">static size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfolly_1_1JemallocHugePageAllocator.html#a14c7fa2c1fab94c134d523e7babc96e6">freeSpace</a> ()</td></tr>
<tr class="separator:a14c7fa2c1fab94c134d523e7babc96e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1fc9f0f5f0f0d349a79c766b6d4d6685"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfolly_1_1JemallocHugePageAllocator.html#a1fc9f0f5f0f0d349a79c766b6d4d6685">addressInArena</a> (void *address)</td></tr>
<tr class="separator:a1fc9f0f5f0f0d349a79c766b6d4d6685"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-static-attribs"></a>
Static Private Attributes</h2></td></tr>
<tr class="memitem:aa75f2f13de92bb0a8d2c5651eaa84e4c"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfolly_1_1JemallocHugePageAllocator.html#aa75f2f13de92bb0a8d2c5651eaa84e4c">flags_</a> {0}</td></tr>
<tr class="separator:aa75f2f13de92bb0a8d2c5651eaa84e4c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a46425c0d972bf479cdd0845ea43a20d3"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfolly_1_1JemallocHugePageAllocator.html#a46425c0d972bf479cdd0845ea43a20d3">hugePagesSupported</a> {false}</td></tr>
<tr class="separator:a46425c0d972bf479cdd0845ea43a20d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>An allocator which uses Jemalloc to create a dedicated huge page arena, backed by 2MB huge pages (on linux x86-64).</p>
<p>This allocator is specifically intended for linux with the transparent huge page support set to 'madvise' and defrag policy set to 'madvise' or 'defer+madvise'. These can be controller via /sys/kernel/mm/transparent_hugepage/enabled and /sys/kernel/mm/transparent_hugepage/defrag.</p>
<p>The allocator reserves a fixed-size area using mmap, and sets the MADV_HUGEPAGE page attribute using the madvise system call. <a class="el" href="structA.html">A</a> custom jemalloc hook is installed which is called when creating a new extent of memory. This will allocate from the reserved area if possible, and otherwise fall back to the default method. Jemalloc does not use allocated extents across different arenas without first unmapping them, and the advice flags are cleared on munmap. <a class="el" href="structA.html">A</a> regular malloc will never end up allocating memory from this arena.</p>
<p>If binary isn't linked with jemalloc, the logic falls back to malloc / free.</p>
<p>Note that the madvise call does not guarantee huge pages, it is best effort.</p>
<p>1GB Huge Pages are not supported at this point. </p>

<p>Definition at line <a class="el" href="JemallocHugePageAllocator_8h_source.html#l00057">57</a> of file <a class="el" href="JemallocHugePageAllocator_8h_source.html">JemallocHugePageAllocator.h</a>.</p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a1fc9f0f5f0f0d349a79c766b6d4d6685"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool folly::JemallocHugePageAllocator::addressInArena </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>address</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="JemallocHugePageAllocator_8cpp_source.html#l00279">279</a> of file <a class="el" href="JemallocHugePageAllocator_8cpp_source.html">JemallocHugePageAllocator.cpp</a>.</p>

<p>Referenced by <a class="el" href="JemallocHugePageAllocator_8h_source.html#l00075">initialized()</a>, and <a class="el" href="JemallocHugePageAllocatorTest_8cpp_source.html#l00035">TEST()</a>.</p>
<div class="fragment"><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;                                                            {</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;  <span class="keywordflow">return</span> arena.addressInArena(address);</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;}</div></div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a8a0540ec53114608cc50b5eb2692142e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void* folly::JemallocHugePageAllocator::allocate </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>size</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="JemallocHugePageAllocator_8h_source.html#l00061">61</a> of file <a class="el" href="JemallocHugePageAllocator_8h_source.html">JemallocHugePageAllocator.h</a>.</p>

<p>References <a class="el" href="JemallocHugePageAllocator_8h_source.html#l00083">flags_</a>, <a class="el" href="JemallocHugePageAllocator_8h_source.html#l00084">hugePagesSupported</a>, and <a class="el" href="MallocImpl_8cpp_source.html#l00035">mallocx</a>.</p>

<p>Referenced by <a class="el" href="JemallocHugePageAllocator_8h_source.html#l00101">folly::CxxHugePageAllocator&lt; T &gt;::allocate()</a>, and <a class="el" href="JemallocHugePageAllocatorTest_8cpp_source.html#l00035">TEST()</a>.</p>
<div class="fragment"><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;                                     {</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <span class="comment">// If uninitialized, flags_ will be 0 and the mallocx behavior</span></div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <span class="comment">// will match that of a regular malloc</span></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classfolly_1_1JemallocHugePageAllocator.html#a46425c0d972bf479cdd0845ea43a20d3">hugePagesSupported</a> ? <a class="code" href="MallocImpl_8cpp.html#adc9869ed7f33f431b67edf121693febe">mallocx</a>(<a class="code" href="namespacefolly.html#a0606ba855bcb96a1673880aa3b404993">size</a>, <a class="code" href="classfolly_1_1JemallocHugePageAllocator.html#aa75f2f13de92bb0a8d2c5651eaa84e4c">flags_</a>) : malloc(<a class="code" href="namespacefolly.html#a0606ba855bcb96a1673880aa3b404993">size</a>);</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  }</div><div class="ttc" id="namespacefolly_html_a0606ba855bcb96a1673880aa3b404993"><div class="ttname"><a href="namespacefolly.html#a0606ba855bcb96a1673880aa3b404993">folly::size</a></div><div class="ttdeci">constexpr auto size(C const &amp;c) -&gt; decltype(c.size())</div><div class="ttdef"><b>Definition:</b> <a href="Access_8h_source.html#l00045">Access.h:45</a></div></div>
<div class="ttc" id="classfolly_1_1JemallocHugePageAllocator_html_a46425c0d972bf479cdd0845ea43a20d3"><div class="ttname"><a href="classfolly_1_1JemallocHugePageAllocator.html#a46425c0d972bf479cdd0845ea43a20d3">folly::JemallocHugePageAllocator::hugePagesSupported</a></div><div class="ttdeci">static bool hugePagesSupported</div><div class="ttdef"><b>Definition:</b> <a href="JemallocHugePageAllocator_8h_source.html#l00084">JemallocHugePageAllocator.h:84</a></div></div>
<div class="ttc" id="MallocImpl_8cpp_html_adc9869ed7f33f431b67edf121693febe"><div class="ttname"><a href="MallocImpl_8cpp.html#adc9869ed7f33f431b67edf121693febe">mallocx</a></div><div class="ttdeci">void *(* mallocx)(size_t, int)</div><div class="ttdef"><b>Definition:</b> <a href="MallocImpl_8cpp_source.html#l00035">MallocImpl.cpp:35</a></div></div>
<div class="ttc" id="classfolly_1_1JemallocHugePageAllocator_html_aa75f2f13de92bb0a8d2c5651eaa84e4c"><div class="ttname"><a href="classfolly_1_1JemallocHugePageAllocator.html#aa75f2f13de92bb0a8d2c5651eaa84e4c">folly::JemallocHugePageAllocator::flags_</a></div><div class="ttdeci">static int flags_</div><div class="ttdef"><b>Definition:</b> <a href="JemallocHugePageAllocator_8h_source.html#l00083">JemallocHugePageAllocator.h:83</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a19764ca5b900be0b0ad7600dd9efe93f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void folly::JemallocHugePageAllocator::deallocate </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="JemallocHugePageAllocator_8h_source.html#l00071">71</a> of file <a class="el" href="JemallocHugePageAllocator_8h_source.html">JemallocHugePageAllocator.h</a>.</p>

<p>References <a class="el" href="MallocImpl_8cpp_source.html#l00039">dallocx</a>, <a class="el" href="JemallocHugePageAllocator_8h_source.html#l00083">flags_</a>, <a class="el" href="BitVectorCodingTest_8cpp_source.html#l00094">bm::free()</a>, and <a class="el" href="JemallocHugePageAllocator_8h_source.html#l00084">hugePagesSupported</a>.</p>

<p>Referenced by <a class="el" href="JemallocHugePageAllocator_8h_source.html#l00104">folly::CxxHugePageAllocator&lt; T &gt;::deallocate()</a>, and <a class="el" href="JemallocHugePageAllocatorTest_8cpp_source.html#l00035">TEST()</a>.</p>
<div class="fragment"><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;                                              {</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <a class="code" href="classfolly_1_1JemallocHugePageAllocator.html#a46425c0d972bf479cdd0845ea43a20d3">hugePagesSupported</a> ? <a class="code" href="MallocImpl_8cpp.html#ae9b829aa5651f6db24f25f620d288773">dallocx</a>(p, <a class="code" href="classfolly_1_1JemallocHugePageAllocator.html#aa75f2f13de92bb0a8d2c5651eaa84e4c">flags_</a>) : <a class="code" href="namespacebm.html#ad1f2831d164bf5bc0b15eae7b05fcd64">free</a>(p);</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  }</div><div class="ttc" id="MallocImpl_8cpp_html_ae9b829aa5651f6db24f25f620d288773"><div class="ttname"><a href="MallocImpl_8cpp.html#ae9b829aa5651f6db24f25f620d288773">dallocx</a></div><div class="ttdeci">void(* dallocx)(void *, int)</div><div class="ttdef"><b>Definition:</b> <a href="MallocImpl_8cpp_source.html#l00039">MallocImpl.cpp:39</a></div></div>
<div class="ttc" id="classfolly_1_1JemallocHugePageAllocator_html_a46425c0d972bf479cdd0845ea43a20d3"><div class="ttname"><a href="classfolly_1_1JemallocHugePageAllocator.html#a46425c0d972bf479cdd0845ea43a20d3">folly::JemallocHugePageAllocator::hugePagesSupported</a></div><div class="ttdeci">static bool hugePagesSupported</div><div class="ttdef"><b>Definition:</b> <a href="JemallocHugePageAllocator_8h_source.html#l00084">JemallocHugePageAllocator.h:84</a></div></div>
<div class="ttc" id="namespacebm_html_ad1f2831d164bf5bc0b15eae7b05fcd64"><div class="ttname"><a href="namespacebm.html#ad1f2831d164bf5bc0b15eae7b05fcd64">bm::free</a></div><div class="ttdeci">void free()</div><div class="ttdef"><b>Definition:</b> <a href="BitVectorCodingTest_8cpp_source.html#l00094">BitVectorCodingTest.cpp:94</a></div></div>
<div class="ttc" id="classfolly_1_1JemallocHugePageAllocator_html_aa75f2f13de92bb0a8d2c5651eaa84e4c"><div class="ttname"><a href="classfolly_1_1JemallocHugePageAllocator.html#aa75f2f13de92bb0a8d2c5651eaa84e4c">folly::JemallocHugePageAllocator::flags_</a></div><div class="ttdeci">static int flags_</div><div class="ttdef"><b>Definition:</b> <a href="JemallocHugePageAllocator_8h_source.html#l00083">JemallocHugePageAllocator.h:83</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a14c7fa2c1fab94c134d523e7babc96e6"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">size_t folly::JemallocHugePageAllocator::freeSpace </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="JemallocHugePageAllocator_8cpp_source.html#l00275">275</a> of file <a class="el" href="JemallocHugePageAllocator_8cpp_source.html">JemallocHugePageAllocator.cpp</a>.</p>

<p>Referenced by <a class="el" href="JemallocHugePageAllocator_8h_source.html#l00075">initialized()</a>, and <a class="el" href="JemallocHugePageAllocatorTest_8cpp_source.html#l00035">TEST()</a>.</p>
<div class="fragment"><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;                                            {</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;  <span class="keywordflow">return</span> arena.freeSpace();</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;}</div></div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a7ac19b5d88a4b9eb6be37202e94fb461"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool folly::JemallocHugePageAllocator::init </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nr_pages</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="JemallocHugePageAllocator_8cpp_source.html#l00258">258</a> of file <a class="el" href="JemallocHugePageAllocator_8cpp_source.html">JemallocHugePageAllocator.cpp</a>.</p>

<p>References <a class="el" href="memory_2Malloc_8h_source.html#l00147">folly::usingJEMalloc()</a>, and <a class="el" href="namespacefolly.html#a925db14fdb0096fe395f6acc43118f4aa059e9861e0400dfbe05c98a841f3f96b">folly::WARNING</a>.</p>

<p>Referenced by <a class="el" href="JemallocHugePageAllocatorTest_8cpp_source.html#l00035">TEST()</a>.</p>
<div class="fragment"><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;                                                 {</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="namespacefolly.html#afd107211692ed57ebcd9e14257f7b6bd">usingJEMalloc</a>()) {</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    LOG(ERROR) &lt;&lt; <span class="stringliteral">&quot;Not linked with jemalloc?&quot;</span>;</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <a class="code" href="classfolly_1_1JemallocHugePageAllocator.html#a46425c0d972bf479cdd0845ea43a20d3">hugePagesSupported</a> = <span class="keyword">false</span>;</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;  }</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classfolly_1_1JemallocHugePageAllocator.html#a46425c0d972bf479cdd0845ea43a20d3">hugePagesSupported</a>) {</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classfolly_1_1JemallocHugePageAllocator.html#aa75f2f13de92bb0a8d2c5651eaa84e4c">flags_</a> == 0) {</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;      <a class="code" href="classfolly_1_1JemallocHugePageAllocator.html#aa75f2f13de92bb0a8d2c5651eaa84e4c">flags_</a> = arena.init(nr_pages);</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;      LOG(<a class="code" href="namespacefolly.html#a925db14fdb0096fe395f6acc43118f4aa059e9861e0400dfbe05c98a841f3f96b">WARNING</a>) &lt;&lt; <span class="stringliteral">&quot;Already initialized&quot;</span>;</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    }</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    LOG(<a class="code" href="namespacefolly.html#a925db14fdb0096fe395f6acc43118f4aa059e9861e0400dfbe05c98a841f3f96b">WARNING</a>) &lt;&lt; <span class="stringliteral">&quot;Huge Page Allocator not supported&quot;</span>;</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;  }</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classfolly_1_1JemallocHugePageAllocator.html#aa75f2f13de92bb0a8d2c5651eaa84e4c">flags_</a> != 0;</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;}</div><div class="ttc" id="namespacefolly_html_afd107211692ed57ebcd9e14257f7b6bd"><div class="ttname"><a href="namespacefolly.html#afd107211692ed57ebcd9e14257f7b6bd">folly::usingJEMalloc</a></div><div class="ttdeci">bool usingJEMalloc() noexcept</div><div class="ttdef"><b>Definition:</b> <a href="memory_2Malloc_8h_source.html#l00147">Malloc.h:147</a></div></div>
<div class="ttc" id="classfolly_1_1JemallocHugePageAllocator_html_a46425c0d972bf479cdd0845ea43a20d3"><div class="ttname"><a href="classfolly_1_1JemallocHugePageAllocator.html#a46425c0d972bf479cdd0845ea43a20d3">folly::JemallocHugePageAllocator::hugePagesSupported</a></div><div class="ttdeci">static bool hugePagesSupported</div><div class="ttdef"><b>Definition:</b> <a href="JemallocHugePageAllocator_8h_source.html#l00084">JemallocHugePageAllocator.h:84</a></div></div>
<div class="ttc" id="namespacefolly_html_a925db14fdb0096fe395f6acc43118f4aa059e9861e0400dfbe05c98a841f3f96b"><div class="ttname"><a href="namespacefolly.html#a925db14fdb0096fe395f6acc43118f4aa059e9861e0400dfbe05c98a841f3f96b">folly::LogLevel::WARNING</a></div></div>
<div class="ttc" id="classfolly_1_1JemallocHugePageAllocator_html_aa75f2f13de92bb0a8d2c5651eaa84e4c"><div class="ttname"><a href="classfolly_1_1JemallocHugePageAllocator.html#aa75f2f13de92bb0a8d2c5651eaa84e4c">folly::JemallocHugePageAllocator::flags_</a></div><div class="ttdeci">static int flags_</div><div class="ttdef"><b>Definition:</b> <a href="JemallocHugePageAllocator_8h_source.html#l00083">JemallocHugePageAllocator.h:83</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a2f98cb36be5bd97f6a59d4f484cf03d8"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool folly::JemallocHugePageAllocator::initialized </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="JemallocHugePageAllocator_8h_source.html#l00075">75</a> of file <a class="el" href="JemallocHugePageAllocator_8h_source.html">JemallocHugePageAllocator.h</a>.</p>

<p>References <a class="el" href="JemallocHugePageAllocator_8cpp_source.html#l00279">addressInArena()</a>, <a class="el" href="JemallocHugePageAllocator_8h_source.html#l00083">flags_</a>, and <a class="el" href="JemallocHugePageAllocator_8cpp_source.html#l00275">freeSpace()</a>.</p>

<p>Referenced by <a class="el" href="JemallocHugePageAllocatorTest_8cpp_source.html#l00035">TEST()</a>.</p>
<div class="fragment"><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;                            {</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classfolly_1_1JemallocHugePageAllocator.html#aa75f2f13de92bb0a8d2c5651eaa84e4c">flags_</a> != 0;</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  }</div><div class="ttc" id="classfolly_1_1JemallocHugePageAllocator_html_aa75f2f13de92bb0a8d2c5651eaa84e4c"><div class="ttname"><a href="classfolly_1_1JemallocHugePageAllocator.html#aa75f2f13de92bb0a8d2c5651eaa84e4c">folly::JemallocHugePageAllocator::flags_</a></div><div class="ttdeci">static int flags_</div><div class="ttdef"><b>Definition:</b> <a href="JemallocHugePageAllocator_8h_source.html#l00083">JemallocHugePageAllocator.h:83</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a4e924bef48e8d7471ed908560f06312d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void* folly::JemallocHugePageAllocator::reallocate </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="JemallocHugePageAllocator_8h_source.html#l00067">67</a> of file <a class="el" href="JemallocHugePageAllocator_8h_source.html">JemallocHugePageAllocator.h</a>.</p>

<p>References <a class="el" href="JemallocHugePageAllocator_8h_source.html#l00083">flags_</a>, <a class="el" href="JemallocHugePageAllocator_8h_source.html#l00084">hugePagesSupported</a>, and <a class="el" href="MallocImpl_8cpp_source.html#l00036">rallocx</a>.</p>
<div class="fragment"><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;                                                {</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classfolly_1_1JemallocHugePageAllocator.html#a46425c0d972bf479cdd0845ea43a20d3">hugePagesSupported</a> ? <a class="code" href="MallocImpl_8cpp.html#a81872a5787f44cb4a30efd43d177ff66">rallocx</a>(p, <a class="code" href="namespacefolly.html#a0606ba855bcb96a1673880aa3b404993">size</a>, <a class="code" href="classfolly_1_1JemallocHugePageAllocator.html#aa75f2f13de92bb0a8d2c5651eaa84e4c">flags_</a>) : realloc(p, <a class="code" href="namespacefolly.html#a0606ba855bcb96a1673880aa3b404993">size</a>);</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  }</div><div class="ttc" id="namespacefolly_html_a0606ba855bcb96a1673880aa3b404993"><div class="ttname"><a href="namespacefolly.html#a0606ba855bcb96a1673880aa3b404993">folly::size</a></div><div class="ttdeci">constexpr auto size(C const &amp;c) -&gt; decltype(c.size())</div><div class="ttdef"><b>Definition:</b> <a href="Access_8h_source.html#l00045">Access.h:45</a></div></div>
<div class="ttc" id="classfolly_1_1JemallocHugePageAllocator_html_a46425c0d972bf479cdd0845ea43a20d3"><div class="ttname"><a href="classfolly_1_1JemallocHugePageAllocator.html#a46425c0d972bf479cdd0845ea43a20d3">folly::JemallocHugePageAllocator::hugePagesSupported</a></div><div class="ttdeci">static bool hugePagesSupported</div><div class="ttdef"><b>Definition:</b> <a href="JemallocHugePageAllocator_8h_source.html#l00084">JemallocHugePageAllocator.h:84</a></div></div>
<div class="ttc" id="MallocImpl_8cpp_html_a81872a5787f44cb4a30efd43d177ff66"><div class="ttname"><a href="MallocImpl_8cpp.html#a81872a5787f44cb4a30efd43d177ff66">rallocx</a></div><div class="ttdeci">void *(* rallocx)(void *, size_t, int)</div><div class="ttdef"><b>Definition:</b> <a href="MallocImpl_8cpp_source.html#l00036">MallocImpl.cpp:36</a></div></div>
<div class="ttc" id="classfolly_1_1JemallocHugePageAllocator_html_aa75f2f13de92bb0a8d2c5651eaa84e4c"><div class="ttname"><a href="classfolly_1_1JemallocHugePageAllocator.html#aa75f2f13de92bb0a8d2c5651eaa84e4c">folly::JemallocHugePageAllocator::flags_</a></div><div class="ttdeci">static int flags_</div><div class="ttdef"><b>Definition:</b> <a href="JemallocHugePageAllocator_8h_source.html#l00083">JemallocHugePageAllocator.h:83</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="aa75f2f13de92bb0a8d2c5651eaa84e4c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int folly::JemallocHugePageAllocator::flags_ {0}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="JemallocHugePageAllocator_8h_source.html#l00083">83</a> of file <a class="el" href="JemallocHugePageAllocator_8h_source.html">JemallocHugePageAllocator.h</a>.</p>

<p>Referenced by <a class="el" href="JemallocHugePageAllocator_8h_source.html#l00061">allocate()</a>, <a class="el" href="JemallocHugePageAllocator_8h_source.html#l00071">deallocate()</a>, <a class="el" href="JemallocHugePageAllocator_8h_source.html#l00075">initialized()</a>, and <a class="el" href="JemallocHugePageAllocator_8h_source.html#l00067">reallocate()</a>.</p>

</div>
</div>
<a class="anchor" id="a46425c0d972bf479cdd0845ea43a20d3"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool folly::JemallocHugePageAllocator::hugePagesSupported {false}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="JemallocHugePageAllocator_8h_source.html#l00084">84</a> of file <a class="el" href="JemallocHugePageAllocator_8h_source.html">JemallocHugePageAllocator.h</a>.</p>

<p>Referenced by <a class="el" href="JemallocHugePageAllocator_8h_source.html#l00061">allocate()</a>, <a class="el" href="JemallocHugePageAllocator_8h_source.html#l00071">deallocate()</a>, and <a class="el" href="JemallocHugePageAllocator_8h_source.html#l00067">reallocate()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>proxygen/folly/folly/experimental/<a class="el" href="JemallocHugePageAllocator_8h_source.html">JemallocHugePageAllocator.h</a></li>
<li>proxygen/folly/folly/experimental/<a class="el" href="JemallocHugePageAllocator_8cpp_source.html">JemallocHugePageAllocator.cpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacefolly.html">folly</a></li><li class="navelem"><a class="el" href="classfolly_1_1JemallocHugePageAllocator.html">JemallocHugePageAllocator</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
