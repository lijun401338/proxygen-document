<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>proxygen: proxygen/folly/folly/SingletonThreadLocal.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">proxygen
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('SingletonThreadLocal_8h.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#namespaces">Namespaces</a> &#124;
<a href="#define-members">Macros</a>  </div>
  <div class="headertitle">
<div class="title">SingletonThreadLocal.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;boost/intrusive/list.hpp&gt;</code><br />
<code>#include &lt;<a class="el" href="ScopeGuard_8h_source.html">folly/ScopeGuard.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="ThreadLocal_8h_source.html">folly/ThreadLocal.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="detail_2Singleton_8h_source.html">folly/detail/Singleton.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="Invoke_8h_source.html">folly/functional/Invoke.h</a>&gt;</code><br />
</div>
<p><a href="SingletonThreadLocal_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfolly_1_1SingletonThreadLocal.html">folly::SingletonThreadLocal&lt; T, Tag, Make, TLTag &gt;</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structfolly_1_1SingletonThreadLocal_1_1Node.html">folly::SingletonThreadLocal&lt; T, Tag, Make, TLTag &gt;::Node</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structfolly_1_1SingletonThreadLocal_1_1Wrapper.html">folly::SingletonThreadLocal&lt; T, Tag, Make, TLTag &gt;::Wrapper</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="namespaces"></a>
Namespaces</h2></td></tr>
<tr class="memitem:namespacefolly"><td class="memItemLeft" align="right" valign="top"> &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefolly.html">folly</a></td></tr>
<tr class="memdesc:namespacefolly"><td class="mdescLeft">&#160;</td><td class="mdescRight">&mdash;&mdash; Concurrent Priority <a class="el" href="classQueue.html">Queue</a> Implementation &mdash;&mdash; <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:afe0fe9e32457a74527c6e97a278c3fed"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="SingletonThreadLocal_8h.html#afe0fe9e32457a74527c6e97a278c3fed">FOLLY_DECLARE_REUSED</a>(<a class="el" href="folly_2folly_2experimental_2symbolizer_2SignalHandler_8cpp.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, ...)</td></tr>
<tr class="separator:afe0fe9e32457a74527c6e97a278c3fed"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="afe0fe9e32457a74527c6e97a278c3fed"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FOLLY_DECLARE_REUSED</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><a class="el" href="folly_2folly_2experimental_2symbolizer_2SignalHandler_8cpp.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>...</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line"><span class="keyword">struct </span>__folly_reused_type_##<a class="code" href="http__parser_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a> {                                          \</div><div class="line">    __VA_ARGS__ <a class="code" href="AtFork_8cpp.html#a077376d12464f945e2414d5499c79b3f">object</a>;                                                        \</div><div class="line">  };                                                                           \</div><div class="line">  auto&amp; <a class="code" href="http__parser_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a> =                                                                 <a class="code" href="classfolly_1_1SingletonThreadLocal.html#ae10d6fb6008666afb75dc91b5eb96de9">\</a></div><div class="line"><a class="code" href="classfolly_1_1SingletonThreadLocal.html#ae10d6fb6008666afb75dc91b5eb96de9">      ::folly::SingletonThreadLocal&lt;__folly_reused_type_##name&gt;::get</a>().object; \</div><div class="line">  auto __folly_reused_g_##<a class="code" href="http__parser_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a> = <a class="code" href="namespacefolly.html#a507704cb8cb20963bc6ef5a2f871ab2a">::folly::makeGuard</a>([&amp;] { <a class="code" href="http__parser_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>.clear(); })</div><div class="ttc" id="AtFork_8cpp_html_a077376d12464f945e2414d5499c79b3f"><div class="ttname"><a href="AtFork_8cpp.html#a077376d12464f945e2414d5499c79b3f">object</a></div><div class="ttdeci">void * object</div><div class="ttdef"><b>Definition:</b> <a href="AtFork_8cpp_source.html#l00032">AtFork.cpp:32</a></div></div>
<div class="ttc" id="http__parser_8c_html_a8f8f80d37794cde9472343e4487ba3eb"><div class="ttname"><a href="http__parser_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a></div><div class="ttdeci">const char * name</div><div class="ttdef"><b>Definition:</b> <a href="http__parser_8c_source.html#l00437">http_parser.c:437</a></div></div>
<div class="ttc" id="namespacefolly_html_a507704cb8cb20963bc6ef5a2f871ab2a"><div class="ttname"><a href="namespacefolly.html#a507704cb8cb20963bc6ef5a2f871ab2a">folly::makeGuard</a></div><div class="ttdeci">FOLLY_NODISCARD detail::ScopeGuardImplDecay&lt; F, true &gt; makeGuard(F &amp;&amp;f) noexcept(noexcept(detail::ScopeGuardImplDecay&lt; F, true &gt;(static_cast&lt; F &amp;&amp; &gt;(f))))</div><div class="ttdef"><b>Definition:</b> <a href="ScopeGuard_8h_source.html#l00184">ScopeGuard.h:184</a></div></div>
<div class="ttc" id="classfolly_1_1SingletonThreadLocal_html_ae10d6fb6008666afb75dc91b5eb96de9"><div class="ttname"><a href="classfolly_1_1SingletonThreadLocal.html#ae10d6fb6008666afb75dc91b5eb96de9">folly::SingletonThreadLocal::get</a></div><div class="ttdeci">FOLLY_EXPORT static FOLLY_ALWAYS_INLINE T &amp; get()</div><div class="ttdef"><b>Definition:</b> <a href="SingletonThreadLocal_8h_source.html#l00155">SingletonThreadLocal.h:155</a></div></div>
</div><!-- fragment --><p>FOLLY_DECLARE_REUSED</p>
<p>Useful for local variables of container types, where it is desired to avoid the overhead associated with the local variable entering and leaving scope. Rather, where it is desired that the memory be reused between invocations of the same scope in the same thread rather than deallocated and reallocated between invocations of the same scope in the same thread. Note that the container will always be cleared between invocations; it is only the backing memory allocation which is reused.</p>
<p>Example:</p>
<p>void traverse_perform(int root); template &lt;typename f&gt;=""&gt; void traverse_each_child_r(int root, F const&amp;); void traverse_depthwise(int root) { // preserves some of the memory backing these per-thread data structures <a class="el" href="SingletonThreadLocal_8h.html#afe0fe9e32457a74527c6e97a278c3fed">FOLLY_DECLARE_REUSED(seen, std::unordered_set&lt;int&gt;)</a>; <a class="el" href="SingletonThreadLocal_8h.html#afe0fe9e32457a74527c6e97a278c3fed">FOLLY_DECLARE_REUSED(work, std::vector&lt;int&gt;)</a>; // example algorithm that uses these per-thread data structures work.push_back(root); while (!work.<a class="el" href="namespacefolly.html#a689e45e870f8267348e24cea50d6877f">empty()</a>) { root = work.back(); work.pop_back(); seen.insert(root); traverse_perform(root); traverse_each_child_r(root, [&amp;](int item) { if (!seen.count(item)) { work.push_back(item); } }); } } </p>

<p>Definition at line <a class="el" href="SingletonThreadLocal_8h_source.html#l00205">205</a> of file <a class="el" href="SingletonThreadLocal_8h_source.html">SingletonThreadLocal.h</a>.</p>

<p>Referenced by <a class="el" href="SingletonThreadLocalTest_8cpp_source.html#l00143">TEST()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_d333e33cf903653326082c1f32e03be5.html">proxygen</a></li><li class="navelem"><a class="el" href="dir_32ce190710b1753ff87b781fbaae9b47.html">folly</a></li><li class="navelem"><a class="el" href="dir_dcf8e1233ba68571c5027662569cd1d9.html">folly</a></li><li class="navelem"><a class="el" href="SingletonThreadLocal_8h.html">SingletonThreadLocal.h</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
