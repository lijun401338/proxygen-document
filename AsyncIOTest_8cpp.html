<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>proxygen: proxygen/folly/folly/experimental/io/test/AsyncIOTest.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">proxygen
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('AsyncIOTest_8cpp.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">AsyncIOTest.cpp File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;<a class="el" href="AsyncIO_8h_source.html">folly/experimental/io/AsyncIO.h</a>&gt;</code><br />
<code>#include &lt;fcntl.h&gt;</code><br />
<code>#include &lt;sys/stat.h&gt;</code><br />
<code>#include &lt;sys/types.h&gt;</code><br />
<code>#include &lt;cstdio&gt;</code><br />
<code>#include &lt;cstdlib&gt;</code><br />
<code>#include &lt;memory&gt;</code><br />
<code>#include &lt;random&gt;</code><br />
<code>#include &lt;thread&gt;</code><br />
<code>#include &lt;vector&gt;</code><br />
<code>#include &lt;glog/logging.h&gt;</code><br />
<code>#include &lt;<a class="el" href="ScopeGuard_8h_source.html">folly/ScopeGuard.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="String_8h_source.html">folly/String.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="FsUtil_8h_source.html">folly/experimental/io/FsUtil.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="GTest_8h_source.html">folly/portability/GTest.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="Sockets_8h_source.html">folly/portability/Sockets.h</a>&gt;</code><br />
</div>
<p><a href="AsyncIOTest_8cpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aeb5145cc53df08229b33a68cdd3a7923"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="AsyncIOTest_8cpp.html#aeb5145cc53df08229b33a68cdd3a7923">TEST</a> (<a class="el" href="classfolly_1_1AsyncIO.html">AsyncIO</a>, ZeroAsyncDataNotPollable)</td></tr>
<tr class="separator:aeb5145cc53df08229b33a68cdd3a7923"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6bf58349b0d148a6ba3746e6008891d6"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="AsyncIOTest_8cpp.html#a6bf58349b0d148a6ba3746e6008891d6">TEST</a> (<a class="el" href="classfolly_1_1AsyncIO.html">AsyncIO</a>, ZeroAsyncDataPollable)</td></tr>
<tr class="separator:a6bf58349b0d148a6ba3746e6008891d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afb2485cb6de310e2bc93f4e739f89282"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="AsyncIOTest_8cpp.html#afb2485cb6de310e2bc93f4e739f89282">TEST</a> (<a class="el" href="classfolly_1_1AsyncIO.html">AsyncIO</a>, SingleAsyncDataNotPollable)</td></tr>
<tr class="separator:afb2485cb6de310e2bc93f4e739f89282"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a37dc48e6b9d23109a5bb5c2a496fc250"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="AsyncIOTest_8cpp.html#a37dc48e6b9d23109a5bb5c2a496fc250">TEST</a> (<a class="el" href="classfolly_1_1AsyncIO.html">AsyncIO</a>, SingleAsyncDataPollable)</td></tr>
<tr class="separator:a37dc48e6b9d23109a5bb5c2a496fc250"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a17c8db7cbfd8dc36b864e7967cd81ad1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="AsyncIOTest_8cpp.html#a17c8db7cbfd8dc36b864e7967cd81ad1">TEST</a> (<a class="el" href="classfolly_1_1AsyncIO.html">AsyncIO</a>, MultipleAsyncDataNotPollable)</td></tr>
<tr class="separator:a17c8db7cbfd8dc36b864e7967cd81ad1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae1e7b5e0437741317525b3c0a2215e9c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="AsyncIOTest_8cpp.html#ae1e7b5e0437741317525b3c0a2215e9c">TEST</a> (<a class="el" href="classfolly_1_1AsyncIO.html">AsyncIO</a>, MultipleAsyncDataPollable)</td></tr>
<tr class="separator:ae1e7b5e0437741317525b3c0a2215e9c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31a4a5761c23d661a137cf24196755b3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="AsyncIOTest_8cpp.html#a31a4a5761c23d661a137cf24196755b3">TEST</a> (<a class="el" href="classfolly_1_1AsyncIO.html">AsyncIO</a>, ManyAsyncDataNotPollable)</td></tr>
<tr class="separator:a31a4a5761c23d661a137cf24196755b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afed531bf3946046be642c1b910c22396"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="AsyncIOTest_8cpp.html#afed531bf3946046be642c1b910c22396">TEST</a> (<a class="el" href="classfolly_1_1AsyncIO.html">AsyncIO</a>, ManyAsyncDataPollable)</td></tr>
<tr class="separator:afed531bf3946046be642c1b910c22396"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af615711696066f8edfb609d920d2c28d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="AsyncIOTest_8cpp.html#af615711696066f8edfb609d920d2c28d">TEST</a> (<a class="el" href="classfolly_1_1AsyncIO.html">AsyncIO</a>, NonBlockingWait)</td></tr>
<tr class="separator:af615711696066f8edfb609d920d2c28d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c4fc0225c346fec0ea57a16722e83c7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="AsyncIOTest_8cpp.html#a8c4fc0225c346fec0ea57a16722e83c7">TEST</a> (<a class="el" href="classfolly_1_1AsyncIO.html">AsyncIO</a>, Cancel)</td></tr>
<tr class="separator:a8c4fc0225c346fec0ea57a16722e83c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="aeb5145cc53df08229b33a68cdd3a7923"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TEST </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfolly_1_1AsyncIO.html">AsyncIO</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ZeroAsyncDataNotPollable&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="AsyncIOTest_8cpp_source.html#l00290">290</a> of file <a class="el" href="AsyncIOTest_8cpp_source.html">AsyncIOTest.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;                                        {</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;  testReads({{0, 0}}, AsyncIO::NOT_POLLABLE);</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;}</div></div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a6bf58349b0d148a6ba3746e6008891d6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TEST </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfolly_1_1AsyncIO.html">AsyncIO</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ZeroAsyncDataPollable&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="AsyncIOTest_8cpp_source.html#l00294">294</a> of file <a class="el" href="AsyncIOTest_8cpp_source.html">AsyncIOTest.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;                                     {</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;  testReads({{0, 0}}, AsyncIO::POLLABLE);</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;}</div></div><!-- fragment -->
</div>
</div>
<a class="anchor" id="afb2485cb6de310e2bc93f4e739f89282"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TEST </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfolly_1_1AsyncIO.html">AsyncIO</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SingleAsyncDataNotPollable&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="AsyncIOTest_8cpp_source.html#l00298">298</a> of file <a class="el" href="AsyncIOTest_8cpp_source.html">AsyncIOTest.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;                                          {</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;  testReads({{0, kAlign}}, AsyncIO::NOT_POLLABLE);</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;  testReads({{0, kAlign}}, AsyncIO::NOT_POLLABLE);</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;}</div></div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a37dc48e6b9d23109a5bb5c2a496fc250"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TEST </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfolly_1_1AsyncIO.html">AsyncIO</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SingleAsyncDataPollable&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="AsyncIOTest_8cpp_source.html#l00303">303</a> of file <a class="el" href="AsyncIOTest_8cpp_source.html">AsyncIOTest.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                                       {</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;  testReads({{0, kAlign}}, AsyncIO::POLLABLE);</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;  testReads({{0, kAlign}}, AsyncIO::POLLABLE);</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;}</div></div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a17c8db7cbfd8dc36b864e7967cd81ad1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TEST </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfolly_1_1AsyncIO.html">AsyncIO</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">MultipleAsyncDataNotPollable&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="AsyncIOTest_8cpp_source.html#l00308">308</a> of file <a class="el" href="AsyncIOTest_8cpp_source.html">AsyncIOTest.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;                                            {</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;  testReads(</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;      {{kAlign, 2 * kAlign}, {kAlign, 2 * kAlign}, {kAlign, 4 * kAlign}},</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;      AsyncIO::NOT_POLLABLE);</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;  testReads(</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;      {{kAlign, 2 * kAlign}, {kAlign, 2 * kAlign}, {kAlign, 4 * kAlign}},</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;      AsyncIO::NOT_POLLABLE);</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;  testReads(</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;      {{0, 5 * 1024 * 1024}, {kAlign, 5 * 1024 * 1024}}, AsyncIO::NOT_POLLABLE);</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;  testReads(</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;      {</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;          {kAlign, 0},</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;          {kAlign, kAlign},</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;          {kAlign, 2 * kAlign},</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;          {kAlign, 20 * kAlign},</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;          {kAlign, 1024 * 1024},</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;      },</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;      AsyncIO::NOT_POLLABLE);</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;}</div></div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ae1e7b5e0437741317525b3c0a2215e9c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TEST </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfolly_1_1AsyncIO.html">AsyncIO</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">MultipleAsyncDataPollable&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="AsyncIOTest_8cpp_source.html#l00330">330</a> of file <a class="el" href="AsyncIOTest_8cpp_source.html">AsyncIOTest.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;                                         {</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;  testReads(</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;      {{kAlign, 2 * kAlign}, {kAlign, 2 * kAlign}, {kAlign, 4 * kAlign}},</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;      AsyncIO::POLLABLE);</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;  testReads(</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;      {{kAlign, 2 * kAlign}, {kAlign, 2 * kAlign}, {kAlign, 4 * kAlign}},</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;      AsyncIO::POLLABLE);</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;  testReads(</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;      {{0, 5 * 1024 * 1024}, {kAlign, 5 * 1024 * 1024}}, AsyncIO::NOT_POLLABLE);</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;  testReads(</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;      {</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;          {kAlign, 0},</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;          {kAlign, kAlign},</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;          {kAlign, 2 * kAlign},</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;          {kAlign, 20 * kAlign},</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;          {kAlign, 1024 * 1024},</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;      },</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;      AsyncIO::NOT_POLLABLE);</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;}</div></div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a31a4a5761c23d661a137cf24196755b3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TEST </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfolly_1_1AsyncIO.html">AsyncIO</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ManyAsyncDataNotPollable&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="AsyncIOTest_8cpp_source.html#l00352">352</a> of file <a class="el" href="AsyncIOTest_8cpp_source.html">AsyncIOTest.cpp</a>.</p>

<p>References <a class="el" href="fizz_2build___2gtest_2src_2gtest_2googletest_2test_2gtest__output__test__golden__lin_8txt_source.html#l00083">i</a>, and <a class="el" href="ParallelBenchmark_8cpp_source.html#l00084">v</a>.</p>
<div class="fragment"><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;                                        {</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;  {</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    std::vector&lt;TestSpec&gt; <a class="code" href="ParallelBenchmark_8cpp.html#a62448945ba9492b4ac991254a7d267bb">v</a>;</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="fizz_2build___2gtest_2src_2gtest_2googletest_2test_2gtest__output__test__golden__lin_8txt.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a> = 0; <a class="code" href="fizz_2build___2gtest_2src_2gtest_2googletest_2test_2gtest__output__test__golden__lin_8txt.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a> &lt; 1000; <a class="code" href="fizz_2build___2gtest_2src_2gtest_2googletest_2test_2gtest__output__test__golden__lin_8txt.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a>++) {</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;      v.push_back({off_t(kAlign * <a class="code" href="fizz_2build___2gtest_2src_2gtest_2googletest_2test_2gtest__output__test__golden__lin_8txt.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a>), kAlign});</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    }</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    testReads(v, AsyncIO::NOT_POLLABLE);</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;  }</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;}</div><div class="ttc" id="fizz_2build___2gtest_2src_2gtest_2googletest_2test_2gtest__output__test__golden__lin_8txt_html_a7e98b8a17c0aad30ba64d47b74e2a6c1"><div class="ttname"><a href="fizz_2build___2gtest_2src_2gtest_2googletest_2test_2gtest__output__test__golden__lin_8txt.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a></div><div class="ttdeci">i</div><div class="ttdef"><b>Definition:</b> <a href="fizz_2build___2gtest_2src_2gtest_2googletest_2test_2gtest__output__test__golden__lin_8txt_source.html#l00083">gtest_output_test_golden_lin.txt:83</a></div></div>
<div class="ttc" id="ParallelBenchmark_8cpp_html_a62448945ba9492b4ac991254a7d267bb"><div class="ttname"><a href="ParallelBenchmark_8cpp.html#a62448945ba9492b4ac991254a7d267bb">v</a></div><div class="ttdeci">auto v</div><div class="ttdef"><b>Definition:</b> <a href="ParallelBenchmark_8cpp_source.html#l00084">ParallelBenchmark.cpp:84</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="afed531bf3946046be642c1b910c22396"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TEST </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfolly_1_1AsyncIO.html">AsyncIO</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ManyAsyncDataPollable&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="AsyncIOTest_8cpp_source.html#l00362">362</a> of file <a class="el" href="AsyncIOTest_8cpp_source.html">AsyncIOTest.cpp</a>.</p>

<p>References <a class="el" href="fizz_2build___2gtest_2src_2gtest_2googletest_2test_2gtest__output__test__golden__lin_8txt_source.html#l00083">i</a>, and <a class="el" href="ParallelBenchmark_8cpp_source.html#l00084">v</a>.</p>
<div class="fragment"><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;                                     {</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;  {</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    std::vector&lt;TestSpec&gt; <a class="code" href="ParallelBenchmark_8cpp.html#a62448945ba9492b4ac991254a7d267bb">v</a>;</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="fizz_2build___2gtest_2src_2gtest_2googletest_2test_2gtest__output__test__golden__lin_8txt.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a> = 0; <a class="code" href="fizz_2build___2gtest_2src_2gtest_2googletest_2test_2gtest__output__test__golden__lin_8txt.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a> &lt; 1000; <a class="code" href="fizz_2build___2gtest_2src_2gtest_2googletest_2test_2gtest__output__test__golden__lin_8txt.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a>++) {</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;      v.push_back({off_t(kAlign * <a class="code" href="fizz_2build___2gtest_2src_2gtest_2googletest_2test_2gtest__output__test__golden__lin_8txt.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a>), kAlign});</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    }</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    testReads(v, AsyncIO::POLLABLE);</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;  }</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;}</div><div class="ttc" id="fizz_2build___2gtest_2src_2gtest_2googletest_2test_2gtest__output__test__golden__lin_8txt_html_a7e98b8a17c0aad30ba64d47b74e2a6c1"><div class="ttname"><a href="fizz_2build___2gtest_2src_2gtest_2googletest_2test_2gtest__output__test__golden__lin_8txt.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a></div><div class="ttdeci">i</div><div class="ttdef"><b>Definition:</b> <a href="fizz_2build___2gtest_2src_2gtest_2googletest_2test_2gtest__output__test__golden__lin_8txt_source.html#l00083">gtest_output_test_golden_lin.txt:83</a></div></div>
<div class="ttc" id="ParallelBenchmark_8cpp_html_a62448945ba9492b4ac991254a7d267bb"><div class="ttname"><a href="ParallelBenchmark_8cpp.html#a62448945ba9492b4ac991254a7d267bb">v</a></div><div class="ttdeci">auto v</div><div class="ttdef"><b>Definition:</b> <a href="ParallelBenchmark_8cpp_source.html#l00084">ParallelBenchmark.cpp:84</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="af615711696066f8edfb609d920d2c28d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TEST </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfolly_1_1AsyncIO.html">AsyncIO</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">NonBlockingWait&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="AsyncIOTest_8cpp_source.html#l00372">372</a> of file <a class="el" href="AsyncIOTest_8cpp_source.html">AsyncIOTest.cpp</a>.</p>

<p>References <a class="el" href="NetOps_8cpp_source.html#l00090">folly::netops::close()</a>, <a class="el" href="String_8cpp_source.html#l00463">folly::errnoStr()</a>, <a class="el" href="fizz_2build___2gtest_2src_2gtest_2googletest_2include_2gtest_2gtest_8h_source.html#l01922">EXPECT_EQ</a>, <a class="el" href="fizz_2build___2gtest_2src_2gtest_2googletest_2include_2gtest_2gtest_8h_source.html#l01928">EXPECT_LE</a>, <a class="el" href="fizz_2build___2gtest_2src_2gtest_2googletest_2include_2gtest_2gtest_8h_source.html#l01859">EXPECT_TRUE</a>, <a class="el" href="AsyncIO_8h_source.html#l00173">folly::AsyncIO::pending()</a>, <a class="el" href="ScopeGuard_8h_source.html#l00274">SCOPE_EXIT</a>, <a class="el" href="Access_8h_source.html#l00045">folly::size()</a>, <a class="el" href="AsyncIO_8cpp_source.html#l00164">folly::AsyncIO::submit()</a>, and <a class="el" href="AsyncIO_8cpp_source.html#l00189">folly::AsyncIO::wait()</a>.</p>
<div class="fragment"><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;                               {</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;  <a class="code" href="classfolly_1_1AsyncIO.html">AsyncIO</a> aioReader(1, AsyncIO::NOT_POLLABLE);</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;  <a class="code" href="namespacefolly_1_1detail_1_1function.html#ae6f93e257499e897fb9a10f6f9c30c2b">AsyncIO::Op</a> <a class="code" href="namespacefolly_1_1pushmi_1_1operators.html">op</a>;</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;  <span class="keywordtype">int</span> fd = ::open(tempFile.path().c_str(), O_DIRECT | O_RDONLY);</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;  PCHECK(fd != -1);</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;  <a class="code" href="ScopeGuard_8h.html#a175c354c3e38222bc00ce5df5e6d431d">SCOPE_EXIT</a> {</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    <a class="code" href="namespacefolly_1_1netops.html#a27d9201e6386937ffded3bfd86f995aa">::close</a>(fd);</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;  };</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;  <span class="keywordtype">size_t</span> <a class="code" href="namespacefolly.html#a0606ba855bcb96a1673880aa3b404993">size</a> = 2 * kAlign;</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;  <span class="keyword">auto</span> buf = allocateAligned(size);</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;  op.pread(fd, buf.get(), <a class="code" href="namespacefolly.html#a0606ba855bcb96a1673880aa3b404993">size</a>, 0);</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;  aioReader.submit(&amp;op);</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;  <a class="code" href="fizz_2build___2gtest_2src_2gtest_2googletest_2include_2gtest_2gtest_8h.html#a4159019abda84f5366acdb7604ff220a">EXPECT_EQ</a>(aioReader.pending(), 1);</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;  <a class="code" href="classfolly_1_1Range.html">folly::Range&lt;AsyncIO::Op**&gt;</a> completed;</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;  <span class="keywordflow">while</span> (completed.empty()) {</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    <span class="comment">// poll without blocking until the read request completes.</span></div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    completed = aioReader.wait(0);</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;  }</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;  <a class="code" href="fizz_2build___2gtest_2src_2gtest_2googletest_2include_2gtest_2gtest_8h.html#a4159019abda84f5366acdb7604ff220a">EXPECT_EQ</a>(completed.size(), 1);</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;  <a class="code" href="fizz_2build___2gtest_2src_2gtest_2googletest_2include_2gtest_2gtest_8h.html#ac33e7cdfb5d44a7a0f0ab552eb5c3c6a">EXPECT_TRUE</a>(completed[0] == &amp;op);</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;  ssize_t res = op.result();</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;  <a class="code" href="fizz_2build___2gtest_2src_2gtest_2googletest_2include_2gtest_2gtest_8h.html#ae0f265632323b4a07b585dcfde10f60a">EXPECT_LE</a>(0, res) &lt;&lt; <a class="code" href="namespacefolly.html#ad904a601e206bb84a84f7f68302ac92f">folly::errnoStr</a>(-res);</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;  <a class="code" href="fizz_2build___2gtest_2src_2gtest_2googletest_2include_2gtest_2gtest_8h.html#a4159019abda84f5366acdb7604ff220a">EXPECT_EQ</a>(size, res);</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;  <a class="code" href="fizz_2build___2gtest_2src_2gtest_2googletest_2include_2gtest_2gtest_8h.html#a4159019abda84f5366acdb7604ff220a">EXPECT_EQ</a>(aioReader.pending(), 0);</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;}</div><div class="ttc" id="fizz_2build___2gtest_2src_2gtest_2googletest_2include_2gtest_2gtest_8h_html_ae0f265632323b4a07b585dcfde10f60a"><div class="ttname"><a href="fizz_2build___2gtest_2src_2gtest_2googletest_2include_2gtest_2gtest_8h.html#ae0f265632323b4a07b585dcfde10f60a">EXPECT_LE</a></div><div class="ttdeci">#define EXPECT_LE(val1, val2)</div><div class="ttdef"><b>Definition:</b> <a href="fizz_2build___2gtest_2src_2gtest_2googletest_2include_2gtest_2gtest_8h_source.html#l01928">gtest.h:1928</a></div></div>
<div class="ttc" id="fizz_2build___2gtest_2src_2gtest_2googletest_2include_2gtest_2gtest_8h_html_a4159019abda84f5366acdb7604ff220a"><div class="ttname"><a href="fizz_2build___2gtest_2src_2gtest_2googletest_2include_2gtest_2gtest_8h.html#a4159019abda84f5366acdb7604ff220a">EXPECT_EQ</a></div><div class="ttdeci">#define EXPECT_EQ(val1, val2)</div><div class="ttdef"><b>Definition:</b> <a href="fizz_2build___2gtest_2src_2gtest_2googletest_2include_2gtest_2gtest_8h_source.html#l01922">gtest.h:1922</a></div></div>
<div class="ttc" id="ScopeGuard_8h_html_a175c354c3e38222bc00ce5df5e6d431d"><div class="ttname"><a href="ScopeGuard_8h.html#a175c354c3e38222bc00ce5df5e6d431d">SCOPE_EXIT</a></div><div class="ttdeci">#define SCOPE_EXIT</div><div class="ttdef"><b>Definition:</b> <a href="ScopeGuard_8h_source.html#l00274">ScopeGuard.h:274</a></div></div>
<div class="ttc" id="namespacefolly_html_a0606ba855bcb96a1673880aa3b404993"><div class="ttname"><a href="namespacefolly.html#a0606ba855bcb96a1673880aa3b404993">folly::size</a></div><div class="ttdeci">constexpr auto size(C const &amp;c) -&gt; decltype(c.size())</div><div class="ttdef"><b>Definition:</b> <a href="Access_8h_source.html#l00045">Access.h:45</a></div></div>
<div class="ttc" id="namespacefolly_1_1pushmi_1_1operators_html"><div class="ttname"><a href="namespacefolly_1_1pushmi_1_1operators.html">folly::pushmi::operators</a></div><div class="ttdef"><b>Definition:</b> <a href="bulk_8h_source.html#l00023">bulk.h:23</a></div></div>
<div class="ttc" id="classfolly_1_1AsyncIO_html"><div class="ttname"><a href="classfolly_1_1AsyncIO.html">folly::AsyncIO</a></div><div class="ttdef"><b>Definition:</b> <a href="AsyncIO_8h_source.html#l00125">AsyncIO.h:125</a></div></div>
<div class="ttc" id="classfolly_1_1Range_html"><div class="ttname"><a href="classfolly_1_1Range.html">folly::Range</a></div><div class="ttdef"><b>Definition:</b> <a href="ScopedEventBaseThread_8h_source.html#l00029">ScopedEventBaseThread.h:29</a></div></div>
<div class="ttc" id="namespacefolly_html_ad904a601e206bb84a84f7f68302ac92f"><div class="ttname"><a href="namespacefolly.html#ad904a601e206bb84a84f7f68302ac92f">folly::errnoStr</a></div><div class="ttdeci">fbstring errnoStr(int err)</div><div class="ttdef"><b>Definition:</b> <a href="String_8cpp_source.html#l00463">String.cpp:463</a></div></div>
<div class="ttc" id="fizz_2build___2gtest_2src_2gtest_2googletest_2include_2gtest_2gtest_8h_html_ac33e7cdfb5d44a7a0f0ab552eb5c3c6a"><div class="ttname"><a href="fizz_2build___2gtest_2src_2gtest_2googletest_2include_2gtest_2gtest_8h.html#ac33e7cdfb5d44a7a0f0ab552eb5c3c6a">EXPECT_TRUE</a></div><div class="ttdeci">#define EXPECT_TRUE(condition)</div><div class="ttdef"><b>Definition:</b> <a href="fizz_2build___2gtest_2src_2gtest_2googletest_2include_2gtest_2gtest_8h_source.html#l01859">gtest.h:1859</a></div></div>
<div class="ttc" id="namespacefolly_1_1netops_html_a27d9201e6386937ffded3bfd86f995aa"><div class="ttname"><a href="namespacefolly_1_1netops.html#a27d9201e6386937ffded3bfd86f995aa">folly::netops::close</a></div><div class="ttdeci">int close(NetworkSocket s)</div><div class="ttdef"><b>Definition:</b> <a href="NetOps_8cpp_source.html#l00090">NetOps.cpp:90</a></div></div>
<div class="ttc" id="namespacefolly_1_1detail_1_1function_html_ae6f93e257499e897fb9a10f6f9c30c2b"><div class="ttname"><a href="namespacefolly_1_1detail_1_1function.html#ae6f93e257499e897fb9a10f6f9c30c2b">folly::detail::function::Op</a></div><div class="ttdeci">Op</div><div class="ttdef"><b>Definition:</b> <a href="Function_8h_source.html#l00250">Function.h:250</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a8c4fc0225c346fec0ea57a16722e83c7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TEST </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfolly_1_1AsyncIO.html">AsyncIO</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Cancel&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="AsyncIOTest_8cpp_source.html#l00400">400</a> of file <a class="el" href="AsyncIOTest_8cpp_source.html">AsyncIOTest.cpp</a>.</p>

<p>References <a class="el" href="AsyncIO_8cpp_source.html#l00197">folly::AsyncIO::cancel()</a>, <a class="el" href="NetOps_8cpp_source.html#l00090">folly::netops::close()</a>, <a class="el" href="fizz_2build___2gtest_2src_2gtest_2googletest_2include_2gtest_2gtest_8h_source.html#l01922">EXPECT_EQ</a>, <a class="el" href="fizz_2build___2gtest_2src_2gtest_2googletest_2include_2gtest_2gtest_8h_source.html#l01932">EXPECT_GE</a>, <a class="el" href="fizz_2build___2gtest_2src_2gtest_2googletest_2include_2gtest_2gtest_8h_source.html#l01859">EXPECT_TRUE</a>, <a class="el" href="fizz_2build___2gtest_2src_2gtest_2googletest_2test_2gtest__output__test__golden__lin_8txt_source.html#l00083">i</a>, <a class="el" href="HazptrTest_8cpp_source.html#l01176">ops</a>, <a class="el" href="AsyncIO_8h_source.html#l00173">folly::AsyncIO::pending()</a>, <a class="el" href="ScopeGuard_8h_source.html#l00274">SCOPE_EXIT</a>, <a class="el" href="Access_8h_source.html#l00045">folly::size()</a>, <a class="el" href="AsyncIO_8cpp_source.html#l00164">folly::AsyncIO::submit()</a>, and <a class="el" href="AsyncIO_8cpp_source.html#l00189">folly::AsyncIO::wait()</a>.</p>
<div class="fragment"><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;                      {</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;  constexpr <span class="keywordtype">size_t</span> kNumOpsBatch1 = 10;</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;  constexpr <span class="keywordtype">size_t</span> kNumOpsBatch2 = 10;</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;  <a class="code" href="classfolly_1_1AsyncIO.html">AsyncIO</a> aioReader(kNumOpsBatch1 + kNumOpsBatch2, AsyncIO::NOT_POLLABLE);</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;  <span class="keywordtype">int</span> fd = ::open(tempFile.path().c_str(), O_DIRECT | O_RDONLY);</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;  PCHECK(fd != -1);</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;  <a class="code" href="ScopeGuard_8h.html#a175c354c3e38222bc00ce5df5e6d431d">SCOPE_EXIT</a> {</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    <a class="code" href="namespacefolly_1_1netops.html#a27d9201e6386937ffded3bfd86f995aa">::close</a>(fd);</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;  };</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;  <span class="keywordtype">size_t</span> completed = 0;</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;  std::vector&lt;std::unique_ptr&lt;AsyncIO::Op&gt;&gt; <a class="code" href="HazptrTest_8cpp.html#a54b1bfcf1a3e0f008eadeb3e72c8035a">ops</a>;</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;  std::vector&lt;ManagedBuffer&gt; bufs;</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span> schedule = [&amp;](<span class="keywordtype">size_t</span> n) {</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="fizz_2build___2gtest_2src_2gtest_2googletest_2test_2gtest__output__test__golden__lin_8txt.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a> = 0; <a class="code" href="fizz_2build___2gtest_2src_2gtest_2googletest_2test_2gtest__output__test__golden__lin_8txt.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a> &lt; n; ++<a class="code" href="fizz_2build___2gtest_2src_2gtest_2googletest_2test_2gtest__output__test__golden__lin_8txt.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a>) {</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">size_t</span> <a class="code" href="namespacefolly.html#a0606ba855bcb96a1673880aa3b404993">size</a> = 2 * kAlign;</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;      bufs.push_back(allocateAligned(size));</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;      ops.push_back(std::make_unique&lt;AsyncIO::Op&gt;());</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;      <span class="keyword">auto</span>&amp; <a class="code" href="namespacefolly_1_1pushmi_1_1operators.html">op</a> = *ops.back();</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;      <a class="code" href="namespacefolly_1_1pushmi_1_1operators.html">op</a>.setNotificationCallback([&amp;](<a class="code" href="classfolly_1_1AsyncIOOp.html">AsyncIOOp</a>*) { ++completed; });</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;      <a class="code" href="namespacefolly_1_1pushmi_1_1operators.html">op</a>.pread(fd, bufs.back().get(), <a class="code" href="namespacefolly.html#a0606ba855bcb96a1673880aa3b404993">size</a>, 0);</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;      aioReader.submit(&amp;<a class="code" href="namespacefolly_1_1pushmi_1_1operators.html">op</a>);</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    }</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;  };</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;  <span class="comment">// Mix completed and canceled operations for this test.</span></div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;  <span class="comment">// In order to achieve that, schedule in two batches and do partial</span></div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;  <span class="comment">// wait() after the first one.</span></div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;  schedule(kNumOpsBatch1);</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;  <a class="code" href="fizz_2build___2gtest_2src_2gtest_2googletest_2include_2gtest_2gtest_8h.html#a4159019abda84f5366acdb7604ff220a">EXPECT_EQ</a>(aioReader.pending(), kNumOpsBatch1);</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;  <a class="code" href="fizz_2build___2gtest_2src_2gtest_2googletest_2include_2gtest_2gtest_8h.html#a4159019abda84f5366acdb7604ff220a">EXPECT_EQ</a>(completed, 0);</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;  <span class="keyword">auto</span> result = aioReader.wait(1);</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;  <a class="code" href="fizz_2build___2gtest_2src_2gtest_2googletest_2include_2gtest_2gtest_8h.html#ab7a0ff4bfa4d9b27baa118d8b0756ca0">EXPECT_GE</a>(result.size(), 1);</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;  <a class="code" href="fizz_2build___2gtest_2src_2gtest_2googletest_2include_2gtest_2gtest_8h.html#a4159019abda84f5366acdb7604ff220a">EXPECT_EQ</a>(completed, result.size());</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;  <a class="code" href="fizz_2build___2gtest_2src_2gtest_2googletest_2include_2gtest_2gtest_8h.html#a4159019abda84f5366acdb7604ff220a">EXPECT_EQ</a>(aioReader.pending(), kNumOpsBatch1 - result.size());</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;  schedule(kNumOpsBatch2);</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;  <a class="code" href="fizz_2build___2gtest_2src_2gtest_2googletest_2include_2gtest_2gtest_8h.html#a4159019abda84f5366acdb7604ff220a">EXPECT_EQ</a>(aioReader.pending(), ops.size() - result.size());</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;  <a class="code" href="fizz_2build___2gtest_2src_2gtest_2googletest_2include_2gtest_2gtest_8h.html#a4159019abda84f5366acdb7604ff220a">EXPECT_EQ</a>(completed, result.size());</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;  <span class="keyword">auto</span> canceled = aioReader.cancel();</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;  <a class="code" href="fizz_2build___2gtest_2src_2gtest_2googletest_2include_2gtest_2gtest_8h.html#a4159019abda84f5366acdb7604ff220a">EXPECT_EQ</a>(canceled.size(), ops.size() - result.size());</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;  <a class="code" href="fizz_2build___2gtest_2src_2gtest_2googletest_2include_2gtest_2gtest_8h.html#a4159019abda84f5366acdb7604ff220a">EXPECT_EQ</a>(aioReader.pending(), 0);</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;  <a class="code" href="fizz_2build___2gtest_2src_2gtest_2googletest_2include_2gtest_2gtest_8h.html#a4159019abda84f5366acdb7604ff220a">EXPECT_EQ</a>(completed, result.size());</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;  <span class="keywordtype">size_t</span> foundCompleted = 0;</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; <a class="code" href="namespacefolly_1_1pushmi_1_1operators.html">op</a> : ops) {</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacefolly_1_1pushmi_1_1operators.html">op</a>-&gt;state() == AsyncIOOp::State::COMPLETED) {</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;      ++foundCompleted;</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;      <a class="code" href="fizz_2build___2gtest_2src_2gtest_2googletest_2include_2gtest_2gtest_8h.html#ac33e7cdfb5d44a7a0f0ab552eb5c3c6a">EXPECT_TRUE</a>(<a class="code" href="namespacefolly_1_1pushmi_1_1operators.html">op</a>-&gt;state() == AsyncIOOp::State::CANCELED) &lt;&lt; *<a class="code" href="namespacefolly_1_1pushmi_1_1operators.html">op</a>;</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    }</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;  }</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;  <a class="code" href="fizz_2build___2gtest_2src_2gtest_2googletest_2include_2gtest_2gtest_8h.html#a4159019abda84f5366acdb7604ff220a">EXPECT_EQ</a>(foundCompleted, completed);</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;}</div><div class="ttc" id="fizz_2build___2gtest_2src_2gtest_2googletest_2test_2gtest__output__test__golden__lin_8txt_html_a7e98b8a17c0aad30ba64d47b74e2a6c1"><div class="ttname"><a href="fizz_2build___2gtest_2src_2gtest_2googletest_2test_2gtest__output__test__golden__lin_8txt.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a></div><div class="ttdeci">i</div><div class="ttdef"><b>Definition:</b> <a href="fizz_2build___2gtest_2src_2gtest_2googletest_2test_2gtest__output__test__golden__lin_8txt_source.html#l00083">gtest_output_test_golden_lin.txt:83</a></div></div>
<div class="ttc" id="fizz_2build___2gtest_2src_2gtest_2googletest_2include_2gtest_2gtest_8h_html_a4159019abda84f5366acdb7604ff220a"><div class="ttname"><a href="fizz_2build___2gtest_2src_2gtest_2googletest_2include_2gtest_2gtest_8h.html#a4159019abda84f5366acdb7604ff220a">EXPECT_EQ</a></div><div class="ttdeci">#define EXPECT_EQ(val1, val2)</div><div class="ttdef"><b>Definition:</b> <a href="fizz_2build___2gtest_2src_2gtest_2googletest_2include_2gtest_2gtest_8h_source.html#l01922">gtest.h:1922</a></div></div>
<div class="ttc" id="ScopeGuard_8h_html_a175c354c3e38222bc00ce5df5e6d431d"><div class="ttname"><a href="ScopeGuard_8h.html#a175c354c3e38222bc00ce5df5e6d431d">SCOPE_EXIT</a></div><div class="ttdeci">#define SCOPE_EXIT</div><div class="ttdef"><b>Definition:</b> <a href="ScopeGuard_8h_source.html#l00274">ScopeGuard.h:274</a></div></div>
<div class="ttc" id="fizz_2build___2gtest_2src_2gtest_2googletest_2include_2gtest_2gtest_8h_html_ab7a0ff4bfa4d9b27baa118d8b0756ca0"><div class="ttname"><a href="fizz_2build___2gtest_2src_2gtest_2googletest_2include_2gtest_2gtest_8h.html#ab7a0ff4bfa4d9b27baa118d8b0756ca0">EXPECT_GE</a></div><div class="ttdeci">#define EXPECT_GE(val1, val2)</div><div class="ttdef"><b>Definition:</b> <a href="fizz_2build___2gtest_2src_2gtest_2googletest_2include_2gtest_2gtest_8h_source.html#l01932">gtest.h:1932</a></div></div>
<div class="ttc" id="classfolly_1_1AsyncIOOp_html"><div class="ttname"><a href="classfolly_1_1AsyncIOOp.html">folly::AsyncIOOp</a></div><div class="ttdef"><b>Definition:</b> <a href="AsyncIO_8h_source.html#l00045">AsyncIO.h:45</a></div></div>
<div class="ttc" id="namespacefolly_html_a0606ba855bcb96a1673880aa3b404993"><div class="ttname"><a href="namespacefolly.html#a0606ba855bcb96a1673880aa3b404993">folly::size</a></div><div class="ttdeci">constexpr auto size(C const &amp;c) -&gt; decltype(c.size())</div><div class="ttdef"><b>Definition:</b> <a href="Access_8h_source.html#l00045">Access.h:45</a></div></div>
<div class="ttc" id="namespacefolly_1_1pushmi_1_1operators_html"><div class="ttname"><a href="namespacefolly_1_1pushmi_1_1operators.html">folly::pushmi::operators</a></div><div class="ttdef"><b>Definition:</b> <a href="bulk_8h_source.html#l00023">bulk.h:23</a></div></div>
<div class="ttc" id="classfolly_1_1AsyncIO_html"><div class="ttname"><a href="classfolly_1_1AsyncIO.html">folly::AsyncIO</a></div><div class="ttdef"><b>Definition:</b> <a href="AsyncIO_8h_source.html#l00125">AsyncIO.h:125</a></div></div>
<div class="ttc" id="HazptrTest_8cpp_html_a54b1bfcf1a3e0f008eadeb3e72c8035a"><div class="ttname"><a href="HazptrTest_8cpp.html#a54b1bfcf1a3e0f008eadeb3e72c8035a">ops</a></div><div class="ttdeci">const int ops</div><div class="ttdef"><b>Definition:</b> <a href="HazptrTest_8cpp_source.html#l01176">HazptrTest.cpp:1176</a></div></div>
<div class="ttc" id="fizz_2build___2gtest_2src_2gtest_2googletest_2include_2gtest_2gtest_8h_html_ac33e7cdfb5d44a7a0f0ab552eb5c3c6a"><div class="ttname"><a href="fizz_2build___2gtest_2src_2gtest_2googletest_2include_2gtest_2gtest_8h.html#ac33e7cdfb5d44a7a0f0ab552eb5c3c6a">EXPECT_TRUE</a></div><div class="ttdeci">#define EXPECT_TRUE(condition)</div><div class="ttdef"><b>Definition:</b> <a href="fizz_2build___2gtest_2src_2gtest_2googletest_2include_2gtest_2gtest_8h_source.html#l01859">gtest.h:1859</a></div></div>
<div class="ttc" id="namespacefolly_1_1netops_html_a27d9201e6386937ffded3bfd86f995aa"><div class="ttname"><a href="namespacefolly_1_1netops.html#a27d9201e6386937ffded3bfd86f995aa">folly::netops::close</a></div><div class="ttdeci">int close(NetworkSocket s)</div><div class="ttdef"><b>Definition:</b> <a href="NetOps_8cpp_source.html#l00090">NetOps.cpp:90</a></div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_d333e33cf903653326082c1f32e03be5.html">proxygen</a></li><li class="navelem"><a class="el" href="dir_32ce190710b1753ff87b781fbaae9b47.html">folly</a></li><li class="navelem"><a class="el" href="dir_dcf8e1233ba68571c5027662569cd1d9.html">folly</a></li><li class="navelem"><a class="el" href="dir_81eb1dbd071cdd475d3d544204dd2893.html">experimental</a></li><li class="navelem"><a class="el" href="dir_c1ba351e7ab72af04f52d34b25a633ca.html">io</a></li><li class="navelem"><a class="el" href="dir_660fe920ac685360f298f93c1e8d3377.html">test</a></li><li class="navelem"><a class="el" href="AsyncIOTest_8cpp.html">AsyncIOTest.cpp</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
