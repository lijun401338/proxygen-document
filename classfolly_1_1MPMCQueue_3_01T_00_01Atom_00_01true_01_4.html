<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>proxygen: folly::MPMCQueue&lt; T, Atom, true &gt; Class Template Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">proxygen
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-types">Private Types</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="#friends">Friends</a> &#124;
<a href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">folly::MPMCQueue&lt; T, Atom, true &gt; Class Template Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="MPMCQueue_8h_source.html">MPMCQueue.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for folly::MPMCQueue&lt; T, Atom, true &gt;:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.png" usemap="#folly::MPMCQueue_3C_20T_2C_20Atom_2C_20true_20_3E_map" alt=""/>
  <map id="folly::MPMCQueue_3C_20T_2C_20Atom_2C_20true_20_3E_map" name="folly::MPMCQueue&lt; T, Atom, true &gt;_map">
<area href="classfolly_1_1detail_1_1MPMCQueueBase.html" alt="folly::detail::MPMCQueueBase&lt; MPMCQueue&lt; T, Atom, true &gt; &gt;" shape="rect" coords="0,0,383,24"/>
</map>
 </div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4_1_1ClosedArray.html">ClosedArray</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a74782acdd85c81c79618164df514da3e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#a74782acdd85c81c79618164df514da3e">MPMCQueue</a> (size_t queueCapacity)</td></tr>
<tr class="separator:a74782acdd85c81c79618164df514da3e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae486a5decd244594c03d6f5cbf86c47"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#aae486a5decd244594c03d6f5cbf86c47">MPMCQueue</a> (size_t queueCapacity, size_t minCapacity, size_t expansionMultiplier)</td></tr>
<tr class="separator:aae486a5decd244594c03d6f5cbf86c47"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0b668296e1a5fbfa8991caf76219417"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#aa0b668296e1a5fbfa8991caf76219417">MPMCQueue</a> () noexcept</td></tr>
<tr class="separator:aa0b668296e1a5fbfa8991caf76219417"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a354f8e3970b9f41da55f0c77bf4ab75f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#a354f8e3970b9f41da55f0c77bf4ab75f">MPMCQueue</a> (<a class="el" href="classfolly_1_1MPMCQueue.html">MPMCQueue</a>&lt; <a class="el" href="namespacefolly.html#a0652a9c51b69e7a13d40ccbcb139bc55">T</a>, <a class="el" href="ConcurrentHashMapTest_8cpp.html#a98ac53dd3c18b4046e7c5cb0bcb64b75">Atom</a>, true &gt; &amp;&amp;rhs) noexcept</td></tr>
<tr class="separator:a354f8e3970b9f41da55f0c77bf4ab75f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae985403661ae793c593ff08257cdc242"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfolly_1_1MPMCQueue.html">MPMCQueue</a>&lt; <a class="el" href="namespacefolly.html#a0652a9c51b69e7a13d40ccbcb139bc55">T</a>, <a class="el" href="ConcurrentHashMapTest_8cpp.html#a98ac53dd3c18b4046e7c5cb0bcb64b75">Atom</a>, true &gt; const &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#ae985403661ae793c593ff08257cdc242">operator=</a> (<a class="el" href="classfolly_1_1MPMCQueue.html">MPMCQueue</a>&lt; <a class="el" href="namespacefolly.html#a0652a9c51b69e7a13d40ccbcb139bc55">T</a>, <a class="el" href="ConcurrentHashMapTest_8cpp.html#a98ac53dd3c18b4046e7c5cb0bcb64b75">Atom</a>, true &gt; &amp;&amp;rhs)</td></tr>
<tr class="separator:ae985403661ae793c593ff08257cdc242"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4875b058225128653a88d18d1110529f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#a4875b058225128653a88d18d1110529f">~MPMCQueue</a> ()</td></tr>
<tr class="separator:a4875b058225128653a88d18d1110529f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9c1ed8c80365f0615faa4c291a40855c"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#a9c1ed8c80365f0615faa4c291a40855c">allocatedCapacity</a> () const noexcept</td></tr>
<tr class="separator:a9c1ed8c80365f0615faa4c291a40855c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa8ace83f74f91e59b23f17fb325660d"><td class="memTemplParams" colspan="2">template&lt;typename... Args&gt; </td></tr>
<tr class="memitem:afa8ace83f74f91e59b23f17fb325660d"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#afa8ace83f74f91e59b23f17fb325660d">blockingWrite</a> (Args &amp;&amp;...args) noexcept</td></tr>
<tr class="separator:afa8ace83f74f91e59b23f17fb325660d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab5a7134166b7365d0e445c75bff95f19"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#ab5a7134166b7365d0e445c75bff95f19">blockingReadWithTicket</a> (<a class="el" href="ConstexprMathBenchmark_8cpp.html#a5dc34568a989dd90728a4ed499cd9fab">uint64_t</a> &amp;<a class="el" href="TicketCodecTest_8cpp.html#a7093cc9e41a6fdad6b2f2aa9211604c6">ticket</a>, <a class="el" href="namespacefolly.html#a0652a9c51b69e7a13d40ccbcb139bc55">T</a> &amp;elem) noexcept</td></tr>
<tr class="separator:ab5a7134166b7365d0e445c75bff95f19"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-types"></a>
Private Types</h2></td></tr>
<tr class="memitem:ad5007737e7e398627738cb15d63e2315"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom">{ <a class="el" href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#ad5007737e7e398627738cb15d63e2315a9da77cfd3d7a49b60f0b968276a37e8d">kSeqlockBits</a> = 6, 
<a class="el" href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#ad5007737e7e398627738cb15d63e2315aba5edc6e9d80a3dd82f5d7016063f209">kDefaultMinDynamicCapacity</a> = 10, 
<a class="el" href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#ad5007737e7e398627738cb15d63e2315a6c2755abf5217ac110ec8d511f145654">kDefaultExpansionMultiplier</a> = 10
 }</td></tr>
<tr class="separator:ad5007737e7e398627738cb15d63e2315"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af3e6effcf6548f3217edcca9fe6c1840"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#af3e6effcf6548f3217edcca9fe6c1840">Slot</a> = <a class="el" href="structfolly_1_1detail_1_1SingleElementQueue.html">detail::SingleElementQueue</a>&lt; <a class="el" href="namespacefolly.html#a0652a9c51b69e7a13d40ccbcb139bc55">T</a>, <a class="el" href="ConcurrentHashMapTest_8cpp.html#a98ac53dd3c18b4046e7c5cb0bcb64b75">Atom</a> &gt;</td></tr>
<tr class="separator:af3e6effcf6548f3217edcca9fe6c1840"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a436d291a23ef37962c667a0014f37e6d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#a436d291a23ef37962c667a0014f37e6d">initQueue</a> (const size_t cap, const size_t mult)</td></tr>
<tr class="separator:a436d291a23ef37962c667a0014f37e6d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afb83fb386a8c555340179c1e604584b2"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#afb83fb386a8c555340179c1e604584b2">tryObtainReadyPushTicket</a> (<a class="el" href="ConstexprMathBenchmark_8cpp.html#a5dc34568a989dd90728a4ed499cd9fab">uint64_t</a> &amp;<a class="el" href="TicketCodecTest_8cpp.html#a7093cc9e41a6fdad6b2f2aa9211604c6">ticket</a>, <a class="el" href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#af3e6effcf6548f3217edcca9fe6c1840">Slot</a> *&amp;slots, size_t &amp;cap, int &amp;stride) noexcept</td></tr>
<tr class="separator:afb83fb386a8c555340179c1e604584b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abd463e7bf1bf11e404d017e1916a3740"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#abd463e7bf1bf11e404d017e1916a3740">tryObtainPromisedPushTicket</a> (<a class="el" href="ConstexprMathBenchmark_8cpp.html#a5dc34568a989dd90728a4ed499cd9fab">uint64_t</a> &amp;<a class="el" href="TicketCodecTest_8cpp.html#a7093cc9e41a6fdad6b2f2aa9211604c6">ticket</a>, <a class="el" href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#af3e6effcf6548f3217edcca9fe6c1840">Slot</a> *&amp;slots, size_t &amp;cap, int &amp;stride) noexcept</td></tr>
<tr class="separator:abd463e7bf1bf11e404d017e1916a3740"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa1e6354557919cd68eee2336835d113c"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#aa1e6354557919cd68eee2336835d113c">tryObtainReadyPopTicket</a> (<a class="el" href="ConstexprMathBenchmark_8cpp.html#a5dc34568a989dd90728a4ed499cd9fab">uint64_t</a> &amp;<a class="el" href="TicketCodecTest_8cpp.html#a7093cc9e41a6fdad6b2f2aa9211604c6">ticket</a>, <a class="el" href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#af3e6effcf6548f3217edcca9fe6c1840">Slot</a> *&amp;slots, size_t &amp;cap, int &amp;stride) noexcept</td></tr>
<tr class="separator:aa1e6354557919cd68eee2336835d113c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a16f8314a007111833472a92a68e92dc9"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#a16f8314a007111833472a92a68e92dc9">tryObtainPromisedPopTicket</a> (<a class="el" href="ConstexprMathBenchmark_8cpp.html#a5dc34568a989dd90728a4ed499cd9fab">uint64_t</a> &amp;<a class="el" href="TicketCodecTest_8cpp.html#a7093cc9e41a6fdad6b2f2aa9211604c6">ticket</a>, <a class="el" href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#af3e6effcf6548f3217edcca9fe6c1840">Slot</a> *&amp;slots, size_t &amp;cap, int &amp;stride) noexcept</td></tr>
<tr class="separator:a16f8314a007111833472a92a68e92dc9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5a69442c10f211d651aab676cae1c577"><td class="memTemplParams" colspan="2">template&lt;typename... Args&gt; </td></tr>
<tr class="memitem:a5a69442c10f211d651aab676cae1c577"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#a5a69442c10f211d651aab676cae1c577">enqueueWithTicket</a> (const <a class="el" href="ConstexprMathBenchmark_8cpp.html#a5dc34568a989dd90728a4ed499cd9fab">uint64_t</a> <a class="el" href="TicketCodecTest_8cpp.html#a7093cc9e41a6fdad6b2f2aa9211604c6">ticket</a>, Args &amp;&amp;...args) noexcept</td></tr>
<tr class="memdesc:a5a69442c10f211d651aab676cae1c577"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enqueues an element with a specific ticket number.  <a href="#a5a69442c10f211d651aab676cae1c577">More...</a><br /></td></tr>
<tr class="separator:a5a69442c10f211d651aab676cae1c577"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a00c26479126417f3851154d8c331a6f7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="ConstexprMathBenchmark_8cpp.html#a5dc34568a989dd90728a4ed499cd9fab">uint64_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#a00c26479126417f3851154d8c331a6f7">getOffset</a> (const <a class="el" href="ConstexprMathBenchmark_8cpp.html#a5dc34568a989dd90728a4ed499cd9fab">uint64_t</a> <a class="el" href="http__parser_8c.html#adc6e5733fc3c22f0a7b2914188c49c90">state</a>) const noexcept</td></tr>
<tr class="separator:a00c26479126417f3851154d8c331a6f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad196d671a16c02bfade4ee332f4bffb0"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#ad196d671a16c02bfade4ee332f4bffb0">getNumClosed</a> (const <a class="el" href="ConstexprMathBenchmark_8cpp.html#a5dc34568a989dd90728a4ed499cd9fab">uint64_t</a> <a class="el" href="http__parser_8c.html#adc6e5733fc3c22f0a7b2914188c49c90">state</a>) const noexcept</td></tr>
<tr class="separator:ad196d671a16c02bfade4ee332f4bffb0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adfdfdbea44e41365108d8ee6ac84cbbc"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#adfdfdbea44e41365108d8ee6ac84cbbc">tryExpand</a> (const <a class="el" href="ConstexprMathBenchmark_8cpp.html#a5dc34568a989dd90728a4ed499cd9fab">uint64_t</a> <a class="el" href="http__parser_8c.html#adc6e5733fc3c22f0a7b2914188c49c90">state</a>, const size_t cap) noexcept</td></tr>
<tr class="separator:adfdfdbea44e41365108d8ee6ac84cbbc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a839cd742d49e826c2f8b4a7c6fd5c1c3"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#a839cd742d49e826c2f8b4a7c6fd5c1c3">trySeqlockReadSection</a> (<a class="el" href="ConstexprMathBenchmark_8cpp.html#a5dc34568a989dd90728a4ed499cd9fab">uint64_t</a> &amp;<a class="el" href="http__parser_8c.html#adc6e5733fc3c22f0a7b2914188c49c90">state</a>, <a class="el" href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#af3e6effcf6548f3217edcca9fe6c1840">Slot</a> *&amp;slots, size_t &amp;cap, int &amp;stride) noexcept</td></tr>
<tr class="memdesc:a839cd742d49e826c2f8b4a7c6fd5c1c3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Seqlock read-only section.  <a href="#a839cd742d49e826c2f8b4a7c6fd5c1c3">More...</a><br /></td></tr>
<tr class="separator:a839cd742d49e826c2f8b4a7c6fd5c1c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa9ebb95aab00fa14883787135388a17"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#aaa9ebb95aab00fa14883787135388a17">maybeUpdateFromClosed</a> (const <a class="el" href="ConstexprMathBenchmark_8cpp.html#a5dc34568a989dd90728a4ed499cd9fab">uint64_t</a> <a class="el" href="http__parser_8c.html#adc6e5733fc3c22f0a7b2914188c49c90">state</a>, const <a class="el" href="ConstexprMathBenchmark_8cpp.html#a5dc34568a989dd90728a4ed499cd9fab">uint64_t</a> <a class="el" href="TicketCodecTest_8cpp.html#a7093cc9e41a6fdad6b2f2aa9211604c6">ticket</a>, <a class="el" href="ConstexprMathBenchmark_8cpp.html#a5dc34568a989dd90728a4ed499cd9fab">uint64_t</a> &amp;offset, <a class="el" href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#af3e6effcf6548f3217edcca9fe6c1840">Slot</a> *&amp;slots, size_t &amp;cap, int &amp;stride) noexcept</td></tr>
<tr class="separator:aaa9ebb95aab00fa14883787135388a17"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:aff7178738b1f3c951ec912dbdaa048f9"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#aff7178738b1f3c951ec912dbdaa048f9">dmult_</a></td></tr>
<tr class="separator:aff7178738b1f3c951ec912dbdaa048f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8390750198bd5e93adf9aa061442d518"><td class="memItemLeft" align="right" valign="top">ClosedArray *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#a8390750198bd5e93adf9aa061442d518">closed_</a></td></tr>
<tr class="separator:a8390750198bd5e93adf9aa061442d518"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="friends"></a>
Friends</h2></td></tr>
<tr class="memitem:a9dbb3bcaa4bcb2f29781db56e5c3ea64"><td class="memItemLeft" align="right" valign="top">class&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#a9dbb3bcaa4bcb2f29781db56e5c3ea64">detail::MPMCQueueBase&lt; MPMCQueue&lt; T, Atom, true &gt; &gt;</a></td></tr>
<tr class="separator:a9dbb3bcaa4bcb2f29781db56e5c3ea64"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><h3>template&lt;typename T, template&lt; typename &gt; class Atom&gt;<br />
class folly::MPMCQueue&lt; T, Atom, true &gt;</h3>

<p>The dynamic version of <a class="el" href="classfolly_1_1MPMCQueue.html">MPMCQueue</a> allows dynamic expansion of queue capacity, such that a queue may start with a smaller capacity than specified and expand only if needed. Users may optionally specify the initial capacity and the expansion multiplier.</p>
<p>The design uses a seqlock to enforce mutual exclusion among expansion attempts. Regular operations read up-to-date queue information (slots array, capacity, stride) inside read-only seqlock sections, which are unimpeded when no expansion is in progress.</p>
<p>An expansion computes a new capacity, allocates a new slots array, and updates stride. No information needs to be copied from the current slots array to the new one. When this happens, new slots will not have sequence numbers that match ticket numbers. The expansion needs to compute a ticket offset such that operations that use new arrays can adjust the calculations of slot indexes and sequence numbers that take into account that the new slots start with sequence numbers of zero. The current ticket offset is packed with the seqlock in an atomic 64-bit integer. The initial offset is zero.</p>
<p>Lagging write and read operations with tickets lower than the ticket offset of the current slots array (i.e., the minimum ticket number that can be served by the current array) must use earlier closed arrays instead of the current one. Information about closed slots arrays (array address, capacity, stride, and offset) is maintained in a logarithmic-sized structure. Each entry in that structure never needs to be changed once set. The number of closed arrays is half the value of the seqlock (when unlocked).</p>
<p>The acquisition of the seqlock to perform an expansion does not prevent the issuing of new push and pop tickets concurrently. The expansion must set the new ticket offset to a value that couldn't have been issued to an operation that has already gone through a seqlock read-only section (and hence obtained information for older closed arrays).</p>
<p>Note that the total queue capacity can temporarily exceed the specified capacity when there are lagging consumers that haven't yet consumed all the elements in closed arrays. Users should not rely on the capacity of dynamic queues for synchronization, e.g., they should not expect that a thread will definitely block on a call to <a class="el" href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#afa8ace83f74f91e59b23f17fb325660d">blockingWrite()</a> when the queue size is known to be equal to its capacity.</p>
<p>Note that some writeIfNotFull() and tryWriteUntil() operations may fail even if the size of the queue is less than its maximum capacity and despite the success of expansion, if the operation happens to acquire a ticket that belongs to a closed array. This is a transient condition. Typically, one or two ticket values may be subject to such condition per expansion.</p>
<p>The dynamic version is a partial specialization of <a class="el" href="classfolly_1_1MPMCQueue.html">MPMCQueue</a> with Dynamic == true </p>

<p>Definition at line <a class="el" href="MPMCQueue_8h_source.html#l00176">176</a> of file <a class="el" href="MPMCQueue_8h_source.html">MPMCQueue.h</a>.</p>
</div><h2 class="groupheader">Member Typedef Documentation</h2>
<a class="anchor" id="af3e6effcf6548f3217edcca9fe6c1840"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T , template&lt; typename &gt; class Atom&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="classfolly_1_1MPMCQueue.html">folly::MPMCQueue</a>&lt; <a class="el" href="namespacefolly.html#a0652a9c51b69e7a13d40ccbcb139bc55">T</a>, <a class="el" href="ConcurrentHashMapTest_8cpp.html#a98ac53dd3c18b4046e7c5cb0bcb64b75">Atom</a>, true &gt;::<a class="el" href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#af3e6effcf6548f3217edcca9fe6c1840">Slot</a> =  <a class="el" href="structfolly_1_1detail_1_1SingleElementQueue.html">detail::SingleElementQueue</a>&lt;<a class="el" href="namespacefolly.html#a0652a9c51b69e7a13d40ccbcb139bc55">T</a>, <a class="el" href="ConcurrentHashMapTest_8cpp.html#a98ac53dd3c18b4046e7c5cb0bcb64b75">Atom</a>&gt;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="MPMCQueue_8h_source.html#l00179">179</a> of file <a class="el" href="MPMCQueue_8h_source.html">MPMCQueue.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Enumeration Documentation</h2>
<a class="anchor" id="ad5007737e7e398627738cb15d63e2315"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T , template&lt; typename &gt; class Atom&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">anonymous enum</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a class="anchor" id="ad5007737e7e398627738cb15d63e2315a9da77cfd3d7a49b60f0b968276a37e8d"></a>kSeqlockBits&#160;</td><td class="fielddoc">
</td></tr>
<tr><td class="fieldname"><a class="anchor" id="ad5007737e7e398627738cb15d63e2315aba5edc6e9d80a3dd82f5d7016063f209"></a>kDefaultMinDynamicCapacity&#160;</td><td class="fielddoc">
</td></tr>
<tr><td class="fieldname"><a class="anchor" id="ad5007737e7e398627738cb15d63e2315a6c2755abf5217ac110ec8d511f145654"></a>kDefaultExpansionMultiplier&#160;</td><td class="fielddoc">
</td></tr>
</table>

<p>Definition at line <a class="el" href="MPMCQueue_8h_source.html#l00337">337</a> of file <a class="el" href="MPMCQueue_8h_source.html">MPMCQueue.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;       {</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    <a class="code" href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#ad5007737e7e398627738cb15d63e2315a9da77cfd3d7a49b60f0b968276a37e8d">kSeqlockBits</a> = 6,</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    <a class="code" href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#ad5007737e7e398627738cb15d63e2315aba5edc6e9d80a3dd82f5d7016063f209">kDefaultMinDynamicCapacity</a> = 10,</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    <a class="code" href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#ad5007737e7e398627738cb15d63e2315a6c2755abf5217ac110ec8d511f145654">kDefaultExpansionMultiplier</a> = 10,</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;  };</div><div class="ttc" id="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4_html_ad5007737e7e398627738cb15d63e2315aba5edc6e9d80a3dd82f5d7016063f209"><div class="ttname"><a href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#ad5007737e7e398627738cb15d63e2315aba5edc6e9d80a3dd82f5d7016063f209">folly::MPMCQueue&lt; T, Atom, true &gt;::kDefaultMinDynamicCapacity</a></div><div class="ttdef"><b>Definition:</b> <a href="MPMCQueue_8h_source.html#l00339">MPMCQueue.h:339</a></div></div>
<div class="ttc" id="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4_html_ad5007737e7e398627738cb15d63e2315a9da77cfd3d7a49b60f0b968276a37e8d"><div class="ttname"><a href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#ad5007737e7e398627738cb15d63e2315a9da77cfd3d7a49b60f0b968276a37e8d">folly::MPMCQueue&lt; T, Atom, true &gt;::kSeqlockBits</a></div><div class="ttdef"><b>Definition:</b> <a href="MPMCQueue_8h_source.html#l00338">MPMCQueue.h:338</a></div></div>
<div class="ttc" id="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4_html_ad5007737e7e398627738cb15d63e2315a6c2755abf5217ac110ec8d511f145654"><div class="ttname"><a href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#ad5007737e7e398627738cb15d63e2315a6c2755abf5217ac110ec8d511f145654">folly::MPMCQueue&lt; T, Atom, true &gt;::kDefaultExpansionMultiplier</a></div><div class="ttdef"><b>Definition:</b> <a href="MPMCQueue_8h_source.html#l00340">MPMCQueue.h:340</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a74782acdd85c81c79618164df514da3e"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T , template&lt; typename &gt; class Atom&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classfolly_1_1MPMCQueue.html">folly::MPMCQueue</a>&lt; <a class="el" href="namespacefolly.html#a0652a9c51b69e7a13d40ccbcb139bc55">T</a>, <a class="el" href="ConcurrentHashMapTest_8cpp.html#a98ac53dd3c18b4046e7c5cb0bcb64b75">Atom</a>, true &gt;::<a class="el" href="classfolly_1_1MPMCQueue.html">MPMCQueue</a> </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>queueCapacity</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">explicit</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="MPMCQueue_8h_source.html#l00189">189</a> of file <a class="el" href="MPMCQueue_8h_source.html">MPMCQueue.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;      : detail::MPMCQueueBase&lt;MPMCQueue&lt;T, Atom, true&gt;&gt;(queueCapacity) {</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <span class="keywordtype">size_t</span> cap = std::min&lt;size_t&gt;(<a class="code" href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#ad5007737e7e398627738cb15d63e2315aba5edc6e9d80a3dd82f5d7016063f209">kDefaultMinDynamicCapacity</a>, queueCapacity);</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <a class="code" href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#a436d291a23ef37962c667a0014f37e6d">initQueue</a>(cap, <a class="code" href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#ad5007737e7e398627738cb15d63e2315a6c2755abf5217ac110ec8d511f145654">kDefaultExpansionMultiplier</a>);</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  }</div><div class="ttc" id="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4_html_ad5007737e7e398627738cb15d63e2315aba5edc6e9d80a3dd82f5d7016063f209"><div class="ttname"><a href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#ad5007737e7e398627738cb15d63e2315aba5edc6e9d80a3dd82f5d7016063f209">folly::MPMCQueue&lt; T, Atom, true &gt;::kDefaultMinDynamicCapacity</a></div><div class="ttdef"><b>Definition:</b> <a href="MPMCQueue_8h_source.html#l00339">MPMCQueue.h:339</a></div></div>
<div class="ttc" id="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4_html_ad5007737e7e398627738cb15d63e2315a6c2755abf5217ac110ec8d511f145654"><div class="ttname"><a href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#ad5007737e7e398627738cb15d63e2315a6c2755abf5217ac110ec8d511f145654">folly::MPMCQueue&lt; T, Atom, true &gt;::kDefaultExpansionMultiplier</a></div><div class="ttdef"><b>Definition:</b> <a href="MPMCQueue_8h_source.html#l00340">MPMCQueue.h:340</a></div></div>
<div class="ttc" id="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4_html_a436d291a23ef37962c667a0014f37e6d"><div class="ttname"><a href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#a436d291a23ef37962c667a0014f37e6d">folly::MPMCQueue&lt; T, Atom, true &gt;::initQueue</a></div><div class="ttdeci">void initQueue(const size_t cap, const size_t mult)</div><div class="ttdef"><b>Definition:</b> <a href="MPMCQueue_8h_source.html#l00348">MPMCQueue.h:348</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aae486a5decd244594c03d6f5cbf86c47"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T , template&lt; typename &gt; class Atom&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classfolly_1_1MPMCQueue.html">folly::MPMCQueue</a>&lt; <a class="el" href="namespacefolly.html#a0652a9c51b69e7a13d40ccbcb139bc55">T</a>, <a class="el" href="ConcurrentHashMapTest_8cpp.html#a98ac53dd3c18b4046e7c5cb0bcb64b75">Atom</a>, true &gt;::<a class="el" href="classfolly_1_1MPMCQueue.html">MPMCQueue</a> </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>queueCapacity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>minCapacity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>expansionMultiplier</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">explicit</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="MPMCQueue_8h_source.html#l00195">195</a> of file <a class="el" href="MPMCQueue_8h_source.html">MPMCQueue.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;      : detail::MPMCQueueBase&lt;MPMCQueue&lt;T, Atom, true&gt;&gt;(queueCapacity) {</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    minCapacity = std::max&lt;size_t&gt;(1, minCapacity);</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <span class="keywordtype">size_t</span> cap = std::min&lt;size_t&gt;(minCapacity, queueCapacity);</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    expansionMultiplier = std::max&lt;size_t&gt;(2, expansionMultiplier);</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <a class="code" href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#a436d291a23ef37962c667a0014f37e6d">initQueue</a>(cap, expansionMultiplier);</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  }</div><div class="ttc" id="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4_html_a436d291a23ef37962c667a0014f37e6d"><div class="ttname"><a href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#a436d291a23ef37962c667a0014f37e6d">folly::MPMCQueue&lt; T, Atom, true &gt;::initQueue</a></div><div class="ttdeci">void initQueue(const size_t cap, const size_t mult)</div><div class="ttdef"><b>Definition:</b> <a href="MPMCQueue_8h_source.html#l00348">MPMCQueue.h:348</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aa0b668296e1a5fbfa8991caf76219417"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T , template&lt; typename &gt; class Atom&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classfolly_1_1MPMCQueue.html">folly::MPMCQueue</a>&lt; <a class="el" href="namespacefolly.html#a0652a9c51b69e7a13d40ccbcb139bc55">T</a>, <a class="el" href="ConcurrentHashMapTest_8cpp.html#a98ac53dd3c18b4046e7c5cb0bcb64b75">Atom</a>, true &gt;::<a class="el" href="classfolly_1_1MPMCQueue.html">MPMCQueue</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="MPMCQueue_8h_source.html#l00206">206</a> of file <a class="el" href="MPMCQueue_8h_source.html">MPMCQueue.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;                       {</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <a class="code" href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#aff7178738b1f3c951ec912dbdaa048f9">dmult_</a> = 0;</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <a class="code" href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#a8390750198bd5e93adf9aa061442d518">closed_</a> = <span class="keyword">nullptr</span>;</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  }</div><div class="ttc" id="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4_html_aff7178738b1f3c951ec912dbdaa048f9"><div class="ttname"><a href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#aff7178738b1f3c951ec912dbdaa048f9">folly::MPMCQueue&lt; T, Atom, true &gt;::dmult_</a></div><div class="ttdeci">size_t dmult_</div><div class="ttdef"><b>Definition:</b> <a href="MPMCQueue_8h_source.html#l00343">MPMCQueue.h:343</a></div></div>
<div class="ttc" id="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4_html_a8390750198bd5e93adf9aa061442d518"><div class="ttname"><a href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#a8390750198bd5e93adf9aa061442d518">folly::MPMCQueue&lt; T, Atom, true &gt;::closed_</a></div><div class="ttdeci">ClosedArray * closed_</div><div class="ttdef"><b>Definition:</b> <a href="MPMCQueue_8h_source.html#l00346">MPMCQueue.h:346</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a354f8e3970b9f41da55f0c77bf4ab75f"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T , template&lt; typename &gt; class Atom&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classfolly_1_1MPMCQueue.html">folly::MPMCQueue</a>&lt; <a class="el" href="namespacefolly.html#a0652a9c51b69e7a13d40ccbcb139bc55">T</a>, <a class="el" href="ConcurrentHashMapTest_8cpp.html#a98ac53dd3c18b4046e7c5cb0bcb64b75">Atom</a>, true &gt;::<a class="el" href="classfolly_1_1MPMCQueue.html">MPMCQueue</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfolly_1_1MPMCQueue.html">MPMCQueue</a>&lt; <a class="el" href="namespacefolly.html#a0652a9c51b69e7a13d40ccbcb139bc55">T</a>, <a class="el" href="ConcurrentHashMapTest_8cpp.html#a98ac53dd3c18b4046e7c5cb0bcb64b75">Atom</a>, true &gt; &amp;&amp;&#160;</td>
          <td class="paramname"><em>rhs</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="MPMCQueue_8h_source.html#l00211">211</a> of file <a class="el" href="MPMCQueue_8h_source.html">MPMCQueue.h</a>.</p>

<p>References <a class="el" href="Traits_8h_source.html#l00649">folly::detail::rhs</a>.</p>
<div class="fragment"><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;                                                     {</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    this-&gt;capacity_ = <a class="code" href="namespacefolly_1_1detail.html#a2dccd19efd4e58589c88f81f62bbf32e">rhs</a>.capacity_;</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <span class="keyword">new</span> (&amp;this-&gt;dslots_)</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        Atom&lt;Slot*&gt;(<a class="code" href="namespacefolly_1_1detail.html#a2dccd19efd4e58589c88f81f62bbf32e">rhs</a>.dslots_.load(std::memory_order_relaxed));</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <span class="keyword">new</span> (&amp;this-&gt;dstride_)</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        Atom&lt;int&gt;(<a class="code" href="namespacefolly_1_1detail.html#a2dccd19efd4e58589c88f81f62bbf32e">rhs</a>.dstride_.load(std::memory_order_relaxed));</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    this-&gt;dstate_.store(</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;        <a class="code" href="namespacefolly_1_1detail.html#a2dccd19efd4e58589c88f81f62bbf32e">rhs</a>.dstate_.load(std::memory_order_relaxed), std::memory_order_relaxed);</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    this-&gt;dcapacity_.store(</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;        <a class="code" href="namespacefolly_1_1detail.html#a2dccd19efd4e58589c88f81f62bbf32e">rhs</a>.dcapacity_.load(std::memory_order_relaxed),</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;        std::memory_order_relaxed);</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    this-&gt;pushTicket_.store(</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;        <a class="code" href="namespacefolly_1_1detail.html#a2dccd19efd4e58589c88f81f62bbf32e">rhs</a>.pushTicket_.load(std::memory_order_relaxed),</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        std::memory_order_relaxed);</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    this-&gt;popTicket_.store(</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        <a class="code" href="namespacefolly_1_1detail.html#a2dccd19efd4e58589c88f81f62bbf32e">rhs</a>.popTicket_.load(std::memory_order_relaxed),</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        std::memory_order_relaxed);</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    this-&gt;pushSpinCutoff_.store(</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;        <a class="code" href="namespacefolly_1_1detail.html#a2dccd19efd4e58589c88f81f62bbf32e">rhs</a>.pushSpinCutoff_.load(std::memory_order_relaxed),</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        std::memory_order_relaxed);</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    this-&gt;popSpinCutoff_.store(</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        <a class="code" href="namespacefolly_1_1detail.html#a2dccd19efd4e58589c88f81f62bbf32e">rhs</a>.popSpinCutoff_.load(std::memory_order_relaxed),</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;        std::memory_order_relaxed);</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <a class="code" href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#aff7178738b1f3c951ec912dbdaa048f9">dmult_</a> = <a class="code" href="namespacefolly_1_1detail.html#a2dccd19efd4e58589c88f81f62bbf32e">rhs</a>.dmult_;</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <a class="code" href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#a8390750198bd5e93adf9aa061442d518">closed_</a> = <a class="code" href="namespacefolly_1_1detail.html#a2dccd19efd4e58589c88f81f62bbf32e">rhs</a>.closed_;</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <a class="code" href="namespacefolly_1_1detail.html#a2dccd19efd4e58589c88f81f62bbf32e">rhs</a>.capacity_ = 0;</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <a class="code" href="namespacefolly_1_1detail.html#a2dccd19efd4e58589c88f81f62bbf32e">rhs</a>.dslots_.store(<span class="keyword">nullptr</span>, std::memory_order_relaxed);</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <a class="code" href="namespacefolly_1_1detail.html#a2dccd19efd4e58589c88f81f62bbf32e">rhs</a>.dstride_.store(0, std::memory_order_relaxed);</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <a class="code" href="namespacefolly_1_1detail.html#a2dccd19efd4e58589c88f81f62bbf32e">rhs</a>.dstate_.store(0, std::memory_order_relaxed);</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <a class="code" href="namespacefolly_1_1detail.html#a2dccd19efd4e58589c88f81f62bbf32e">rhs</a>.dcapacity_.store(0, std::memory_order_relaxed);</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <a class="code" href="namespacefolly_1_1detail.html#a2dccd19efd4e58589c88f81f62bbf32e">rhs</a>.pushTicket_.store(0, std::memory_order_relaxed);</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <a class="code" href="namespacefolly_1_1detail.html#a2dccd19efd4e58589c88f81f62bbf32e">rhs</a>.popTicket_.store(0, std::memory_order_relaxed);</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <a class="code" href="namespacefolly_1_1detail.html#a2dccd19efd4e58589c88f81f62bbf32e">rhs</a>.pushSpinCutoff_.store(0, std::memory_order_relaxed);</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <a class="code" href="namespacefolly_1_1detail.html#a2dccd19efd4e58589c88f81f62bbf32e">rhs</a>.popSpinCutoff_.store(0, std::memory_order_relaxed);</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <a class="code" href="namespacefolly_1_1detail.html#a2dccd19efd4e58589c88f81f62bbf32e">rhs</a>.dmult_ = 0;</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <a class="code" href="namespacefolly_1_1detail.html#a2dccd19efd4e58589c88f81f62bbf32e">rhs</a>.closed_ = <span class="keyword">nullptr</span>;</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;  }</div><div class="ttc" id="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4_html_aff7178738b1f3c951ec912dbdaa048f9"><div class="ttname"><a href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#aff7178738b1f3c951ec912dbdaa048f9">folly::MPMCQueue&lt; T, Atom, true &gt;::dmult_</a></div><div class="ttdeci">size_t dmult_</div><div class="ttdef"><b>Definition:</b> <a href="MPMCQueue_8h_source.html#l00343">MPMCQueue.h:343</a></div></div>
<div class="ttc" id="namespacefolly_1_1detail_html_a2dccd19efd4e58589c88f81f62bbf32e"><div class="ttname"><a href="namespacefolly_1_1detail.html#a2dccd19efd4e58589c88f81f62bbf32e">folly::detail::rhs</a></div><div class="ttdeci">FOLLY_PUSH_WARNING RHS rhs</div><div class="ttdef"><b>Definition:</b> <a href="Traits_8h_source.html#l00649">Traits.h:649</a></div></div>
<div class="ttc" id="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4_html_a8390750198bd5e93adf9aa061442d518"><div class="ttname"><a href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#a8390750198bd5e93adf9aa061442d518">folly::MPMCQueue&lt; T, Atom, true &gt;::closed_</a></div><div class="ttdeci">ClosedArray * closed_</div><div class="ttdef"><b>Definition:</b> <a href="MPMCQueue_8h_source.html#l00346">MPMCQueue.h:346</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a4875b058225128653a88d18d1110529f"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T , template&lt; typename &gt; class Atom&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classfolly_1_1MPMCQueue.html">folly::MPMCQueue</a>&lt; <a class="el" href="namespacefolly.html#a0652a9c51b69e7a13d40ccbcb139bc55">T</a>, <a class="el" href="ConcurrentHashMapTest_8cpp.html#a98ac53dd3c18b4046e7c5cb0bcb64b75">Atom</a>, true &gt;::~<a class="el" href="classfolly_1_1MPMCQueue.html">MPMCQueue</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="MPMCQueue_8h_source.html#l00258">258</a> of file <a class="el" href="MPMCQueue_8h_source.html">MPMCQueue.h</a>.</p>

<p>References <a class="el" href="fizz_2build___2gtest_2src_2gtest_2googletest_2test_2gtest__output__test__golden__lin_8txt_source.html#l00083">i</a>.</p>
<div class="fragment"><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;               {</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#a8390750198bd5e93adf9aa061442d518">closed_</a> != <span class="keyword">nullptr</span>) {</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="fizz_2build___2gtest_2src_2gtest_2googletest_2test_2gtest__output__test__golden__lin_8txt.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a> = <a class="code" href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#ad196d671a16c02bfade4ee332f4bffb0">getNumClosed</a>(this-&gt;dstate_.load()) - 1; <a class="code" href="fizz_2build___2gtest_2src_2gtest_2googletest_2test_2gtest__output__test__golden__lin_8txt.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a> &gt;= 0; --<a class="code" href="fizz_2build___2gtest_2src_2gtest_2googletest_2test_2gtest__output__test__golden__lin_8txt.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a>) {</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        <span class="keyword">delete</span>[] <a class="code" href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#a8390750198bd5e93adf9aa061442d518">closed_</a>[<a class="code" href="fizz_2build___2gtest_2src_2gtest_2googletest_2test_2gtest__output__test__golden__lin_8txt.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a>].<a class="code" href="structfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4_1_1ClosedArray.html#ae18ae99239acd91c28561490be587688">slots_</a>;</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;      }</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;      <span class="keyword">delete</span>[] <a class="code" href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#a8390750198bd5e93adf9aa061442d518">closed_</a>;</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    }</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <span class="keyword">using</span> AtomInt = Atom&lt;int&gt;;</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    this-&gt;dstride_.~AtomInt();</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <span class="keyword">using</span> AtomSlot = Atom&lt;Slot*&gt;;</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <span class="comment">// Sort of a hack to get ~MPMCQueueBase to free dslots_</span></div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <span class="keyword">auto</span> slots = this-&gt;dslots_.load();</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    this-&gt;dslots_.~AtomSlot();</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    this-&gt;slots_ = slots;</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;  }</div><div class="ttc" id="fizz_2build___2gtest_2src_2gtest_2googletest_2test_2gtest__output__test__golden__lin_8txt_html_a7e98b8a17c0aad30ba64d47b74e2a6c1"><div class="ttname"><a href="fizz_2build___2gtest_2src_2gtest_2googletest_2test_2gtest__output__test__golden__lin_8txt.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a></div><div class="ttdeci">i</div><div class="ttdef"><b>Definition:</b> <a href="fizz_2build___2gtest_2src_2gtest_2googletest_2test_2gtest__output__test__golden__lin_8txt_source.html#l00083">gtest_output_test_golden_lin.txt:83</a></div></div>
<div class="ttc" id="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4_html_a8390750198bd5e93adf9aa061442d518"><div class="ttname"><a href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#a8390750198bd5e93adf9aa061442d518">folly::MPMCQueue&lt; T, Atom, true &gt;::closed_</a></div><div class="ttdeci">ClosedArray * closed_</div><div class="ttdef"><b>Definition:</b> <a href="MPMCQueue_8h_source.html#l00346">MPMCQueue.h:346</a></div></div>
<div class="ttc" id="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4_html_ad196d671a16c02bfade4ee332f4bffb0"><div class="ttname"><a href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#ad196d671a16c02bfade4ee332f4bffb0">folly::MPMCQueue&lt; T, Atom, true &gt;::getNumClosed</a></div><div class="ttdeci">int getNumClosed(const uint64_t state) const noexcept</div><div class="ttdef"><b>Definition:</b> <a href="MPMCQueue_8h_source.html#l00533">MPMCQueue.h:533</a></div></div>
<div class="ttc" id="structfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4_1_1ClosedArray_html_ae18ae99239acd91c28561490be587688"><div class="ttname"><a href="structfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4_1_1ClosedArray.html#ae18ae99239acd91c28561490be587688">folly::MPMCQueue&lt; T, Atom, true &gt;::ClosedArray::slots_</a></div><div class="ttdeci">Slot * slots_</div><div class="ttdef"><b>Definition:</b> <a href="MPMCQueue_8h_source.html#l00183">MPMCQueue.h:183</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a9c1ed8c80365f0615faa4c291a40855c"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T , template&lt; typename &gt; class Atom&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">size_t <a class="el" href="classfolly_1_1MPMCQueue.html">folly::MPMCQueue</a>&lt; <a class="el" href="namespacefolly.html#a0652a9c51b69e7a13d40ccbcb139bc55">T</a>, <a class="el" href="ConcurrentHashMapTest_8cpp.html#a98ac53dd3c18b4046e7c5cb0bcb64b75">Atom</a>, true &gt;::allocatedCapacity </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="MPMCQueue_8h_source.html#l00274">274</a> of file <a class="el" href="MPMCQueue_8h_source.html">MPMCQueue.h</a>.</p>

<p>References <a class="el" href="fizz_2build___2gtest_2src_2gtest_2googlemock_2include_2gmock_2gmock-generated-matchers_8h_source.html#l00481">testing::Args()</a>.</p>
<div class="fragment"><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;                                            {</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    <span class="keywordflow">return</span> this-&gt;dcapacity_.load(std::memory_order_relaxed);</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;  }</div></div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ab5a7134166b7365d0e445c75bff95f19"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T , template&lt; typename &gt; class Atom&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classfolly_1_1MPMCQueue.html">folly::MPMCQueue</a>&lt; <a class="el" href="namespacefolly.html#a0652a9c51b69e7a13d40ccbcb139bc55">T</a>, <a class="el" href="ConcurrentHashMapTest_8cpp.html#a98ac53dd3c18b4046e7c5cb0bcb64b75">Atom</a>, true &gt;::blockingReadWithTicket </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ConstexprMathBenchmark_8cpp.html#a5dc34568a989dd90728a4ed499cd9fab">uint64_t</a> &amp;&#160;</td>
          <td class="paramname"><em>ticket</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacefolly.html#a0652a9c51b69e7a13d40ccbcb139bc55">T</a> &amp;&#160;</td>
          <td class="paramname"><em>elem</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="MPMCQueue_8h_source.html#l00320">320</a> of file <a class="el" href="MPMCQueue_8h_source.html">MPMCQueue.h</a>.</p>

<p>References <a class="el" href="Asm_8h_source.html#l00037">folly::asm_volatile_pause()</a>, <a class="el" href="Base-inl_8h_source.html#l02589">folly::gen::stride()</a>, <a class="el" href="TicketCodecTest_8cpp_source.html#l00021">ticket</a>, and <a class="el" href="ConstexprMathBenchmark_8cpp_source.html#l00190">uint64_t</a>.</p>
<div class="fragment"><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;                                                                  {</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    <a class="code" href="TicketCodecTest_8cpp.html#a7093cc9e41a6fdad6b2f2aa9211604c6">ticket</a> = this-&gt;popTicket_++;</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    <a class="code" href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#af3e6effcf6548f3217edcca9fe6c1840">Slot</a>* slots;</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    <span class="keywordtype">size_t</span> cap;</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="namespacefolly_1_1gen.html#aa36a13c6afb34e3e6f9fa5d337ea41de">stride</a>;</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    <a class="code" href="ConstexprMathBenchmark_8cpp.html#a5dc34568a989dd90728a4ed499cd9fab">uint64_t</a> <a class="code" href="http__parser_8c.html#adc6e5733fc3c22f0a7b2914188c49c90">state</a>;</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    <a class="code" href="ConstexprMathBenchmark_8cpp.html#a5dc34568a989dd90728a4ed499cd9fab">uint64_t</a> offset;</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    <span class="keywordflow">while</span> (!<a class="code" href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#a839cd742d49e826c2f8b4a7c6fd5c1c3">trySeqlockReadSection</a>(state, slots, cap, stride)) {</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;      <a class="code" href="namespacefolly.html#aaf13bc11e412f3e0899525ee0eef1443">asm_volatile_pause</a>();</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    }</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <span class="comment">// If there was an expansion after the corresponding push ticket</span></div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <span class="comment">// was issued, adjust accordingly</span></div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <a class="code" href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#aaa9ebb95aab00fa14883787135388a17">maybeUpdateFromClosed</a>(state, <a class="code" href="TicketCodecTest_8cpp.html#a7093cc9e41a6fdad6b2f2aa9211604c6">ticket</a>, offset, slots, cap, stride);</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    this-&gt;dequeueWithTicketBase(<a class="code" href="TicketCodecTest_8cpp.html#a7093cc9e41a6fdad6b2f2aa9211604c6">ticket</a> - offset, slots, cap, stride, elem);</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;  }</div><div class="ttc" id="TicketCodecTest_8cpp_html_a7093cc9e41a6fdad6b2f2aa9211604c6"><div class="ttname"><a href="TicketCodecTest_8cpp.html#a7093cc9e41a6fdad6b2f2aa9211604c6">ticket</a></div><div class="ttdeci">static constexpr StringPiece ticket</div><div class="ttdef"><b>Definition:</b> <a href="TicketCodecTest_8cpp_source.html#l00021">TicketCodecTest.cpp:21</a></div></div>
<div class="ttc" id="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4_html_af3e6effcf6548f3217edcca9fe6c1840"><div class="ttname"><a href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#af3e6effcf6548f3217edcca9fe6c1840">folly::MPMCQueue&lt; T, Atom, true &gt;::Slot</a></div><div class="ttdeci">detail::SingleElementQueue&lt; T, Atom &gt; Slot</div><div class="ttdef"><b>Definition:</b> <a href="MPMCQueue_8h_source.html#l00179">MPMCQueue.h:179</a></div></div>
<div class="ttc" id="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4_html_a839cd742d49e826c2f8b4a7c6fd5c1c3"><div class="ttname"><a href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#a839cd742d49e826c2f8b4a7c6fd5c1c3">folly::MPMCQueue&lt; T, Atom, true &gt;::trySeqlockReadSection</a></div><div class="ttdeci">bool trySeqlockReadSection(uint64_t &amp;state, Slot *&amp;slots, size_t &amp;cap, int &amp;stride) noexcept</div><div class="ttdoc">Seqlock read-only section. </div><div class="ttdef"><b>Definition:</b> <a href="MPMCQueue_8h_source.html#l00586">MPMCQueue.h:586</a></div></div>
<div class="ttc" id="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4_html_aaa9ebb95aab00fa14883787135388a17"><div class="ttname"><a href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#aaa9ebb95aab00fa14883787135388a17">folly::MPMCQueue&lt; T, Atom, true &gt;::maybeUpdateFromClosed</a></div><div class="ttdeci">bool maybeUpdateFromClosed(const uint64_t state, const uint64_t ticket, uint64_t &amp;offset, Slot *&amp;slots, size_t &amp;cap, int &amp;stride) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="MPMCQueue_8h_source.html#l00608">MPMCQueue.h:608</a></div></div>
<div class="ttc" id="ConstexprMathBenchmark_8cpp_html_a5dc34568a989dd90728a4ed499cd9fab"><div class="ttname"><a href="ConstexprMathBenchmark_8cpp.html#a5dc34568a989dd90728a4ed499cd9fab">uint64_t</a></div><div class="ttdeci">uint64_t</div><div class="ttdef"><b>Definition:</b> <a href="ConstexprMathBenchmark_8cpp_source.html#l00190">ConstexprMathBenchmark.cpp:190</a></div></div>
<div class="ttc" id="namespacefolly_1_1gen_html_aa36a13c6afb34e3e6f9fa5d337ea41de"><div class="ttname"><a href="namespacefolly_1_1gen.html#aa36a13c6afb34e3e6f9fa5d337ea41de">folly::gen::stride</a></div><div class="ttdeci">detail::Stride stride(size_t s)</div><div class="ttdef"><b>Definition:</b> <a href="Base-inl_8h_source.html#l02589">Base-inl.h:2589</a></div></div>
<div class="ttc" id="http__parser_8c_html_adc6e5733fc3c22f0a7b2914188c49c90"><div class="ttname"><a href="http__parser_8c.html#adc6e5733fc3c22f0a7b2914188c49c90">state</a></div><div class="ttdeci">state</div><div class="ttdef"><b>Definition:</b> <a href="http__parser_8c_source.html#l00272">http_parser.c:272</a></div></div>
<div class="ttc" id="namespacefolly_html_aaf13bc11e412f3e0899525ee0eef1443"><div class="ttname"><a href="namespacefolly.html#aaf13bc11e412f3e0899525ee0eef1443">folly::asm_volatile_pause</a></div><div class="ttdeci">void asm_volatile_pause()</div><div class="ttdef"><b>Definition:</b> <a href="Asm_8h_source.html#l00037">Asm.h:37</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="afa8ace83f74f91e59b23f17fb325660d"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T , template&lt; typename &gt; class Atom&gt; </div>
<div class="memtemplate">
template&lt;typename... Args&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classfolly_1_1MPMCQueue.html">folly::MPMCQueue</a>&lt; <a class="el" href="namespacefolly.html#a0652a9c51b69e7a13d40ccbcb139bc55">T</a>, <a class="el" href="ConcurrentHashMapTest_8cpp.html#a98ac53dd3c18b4046e7c5cb0bcb64b75">Atom</a>, true &gt;::blockingWrite </td>
          <td>(</td>
          <td class="paramtype">Args &amp;&amp;...&#160;</td>
          <td class="paramname"><em>args</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="MPMCQueue_8h_source.html#l00279">279</a> of file <a class="el" href="MPMCQueue_8h_source.html">MPMCQueue.h</a>.</p>

<p>References <a class="el" href="Asm_8h_source.html#l00037">folly::asm_volatile_pause()</a>, <a class="el" href="Base-inl_8h_source.html#l02589">folly::gen::stride()</a>, <a class="el" href="TicketCodecTest_8cpp_source.html#l00021">ticket</a>, and <a class="el" href="ConstexprMathBenchmark_8cpp_source.html#l00190">uint64_t</a>.</p>
<div class="fragment"><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;                                              {</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    <a class="code" href="ConstexprMathBenchmark_8cpp.html#a5dc34568a989dd90728a4ed499cd9fab">uint64_t</a> <a class="code" href="TicketCodecTest_8cpp.html#a7093cc9e41a6fdad6b2f2aa9211604c6">ticket</a> = this-&gt;pushTicket_++;</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    <a class="code" href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#af3e6effcf6548f3217edcca9fe6c1840">Slot</a>* slots;</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <span class="keywordtype">size_t</span> cap;</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="namespacefolly_1_1gen.html#aa36a13c6afb34e3e6f9fa5d337ea41de">stride</a>;</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <a class="code" href="ConstexprMathBenchmark_8cpp.html#a5dc34568a989dd90728a4ed499cd9fab">uint64_t</a> <a class="code" href="http__parser_8c.html#adc6e5733fc3c22f0a7b2914188c49c90">state</a>;</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <a class="code" href="ConstexprMathBenchmark_8cpp.html#a5dc34568a989dd90728a4ed499cd9fab">uint64_t</a> offset;</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <span class="keywordflow">do</span> {</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#a839cd742d49e826c2f8b4a7c6fd5c1c3">trySeqlockReadSection</a>(state, slots, cap, stride)) {</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;        <a class="code" href="namespacefolly.html#aaf13bc11e412f3e0899525ee0eef1443">asm_volatile_pause</a>();</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;      }</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#aaa9ebb95aab00fa14883787135388a17">maybeUpdateFromClosed</a>(state, ticket, offset, slots, cap, stride)) {</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;        <span class="comment">// There was an expansion after this ticket was issued.</span></div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;      }</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;      <span class="keywordflow">if</span> (slots[this-&gt;idx((ticket - offset), cap, stride)].mayEnqueue(</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;              this-&gt;turn(ticket - offset, cap))) {</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;        <span class="comment">// A slot is ready. No need to expand.</span></div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;          this-&gt;popTicket_.load(std::memory_order_relaxed) + cap &gt; <a class="code" href="TicketCodecTest_8cpp.html#a7093cc9e41a6fdad6b2f2aa9211604c6">ticket</a>) {</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        <span class="comment">// May block, but a pop is in progress. No need to expand.</span></div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;        <span class="comment">// Get seqlock read section info again in case an expansion</span></div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;        <span class="comment">// occurred with an equal or higher ticket.</span></div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;        <span class="comment">// May block. See if we can expand.</span></div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#adfdfdbea44e41365108d8ee6ac84cbbc">tryExpand</a>(state, cap)) {</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;          <span class="comment">// This or another thread started an expansion. Get updated info.</span></div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;          <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;          <span class="comment">// Can&#39;t expand.</span></div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;          <span class="keywordflow">break</span>;</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;        }</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;      }</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    } <span class="keywordflow">while</span> (<span class="keyword">true</span>);</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    this-&gt;enqueueWithTicketBase(</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;        ticket - offset, slots, cap, stride, std::forward&lt;Args&gt;(args)...);</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  }</div><div class="ttc" id="TicketCodecTest_8cpp_html_a7093cc9e41a6fdad6b2f2aa9211604c6"><div class="ttname"><a href="TicketCodecTest_8cpp.html#a7093cc9e41a6fdad6b2f2aa9211604c6">ticket</a></div><div class="ttdeci">static constexpr StringPiece ticket</div><div class="ttdef"><b>Definition:</b> <a href="TicketCodecTest_8cpp_source.html#l00021">TicketCodecTest.cpp:21</a></div></div>
<div class="ttc" id="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4_html_af3e6effcf6548f3217edcca9fe6c1840"><div class="ttname"><a href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#af3e6effcf6548f3217edcca9fe6c1840">folly::MPMCQueue&lt; T, Atom, true &gt;::Slot</a></div><div class="ttdeci">detail::SingleElementQueue&lt; T, Atom &gt; Slot</div><div class="ttdef"><b>Definition:</b> <a href="MPMCQueue_8h_source.html#l00179">MPMCQueue.h:179</a></div></div>
<div class="ttc" id="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4_html_a839cd742d49e826c2f8b4a7c6fd5c1c3"><div class="ttname"><a href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#a839cd742d49e826c2f8b4a7c6fd5c1c3">folly::MPMCQueue&lt; T, Atom, true &gt;::trySeqlockReadSection</a></div><div class="ttdeci">bool trySeqlockReadSection(uint64_t &amp;state, Slot *&amp;slots, size_t &amp;cap, int &amp;stride) noexcept</div><div class="ttdoc">Seqlock read-only section. </div><div class="ttdef"><b>Definition:</b> <a href="MPMCQueue_8h_source.html#l00586">MPMCQueue.h:586</a></div></div>
<div class="ttc" id="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4_html_adfdfdbea44e41365108d8ee6ac84cbbc"><div class="ttname"><a href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#adfdfdbea44e41365108d8ee6ac84cbbc">folly::MPMCQueue&lt; T, Atom, true &gt;::tryExpand</a></div><div class="ttdeci">bool tryExpand(const uint64_t state, const size_t cap) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="MPMCQueue_8h_source.html#l00541">MPMCQueue.h:541</a></div></div>
<div class="ttc" id="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4_html_aaa9ebb95aab00fa14883787135388a17"><div class="ttname"><a href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#aaa9ebb95aab00fa14883787135388a17">folly::MPMCQueue&lt; T, Atom, true &gt;::maybeUpdateFromClosed</a></div><div class="ttdeci">bool maybeUpdateFromClosed(const uint64_t state, const uint64_t ticket, uint64_t &amp;offset, Slot *&amp;slots, size_t &amp;cap, int &amp;stride) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="MPMCQueue_8h_source.html#l00608">MPMCQueue.h:608</a></div></div>
<div class="ttc" id="ConstexprMathBenchmark_8cpp_html_a5dc34568a989dd90728a4ed499cd9fab"><div class="ttname"><a href="ConstexprMathBenchmark_8cpp.html#a5dc34568a989dd90728a4ed499cd9fab">uint64_t</a></div><div class="ttdeci">uint64_t</div><div class="ttdef"><b>Definition:</b> <a href="ConstexprMathBenchmark_8cpp_source.html#l00190">ConstexprMathBenchmark.cpp:190</a></div></div>
<div class="ttc" id="namespacefolly_1_1gen_html_aa36a13c6afb34e3e6f9fa5d337ea41de"><div class="ttname"><a href="namespacefolly_1_1gen.html#aa36a13c6afb34e3e6f9fa5d337ea41de">folly::gen::stride</a></div><div class="ttdeci">detail::Stride stride(size_t s)</div><div class="ttdef"><b>Definition:</b> <a href="Base-inl_8h_source.html#l02589">Base-inl.h:2589</a></div></div>
<div class="ttc" id="http__parser_8c_html_adc6e5733fc3c22f0a7b2914188c49c90"><div class="ttname"><a href="http__parser_8c.html#adc6e5733fc3c22f0a7b2914188c49c90">state</a></div><div class="ttdeci">state</div><div class="ttdef"><b>Definition:</b> <a href="http__parser_8c_source.html#l00272">http_parser.c:272</a></div></div>
<div class="ttc" id="namespacefolly_html_aaf13bc11e412f3e0899525ee0eef1443"><div class="ttname"><a href="namespacefolly.html#aaf13bc11e412f3e0899525ee0eef1443">folly::asm_volatile_pause</a></div><div class="ttdeci">void asm_volatile_pause()</div><div class="ttdef"><b>Definition:</b> <a href="Asm_8h_source.html#l00037">Asm.h:37</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a5a69442c10f211d651aab676cae1c577"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T , template&lt; typename &gt; class Atom&gt; </div>
<div class="memtemplate">
template&lt;typename... Args&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classfolly_1_1MPMCQueue.html">folly::MPMCQueue</a>&lt; <a class="el" href="namespacefolly.html#a0652a9c51b69e7a13d40ccbcb139bc55">T</a>, <a class="el" href="ConcurrentHashMapTest_8cpp.html#a98ac53dd3c18b4046e7c5cb0bcb64b75">Atom</a>, true &gt;::enqueueWithTicket </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="ConstexprMathBenchmark_8cpp.html#a5dc34568a989dd90728a4ed499cd9fab">uint64_t</a>&#160;</td>
          <td class="paramname"><em>ticket</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Args &amp;&amp;...&#160;</td>
          <td class="paramname"><em>args</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Enqueues an element with a specific ticket number. </p>

<p>Definition at line <a class="el" href="MPMCQueue_8h_source.html#l00511">511</a> of file <a class="el" href="MPMCQueue_8h_source.html">MPMCQueue.h</a>.</p>

<p>References <a class="el" href="Base-inl_8h_source.html#l02589">folly::gen::stride()</a>, and <a class="el" href="ConstexprMathBenchmark_8cpp_source.html#l00190">uint64_t</a>.</p>
<div class="fragment"><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;                                                                         {</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    <a class="code" href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#af3e6effcf6548f3217edcca9fe6c1840">Slot</a>* slots;</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    <span class="keywordtype">size_t</span> cap;</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="namespacefolly_1_1gen.html#aa36a13c6afb34e3e6f9fa5d337ea41de">stride</a>;</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    <a class="code" href="ConstexprMathBenchmark_8cpp.html#a5dc34568a989dd90728a4ed499cd9fab">uint64_t</a> <a class="code" href="http__parser_8c.html#adc6e5733fc3c22f0a7b2914188c49c90">state</a>;</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    <a class="code" href="ConstexprMathBenchmark_8cpp.html#a5dc34568a989dd90728a4ed499cd9fab">uint64_t</a> offset;</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    <span class="keywordflow">while</span> (!<a class="code" href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#a839cd742d49e826c2f8b4a7c6fd5c1c3">trySeqlockReadSection</a>(state, slots, cap, stride)) {</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    }</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    <span class="comment">// If there was an expansion after this ticket was issued, adjust</span></div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    <span class="comment">// accordingly</span></div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    <a class="code" href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#aaa9ebb95aab00fa14883787135388a17">maybeUpdateFromClosed</a>(state, <a class="code" href="TicketCodecTest_8cpp.html#a7093cc9e41a6fdad6b2f2aa9211604c6">ticket</a>, offset, slots, cap, stride);</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    this-&gt;enqueueWithTicketBase(</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;        <a class="code" href="TicketCodecTest_8cpp.html#a7093cc9e41a6fdad6b2f2aa9211604c6">ticket</a> - offset, slots, cap, stride, std::forward&lt;Args&gt;(args)...);</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;  }</div><div class="ttc" id="TicketCodecTest_8cpp_html_a7093cc9e41a6fdad6b2f2aa9211604c6"><div class="ttname"><a href="TicketCodecTest_8cpp.html#a7093cc9e41a6fdad6b2f2aa9211604c6">ticket</a></div><div class="ttdeci">static constexpr StringPiece ticket</div><div class="ttdef"><b>Definition:</b> <a href="TicketCodecTest_8cpp_source.html#l00021">TicketCodecTest.cpp:21</a></div></div>
<div class="ttc" id="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4_html_af3e6effcf6548f3217edcca9fe6c1840"><div class="ttname"><a href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#af3e6effcf6548f3217edcca9fe6c1840">folly::MPMCQueue&lt; T, Atom, true &gt;::Slot</a></div><div class="ttdeci">detail::SingleElementQueue&lt; T, Atom &gt; Slot</div><div class="ttdef"><b>Definition:</b> <a href="MPMCQueue_8h_source.html#l00179">MPMCQueue.h:179</a></div></div>
<div class="ttc" id="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4_html_a839cd742d49e826c2f8b4a7c6fd5c1c3"><div class="ttname"><a href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#a839cd742d49e826c2f8b4a7c6fd5c1c3">folly::MPMCQueue&lt; T, Atom, true &gt;::trySeqlockReadSection</a></div><div class="ttdeci">bool trySeqlockReadSection(uint64_t &amp;state, Slot *&amp;slots, size_t &amp;cap, int &amp;stride) noexcept</div><div class="ttdoc">Seqlock read-only section. </div><div class="ttdef"><b>Definition:</b> <a href="MPMCQueue_8h_source.html#l00586">MPMCQueue.h:586</a></div></div>
<div class="ttc" id="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4_html_aaa9ebb95aab00fa14883787135388a17"><div class="ttname"><a href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#aaa9ebb95aab00fa14883787135388a17">folly::MPMCQueue&lt; T, Atom, true &gt;::maybeUpdateFromClosed</a></div><div class="ttdeci">bool maybeUpdateFromClosed(const uint64_t state, const uint64_t ticket, uint64_t &amp;offset, Slot *&amp;slots, size_t &amp;cap, int &amp;stride) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="MPMCQueue_8h_source.html#l00608">MPMCQueue.h:608</a></div></div>
<div class="ttc" id="ConstexprMathBenchmark_8cpp_html_a5dc34568a989dd90728a4ed499cd9fab"><div class="ttname"><a href="ConstexprMathBenchmark_8cpp.html#a5dc34568a989dd90728a4ed499cd9fab">uint64_t</a></div><div class="ttdeci">uint64_t</div><div class="ttdef"><b>Definition:</b> <a href="ConstexprMathBenchmark_8cpp_source.html#l00190">ConstexprMathBenchmark.cpp:190</a></div></div>
<div class="ttc" id="namespacefolly_1_1gen_html_aa36a13c6afb34e3e6f9fa5d337ea41de"><div class="ttname"><a href="namespacefolly_1_1gen.html#aa36a13c6afb34e3e6f9fa5d337ea41de">folly::gen::stride</a></div><div class="ttdeci">detail::Stride stride(size_t s)</div><div class="ttdef"><b>Definition:</b> <a href="Base-inl_8h_source.html#l02589">Base-inl.h:2589</a></div></div>
<div class="ttc" id="http__parser_8c_html_adc6e5733fc3c22f0a7b2914188c49c90"><div class="ttname"><a href="http__parser_8c.html#adc6e5733fc3c22f0a7b2914188c49c90">state</a></div><div class="ttdeci">state</div><div class="ttdef"><b>Definition:</b> <a href="http__parser_8c_source.html#l00272">http_parser.c:272</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ad196d671a16c02bfade4ee332f4bffb0"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T , template&lt; typename &gt; class Atom&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="classfolly_1_1MPMCQueue.html">folly::MPMCQueue</a>&lt; <a class="el" href="namespacefolly.html#a0652a9c51b69e7a13d40ccbcb139bc55">T</a>, <a class="el" href="ConcurrentHashMapTest_8cpp.html#a98ac53dd3c18b4046e7c5cb0bcb64b75">Atom</a>, true &gt;::getNumClosed </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="ConstexprMathBenchmark_8cpp.html#a5dc34568a989dd90728a4ed499cd9fab">uint64_t</a>&#160;</td>
          <td class="paramname"><em>state</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="MPMCQueue_8h_source.html#l00533">533</a> of file <a class="el" href="MPMCQueue_8h_source.html">MPMCQueue.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;                                                        {</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    <span class="keywordflow">return</span> (<a class="code" href="http__parser_8c.html#adc6e5733fc3c22f0a7b2914188c49c90">state</a> &amp; ((1 &lt;&lt; <a class="code" href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#ad5007737e7e398627738cb15d63e2315a9da77cfd3d7a49b60f0b968276a37e8d">kSeqlockBits</a>) - 1)) &gt;&gt; 1;</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;  }</div><div class="ttc" id="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4_html_ad5007737e7e398627738cb15d63e2315a9da77cfd3d7a49b60f0b968276a37e8d"><div class="ttname"><a href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#ad5007737e7e398627738cb15d63e2315a9da77cfd3d7a49b60f0b968276a37e8d">folly::MPMCQueue&lt; T, Atom, true &gt;::kSeqlockBits</a></div><div class="ttdef"><b>Definition:</b> <a href="MPMCQueue_8h_source.html#l00338">MPMCQueue.h:338</a></div></div>
<div class="ttc" id="http__parser_8c_html_adc6e5733fc3c22f0a7b2914188c49c90"><div class="ttname"><a href="http__parser_8c.html#adc6e5733fc3c22f0a7b2914188c49c90">state</a></div><div class="ttdeci">state</div><div class="ttdef"><b>Definition:</b> <a href="http__parser_8c_source.html#l00272">http_parser.c:272</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a00c26479126417f3851154d8c331a6f7"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T , template&lt; typename &gt; class Atom&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="ConstexprMathBenchmark_8cpp.html#a5dc34568a989dd90728a4ed499cd9fab">uint64_t</a> <a class="el" href="classfolly_1_1MPMCQueue.html">folly::MPMCQueue</a>&lt; <a class="el" href="namespacefolly.html#a0652a9c51b69e7a13d40ccbcb139bc55">T</a>, <a class="el" href="ConcurrentHashMapTest_8cpp.html#a98ac53dd3c18b4046e7c5cb0bcb64b75">Atom</a>, true &gt;::getOffset </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="ConstexprMathBenchmark_8cpp.html#a5dc34568a989dd90728a4ed499cd9fab">uint64_t</a>&#160;</td>
          <td class="paramname"><em>state</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="MPMCQueue_8h_source.html#l00529">529</a> of file <a class="el" href="MPMCQueue_8h_source.html">MPMCQueue.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;                                                          {</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="http__parser_8c.html#adc6e5733fc3c22f0a7b2914188c49c90">state</a> &gt;&gt; <a class="code" href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#ad5007737e7e398627738cb15d63e2315a9da77cfd3d7a49b60f0b968276a37e8d">kSeqlockBits</a>;</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;  }</div><div class="ttc" id="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4_html_ad5007737e7e398627738cb15d63e2315a9da77cfd3d7a49b60f0b968276a37e8d"><div class="ttname"><a href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#ad5007737e7e398627738cb15d63e2315a9da77cfd3d7a49b60f0b968276a37e8d">folly::MPMCQueue&lt; T, Atom, true &gt;::kSeqlockBits</a></div><div class="ttdef"><b>Definition:</b> <a href="MPMCQueue_8h_source.html#l00338">MPMCQueue.h:338</a></div></div>
<div class="ttc" id="http__parser_8c_html_adc6e5733fc3c22f0a7b2914188c49c90"><div class="ttname"><a href="http__parser_8c.html#adc6e5733fc3c22f0a7b2914188c49c90">state</a></div><div class="ttdeci">state</div><div class="ttdef"><b>Definition:</b> <a href="http__parser_8c_source.html#l00272">http_parser.c:272</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a436d291a23ef37962c667a0014f37e6d"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T , template&lt; typename &gt; class Atom&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classfolly_1_1MPMCQueue.html">folly::MPMCQueue</a>&lt; <a class="el" href="namespacefolly.html#a0652a9c51b69e7a13d40ccbcb139bc55">T</a>, <a class="el" href="ConcurrentHashMapTest_8cpp.html#a98ac53dd3c18b4046e7c5cb0bcb64b75">Atom</a>, true &gt;::initQueue </td>
          <td>(</td>
          <td class="paramtype">const size_t&#160;</td>
          <td class="paramname"><em>cap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const size_t&#160;</td>
          <td class="paramname"><em>mult</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="MPMCQueue_8h_source.html#l00348">348</a> of file <a class="el" href="MPMCQueue_8h_source.html">MPMCQueue.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;                                                      {</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    <span class="keyword">new</span> (&amp;this-&gt;dstride_) Atom&lt;int&gt;(this-&gt;computeStride(cap));</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    <a class="code" href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#af3e6effcf6548f3217edcca9fe6c1840">Slot</a>* slots = <span class="keyword">new</span> <a class="code" href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#af3e6effcf6548f3217edcca9fe6c1840">Slot</a>[cap + 2 * this-&gt;kSlotPadding];</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    <span class="keyword">new</span> (&amp;this-&gt;dslots_) Atom&lt;Slot*&gt;(slots);</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    this-&gt;dstate_.store(0);</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    this-&gt;dcapacity_.store(cap);</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    <a class="code" href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#aff7178738b1f3c951ec912dbdaa048f9">dmult_</a> = mult;</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    <span class="keywordtype">size_t</span> maxClosed = 0;</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> expanded = cap; expanded &lt; this-&gt;capacity_; expanded *= mult) {</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;      ++maxClosed;</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    }</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    <a class="code" href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#a8390750198bd5e93adf9aa061442d518">closed_</a> = (maxClosed &gt; 0) ? <span class="keyword">new</span> ClosedArray[maxClosed] : <span class="keyword">nullptr</span>;</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;  }</div><div class="ttc" id="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4_html_aff7178738b1f3c951ec912dbdaa048f9"><div class="ttname"><a href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#aff7178738b1f3c951ec912dbdaa048f9">folly::MPMCQueue&lt; T, Atom, true &gt;::dmult_</a></div><div class="ttdeci">size_t dmult_</div><div class="ttdef"><b>Definition:</b> <a href="MPMCQueue_8h_source.html#l00343">MPMCQueue.h:343</a></div></div>
<div class="ttc" id="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4_html_af3e6effcf6548f3217edcca9fe6c1840"><div class="ttname"><a href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#af3e6effcf6548f3217edcca9fe6c1840">folly::MPMCQueue&lt; T, Atom, true &gt;::Slot</a></div><div class="ttdeci">detail::SingleElementQueue&lt; T, Atom &gt; Slot</div><div class="ttdef"><b>Definition:</b> <a href="MPMCQueue_8h_source.html#l00179">MPMCQueue.h:179</a></div></div>
<div class="ttc" id="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4_html_a8390750198bd5e93adf9aa061442d518"><div class="ttname"><a href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#a8390750198bd5e93adf9aa061442d518">folly::MPMCQueue&lt; T, Atom, true &gt;::closed_</a></div><div class="ttdeci">ClosedArray * closed_</div><div class="ttdef"><b>Definition:</b> <a href="MPMCQueue_8h_source.html#l00346">MPMCQueue.h:346</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aaa9ebb95aab00fa14883787135388a17"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T , template&lt; typename &gt; class Atom&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classfolly_1_1MPMCQueue.html">folly::MPMCQueue</a>&lt; <a class="el" href="namespacefolly.html#a0652a9c51b69e7a13d40ccbcb139bc55">T</a>, <a class="el" href="ConcurrentHashMapTest_8cpp.html#a98ac53dd3c18b4046e7c5cb0bcb64b75">Atom</a>, true &gt;::maybeUpdateFromClosed </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="ConstexprMathBenchmark_8cpp.html#a5dc34568a989dd90728a4ed499cd9fab">uint64_t</a>&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="ConstexprMathBenchmark_8cpp.html#a5dc34568a989dd90728a4ed499cd9fab">uint64_t</a>&#160;</td>
          <td class="paramname"><em>ticket</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ConstexprMathBenchmark_8cpp.html#a5dc34568a989dd90728a4ed499cd9fab">uint64_t</a> &amp;&#160;</td>
          <td class="paramname"><em>offset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#af3e6effcf6548f3217edcca9fe6c1840">Slot</a> *&amp;&#160;</td>
          <td class="paramname"><em>slots</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t &amp;&#160;</td>
          <td class="paramname"><em>cap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;&#160;</td>
          <td class="paramname"><em>stride</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>If there was an expansion after ticket was issued, update local variables of the lagging operation using the most recent closed array with offset &lt;= ticket and return true. Otherwise, return false; </p>

<p>Definition at line <a class="el" href="MPMCQueue_8h_source.html#l00608">608</a> of file <a class="el" href="MPMCQueue_8h_source.html">MPMCQueue.h</a>.</p>

<p>References <a class="el" href="ConcurrentHashMapTest_8cpp_source.html#l00301">Atom</a>, <a class="el" href="fizz_2build___2gtest_2src_2gtest_2googletest_2test_2gtest__output__test__golden__lin_8txt_source.html#l00083">i</a>, <a class="el" href="Base-inl_8h_source.html#l02589">folly::gen::stride()</a>, and <a class="el" href="TicketCodecTest_8cpp_source.html#l00021">ticket</a>.</p>
<div class="fragment"><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;                            {</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;    offset = <a class="code" href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#a00c26479126417f3851154d8c331a6f7">getOffset</a>(<a class="code" href="http__parser_8c.html#adc6e5733fc3c22f0a7b2914188c49c90">state</a>);</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="TicketCodecTest_8cpp.html#a7093cc9e41a6fdad6b2f2aa9211604c6">ticket</a> &gt;= offset) {</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;    }</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="fizz_2build___2gtest_2src_2gtest_2googletest_2test_2gtest__output__test__golden__lin_8txt.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a> = <a class="code" href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#ad196d671a16c02bfade4ee332f4bffb0">getNumClosed</a>(<a class="code" href="http__parser_8c.html#adc6e5733fc3c22f0a7b2914188c49c90">state</a>) - 1; <a class="code" href="fizz_2build___2gtest_2src_2gtest_2googletest_2test_2gtest__output__test__golden__lin_8txt.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a> &gt;= 0; --<a class="code" href="fizz_2build___2gtest_2src_2gtest_2googletest_2test_2gtest__output__test__golden__lin_8txt.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a>) {</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;      offset = <a class="code" href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#a8390750198bd5e93adf9aa061442d518">closed_</a>[<a class="code" href="fizz_2build___2gtest_2src_2gtest_2googletest_2test_2gtest__output__test__golden__lin_8txt.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a>].<a class="code" href="structfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4_1_1ClosedArray.html#a25162c6d133a00685dfbfd21ae0338cd">offset_</a>;</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;      <span class="keywordflow">if</span> (offset &lt;= <a class="code" href="TicketCodecTest_8cpp.html#a7093cc9e41a6fdad6b2f2aa9211604c6">ticket</a>) {</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;        slots = <a class="code" href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#a8390750198bd5e93adf9aa061442d518">closed_</a>[<a class="code" href="fizz_2build___2gtest_2src_2gtest_2googletest_2test_2gtest__output__test__golden__lin_8txt.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a>].<a class="code" href="structfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4_1_1ClosedArray.html#ae18ae99239acd91c28561490be587688">slots_</a>;</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;        cap = <a class="code" href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#a8390750198bd5e93adf9aa061442d518">closed_</a>[<a class="code" href="fizz_2build___2gtest_2src_2gtest_2googletest_2test_2gtest__output__test__golden__lin_8txt.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a>].<a class="code" href="structfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4_1_1ClosedArray.html#a30acd43e8e0e0e409359ee26e6656c06">capacity_</a>;</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;        <a class="code" href="namespacefolly_1_1gen.html#aa36a13c6afb34e3e6f9fa5d337ea41de">stride</a> = <a class="code" href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#a8390750198bd5e93adf9aa061442d518">closed_</a>[<a class="code" href="fizz_2build___2gtest_2src_2gtest_2googletest_2test_2gtest__output__test__golden__lin_8txt.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a>].<a class="code" href="structfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4_1_1ClosedArray.html#ab8b52887883184a05e73049838e4a4a9">stride_</a>;</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;      }</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;    }</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;    <span class="comment">// A closed array with offset &lt;= ticket should have been found</span></div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;    assert(<span class="keyword">false</span>);</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;  }</div><div class="ttc" id="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4_html_a00c26479126417f3851154d8c331a6f7"><div class="ttname"><a href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#a00c26479126417f3851154d8c331a6f7">folly::MPMCQueue&lt; T, Atom, true &gt;::getOffset</a></div><div class="ttdeci">uint64_t getOffset(const uint64_t state) const noexcept</div><div class="ttdef"><b>Definition:</b> <a href="MPMCQueue_8h_source.html#l00529">MPMCQueue.h:529</a></div></div>
<div class="ttc" id="fizz_2build___2gtest_2src_2gtest_2googletest_2test_2gtest__output__test__golden__lin_8txt_html_a7e98b8a17c0aad30ba64d47b74e2a6c1"><div class="ttname"><a href="fizz_2build___2gtest_2src_2gtest_2googletest_2test_2gtest__output__test__golden__lin_8txt.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a></div><div class="ttdeci">i</div><div class="ttdef"><b>Definition:</b> <a href="fizz_2build___2gtest_2src_2gtest_2googletest_2test_2gtest__output__test__golden__lin_8txt_source.html#l00083">gtest_output_test_golden_lin.txt:83</a></div></div>
<div class="ttc" id="structfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4_1_1ClosedArray_html_a25162c6d133a00685dfbfd21ae0338cd"><div class="ttname"><a href="structfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4_1_1ClosedArray.html#a25162c6d133a00685dfbfd21ae0338cd">folly::MPMCQueue&lt; T, Atom, true &gt;::ClosedArray::offset_</a></div><div class="ttdeci">uint64_t offset_</div><div class="ttdef"><b>Definition:</b> <a href="MPMCQueue_8h_source.html#l00182">MPMCQueue.h:182</a></div></div>
<div class="ttc" id="TicketCodecTest_8cpp_html_a7093cc9e41a6fdad6b2f2aa9211604c6"><div class="ttname"><a href="TicketCodecTest_8cpp.html#a7093cc9e41a6fdad6b2f2aa9211604c6">ticket</a></div><div class="ttdeci">static constexpr StringPiece ticket</div><div class="ttdef"><b>Definition:</b> <a href="TicketCodecTest_8cpp_source.html#l00021">TicketCodecTest.cpp:21</a></div></div>
<div class="ttc" id="structfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4_1_1ClosedArray_html_a30acd43e8e0e0e409359ee26e6656c06"><div class="ttname"><a href="structfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4_1_1ClosedArray.html#a30acd43e8e0e0e409359ee26e6656c06">folly::MPMCQueue&lt; T, Atom, true &gt;::ClosedArray::capacity_</a></div><div class="ttdeci">size_t capacity_</div><div class="ttdef"><b>Definition:</b> <a href="MPMCQueue_8h_source.html#l00184">MPMCQueue.h:184</a></div></div>
<div class="ttc" id="structfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4_1_1ClosedArray_html_ab8b52887883184a05e73049838e4a4a9"><div class="ttname"><a href="structfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4_1_1ClosedArray.html#ab8b52887883184a05e73049838e4a4a9">folly::MPMCQueue&lt; T, Atom, true &gt;::ClosedArray::stride_</a></div><div class="ttdeci">int stride_</div><div class="ttdef"><b>Definition:</b> <a href="MPMCQueue_8h_source.html#l00185">MPMCQueue.h:185</a></div></div>
<div class="ttc" id="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4_html_a8390750198bd5e93adf9aa061442d518"><div class="ttname"><a href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#a8390750198bd5e93adf9aa061442d518">folly::MPMCQueue&lt; T, Atom, true &gt;::closed_</a></div><div class="ttdeci">ClosedArray * closed_</div><div class="ttdef"><b>Definition:</b> <a href="MPMCQueue_8h_source.html#l00346">MPMCQueue.h:346</a></div></div>
<div class="ttc" id="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4_html_ad196d671a16c02bfade4ee332f4bffb0"><div class="ttname"><a href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#ad196d671a16c02bfade4ee332f4bffb0">folly::MPMCQueue&lt; T, Atom, true &gt;::getNumClosed</a></div><div class="ttdeci">int getNumClosed(const uint64_t state) const noexcept</div><div class="ttdef"><b>Definition:</b> <a href="MPMCQueue_8h_source.html#l00533">MPMCQueue.h:533</a></div></div>
<div class="ttc" id="namespacefolly_1_1gen_html_aa36a13c6afb34e3e6f9fa5d337ea41de"><div class="ttname"><a href="namespacefolly_1_1gen.html#aa36a13c6afb34e3e6f9fa5d337ea41de">folly::gen::stride</a></div><div class="ttdeci">detail::Stride stride(size_t s)</div><div class="ttdef"><b>Definition:</b> <a href="Base-inl_8h_source.html#l02589">Base-inl.h:2589</a></div></div>
<div class="ttc" id="http__parser_8c_html_adc6e5733fc3c22f0a7b2914188c49c90"><div class="ttname"><a href="http__parser_8c.html#adc6e5733fc3c22f0a7b2914188c49c90">state</a></div><div class="ttdeci">state</div><div class="ttdef"><b>Definition:</b> <a href="http__parser_8c_source.html#l00272">http_parser.c:272</a></div></div>
<div class="ttc" id="structfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4_1_1ClosedArray_html_ae18ae99239acd91c28561490be587688"><div class="ttname"><a href="structfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4_1_1ClosedArray.html#ae18ae99239acd91c28561490be587688">folly::MPMCQueue&lt; T, Atom, true &gt;::ClosedArray::slots_</a></div><div class="ttdeci">Slot * slots_</div><div class="ttdef"><b>Definition:</b> <a href="MPMCQueue_8h_source.html#l00183">MPMCQueue.h:183</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ae985403661ae793c593ff08257cdc242"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T , template&lt; typename &gt; class Atom&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classfolly_1_1MPMCQueue.html">MPMCQueue</a>&lt;<a class="el" href="namespacefolly.html#a0652a9c51b69e7a13d40ccbcb139bc55">T</a>, <a class="el" href="ConcurrentHashMapTest_8cpp.html#a98ac53dd3c18b4046e7c5cb0bcb64b75">Atom</a>, true&gt; const&amp; <a class="el" href="classfolly_1_1MPMCQueue.html">folly::MPMCQueue</a>&lt; <a class="el" href="namespacefolly.html#a0652a9c51b69e7a13d40ccbcb139bc55">T</a>, <a class="el" href="ConcurrentHashMapTest_8cpp.html#a98ac53dd3c18b4046e7c5cb0bcb64b75">Atom</a>, true &gt;::operator= </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfolly_1_1MPMCQueue.html">MPMCQueue</a>&lt; <a class="el" href="namespacefolly.html#a0652a9c51b69e7a13d40ccbcb139bc55">T</a>, <a class="el" href="ConcurrentHashMapTest_8cpp.html#a98ac53dd3c18b4046e7c5cb0bcb64b75">Atom</a>, true &gt; &amp;&amp;&#160;</td>
          <td class="paramname"><em>rhs</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="MPMCQueue_8h_source.html#l00250">250</a> of file <a class="el" href="MPMCQueue_8h_source.html">MPMCQueue.h</a>.</p>

<p>References <a class="el" href="Base-inl_8h_source.html#l02567">folly::gen::move</a>, and <a class="el" href="Traits_8h_source.html#l00649">folly::detail::rhs</a>.</p>
<div class="fragment"><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;                                                                            {</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">this</span> != &amp;<a class="code" href="namespacefolly_1_1detail.html#a2dccd19efd4e58589c88f81f62bbf32e">rhs</a>) {</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;      this-&gt;<a class="code" href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#a4875b058225128653a88d18d1110529f">~MPMCQueue</a>();</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;      <span class="keyword">new</span> (<span class="keyword">this</span>) <a class="code" href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#aa0b668296e1a5fbfa8991caf76219417">MPMCQueue</a>(<a class="code" href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">std::move</a>(<a class="code" href="namespacefolly_1_1detail.html#a2dccd19efd4e58589c88f81f62bbf32e">rhs</a>));</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    }</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;  }</div><div class="ttc" id="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4_html_a4875b058225128653a88d18d1110529f"><div class="ttname"><a href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#a4875b058225128653a88d18d1110529f">folly::MPMCQueue&lt; T, Atom, true &gt;::~MPMCQueue</a></div><div class="ttdeci">~MPMCQueue()</div><div class="ttdef"><b>Definition:</b> <a href="MPMCQueue_8h_source.html#l00258">MPMCQueue.h:258</a></div></div>
<div class="ttc" id="namespacefolly_1_1gen_html_ac24ec252b1b738a40c274285527c193f"><div class="ttname"><a href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">folly::gen::move</a></div><div class="ttdeci">constexpr detail::Map&lt; Move &gt; move</div><div class="ttdef"><b>Definition:</b> <a href="Base-inl_8h_source.html#l02567">Base-inl.h:2567</a></div></div>
<div class="ttc" id="namespacefolly_1_1detail_html_a2dccd19efd4e58589c88f81f62bbf32e"><div class="ttname"><a href="namespacefolly_1_1detail.html#a2dccd19efd4e58589c88f81f62bbf32e">folly::detail::rhs</a></div><div class="ttdeci">FOLLY_PUSH_WARNING RHS rhs</div><div class="ttdef"><b>Definition:</b> <a href="Traits_8h_source.html#l00649">Traits.h:649</a></div></div>
<div class="ttc" id="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4_html_aa0b668296e1a5fbfa8991caf76219417"><div class="ttname"><a href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#aa0b668296e1a5fbfa8991caf76219417">folly::MPMCQueue&lt; T, Atom, true &gt;::MPMCQueue</a></div><div class="ttdeci">MPMCQueue() noexcept</div><div class="ttdef"><b>Definition:</b> <a href="MPMCQueue_8h_source.html#l00206">MPMCQueue.h:206</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="adfdfdbea44e41365108d8ee6ac84cbbc"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T , template&lt; typename &gt; class Atom&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classfolly_1_1MPMCQueue.html">folly::MPMCQueue</a>&lt; <a class="el" href="namespacefolly.html#a0652a9c51b69e7a13d40ccbcb139bc55">T</a>, <a class="el" href="ConcurrentHashMapTest_8cpp.html#a98ac53dd3c18b4046e7c5cb0bcb64b75">Atom</a>, true &gt;::tryExpand </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="ConstexprMathBenchmark_8cpp.html#a5dc34568a989dd90728a4ed499cd9fab">uint64_t</a>&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const size_t&#160;</td>
          <td class="paramname"><em>cap</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p><a class="el" href="classfolly_1_1Try.html">Try</a> to expand the queue. Returns true if this expansion was successful or a concurent expansion is in progress. Returns false if the queue has reached its maximum capacity or allocation has failed. </p>

<p>Definition at line <a class="el" href="MPMCQueue_8h_source.html#l00541">541</a> of file <a class="el" href="MPMCQueue_8h_source.html">MPMCQueue.h</a>.</p>

<p>References <a class="el" href="LogLevel_8cpp_source.html#l00031">max</a>, <a class="el" href="LogLevel_8cpp_source.html#l00030">min</a>, <a class="el" href="TicketCodecTest_8cpp_source.html#l00021">ticket</a>, and <a class="el" href="ConstexprMathBenchmark_8cpp_source.html#l00190">uint64_t</a>.</p>
<div class="fragment"><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;                                                                  {</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    <span class="keywordflow">if</span> (cap == this-&gt;capacity_) {</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    }</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    <span class="comment">// Acquire seqlock</span></div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    <a class="code" href="ConstexprMathBenchmark_8cpp.html#a5dc34568a989dd90728a4ed499cd9fab">uint64_t</a> oldval = <a class="code" href="http__parser_8c.html#adc6e5733fc3c22f0a7b2914188c49c90">state</a>;</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    assert((<a class="code" href="http__parser_8c.html#adc6e5733fc3c22f0a7b2914188c49c90">state</a> &amp; 1) == 0);</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    <span class="keywordflow">if</span> (this-&gt;dstate_.compare_exchange_strong(oldval, <a class="code" href="http__parser_8c.html#adc6e5733fc3c22f0a7b2914188c49c90">state</a> + 1)) {</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;      assert(cap == this-&gt;dcapacity_.load());</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;      <a class="code" href="ConstexprMathBenchmark_8cpp.html#a5dc34568a989dd90728a4ed499cd9fab">uint64_t</a> <a class="code" href="TicketCodecTest_8cpp.html#a7093cc9e41a6fdad6b2f2aa9211604c6">ticket</a> =</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;          1 + <a class="code" href="LogLevel_8cpp.html#a15c8b90f03cae068a6979f32590642e2">std::max</a>(this-&gt;pushTicket_.load(), this-&gt;popTicket_.load());</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;      <span class="keywordtype">size_t</span> newCapacity = <a class="code" href="LogLevel_8cpp.html#a7361901234703a521a82885405734c53">std::min</a>(<a class="code" href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#aff7178738b1f3c951ec912dbdaa048f9">dmult_</a> * cap, this-&gt;capacity_);</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;      <a class="code" href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#af3e6effcf6548f3217edcca9fe6c1840">Slot</a>* newSlots =</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;          <span class="keyword">new</span> (std::nothrow) <a class="code" href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#af3e6effcf6548f3217edcca9fe6c1840">Slot</a>[newCapacity + 2 * this-&gt;kSlotPadding];</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;      <span class="keywordflow">if</span> (newSlots == <span class="keyword">nullptr</span>) {</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;        <span class="comment">// Expansion failed. Restore the seqlock</span></div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;        this-&gt;dstate_.store(<a class="code" href="http__parser_8c.html#adc6e5733fc3c22f0a7b2914188c49c90">state</a>);</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;      }</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;      <span class="comment">// Successful expansion</span></div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;      <span class="comment">// calculate the current ticket offset</span></div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;      <a class="code" href="ConstexprMathBenchmark_8cpp.html#a5dc34568a989dd90728a4ed499cd9fab">uint64_t</a> offset = <a class="code" href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#a00c26479126417f3851154d8c331a6f7">getOffset</a>(<a class="code" href="http__parser_8c.html#adc6e5733fc3c22f0a7b2914188c49c90">state</a>);</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;      <span class="comment">// calculate index in closed array</span></div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;      <span class="keywordtype">int</span> index = <a class="code" href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#ad196d671a16c02bfade4ee332f4bffb0">getNumClosed</a>(<a class="code" href="http__parser_8c.html#adc6e5733fc3c22f0a7b2914188c49c90">state</a>);</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;      assert((index &lt;&lt; 1) &lt; (1 &lt;&lt; <a class="code" href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#ad5007737e7e398627738cb15d63e2315a9da77cfd3d7a49b60f0b968276a37e8d">kSeqlockBits</a>));</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;      <span class="comment">// fill the info for the closed slots array</span></div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;      <a class="code" href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#a8390750198bd5e93adf9aa061442d518">closed_</a>[index].<a class="code" href="structfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4_1_1ClosedArray.html#a25162c6d133a00685dfbfd21ae0338cd">offset_</a> = offset;</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;      <a class="code" href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#a8390750198bd5e93adf9aa061442d518">closed_</a>[index].<a class="code" href="structfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4_1_1ClosedArray.html#ae18ae99239acd91c28561490be587688">slots_</a> = this-&gt;dslots_.load();</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;      <a class="code" href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#a8390750198bd5e93adf9aa061442d518">closed_</a>[index].<a class="code" href="structfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4_1_1ClosedArray.html#a30acd43e8e0e0e409359ee26e6656c06">capacity_</a> = cap;</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;      <a class="code" href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#a8390750198bd5e93adf9aa061442d518">closed_</a>[index].<a class="code" href="structfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4_1_1ClosedArray.html#ab8b52887883184a05e73049838e4a4a9">stride_</a> = this-&gt;dstride_.load();</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;      <span class="comment">// update the new slots array info</span></div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;      this-&gt;dslots_.store(newSlots);</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;      this-&gt;dcapacity_.store(newCapacity);</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;      this-&gt;dstride_.store(this-&gt;computeStride(newCapacity));</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;      <span class="comment">// Release the seqlock and record the new ticket offset</span></div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;      this-&gt;dstate_.store((ticket &lt;&lt; <a class="code" href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#ad5007737e7e398627738cb15d63e2315a9da77cfd3d7a49b60f0b968276a37e8d">kSeqlockBits</a>) + (2 * (index + 1)));</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    } <span class="keywordflow">else</span> { <span class="comment">// failed to acquire seqlock</span></div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;      <span class="comment">// Someone acaquired the seqlock. Go back to the caller and get</span></div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;      <span class="comment">// up-to-date info.</span></div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;    }</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;  }</div><div class="ttc" id="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4_html_a00c26479126417f3851154d8c331a6f7"><div class="ttname"><a href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#a00c26479126417f3851154d8c331a6f7">folly::MPMCQueue&lt; T, Atom, true &gt;::getOffset</a></div><div class="ttdeci">uint64_t getOffset(const uint64_t state) const noexcept</div><div class="ttdef"><b>Definition:</b> <a href="MPMCQueue_8h_source.html#l00529">MPMCQueue.h:529</a></div></div>
<div class="ttc" id="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4_html_aff7178738b1f3c951ec912dbdaa048f9"><div class="ttname"><a href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#aff7178738b1f3c951ec912dbdaa048f9">folly::MPMCQueue&lt; T, Atom, true &gt;::dmult_</a></div><div class="ttdeci">size_t dmult_</div><div class="ttdef"><b>Definition:</b> <a href="MPMCQueue_8h_source.html#l00343">MPMCQueue.h:343</a></div></div>
<div class="ttc" id="structfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4_1_1ClosedArray_html_a25162c6d133a00685dfbfd21ae0338cd"><div class="ttname"><a href="structfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4_1_1ClosedArray.html#a25162c6d133a00685dfbfd21ae0338cd">folly::MPMCQueue&lt; T, Atom, true &gt;::ClosedArray::offset_</a></div><div class="ttdeci">uint64_t offset_</div><div class="ttdef"><b>Definition:</b> <a href="MPMCQueue_8h_source.html#l00182">MPMCQueue.h:182</a></div></div>
<div class="ttc" id="LogLevel_8cpp_html_a15c8b90f03cae068a6979f32590642e2"><div class="ttname"><a href="LogLevel_8cpp.html#a15c8b90f03cae068a6979f32590642e2">max</a></div><div class="ttdeci">LogLevel max</div><div class="ttdef"><b>Definition:</b> <a href="LogLevel_8cpp_source.html#l00031">LogLevel.cpp:31</a></div></div>
<div class="ttc" id="TicketCodecTest_8cpp_html_a7093cc9e41a6fdad6b2f2aa9211604c6"><div class="ttname"><a href="TicketCodecTest_8cpp.html#a7093cc9e41a6fdad6b2f2aa9211604c6">ticket</a></div><div class="ttdeci">static constexpr StringPiece ticket</div><div class="ttdef"><b>Definition:</b> <a href="TicketCodecTest_8cpp_source.html#l00021">TicketCodecTest.cpp:21</a></div></div>
<div class="ttc" id="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4_html_af3e6effcf6548f3217edcca9fe6c1840"><div class="ttname"><a href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#af3e6effcf6548f3217edcca9fe6c1840">folly::MPMCQueue&lt; T, Atom, true &gt;::Slot</a></div><div class="ttdeci">detail::SingleElementQueue&lt; T, Atom &gt; Slot</div><div class="ttdef"><b>Definition:</b> <a href="MPMCQueue_8h_source.html#l00179">MPMCQueue.h:179</a></div></div>
<div class="ttc" id="structfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4_1_1ClosedArray_html_a30acd43e8e0e0e409359ee26e6656c06"><div class="ttname"><a href="structfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4_1_1ClosedArray.html#a30acd43e8e0e0e409359ee26e6656c06">folly::MPMCQueue&lt; T, Atom, true &gt;::ClosedArray::capacity_</a></div><div class="ttdeci">size_t capacity_</div><div class="ttdef"><b>Definition:</b> <a href="MPMCQueue_8h_source.html#l00184">MPMCQueue.h:184</a></div></div>
<div class="ttc" id="LogLevel_8cpp_html_a7361901234703a521a82885405734c53"><div class="ttname"><a href="LogLevel_8cpp.html#a7361901234703a521a82885405734c53">min</a></div><div class="ttdeci">LogLevel min</div><div class="ttdef"><b>Definition:</b> <a href="LogLevel_8cpp_source.html#l00030">LogLevel.cpp:30</a></div></div>
<div class="ttc" id="structfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4_1_1ClosedArray_html_ab8b52887883184a05e73049838e4a4a9"><div class="ttname"><a href="structfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4_1_1ClosedArray.html#ab8b52887883184a05e73049838e4a4a9">folly::MPMCQueue&lt; T, Atom, true &gt;::ClosedArray::stride_</a></div><div class="ttdeci">int stride_</div><div class="ttdef"><b>Definition:</b> <a href="MPMCQueue_8h_source.html#l00185">MPMCQueue.h:185</a></div></div>
<div class="ttc" id="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4_html_a8390750198bd5e93adf9aa061442d518"><div class="ttname"><a href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#a8390750198bd5e93adf9aa061442d518">folly::MPMCQueue&lt; T, Atom, true &gt;::closed_</a></div><div class="ttdeci">ClosedArray * closed_</div><div class="ttdef"><b>Definition:</b> <a href="MPMCQueue_8h_source.html#l00346">MPMCQueue.h:346</a></div></div>
<div class="ttc" id="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4_html_ad5007737e7e398627738cb15d63e2315a9da77cfd3d7a49b60f0b968276a37e8d"><div class="ttname"><a href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#ad5007737e7e398627738cb15d63e2315a9da77cfd3d7a49b60f0b968276a37e8d">folly::MPMCQueue&lt; T, Atom, true &gt;::kSeqlockBits</a></div><div class="ttdef"><b>Definition:</b> <a href="MPMCQueue_8h_source.html#l00338">MPMCQueue.h:338</a></div></div>
<div class="ttc" id="ConstexprMathBenchmark_8cpp_html_a5dc34568a989dd90728a4ed499cd9fab"><div class="ttname"><a href="ConstexprMathBenchmark_8cpp.html#a5dc34568a989dd90728a4ed499cd9fab">uint64_t</a></div><div class="ttdeci">uint64_t</div><div class="ttdef"><b>Definition:</b> <a href="ConstexprMathBenchmark_8cpp_source.html#l00190">ConstexprMathBenchmark.cpp:190</a></div></div>
<div class="ttc" id="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4_html_ad196d671a16c02bfade4ee332f4bffb0"><div class="ttname"><a href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#ad196d671a16c02bfade4ee332f4bffb0">folly::MPMCQueue&lt; T, Atom, true &gt;::getNumClosed</a></div><div class="ttdeci">int getNumClosed(const uint64_t state) const noexcept</div><div class="ttdef"><b>Definition:</b> <a href="MPMCQueue_8h_source.html#l00533">MPMCQueue.h:533</a></div></div>
<div class="ttc" id="http__parser_8c_html_adc6e5733fc3c22f0a7b2914188c49c90"><div class="ttname"><a href="http__parser_8c.html#adc6e5733fc3c22f0a7b2914188c49c90">state</a></div><div class="ttdeci">state</div><div class="ttdef"><b>Definition:</b> <a href="http__parser_8c_source.html#l00272">http_parser.c:272</a></div></div>
<div class="ttc" id="structfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4_1_1ClosedArray_html_ae18ae99239acd91c28561490be587688"><div class="ttname"><a href="structfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4_1_1ClosedArray.html#ae18ae99239acd91c28561490be587688">folly::MPMCQueue&lt; T, Atom, true &gt;::ClosedArray::slots_</a></div><div class="ttdeci">Slot * slots_</div><div class="ttdef"><b>Definition:</b> <a href="MPMCQueue_8h_source.html#l00183">MPMCQueue.h:183</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a16f8314a007111833472a92a68e92dc9"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T , template&lt; typename &gt; class Atom&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classfolly_1_1MPMCQueue.html">folly::MPMCQueue</a>&lt; <a class="el" href="namespacefolly.html#a0652a9c51b69e7a13d40ccbcb139bc55">T</a>, <a class="el" href="ConcurrentHashMapTest_8cpp.html#a98ac53dd3c18b4046e7c5cb0bcb64b75">Atom</a>, true &gt;::tryObtainPromisedPopTicket </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ConstexprMathBenchmark_8cpp.html#a5dc34568a989dd90728a4ed499cd9fab">uint64_t</a> &amp;&#160;</td>
          <td class="paramname"><em>ticket</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#af3e6effcf6548f3217edcca9fe6c1840">Slot</a> *&amp;&#160;</td>
          <td class="paramname"><em>slots</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t &amp;&#160;</td>
          <td class="paramname"><em>cap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;&#160;</td>
          <td class="paramname"><em>stride</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="MPMCQueue_8h_source.html#l00479">479</a> of file <a class="el" href="MPMCQueue_8h_source.html">MPMCQueue.h</a>.</p>

<p>References <a class="el" href="fizz_2build___2gtest_2src_2gtest_2googlemock_2include_2gmock_2gmock-generated-matchers_8h_source.html#l00481">testing::Args()</a>, <a class="el" href="Asm_8h_source.html#l00037">folly::asm_volatile_pause()</a>, <a class="el" href="Base-inl_8h_source.html#l02589">folly::gen::stride()</a>, <a class="el" href="TicketCodecTest_8cpp_source.html#l00021">ticket</a>, and <a class="el" href="ConstexprMathBenchmark_8cpp_source.html#l00190">uint64_t</a>.</p>
<div class="fragment"><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;                            {</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    <a class="code" href="ConstexprMathBenchmark_8cpp.html#a5dc34568a989dd90728a4ed499cd9fab">uint64_t</a> <a class="code" href="http__parser_8c.html#adc6e5733fc3c22f0a7b2914188c49c90">state</a>;</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    <span class="keywordflow">do</span> {</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;      <a class="code" href="TicketCodecTest_8cpp.html#a7093cc9e41a6fdad6b2f2aa9211604c6">ticket</a> = this-&gt;popTicket_.load(std::memory_order_acquire);</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;      <span class="keyword">auto</span> numPushes = this-&gt;pushTicket_.load(std::memory_order_acquire);</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#a839cd742d49e826c2f8b4a7c6fd5c1c3">trySeqlockReadSection</a>(state, slots, cap, <a class="code" href="namespacefolly_1_1gen.html#aa36a13c6afb34e3e6f9fa5d337ea41de">stride</a>)) {</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;        <a class="code" href="namespacefolly.html#aaf13bc11e412f3e0899525ee0eef1443">asm_volatile_pause</a>();</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;      }</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;      <a class="code" href="ConstexprMathBenchmark_8cpp.html#a5dc34568a989dd90728a4ed499cd9fab">uint64_t</a> offset;</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;      <span class="comment">// If there was an expansion after the corresponding push</span></div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;      <span class="comment">// ticket was issued, adjust accordingly</span></div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;      <a class="code" href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#aaa9ebb95aab00fa14883787135388a17">maybeUpdateFromClosed</a>(state, <a class="code" href="TicketCodecTest_8cpp.html#a7093cc9e41a6fdad6b2f2aa9211604c6">ticket</a>, offset, slots, cap, <a class="code" href="namespacefolly_1_1gen.html#aa36a13c6afb34e3e6f9fa5d337ea41de">stride</a>);</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="TicketCodecTest_8cpp.html#a7093cc9e41a6fdad6b2f2aa9211604c6">ticket</a> &gt;= numPushes) {</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;        <a class="code" href="TicketCodecTest_8cpp.html#a7093cc9e41a6fdad6b2f2aa9211604c6">ticket</a> -= offset;</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;      }</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;      <span class="keywordflow">if</span> (this-&gt;popTicket_.compare_exchange_strong(<a class="code" href="TicketCodecTest_8cpp.html#a7093cc9e41a6fdad6b2f2aa9211604c6">ticket</a>, <a class="code" href="TicketCodecTest_8cpp.html#a7093cc9e41a6fdad6b2f2aa9211604c6">ticket</a> + 1)) {</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;        <a class="code" href="TicketCodecTest_8cpp.html#a7093cc9e41a6fdad6b2f2aa9211604c6">ticket</a> -= offset;</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;      }</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    } <span class="keywordflow">while</span> (<span class="keyword">true</span>);</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;  }</div><div class="ttc" id="TicketCodecTest_8cpp_html_a7093cc9e41a6fdad6b2f2aa9211604c6"><div class="ttname"><a href="TicketCodecTest_8cpp.html#a7093cc9e41a6fdad6b2f2aa9211604c6">ticket</a></div><div class="ttdeci">static constexpr StringPiece ticket</div><div class="ttdef"><b>Definition:</b> <a href="TicketCodecTest_8cpp_source.html#l00021">TicketCodecTest.cpp:21</a></div></div>
<div class="ttc" id="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4_html_a839cd742d49e826c2f8b4a7c6fd5c1c3"><div class="ttname"><a href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#a839cd742d49e826c2f8b4a7c6fd5c1c3">folly::MPMCQueue&lt; T, Atom, true &gt;::trySeqlockReadSection</a></div><div class="ttdeci">bool trySeqlockReadSection(uint64_t &amp;state, Slot *&amp;slots, size_t &amp;cap, int &amp;stride) noexcept</div><div class="ttdoc">Seqlock read-only section. </div><div class="ttdef"><b>Definition:</b> <a href="MPMCQueue_8h_source.html#l00586">MPMCQueue.h:586</a></div></div>
<div class="ttc" id="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4_html_aaa9ebb95aab00fa14883787135388a17"><div class="ttname"><a href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#aaa9ebb95aab00fa14883787135388a17">folly::MPMCQueue&lt; T, Atom, true &gt;::maybeUpdateFromClosed</a></div><div class="ttdeci">bool maybeUpdateFromClosed(const uint64_t state, const uint64_t ticket, uint64_t &amp;offset, Slot *&amp;slots, size_t &amp;cap, int &amp;stride) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="MPMCQueue_8h_source.html#l00608">MPMCQueue.h:608</a></div></div>
<div class="ttc" id="ConstexprMathBenchmark_8cpp_html_a5dc34568a989dd90728a4ed499cd9fab"><div class="ttname"><a href="ConstexprMathBenchmark_8cpp.html#a5dc34568a989dd90728a4ed499cd9fab">uint64_t</a></div><div class="ttdeci">uint64_t</div><div class="ttdef"><b>Definition:</b> <a href="ConstexprMathBenchmark_8cpp_source.html#l00190">ConstexprMathBenchmark.cpp:190</a></div></div>
<div class="ttc" id="namespacefolly_1_1gen_html_aa36a13c6afb34e3e6f9fa5d337ea41de"><div class="ttname"><a href="namespacefolly_1_1gen.html#aa36a13c6afb34e3e6f9fa5d337ea41de">folly::gen::stride</a></div><div class="ttdeci">detail::Stride stride(size_t s)</div><div class="ttdef"><b>Definition:</b> <a href="Base-inl_8h_source.html#l02589">Base-inl.h:2589</a></div></div>
<div class="ttc" id="http__parser_8c_html_adc6e5733fc3c22f0a7b2914188c49c90"><div class="ttname"><a href="http__parser_8c.html#adc6e5733fc3c22f0a7b2914188c49c90">state</a></div><div class="ttdeci">state</div><div class="ttdef"><b>Definition:</b> <a href="http__parser_8c_source.html#l00272">http_parser.c:272</a></div></div>
<div class="ttc" id="namespacefolly_html_aaf13bc11e412f3e0899525ee0eef1443"><div class="ttname"><a href="namespacefolly.html#aaf13bc11e412f3e0899525ee0eef1443">folly::asm_volatile_pause</a></div><div class="ttdeci">void asm_volatile_pause()</div><div class="ttdef"><b>Definition:</b> <a href="Asm_8h_source.html#l00037">Asm.h:37</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="abd463e7bf1bf11e404d017e1916a3740"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T , template&lt; typename &gt; class Atom&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classfolly_1_1MPMCQueue.html">folly::MPMCQueue</a>&lt; <a class="el" href="namespacefolly.html#a0652a9c51b69e7a13d40ccbcb139bc55">T</a>, <a class="el" href="ConcurrentHashMapTest_8cpp.html#a98ac53dd3c18b4046e7c5cb0bcb64b75">Atom</a>, true &gt;::tryObtainPromisedPushTicket </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ConstexprMathBenchmark_8cpp.html#a5dc34568a989dd90728a4ed499cd9fab">uint64_t</a> &amp;&#160;</td>
          <td class="paramname"><em>ticket</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#af3e6effcf6548f3217edcca9fe6c1840">Slot</a> *&amp;&#160;</td>
          <td class="paramname"><em>slots</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t &amp;&#160;</td>
          <td class="paramname"><em>cap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;&#160;</td>
          <td class="paramname"><em>stride</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="MPMCQueue_8h_source.html#l00408">408</a> of file <a class="el" href="MPMCQueue_8h_source.html">MPMCQueue.h</a>.</p>

<p>References <a class="el" href="Asm_8h_source.html#l00037">folly::asm_volatile_pause()</a>, <a class="el" href="ConstexprMathBenchmark_8cpp_source.html#l00188">int64_t</a>, <a class="el" href="Base-inl_8h_source.html#l02589">folly::gen::stride()</a>, <a class="el" href="TicketCodecTest_8cpp_source.html#l00021">ticket</a>, and <a class="el" href="ConstexprMathBenchmark_8cpp_source.html#l00190">uint64_t</a>.</p>
<div class="fragment"><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;                            {</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    <a class="code" href="ConstexprMathBenchmark_8cpp.html#a5dc34568a989dd90728a4ed499cd9fab">uint64_t</a> <a class="code" href="http__parser_8c.html#adc6e5733fc3c22f0a7b2914188c49c90">state</a>;</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    <span class="keywordflow">do</span> {</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;      <a class="code" href="TicketCodecTest_8cpp.html#a7093cc9e41a6fdad6b2f2aa9211604c6">ticket</a> = this-&gt;pushTicket_.load(std::memory_order_acquire);</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;      <span class="keyword">auto</span> numPops = this-&gt;popTicket_.load(std::memory_order_acquire);</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#a839cd742d49e826c2f8b4a7c6fd5c1c3">trySeqlockReadSection</a>(state, slots, cap, <a class="code" href="namespacefolly_1_1gen.html#aa36a13c6afb34e3e6f9fa5d337ea41de">stride</a>)) {</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;        <a class="code" href="namespacefolly.html#aaf13bc11e412f3e0899525ee0eef1443">asm_volatile_pause</a>();</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;      }</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span> curCap = cap;</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;      <span class="comment">// If there was an expansion with offset greater than this ticket,</span></div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;      <span class="comment">// adjust accordingly</span></div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;      <a class="code" href="ConstexprMathBenchmark_8cpp.html#a5dc34568a989dd90728a4ed499cd9fab">uint64_t</a> offset;</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;      <a class="code" href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#aaa9ebb95aab00fa14883787135388a17">maybeUpdateFromClosed</a>(state, <a class="code" href="TicketCodecTest_8cpp.html#a7093cc9e41a6fdad6b2f2aa9211604c6">ticket</a>, offset, slots, cap, <a class="code" href="namespacefolly_1_1gen.html#aa36a13c6afb34e3e6f9fa5d337ea41de">stride</a>);</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;      <a class="code" href="ConstexprMathBenchmark_8cpp.html#a21214d6ef664ff09b89c1fd75fe0a042">int64_t</a> n = <a class="code" href="TicketCodecTest_8cpp.html#a7093cc9e41a6fdad6b2f2aa9211604c6">ticket</a> - numPops;</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;      <span class="keywordflow">if</span> (n &gt;= static_cast&lt;ssize_t&gt;(cap)) {</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;        <span class="keywordflow">if</span> ((cap == curCap) &amp;&amp; <a class="code" href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#adfdfdbea44e41365108d8ee6ac84cbbc">tryExpand</a>(state, cap)) {</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;          <span class="comment">// This or another thread started an expansion. Start over.</span></div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;          <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;        }</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;        <span class="comment">// Can&#39;t expand.</span></div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;        <a class="code" href="TicketCodecTest_8cpp.html#a7093cc9e41a6fdad6b2f2aa9211604c6">ticket</a> -= offset;</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;      }</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;      <span class="keywordflow">if</span> (this-&gt;pushTicket_.compare_exchange_strong(<a class="code" href="TicketCodecTest_8cpp.html#a7093cc9e41a6fdad6b2f2aa9211604c6">ticket</a>, <a class="code" href="TicketCodecTest_8cpp.html#a7093cc9e41a6fdad6b2f2aa9211604c6">ticket</a> + 1)) {</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;        <span class="comment">// Adjust ticket</span></div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;        <a class="code" href="TicketCodecTest_8cpp.html#a7093cc9e41a6fdad6b2f2aa9211604c6">ticket</a> -= offset;</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;      }</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    } <span class="keywordflow">while</span> (<span class="keyword">true</span>);</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;  }</div><div class="ttc" id="TicketCodecTest_8cpp_html_a7093cc9e41a6fdad6b2f2aa9211604c6"><div class="ttname"><a href="TicketCodecTest_8cpp.html#a7093cc9e41a6fdad6b2f2aa9211604c6">ticket</a></div><div class="ttdeci">static constexpr StringPiece ticket</div><div class="ttdef"><b>Definition:</b> <a href="TicketCodecTest_8cpp_source.html#l00021">TicketCodecTest.cpp:21</a></div></div>
<div class="ttc" id="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4_html_a839cd742d49e826c2f8b4a7c6fd5c1c3"><div class="ttname"><a href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#a839cd742d49e826c2f8b4a7c6fd5c1c3">folly::MPMCQueue&lt; T, Atom, true &gt;::trySeqlockReadSection</a></div><div class="ttdeci">bool trySeqlockReadSection(uint64_t &amp;state, Slot *&amp;slots, size_t &amp;cap, int &amp;stride) noexcept</div><div class="ttdoc">Seqlock read-only section. </div><div class="ttdef"><b>Definition:</b> <a href="MPMCQueue_8h_source.html#l00586">MPMCQueue.h:586</a></div></div>
<div class="ttc" id="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4_html_adfdfdbea44e41365108d8ee6ac84cbbc"><div class="ttname"><a href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#adfdfdbea44e41365108d8ee6ac84cbbc">folly::MPMCQueue&lt; T, Atom, true &gt;::tryExpand</a></div><div class="ttdeci">bool tryExpand(const uint64_t state, const size_t cap) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="MPMCQueue_8h_source.html#l00541">MPMCQueue.h:541</a></div></div>
<div class="ttc" id="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4_html_aaa9ebb95aab00fa14883787135388a17"><div class="ttname"><a href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#aaa9ebb95aab00fa14883787135388a17">folly::MPMCQueue&lt; T, Atom, true &gt;::maybeUpdateFromClosed</a></div><div class="ttdeci">bool maybeUpdateFromClosed(const uint64_t state, const uint64_t ticket, uint64_t &amp;offset, Slot *&amp;slots, size_t &amp;cap, int &amp;stride) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="MPMCQueue_8h_source.html#l00608">MPMCQueue.h:608</a></div></div>
<div class="ttc" id="ConstexprMathBenchmark_8cpp_html_a5dc34568a989dd90728a4ed499cd9fab"><div class="ttname"><a href="ConstexprMathBenchmark_8cpp.html#a5dc34568a989dd90728a4ed499cd9fab">uint64_t</a></div><div class="ttdeci">uint64_t</div><div class="ttdef"><b>Definition:</b> <a href="ConstexprMathBenchmark_8cpp_source.html#l00190">ConstexprMathBenchmark.cpp:190</a></div></div>
<div class="ttc" id="ConstexprMathBenchmark_8cpp_html_a21214d6ef664ff09b89c1fd75fe0a042"><div class="ttname"><a href="ConstexprMathBenchmark_8cpp.html#a21214d6ef664ff09b89c1fd75fe0a042">int64_t</a></div><div class="ttdeci">int64_t</div><div class="ttdef"><b>Definition:</b> <a href="ConstexprMathBenchmark_8cpp_source.html#l00188">ConstexprMathBenchmark.cpp:188</a></div></div>
<div class="ttc" id="namespacefolly_1_1gen_html_aa36a13c6afb34e3e6f9fa5d337ea41de"><div class="ttname"><a href="namespacefolly_1_1gen.html#aa36a13c6afb34e3e6f9fa5d337ea41de">folly::gen::stride</a></div><div class="ttdeci">detail::Stride stride(size_t s)</div><div class="ttdef"><b>Definition:</b> <a href="Base-inl_8h_source.html#l02589">Base-inl.h:2589</a></div></div>
<div class="ttc" id="http__parser_8c_html_adc6e5733fc3c22f0a7b2914188c49c90"><div class="ttname"><a href="http__parser_8c.html#adc6e5733fc3c22f0a7b2914188c49c90">state</a></div><div class="ttdeci">state</div><div class="ttdef"><b>Definition:</b> <a href="http__parser_8c_source.html#l00272">http_parser.c:272</a></div></div>
<div class="ttc" id="namespacefolly_html_aaf13bc11e412f3e0899525ee0eef1443"><div class="ttname"><a href="namespacefolly.html#aaf13bc11e412f3e0899525ee0eef1443">folly::asm_volatile_pause</a></div><div class="ttdeci">void asm_volatile_pause()</div><div class="ttdef"><b>Definition:</b> <a href="Asm_8h_source.html#l00037">Asm.h:37</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aa1e6354557919cd68eee2336835d113c"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T , template&lt; typename &gt; class Atom&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classfolly_1_1MPMCQueue.html">folly::MPMCQueue</a>&lt; <a class="el" href="namespacefolly.html#a0652a9c51b69e7a13d40ccbcb139bc55">T</a>, <a class="el" href="ConcurrentHashMapTest_8cpp.html#a98ac53dd3c18b4046e7c5cb0bcb64b75">Atom</a>, true &gt;::tryObtainReadyPopTicket </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ConstexprMathBenchmark_8cpp.html#a5dc34568a989dd90728a4ed499cd9fab">uint64_t</a> &amp;&#160;</td>
          <td class="paramname"><em>ticket</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#af3e6effcf6548f3217edcca9fe6c1840">Slot</a> *&amp;&#160;</td>
          <td class="paramname"><em>slots</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t &amp;&#160;</td>
          <td class="paramname"><em>cap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;&#160;</td>
          <td class="paramname"><em>stride</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="MPMCQueue_8h_source.html#l00448">448</a> of file <a class="el" href="MPMCQueue_8h_source.html">MPMCQueue.h</a>.</p>

<p>References <a class="el" href="Asm_8h_source.html#l00037">folly::asm_volatile_pause()</a>, <a class="el" href="Base-inl_8h_source.html#l02589">folly::gen::stride()</a>, <a class="el" href="TicketCodecTest_8cpp_source.html#l00021">ticket</a>, and <a class="el" href="ConstexprMathBenchmark_8cpp_source.html#l00190">uint64_t</a>.</p>
<div class="fragment"><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;                            {</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    <a class="code" href="ConstexprMathBenchmark_8cpp.html#a5dc34568a989dd90728a4ed499cd9fab">uint64_t</a> <a class="code" href="http__parser_8c.html#adc6e5733fc3c22f0a7b2914188c49c90">state</a>;</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    <span class="keywordflow">do</span> {</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;      <a class="code" href="TicketCodecTest_8cpp.html#a7093cc9e41a6fdad6b2f2aa9211604c6">ticket</a> = this-&gt;popTicket_.load(std::memory_order_relaxed);</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#a839cd742d49e826c2f8b4a7c6fd5c1c3">trySeqlockReadSection</a>(state, slots, cap, <a class="code" href="namespacefolly_1_1gen.html#aa36a13c6afb34e3e6f9fa5d337ea41de">stride</a>)) {</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;        <a class="code" href="namespacefolly.html#aaf13bc11e412f3e0899525ee0eef1443">asm_volatile_pause</a>();</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;      }</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;      <span class="comment">// If there was an expansion after the corresponding push ticket</span></div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;      <span class="comment">// was issued, adjust accordingly</span></div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;      <a class="code" href="ConstexprMathBenchmark_8cpp.html#a5dc34568a989dd90728a4ed499cd9fab">uint64_t</a> offset;</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;      <a class="code" href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#aaa9ebb95aab00fa14883787135388a17">maybeUpdateFromClosed</a>(state, <a class="code" href="TicketCodecTest_8cpp.html#a7093cc9e41a6fdad6b2f2aa9211604c6">ticket</a>, offset, slots, cap, <a class="code" href="namespacefolly_1_1gen.html#aa36a13c6afb34e3e6f9fa5d337ea41de">stride</a>);</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;      <span class="keywordflow">if</span> (slots[this-&gt;idx((<a class="code" href="TicketCodecTest_8cpp.html#a7093cc9e41a6fdad6b2f2aa9211604c6">ticket</a> - offset), cap, <a class="code" href="namespacefolly_1_1gen.html#aa36a13c6afb34e3e6f9fa5d337ea41de">stride</a>)].mayDequeue(</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;              this-&gt;turn(<a class="code" href="TicketCodecTest_8cpp.html#a7093cc9e41a6fdad6b2f2aa9211604c6">ticket</a> - offset, cap))) {</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;        <span class="keywordflow">if</span> (this-&gt;popTicket_.compare_exchange_strong(<a class="code" href="TicketCodecTest_8cpp.html#a7093cc9e41a6fdad6b2f2aa9211604c6">ticket</a>, <a class="code" href="TicketCodecTest_8cpp.html#a7093cc9e41a6fdad6b2f2aa9211604c6">ticket</a> + 1)) {</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;          <span class="comment">// Adjust ticket</span></div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;          <a class="code" href="TicketCodecTest_8cpp.html#a7093cc9e41a6fdad6b2f2aa9211604c6">ticket</a> -= offset;</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;        }</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;      }</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    } <span class="keywordflow">while</span> (<span class="keyword">true</span>);</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;  }</div><div class="ttc" id="TicketCodecTest_8cpp_html_a7093cc9e41a6fdad6b2f2aa9211604c6"><div class="ttname"><a href="TicketCodecTest_8cpp.html#a7093cc9e41a6fdad6b2f2aa9211604c6">ticket</a></div><div class="ttdeci">static constexpr StringPiece ticket</div><div class="ttdef"><b>Definition:</b> <a href="TicketCodecTest_8cpp_source.html#l00021">TicketCodecTest.cpp:21</a></div></div>
<div class="ttc" id="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4_html_a839cd742d49e826c2f8b4a7c6fd5c1c3"><div class="ttname"><a href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#a839cd742d49e826c2f8b4a7c6fd5c1c3">folly::MPMCQueue&lt; T, Atom, true &gt;::trySeqlockReadSection</a></div><div class="ttdeci">bool trySeqlockReadSection(uint64_t &amp;state, Slot *&amp;slots, size_t &amp;cap, int &amp;stride) noexcept</div><div class="ttdoc">Seqlock read-only section. </div><div class="ttdef"><b>Definition:</b> <a href="MPMCQueue_8h_source.html#l00586">MPMCQueue.h:586</a></div></div>
<div class="ttc" id="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4_html_aaa9ebb95aab00fa14883787135388a17"><div class="ttname"><a href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#aaa9ebb95aab00fa14883787135388a17">folly::MPMCQueue&lt; T, Atom, true &gt;::maybeUpdateFromClosed</a></div><div class="ttdeci">bool maybeUpdateFromClosed(const uint64_t state, const uint64_t ticket, uint64_t &amp;offset, Slot *&amp;slots, size_t &amp;cap, int &amp;stride) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="MPMCQueue_8h_source.html#l00608">MPMCQueue.h:608</a></div></div>
<div class="ttc" id="ConstexprMathBenchmark_8cpp_html_a5dc34568a989dd90728a4ed499cd9fab"><div class="ttname"><a href="ConstexprMathBenchmark_8cpp.html#a5dc34568a989dd90728a4ed499cd9fab">uint64_t</a></div><div class="ttdeci">uint64_t</div><div class="ttdef"><b>Definition:</b> <a href="ConstexprMathBenchmark_8cpp_source.html#l00190">ConstexprMathBenchmark.cpp:190</a></div></div>
<div class="ttc" id="namespacefolly_1_1gen_html_aa36a13c6afb34e3e6f9fa5d337ea41de"><div class="ttname"><a href="namespacefolly_1_1gen.html#aa36a13c6afb34e3e6f9fa5d337ea41de">folly::gen::stride</a></div><div class="ttdeci">detail::Stride stride(size_t s)</div><div class="ttdef"><b>Definition:</b> <a href="Base-inl_8h_source.html#l02589">Base-inl.h:2589</a></div></div>
<div class="ttc" id="http__parser_8c_html_adc6e5733fc3c22f0a7b2914188c49c90"><div class="ttname"><a href="http__parser_8c.html#adc6e5733fc3c22f0a7b2914188c49c90">state</a></div><div class="ttdeci">state</div><div class="ttdef"><b>Definition:</b> <a href="http__parser_8c_source.html#l00272">http_parser.c:272</a></div></div>
<div class="ttc" id="namespacefolly_html_aaf13bc11e412f3e0899525ee0eef1443"><div class="ttname"><a href="namespacefolly.html#aaf13bc11e412f3e0899525ee0eef1443">folly::asm_volatile_pause</a></div><div class="ttdeci">void asm_volatile_pause()</div><div class="ttdef"><b>Definition:</b> <a href="Asm_8h_source.html#l00037">Asm.h:37</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="afb83fb386a8c555340179c1e604584b2"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T , template&lt; typename &gt; class Atom&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classfolly_1_1MPMCQueue.html">folly::MPMCQueue</a>&lt; <a class="el" href="namespacefolly.html#a0652a9c51b69e7a13d40ccbcb139bc55">T</a>, <a class="el" href="ConcurrentHashMapTest_8cpp.html#a98ac53dd3c18b4046e7c5cb0bcb64b75">Atom</a>, true &gt;::tryObtainReadyPushTicket </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ConstexprMathBenchmark_8cpp.html#a5dc34568a989dd90728a4ed499cd9fab">uint64_t</a> &amp;&#160;</td>
          <td class="paramname"><em>ticket</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#af3e6effcf6548f3217edcca9fe6c1840">Slot</a> *&amp;&#160;</td>
          <td class="paramname"><em>slots</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t &amp;&#160;</td>
          <td class="paramname"><em>cap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;&#160;</td>
          <td class="paramname"><em>stride</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="MPMCQueue_8h_source.html#l00362">362</a> of file <a class="el" href="MPMCQueue_8h_source.html">MPMCQueue.h</a>.</p>

<p>References <a class="el" href="Asm_8h_source.html#l00037">folly::asm_volatile_pause()</a>, <a class="el" href="Base-inl_8h_source.html#l02589">folly::gen::stride()</a>, <a class="el" href="TicketCodecTest_8cpp_source.html#l00021">ticket</a>, and <a class="el" href="ConstexprMathBenchmark_8cpp_source.html#l00190">uint64_t</a>.</p>
<div class="fragment"><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;                            {</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    <a class="code" href="ConstexprMathBenchmark_8cpp.html#a5dc34568a989dd90728a4ed499cd9fab">uint64_t</a> <a class="code" href="http__parser_8c.html#adc6e5733fc3c22f0a7b2914188c49c90">state</a>;</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    <span class="keywordflow">do</span> {</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;      <a class="code" href="TicketCodecTest_8cpp.html#a7093cc9e41a6fdad6b2f2aa9211604c6">ticket</a> = this-&gt;pushTicket_.load(std::memory_order_acquire); <span class="comment">// A</span></div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#a839cd742d49e826c2f8b4a7c6fd5c1c3">trySeqlockReadSection</a>(state, slots, cap, <a class="code" href="namespacefolly_1_1gen.html#aa36a13c6afb34e3e6f9fa5d337ea41de">stride</a>)) {</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;        <a class="code" href="namespacefolly.html#aaf13bc11e412f3e0899525ee0eef1443">asm_volatile_pause</a>();</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;      }</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;      <span class="comment">// If there was an expansion with offset greater than this ticket,</span></div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;      <span class="comment">// adjust accordingly</span></div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;      <a class="code" href="ConstexprMathBenchmark_8cpp.html#a5dc34568a989dd90728a4ed499cd9fab">uint64_t</a> offset;</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;      <a class="code" href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#aaa9ebb95aab00fa14883787135388a17">maybeUpdateFromClosed</a>(state, <a class="code" href="TicketCodecTest_8cpp.html#a7093cc9e41a6fdad6b2f2aa9211604c6">ticket</a>, offset, slots, cap, <a class="code" href="namespacefolly_1_1gen.html#aa36a13c6afb34e3e6f9fa5d337ea41de">stride</a>);</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;      <span class="keywordflow">if</span> (slots[this-&gt;idx((<a class="code" href="TicketCodecTest_8cpp.html#a7093cc9e41a6fdad6b2f2aa9211604c6">ticket</a> - offset), cap, <a class="code" href="namespacefolly_1_1gen.html#aa36a13c6afb34e3e6f9fa5d337ea41de">stride</a>)].mayEnqueue(</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;              this-&gt;turn(<a class="code" href="TicketCodecTest_8cpp.html#a7093cc9e41a6fdad6b2f2aa9211604c6">ticket</a> - offset, cap))) {</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;        <span class="comment">// A slot is ready.</span></div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;        <span class="keywordflow">if</span> (this-&gt;pushTicket_.compare_exchange_strong(<a class="code" href="TicketCodecTest_8cpp.html#a7093cc9e41a6fdad6b2f2aa9211604c6">ticket</a>, <a class="code" href="TicketCodecTest_8cpp.html#a7093cc9e41a6fdad6b2f2aa9211604c6">ticket</a> + 1)) {</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;          <span class="comment">// Adjust ticket</span></div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;          <a class="code" href="TicketCodecTest_8cpp.html#a7093cc9e41a6fdad6b2f2aa9211604c6">ticket</a> -= offset;</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;          <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;        }</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="TicketCodecTest_8cpp.html#a7093cc9e41a6fdad6b2f2aa9211604c6">ticket</a> != this-&gt;pushTicket_.load(std::memory_order_relaxed)) { <span class="comment">// B</span></div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;          <span class="comment">// Try again. Ticket changed.</span></div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;          <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;        }</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;        <span class="comment">// Likely to block.</span></div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;        <span class="comment">// Try to expand unless the ticket is for a closed array</span></div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;        <span class="keywordflow">if</span> (offset == <a class="code" href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#a00c26479126417f3851154d8c331a6f7">getOffset</a>(state)) {</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#adfdfdbea44e41365108d8ee6ac84cbbc">tryExpand</a>(state, cap)) {</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;            <span class="comment">// This or another thread started an expansion. Get up-to-date info.</span></div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;          }</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;        }</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;      }</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    } <span class="keywordflow">while</span> (<span class="keyword">true</span>);</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;  }</div><div class="ttc" id="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4_html_a00c26479126417f3851154d8c331a6f7"><div class="ttname"><a href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#a00c26479126417f3851154d8c331a6f7">folly::MPMCQueue&lt; T, Atom, true &gt;::getOffset</a></div><div class="ttdeci">uint64_t getOffset(const uint64_t state) const noexcept</div><div class="ttdef"><b>Definition:</b> <a href="MPMCQueue_8h_source.html#l00529">MPMCQueue.h:529</a></div></div>
<div class="ttc" id="TicketCodecTest_8cpp_html_a7093cc9e41a6fdad6b2f2aa9211604c6"><div class="ttname"><a href="TicketCodecTest_8cpp.html#a7093cc9e41a6fdad6b2f2aa9211604c6">ticket</a></div><div class="ttdeci">static constexpr StringPiece ticket</div><div class="ttdef"><b>Definition:</b> <a href="TicketCodecTest_8cpp_source.html#l00021">TicketCodecTest.cpp:21</a></div></div>
<div class="ttc" id="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4_html_a839cd742d49e826c2f8b4a7c6fd5c1c3"><div class="ttname"><a href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#a839cd742d49e826c2f8b4a7c6fd5c1c3">folly::MPMCQueue&lt; T, Atom, true &gt;::trySeqlockReadSection</a></div><div class="ttdeci">bool trySeqlockReadSection(uint64_t &amp;state, Slot *&amp;slots, size_t &amp;cap, int &amp;stride) noexcept</div><div class="ttdoc">Seqlock read-only section. </div><div class="ttdef"><b>Definition:</b> <a href="MPMCQueue_8h_source.html#l00586">MPMCQueue.h:586</a></div></div>
<div class="ttc" id="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4_html_adfdfdbea44e41365108d8ee6ac84cbbc"><div class="ttname"><a href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#adfdfdbea44e41365108d8ee6ac84cbbc">folly::MPMCQueue&lt; T, Atom, true &gt;::tryExpand</a></div><div class="ttdeci">bool tryExpand(const uint64_t state, const size_t cap) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="MPMCQueue_8h_source.html#l00541">MPMCQueue.h:541</a></div></div>
<div class="ttc" id="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4_html_aaa9ebb95aab00fa14883787135388a17"><div class="ttname"><a href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#aaa9ebb95aab00fa14883787135388a17">folly::MPMCQueue&lt; T, Atom, true &gt;::maybeUpdateFromClosed</a></div><div class="ttdeci">bool maybeUpdateFromClosed(const uint64_t state, const uint64_t ticket, uint64_t &amp;offset, Slot *&amp;slots, size_t &amp;cap, int &amp;stride) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="MPMCQueue_8h_source.html#l00608">MPMCQueue.h:608</a></div></div>
<div class="ttc" id="ConstexprMathBenchmark_8cpp_html_a5dc34568a989dd90728a4ed499cd9fab"><div class="ttname"><a href="ConstexprMathBenchmark_8cpp.html#a5dc34568a989dd90728a4ed499cd9fab">uint64_t</a></div><div class="ttdeci">uint64_t</div><div class="ttdef"><b>Definition:</b> <a href="ConstexprMathBenchmark_8cpp_source.html#l00190">ConstexprMathBenchmark.cpp:190</a></div></div>
<div class="ttc" id="namespacefolly_1_1gen_html_aa36a13c6afb34e3e6f9fa5d337ea41de"><div class="ttname"><a href="namespacefolly_1_1gen.html#aa36a13c6afb34e3e6f9fa5d337ea41de">folly::gen::stride</a></div><div class="ttdeci">detail::Stride stride(size_t s)</div><div class="ttdef"><b>Definition:</b> <a href="Base-inl_8h_source.html#l02589">Base-inl.h:2589</a></div></div>
<div class="ttc" id="http__parser_8c_html_adc6e5733fc3c22f0a7b2914188c49c90"><div class="ttname"><a href="http__parser_8c.html#adc6e5733fc3c22f0a7b2914188c49c90">state</a></div><div class="ttdeci">state</div><div class="ttdef"><b>Definition:</b> <a href="http__parser_8c_source.html#l00272">http_parser.c:272</a></div></div>
<div class="ttc" id="namespacefolly_html_aaf13bc11e412f3e0899525ee0eef1443"><div class="ttname"><a href="namespacefolly.html#aaf13bc11e412f3e0899525ee0eef1443">folly::asm_volatile_pause</a></div><div class="ttdeci">void asm_volatile_pause()</div><div class="ttdef"><b>Definition:</b> <a href="Asm_8h_source.html#l00037">Asm.h:37</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a839cd742d49e826c2f8b4a7c6fd5c1c3"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T , template&lt; typename &gt; class Atom&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classfolly_1_1MPMCQueue.html">folly::MPMCQueue</a>&lt; <a class="el" href="namespacefolly.html#a0652a9c51b69e7a13d40ccbcb139bc55">T</a>, <a class="el" href="ConcurrentHashMapTest_8cpp.html#a98ac53dd3c18b4046e7c5cb0bcb64b75">Atom</a>, true &gt;::trySeqlockReadSection </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ConstexprMathBenchmark_8cpp.html#a5dc34568a989dd90728a4ed499cd9fab">uint64_t</a> &amp;&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html#af3e6effcf6548f3217edcca9fe6c1840">Slot</a> *&amp;&#160;</td>
          <td class="paramname"><em>slots</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t &amp;&#160;</td>
          <td class="paramname"><em>cap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;&#160;</td>
          <td class="paramname"><em>stride</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Seqlock read-only section. </p>

<p>Definition at line <a class="el" href="MPMCQueue_8h_source.html#l00586">586</a> of file <a class="el" href="MPMCQueue_8h_source.html">MPMCQueue.h</a>.</p>

<p>References <a class="el" href="Base-inl_8h_source.html#l02589">folly::gen::stride()</a>.</p>
<div class="fragment"><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;                            {</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;    <a class="code" href="http__parser_8c.html#adc6e5733fc3c22f0a7b2914188c49c90">state</a> = this-&gt;dstate_.load(std::memory_order_acquire);</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="http__parser_8c.html#adc6e5733fc3c22f0a7b2914188c49c90">state</a> &amp; 1) {</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;      <span class="comment">// Locked.</span></div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;    }</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;    <span class="comment">// Start read-only section.</span></div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    slots = this-&gt;dslots_.load(std::memory_order_relaxed);</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;    cap = this-&gt;dcapacity_.load(std::memory_order_relaxed);</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;    <a class="code" href="namespacefolly_1_1gen.html#aa36a13c6afb34e3e6f9fa5d337ea41de">stride</a> = this-&gt;dstride_.load(std::memory_order_relaxed);</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;    <span class="comment">// End of read-only section. Validate seqlock.</span></div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;    std::atomic_thread_fence(std::memory_order_acquire);</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;    <span class="keywordflow">return</span> (<a class="code" href="http__parser_8c.html#adc6e5733fc3c22f0a7b2914188c49c90">state</a> == this-&gt;dstate_.load(std::memory_order_relaxed));</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;  }</div><div class="ttc" id="namespacefolly_1_1gen_html_aa36a13c6afb34e3e6f9fa5d337ea41de"><div class="ttname"><a href="namespacefolly_1_1gen.html#aa36a13c6afb34e3e6f9fa5d337ea41de">folly::gen::stride</a></div><div class="ttdeci">detail::Stride stride(size_t s)</div><div class="ttdef"><b>Definition:</b> <a href="Base-inl_8h_source.html#l02589">Base-inl.h:2589</a></div></div>
<div class="ttc" id="http__parser_8c_html_adc6e5733fc3c22f0a7b2914188c49c90"><div class="ttname"><a href="http__parser_8c.html#adc6e5733fc3c22f0a7b2914188c49c90">state</a></div><div class="ttdeci">state</div><div class="ttdef"><b>Definition:</b> <a href="http__parser_8c_source.html#l00272">http_parser.c:272</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Friends And Related Function Documentation</h2>
<a class="anchor" id="a9dbb3bcaa4bcb2f29781db56e5c3ea64"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T , template&lt; typename &gt; class Atom&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">friend class <a class="el" href="classfolly_1_1detail_1_1MPMCQueueBase.html">detail::MPMCQueueBase</a>&lt; <a class="el" href="classfolly_1_1MPMCQueue.html">MPMCQueue</a>&lt; <a class="el" href="namespacefolly.html#a0652a9c51b69e7a13d40ccbcb139bc55">T</a>, <a class="el" href="ConcurrentHashMapTest_8cpp.html#a98ac53dd3c18b4046e7c5cb0bcb64b75">Atom</a>, true &gt; &gt;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="MPMCQueue_8h_source.html#l00178">178</a> of file <a class="el" href="MPMCQueue_8h_source.html">MPMCQueue.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="a8390750198bd5e93adf9aa061442d518"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T , template&lt; typename &gt; class Atom&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">ClosedArray* <a class="el" href="classfolly_1_1MPMCQueue.html">folly::MPMCQueue</a>&lt; <a class="el" href="namespacefolly.html#a0652a9c51b69e7a13d40ccbcb139bc55">T</a>, <a class="el" href="ConcurrentHashMapTest_8cpp.html#a98ac53dd3c18b4046e7c5cb0bcb64b75">Atom</a>, true &gt;::closed_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="MPMCQueue_8h_source.html#l00346">346</a> of file <a class="el" href="MPMCQueue_8h_source.html">MPMCQueue.h</a>.</p>

</div>
</div>
<a class="anchor" id="aff7178738b1f3c951ec912dbdaa048f9"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T , template&lt; typename &gt; class Atom&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">size_t <a class="el" href="classfolly_1_1MPMCQueue.html">folly::MPMCQueue</a>&lt; <a class="el" href="namespacefolly.html#a0652a9c51b69e7a13d40ccbcb139bc55">T</a>, <a class="el" href="ConcurrentHashMapTest_8cpp.html#a98ac53dd3c18b4046e7c5cb0bcb64b75">Atom</a>, true &gt;::dmult_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="MPMCQueue_8h_source.html#l00343">343</a> of file <a class="el" href="MPMCQueue_8h_source.html">MPMCQueue.h</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>proxygen/folly/folly/<a class="el" href="MPMCQueue_8h_source.html">MPMCQueue.h</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacefolly.html">folly</a></li><li class="navelem"><a class="el" href="classfolly_1_1MPMCQueue_3_01T_00_01Atom_00_01true_01_4.html">MPMCQueue&lt; T, Atom, true &gt;</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
