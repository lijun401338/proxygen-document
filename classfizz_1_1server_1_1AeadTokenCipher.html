<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>proxygen: fizz::server::AeadTokenCipher&lt; AeadType, HkdfType &gt; Class Template Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">proxygen
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('classfizz_1_1server_1_1AeadTokenCipher.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-attribs">Static Public Attributes</a> &#124;
<a href="#pri-types">Private Types</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="#pri-static-attribs">Static Private Attributes</a> &#124;
<a href="classfizz_1_1server_1_1AeadTokenCipher-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">fizz::server::AeadTokenCipher&lt; AeadType, HkdfType &gt; Class Template Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="AeadTokenCipher_8h_source.html">AeadTokenCipher.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:aa74ddc854eb0d29dad713c37741bea55"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfizz_1_1server_1_1AeadTokenCipher.html#aa74ddc854eb0d29dad713c37741bea55">AeadTokenCipher</a> (std::vector&lt; <a class="el" href="Conv_8cpp.html#ae1adbce218e7a9d09164012443191d24">std::string</a> &gt; contextStrings)</td></tr>
<tr class="separator:aa74ddc854eb0d29dad713c37741bea55"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a34183014e20a7eda009404d154c11dff"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfizz_1_1server_1_1AeadTokenCipher.html#a34183014e20a7eda009404d154c11dff">~AeadTokenCipher</a> ()</td></tr>
<tr class="separator:a34183014e20a7eda009404d154c11dff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aabae5c0ce836611ae212d41d3754cedb"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfizz_1_1server_1_1AeadTokenCipher.html#aabae5c0ce836611ae212d41d3754cedb">setSecrets</a> (const std::vector&lt; <a class="el" href="namespacefolly.html#a7f61a634c75bc3bb46447ec2b17ff0fe">folly::ByteRange</a> &gt; &amp;tokenSecrets)</td></tr>
<tr class="separator:aabae5c0ce836611ae212d41d3754cedb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a50be0ce553b1ac08034b0aa17169afbb"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfolly_1_1Optional.html">folly::Optional</a>&lt; <a class="el" href="namespacefizz.html#af020f21a568ff86800e03d6ad2a9b84d">Buf</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfizz_1_1server_1_1AeadTokenCipher.html#a50be0ce553b1ac08034b0aa17169afbb">encrypt</a> (<a class="el" href="namespacefizz.html#af020f21a568ff86800e03d6ad2a9b84d">Buf</a> plaintext) const </td></tr>
<tr class="separator:a50be0ce553b1ac08034b0aa17169afbb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1d3325e420874c59537d9389407d18ba"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfolly_1_1Optional.html">folly::Optional</a>&lt; <a class="el" href="namespacefizz.html#af020f21a568ff86800e03d6ad2a9b84d">Buf</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfizz_1_1server_1_1AeadTokenCipher.html#a1d3325e420874c59537d9389407d18ba">decrypt</a> (<a class="el" href="namespacefizz.html#af020f21a568ff86800e03d6ad2a9b84d">Buf</a>) const </td></tr>
<tr class="separator:a1d3325e420874c59537d9389407d18ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-attribs"></a>
Static Public Attributes</h2></td></tr>
<tr class="memitem:a928e3ee56b9ed6200a0b5d61fd7ded4f"><td class="memItemLeft" align="right" valign="top">static constexpr size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfizz_1_1server_1_1AeadTokenCipher.html#a928e3ee56b9ed6200a0b5d61fd7ded4f">kMinTokenSecretLength</a> = 32</td></tr>
<tr class="separator:a928e3ee56b9ed6200a0b5d61fd7ded4f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-types"></a>
Private Types</h2></td></tr>
<tr class="memitem:a84038ad65dc5a9e774cc4192c69dfca9"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfizz_1_1server_1_1AeadTokenCipher.html#a84038ad65dc5a9e774cc4192c69dfca9">Secret</a> = std::vector&lt; <a class="el" href="ConstexprMathBenchmark_8cpp.html#ae1affc9ca37cfb624959c866a73f83c2">uint8_t</a> &gt;</td></tr>
<tr class="separator:a84038ad65dc5a9e774cc4192c69dfca9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4558a415195f02ccd5f0f7787fe5c44e"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfizz_1_1server_1_1AeadTokenCipher.html#a4558a415195f02ccd5f0f7787fe5c44e">Salt</a> = std::array&lt; <a class="el" href="ConstexprMathBenchmark_8cpp.html#ae1affc9ca37cfb624959c866a73f83c2">uint8_t</a>, <a class="el" href="classfizz_1_1server_1_1AeadTokenCipher.html#af1eac01b246a6b69dd07f226e7521e30">kSaltLength</a> &gt;</td></tr>
<tr class="separator:a4558a415195f02ccd5f0f7787fe5c44e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a183ec49afa645962d1d70921c77673e9"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfizz_1_1server_1_1AeadTokenCipher.html#a183ec49afa645962d1d70921c77673e9">SeqNum</a> = <a class="el" href="ConstexprMathBenchmark_8cpp.html#a09a1e304d66d35dd47daffee9731edaa">uint32_t</a></td></tr>
<tr class="separator:a183ec49afa645962d1d70921c77673e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:ac6cc4327f8bae0a8b21ebe9014ee34b7"><td class="memItemLeft" align="right" valign="top">AeadType&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfizz_1_1server_1_1AeadTokenCipher.html#ac6cc4327f8bae0a8b21ebe9014ee34b7">createAead</a> (<a class="el" href="namespacefolly.html#a7f61a634c75bc3bb46447ec2b17ff0fe">folly::ByteRange</a> <a class="el" href="AeadCookieCipherTest_8cpp.html#a23d5c7d0b5a2788db54f6dcb9af8d109">secret</a>, <a class="el" href="namespacefolly.html#a7f61a634c75bc3bb46447ec2b17ff0fe">folly::ByteRange</a> salt) const </td></tr>
<tr class="separator:ac6cc4327f8bae0a8b21ebe9014ee34b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abce0bfc0929dc0044c04670137b82a5b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfizz_1_1server_1_1AeadTokenCipher.html#abce0bfc0929dc0044c04670137b82a5b">clearSecrets</a> ()</td></tr>
<tr class="separator:abce0bfc0929dc0044c04670137b82a5b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a6827cacf3561a048e884322958bfe0b3"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="classfizz_1_1server_1_1AeadTokenCipher.html#a84038ad65dc5a9e774cc4192c69dfca9">Secret</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfizz_1_1server_1_1AeadTokenCipher.html#a6827cacf3561a048e884322958bfe0b3">secrets_</a></td></tr>
<tr class="separator:a6827cacf3561a048e884322958bfe0b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee91c509c8e3a89c66274d53983e2355"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="Conv_8cpp.html#ae1adbce218e7a9d09164012443191d24">std::string</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfizz_1_1server_1_1AeadTokenCipher.html#aee91c509c8e3a89c66274d53983e2355">contextStrings_</a></td></tr>
<tr class="separator:aee91c509c8e3a89c66274d53983e2355"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-static-attribs"></a>
Static Private Attributes</h2></td></tr>
<tr class="memitem:af1eac01b246a6b69dd07f226e7521e30"><td class="memItemLeft" align="right" valign="top">static constexpr size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfizz_1_1server_1_1AeadTokenCipher.html#af1eac01b246a6b69dd07f226e7521e30">kSaltLength</a> = HkdfType::HashLen</td></tr>
<tr class="separator:af1eac01b246a6b69dd07f226e7521e30"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a79dad9001d91d8f2cf62dd54a33ca855"><td class="memItemLeft" align="right" valign="top">static constexpr size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfizz_1_1server_1_1AeadTokenCipher.html#a79dad9001d91d8f2cf62dd54a33ca855">kTokenHeaderLength</a> = <a class="el" href="classfizz_1_1server_1_1AeadTokenCipher.html#af1eac01b246a6b69dd07f226e7521e30">kSaltLength</a> + sizeof(<a class="el" href="classfizz_1_1server_1_1AeadTokenCipher.html#a183ec49afa645962d1d70921c77673e9">SeqNum</a>)</td></tr>
<tr class="separator:a79dad9001d91d8f2cf62dd54a33ca855"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><h3>template&lt;typename AeadType, typename HkdfType&gt;<br />
class fizz::server::AeadTokenCipher&lt; AeadType, HkdfType &gt;</h3>

<p>Used to encrypt and decrypt various tokens (for example PSKs). </p>

<p>Definition at line <a class="el" href="AeadTokenCipher_8h_source.html#l00022">22</a> of file <a class="el" href="AeadTokenCipher_8h_source.html">AeadTokenCipher.h</a>.</p>
</div><h2 class="groupheader">Member Typedef Documentation</h2>
<a class="anchor" id="a4558a415195f02ccd5f0f7787fe5c44e"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename AeadType, typename HkdfType&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="classfizz_1_1server_1_1AeadTokenCipher.html">fizz::server::AeadTokenCipher</a>&lt; AeadType, HkdfType &gt;::<a class="el" href="classfizz_1_1server_1_1AeadTokenCipher.html#a4558a415195f02ccd5f0f7787fe5c44e">Salt</a> =  std::array&lt;<a class="el" href="ConstexprMathBenchmark_8cpp.html#ae1affc9ca37cfb624959c866a73f83c2">uint8_t</a>, <a class="el" href="classfizz_1_1server_1_1AeadTokenCipher.html#af1eac01b246a6b69dd07f226e7521e30">kSaltLength</a>&gt;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="AeadTokenCipher_8h_source.html#l00053">53</a> of file <a class="el" href="AeadTokenCipher_8h_source.html">AeadTokenCipher.h</a>.</p>

</div>
</div>
<a class="anchor" id="a84038ad65dc5a9e774cc4192c69dfca9"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename AeadType, typename HkdfType&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="classfizz_1_1server_1_1AeadTokenCipher.html">fizz::server::AeadTokenCipher</a>&lt; AeadType, HkdfType &gt;::<a class="el" href="classfizz_1_1server_1_1AeadTokenCipher.html#a84038ad65dc5a9e774cc4192c69dfca9">Secret</a> =  std::vector&lt;<a class="el" href="ConstexprMathBenchmark_8cpp.html#ae1affc9ca37cfb624959c866a73f83c2">uint8_t</a>&gt;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="AeadTokenCipher_8h_source.html#l00051">51</a> of file <a class="el" href="AeadTokenCipher_8h_source.html">AeadTokenCipher.h</a>.</p>

</div>
</div>
<a class="anchor" id="a183ec49afa645962d1d70921c77673e9"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename AeadType, typename HkdfType&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="classfizz_1_1server_1_1AeadTokenCipher.html">fizz::server::AeadTokenCipher</a>&lt; AeadType, HkdfType &gt;::<a class="el" href="classfizz_1_1server_1_1AeadTokenCipher.html#a183ec49afa645962d1d70921c77673e9">SeqNum</a> =  <a class="el" href="ConstexprMathBenchmark_8cpp.html#a09a1e304d66d35dd47daffee9731edaa">uint32_t</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="AeadTokenCipher_8h_source.html#l00054">54</a> of file <a class="el" href="AeadTokenCipher_8h_source.html">AeadTokenCipher.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="aa74ddc854eb0d29dad713c37741bea55"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename AeadType, typename HkdfType&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classfizz_1_1server_1_1AeadTokenCipher.html">fizz::server::AeadTokenCipher</a>&lt; AeadType, HkdfType &gt;::<a class="el" href="classfizz_1_1server_1_1AeadTokenCipher.html">AeadTokenCipher</a> </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; <a class="el" href="Conv_8cpp.html#ae1adbce218e7a9d09164012443191d24">std::string</a> &gt;&#160;</td>
          <td class="paramname"><em>contextStrings</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">explicit</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Set additional context strings for use with these tokens. The strings will be used, in order, as part of the key derivation so that different contexts will result in different keys, preventing keys from one context from being used for another. </p>

<p>Definition at line <a class="el" href="AeadTokenCipher_8h_source.html#l00032">32</a> of file <a class="el" href="AeadTokenCipher_8h_source.html">AeadTokenCipher.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;      : <a class="code" href="classfizz_1_1server_1_1AeadTokenCipher.html#aee91c509c8e3a89c66274d53983e2355">contextStrings_</a>(<a class="code" href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">std::move</a>(contextStrings)) {}</div><div class="ttc" id="namespacefolly_1_1gen_html_ac24ec252b1b738a40c274285527c193f"><div class="ttname"><a href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">folly::gen::move</a></div><div class="ttdeci">constexpr detail::Map&lt; Move &gt; move</div><div class="ttdef"><b>Definition:</b> <a href="Base-inl_8h_source.html#l02567">Base-inl.h:2567</a></div></div>
<div class="ttc" id="classfizz_1_1server_1_1AeadTokenCipher_html_aee91c509c8e3a89c66274d53983e2355"><div class="ttname"><a href="classfizz_1_1server_1_1AeadTokenCipher.html#aee91c509c8e3a89c66274d53983e2355">fizz::server::AeadTokenCipher::contextStrings_</a></div><div class="ttdeci">std::vector&lt; std::string &gt; contextStrings_</div><div class="ttdef"><b>Definition:</b> <a href="AeadTokenCipher_8h_source.html#l00064">AeadTokenCipher.h:64</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a34183014e20a7eda009404d154c11dff"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename AeadType, typename HkdfType&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classfizz_1_1server_1_1AeadTokenCipher.html">fizz::server::AeadTokenCipher</a>&lt; AeadType, HkdfType &gt;::~<a class="el" href="classfizz_1_1server_1_1AeadTokenCipher.html">AeadTokenCipher</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="AeadTokenCipher_8h_source.html#l00035">35</a> of file <a class="el" href="AeadTokenCipher_8h_source.html">AeadTokenCipher.h</a>.</p>

<p>References <a class="el" href="AeadTokenCipher-inl_8h_source.html#l00125">fizz::server::AeadTokenCipher&lt; AeadType, HkdfType &gt;::clearSecrets()</a>, <a class="el" href="AeadTokenCipher-inl_8h_source.html#l00083">fizz::server::AeadTokenCipher&lt; AeadType, HkdfType &gt;::decrypt()</a>, <a class="el" href="AeadTokenCipher-inl_8h_source.html#l00062">fizz::server::AeadTokenCipher&lt; AeadType, HkdfType &gt;::encrypt()</a>, and <a class="el" href="AeadTokenCipher-inl_8h_source.html#l00037">fizz::server::AeadTokenCipher&lt; AeadType, HkdfType &gt;::setSecrets()</a>.</p>
<div class="fragment"><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;                     {</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <a class="code" href="classfizz_1_1server_1_1AeadTokenCipher.html#abce0bfc0929dc0044c04670137b82a5b">clearSecrets</a>();</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  }</div><div class="ttc" id="classfizz_1_1server_1_1AeadTokenCipher_html_abce0bfc0929dc0044c04670137b82a5b"><div class="ttname"><a href="classfizz_1_1server_1_1AeadTokenCipher.html#abce0bfc0929dc0044c04670137b82a5b">fizz::server::AeadTokenCipher::clearSecrets</a></div><div class="ttdeci">void clearSecrets()</div><div class="ttdef"><b>Definition:</b> <a href="AeadTokenCipher-inl_8h_source.html#l00125">AeadTokenCipher-inl.h:125</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="abce0bfc0929dc0044c04670137b82a5b"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename AeadType , typename HkdfType &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classfizz_1_1server_1_1AeadTokenCipher.html">fizz::server::AeadTokenCipher</a>&lt; AeadType, HkdfType &gt;::clearSecrets </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="AeadTokenCipher-inl_8h_source.html#l00125">125</a> of file <a class="el" href="AeadTokenCipher-inl_8h_source.html">AeadTokenCipher-inl.h</a>.</p>

<p>References <a class="el" href="Utils_8cpp_source.html#l00038">fizz::CryptoUtils::clean()</a>, <a class="el" href="Range_8h_source.html#l01114">folly::range()</a>, and <a class="el" href="AeadCookieCipherTest_8cpp_source.html#l00021">secret</a>.</p>

<p>Referenced by <a class="el" href="AeadTokenCipher_8h_source.html#l00035">fizz::server::AeadTokenCipher&lt; AeadType, HkdfType &gt;::~AeadTokenCipher()</a>.</p>
<div class="fragment"><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;                                                       {</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; <a class="code" href="AeadCookieCipherTest_8cpp.html#a23d5c7d0b5a2788db54f6dcb9af8d109">secret</a> : <a class="code" href="classfizz_1_1server_1_1AeadTokenCipher.html#a6827cacf3561a048e884322958bfe0b3">secrets_</a>) {</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <a class="code" href="structfizz_1_1CryptoUtils.html#a3dd901f80b2704cc0290ea1e8c992b63">CryptoUtils::clean</a>(<a class="code" href="namespacefolly.html#a79a54cd1a19a22878c86be5f90a33643">folly::range</a>(<a class="code" href="AeadCookieCipherTest_8cpp.html#a23d5c7d0b5a2788db54f6dcb9af8d109">secret</a>));</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  }</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  secrets_.clear();</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;}</div><div class="ttc" id="structfizz_1_1CryptoUtils_html_a3dd901f80b2704cc0290ea1e8c992b63"><div class="ttname"><a href="structfizz_1_1CryptoUtils.html#a3dd901f80b2704cc0290ea1e8c992b63">fizz::CryptoUtils::clean</a></div><div class="ttdeci">static void clean(folly::MutableByteRange range)</div><div class="ttdef"><b>Definition:</b> <a href="Utils_8cpp_source.html#l00038">Utils.cpp:38</a></div></div>
<div class="ttc" id="namespacefolly_html_a79a54cd1a19a22878c86be5f90a33643"><div class="ttname"><a href="namespacefolly.html#a79a54cd1a19a22878c86be5f90a33643">folly::range</a></div><div class="ttdeci">constexpr Range&lt; Iter &gt; range(Iter first, Iter last)</div><div class="ttdef"><b>Definition:</b> <a href="Range_8h_source.html#l01114">Range.h:1114</a></div></div>
<div class="ttc" id="classfizz_1_1server_1_1AeadTokenCipher_html_a6827cacf3561a048e884322958bfe0b3"><div class="ttname"><a href="classfizz_1_1server_1_1AeadTokenCipher.html#a6827cacf3561a048e884322958bfe0b3">fizz::server::AeadTokenCipher::secrets_</a></div><div class="ttdeci">std::vector&lt; Secret &gt; secrets_</div><div class="ttdef"><b>Definition:</b> <a href="AeadTokenCipher_8h_source.html#l00062">AeadTokenCipher.h:62</a></div></div>
<div class="ttc" id="AeadCookieCipherTest_8cpp_html_a23d5c7d0b5a2788db54f6dcb9af8d109"><div class="ttname"><a href="AeadCookieCipherTest_8cpp.html#a23d5c7d0b5a2788db54f6dcb9af8d109">secret</a></div><div class="ttdeci">static constexpr StringPiece secret</div><div class="ttdef"><b>Definition:</b> <a href="AeadCookieCipherTest_8cpp_source.html#l00021">AeadCookieCipherTest.cpp:21</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ac6cc4327f8bae0a8b21ebe9014ee34b7"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename AeadType , typename HkdfType &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">AeadType <a class="el" href="classfizz_1_1server_1_1AeadTokenCipher.html">fizz::server::AeadTokenCipher</a>&lt; AeadType, HkdfType &gt;::createAead </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespacefolly.html#a7f61a634c75bc3bb46447ec2b17ff0fe">folly::ByteRange</a>&#160;</td>
          <td class="paramname"><em>secret</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacefolly.html#a7f61a634c75bc3bb46447ec2b17ff0fe">folly::ByteRange</a>&#160;</td>
          <td class="paramname"><em>salt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="AeadTokenCipher-inl_8h_source.html#l00109">109</a> of file <a class="el" href="AeadTokenCipher-inl_8h_source.html">AeadTokenCipher-inl.h</a>.</p>

<p>References <a class="el" href="deadlock_8py_source.html#l00447">deadlock::info()</a>, <a class="el" href="Base-inl_8h_source.html#l02567">folly::gen::move</a>, and <a class="el" href="IOBuf_8cpp_source.html#l00353">folly::IOBuf::wrapBuffer()</a>.</p>
<div class="fragment"><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;                               {</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  AeadType aead;</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  std::unique_ptr&lt;folly::IOBuf&gt; <a class="code" href="namespacedeadlock.html#a6cba8e3d51735d7ac2ac91a947f4984b">info</a> = <a class="code" href="classfolly_1_1IOBuf.html#a354ecb1fb5f80e8d0006cf0e74307b63">folly::IOBuf::wrapBuffer</a>(salt);</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  <span class="keyword">auto</span> keys =</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;      HkdfType().expand(secret, *info, aead.keyLength() + aead.ivLength());</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  <a class="code" href="classfolly_1_1io_1_1Cursor.html">folly::io::Cursor</a> cursor(keys.get());</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  TrafficKey key;</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  cursor.<a class="code" href="classfolly_1_1io_1_1detail_1_1CursorBase.html#acf3608dda9a7ecbd97c29cbf0b931107">clone</a>(key.key, aead.keyLength());</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  cursor.clone(key.iv, aead.ivLength());</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  aead.setKey(<a class="code" href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">std::move</a>(key));</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  <span class="keywordflow">return</span> aead;</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;}</div><div class="ttc" id="namespacedeadlock_html_a6cba8e3d51735d7ac2ac91a947f4984b"><div class="ttname"><a href="namespacedeadlock.html#a6cba8e3d51735d7ac2ac91a947f4984b">deadlock.info</a></div><div class="ttdeci">def info()</div><div class="ttdef"><b>Definition:</b> <a href="deadlock_8py_source.html#l00447">deadlock.py:447</a></div></div>
<div class="ttc" id="classfolly_1_1IOBuf_html_a354ecb1fb5f80e8d0006cf0e74307b63"><div class="ttname"><a href="classfolly_1_1IOBuf.html#a354ecb1fb5f80e8d0006cf0e74307b63">folly::IOBuf::wrapBuffer</a></div><div class="ttdeci">static std::unique_ptr&lt; IOBuf &gt; wrapBuffer(const void *buf, std::size_t capacity)</div><div class="ttdef"><b>Definition:</b> <a href="IOBuf_8cpp_source.html#l00353">IOBuf.cpp:353</a></div></div>
<div class="ttc" id="classfolly_1_1io_1_1detail_1_1CursorBase_html_acf3608dda9a7ecbd97c29cbf0b931107"><div class="ttname"><a href="classfolly_1_1io_1_1detail_1_1CursorBase.html#acf3608dda9a7ecbd97c29cbf0b931107">folly::io::detail::CursorBase::clone</a></div><div class="ttdeci">void clone(std::unique_ptr&lt; folly::IOBuf &gt; &amp;buf, size_t len)</div><div class="ttdef"><b>Definition:</b> <a href="Cursor_8h_source.html#l00456">Cursor.h:456</a></div></div>
<div class="ttc" id="namespacefolly_1_1gen_html_ac24ec252b1b738a40c274285527c193f"><div class="ttname"><a href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">folly::gen::move</a></div><div class="ttdeci">constexpr detail::Map&lt; Move &gt; move</div><div class="ttdef"><b>Definition:</b> <a href="Base-inl_8h_source.html#l02567">Base-inl.h:2567</a></div></div>
<div class="ttc" id="classfolly_1_1io_1_1Cursor_html"><div class="ttname"><a href="classfolly_1_1io_1_1Cursor.html">folly::io::Cursor</a></div><div class="ttdef"><b>Definition:</b> <a href="Cursor_8h_source.html#l00721">Cursor.h:721</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a1d3325e420874c59537d9389407d18ba"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename AeadType , typename HkdfType &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classfolly_1_1Optional.html">folly::Optional</a>&lt; <a class="el" href="namespacefizz.html#af020f21a568ff86800e03d6ad2a9b84d">Buf</a> &gt; <a class="el" href="classfizz_1_1server_1_1AeadTokenCipher.html">fizz::server::AeadTokenCipher</a>&lt; AeadType, HkdfType &gt;::decrypt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespacefizz.html#af020f21a568ff86800e03d6ad2a9b84d">Buf</a>&#160;</td>
          <td class="paramname"><em>token</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="AeadTokenCipher-inl_8h_source.html#l00083">83</a> of file <a class="el" href="AeadTokenCipher-inl_8h_source.html">AeadTokenCipher-inl.h</a>.</p>

<p>References <a class="el" href="Base-inl_8h_source.html#l02567">folly::gen::move</a>, <a class="el" href="Optional_8h_source.html#l00087">folly::none</a>, <a class="el" href="Range_8h_source.html#l01114">folly::range()</a>, and <a class="el" href="AeadCookieCipherTest_8cpp_source.html#l00021">secret</a>.</p>

<p>Referenced by <a class="el" href="AeadTokenCipher_8h_source.html#l00035">fizz::server::AeadTokenCipher&lt; AeadType, HkdfType &gt;::~AeadTokenCipher()</a>.</p>
<div class="fragment"><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;                     {</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  <a class="code" href="classfolly_1_1io_1_1Cursor.html">folly::io::Cursor</a> cursor(token.get());</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classfizz_1_1server_1_1AeadTokenCipher.html#a6827cacf3561a048e884322958bfe0b3">secrets_</a>.empty() || !cursor.canAdvance(<a class="code" href="classfizz_1_1server_1_1AeadTokenCipher.html#a79dad9001d91d8f2cf62dd54a33ca855">kTokenHeaderLength</a>)) {</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacefolly.html#ac22c63dbe5af3b0bedb0f21031691537">folly::none</a>;</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  }</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  <a class="code" href="classfizz_1_1server_1_1AeadTokenCipher.html#a4558a415195f02ccd5f0f7787fe5c44e">Salt</a> salt;</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  cursor.pull(salt.data(), salt.size());</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  <span class="keyword">auto</span> seqNum = cursor.readBE&lt;<a class="code" href="classfizz_1_1server_1_1AeadTokenCipher.html#a183ec49afa645962d1d70921c77673e9">SeqNum</a>&gt;();</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  <a class="code" href="namespacefizz.html#af020f21a568ff86800e03d6ad2a9b84d">Buf</a> ciphertext;</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  cursor.clone(ciphertext, cursor.totalLength());</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; <a class="code" href="AeadCookieCipherTest_8cpp.html#a23d5c7d0b5a2788db54f6dcb9af8d109">secret</a> : <a class="code" href="classfizz_1_1server_1_1AeadTokenCipher.html#a6827cacf3561a048e884322958bfe0b3">secrets_</a>) {</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <span class="keyword">auto</span> aead = <a class="code" href="classfizz_1_1server_1_1AeadTokenCipher.html#ac6cc4327f8bae0a8b21ebe9014ee34b7">createAead</a>(<a class="code" href="namespacefolly.html#a79a54cd1a19a22878c86be5f90a33643">folly::range</a>(<a class="code" href="AeadCookieCipherTest_8cpp.html#a23d5c7d0b5a2788db54f6dcb9af8d109">secret</a>), <a class="code" href="namespacefolly.html#a79a54cd1a19a22878c86be5f90a33643">folly::range</a>(salt));</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <span class="keyword">auto</span> result = aead.tryDecrypt(ciphertext-&gt;clone(), <span class="keyword">nullptr</span>, seqNum);</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="keywordflow">if</span> (result) {</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">std::move</a>(result);</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    }</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  }</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  VLOG(6) &lt;&lt; <span class="stringliteral">&quot;Failed to decrypt token.&quot;</span>;</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacefolly.html#ac22c63dbe5af3b0bedb0f21031691537">folly::none</a>;</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;}</div><div class="ttc" id="namespacefolly_1_1gen_html_ac24ec252b1b738a40c274285527c193f"><div class="ttname"><a href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">folly::gen::move</a></div><div class="ttdeci">constexpr detail::Map&lt; Move &gt; move</div><div class="ttdef"><b>Definition:</b> <a href="Base-inl_8h_source.html#l02567">Base-inl.h:2567</a></div></div>
<div class="ttc" id="classfizz_1_1server_1_1AeadTokenCipher_html_a4558a415195f02ccd5f0f7787fe5c44e"><div class="ttname"><a href="classfizz_1_1server_1_1AeadTokenCipher.html#a4558a415195f02ccd5f0f7787fe5c44e">fizz::server::AeadTokenCipher::Salt</a></div><div class="ttdeci">std::array&lt; uint8_t, kSaltLength &gt; Salt</div><div class="ttdef"><b>Definition:</b> <a href="AeadTokenCipher_8h_source.html#l00053">AeadTokenCipher.h:53</a></div></div>
<div class="ttc" id="classfolly_1_1io_1_1Cursor_html"><div class="ttname"><a href="classfolly_1_1io_1_1Cursor.html">folly::io::Cursor</a></div><div class="ttdef"><b>Definition:</b> <a href="Cursor_8h_source.html#l00721">Cursor.h:721</a></div></div>
<div class="ttc" id="namespacefolly_html_a79a54cd1a19a22878c86be5f90a33643"><div class="ttname"><a href="namespacefolly.html#a79a54cd1a19a22878c86be5f90a33643">folly::range</a></div><div class="ttdeci">constexpr Range&lt; Iter &gt; range(Iter first, Iter last)</div><div class="ttdef"><b>Definition:</b> <a href="Range_8h_source.html#l01114">Range.h:1114</a></div></div>
<div class="ttc" id="classfizz_1_1server_1_1AeadTokenCipher_html_a79dad9001d91d8f2cf62dd54a33ca855"><div class="ttname"><a href="classfizz_1_1server_1_1AeadTokenCipher.html#a79dad9001d91d8f2cf62dd54a33ca855">fizz::server::AeadTokenCipher::kTokenHeaderLength</a></div><div class="ttdeci">static constexpr size_t kTokenHeaderLength</div><div class="ttdef"><b>Definition:</b> <a href="AeadTokenCipher_8h_source.html#l00055">AeadTokenCipher.h:55</a></div></div>
<div class="ttc" id="classfizz_1_1server_1_1AeadTokenCipher_html_a183ec49afa645962d1d70921c77673e9"><div class="ttname"><a href="classfizz_1_1server_1_1AeadTokenCipher.html#a183ec49afa645962d1d70921c77673e9">fizz::server::AeadTokenCipher::SeqNum</a></div><div class="ttdeci">uint32_t SeqNum</div><div class="ttdef"><b>Definition:</b> <a href="AeadTokenCipher_8h_source.html#l00054">AeadTokenCipher.h:54</a></div></div>
<div class="ttc" id="classfizz_1_1server_1_1AeadTokenCipher_html_a6827cacf3561a048e884322958bfe0b3"><div class="ttname"><a href="classfizz_1_1server_1_1AeadTokenCipher.html#a6827cacf3561a048e884322958bfe0b3">fizz::server::AeadTokenCipher::secrets_</a></div><div class="ttdeci">std::vector&lt; Secret &gt; secrets_</div><div class="ttdef"><b>Definition:</b> <a href="AeadTokenCipher_8h_source.html#l00062">AeadTokenCipher.h:62</a></div></div>
<div class="ttc" id="namespacefizz_html_af020f21a568ff86800e03d6ad2a9b84d"><div class="ttname"><a href="namespacefizz.html#af020f21a568ff86800e03d6ad2a9b84d">fizz::Buf</a></div><div class="ttdeci">std::unique_ptr&lt; folly::IOBuf &gt; Buf</div><div class="ttdef"><b>Definition:</b> <a href="fizz_2fizz_2record_2Types_8h_source.html#l00022">Types.h:22</a></div></div>
<div class="ttc" id="AeadCookieCipherTest_8cpp_html_a23d5c7d0b5a2788db54f6dcb9af8d109"><div class="ttname"><a href="AeadCookieCipherTest_8cpp.html#a23d5c7d0b5a2788db54f6dcb9af8d109">secret</a></div><div class="ttdeci">static constexpr StringPiece secret</div><div class="ttdef"><b>Definition:</b> <a href="AeadCookieCipherTest_8cpp_source.html#l00021">AeadCookieCipherTest.cpp:21</a></div></div>
<div class="ttc" id="namespacefolly_html_ac22c63dbe5af3b0bedb0f21031691537"><div class="ttname"><a href="namespacefolly.html#ac22c63dbe5af3b0bedb0f21031691537">folly::none</a></div><div class="ttdeci">constexpr None none</div><div class="ttdef"><b>Definition:</b> <a href="Optional_8h_source.html#l00087">Optional.h:87</a></div></div>
<div class="ttc" id="classfizz_1_1server_1_1AeadTokenCipher_html_ac6cc4327f8bae0a8b21ebe9014ee34b7"><div class="ttname"><a href="classfizz_1_1server_1_1AeadTokenCipher.html#ac6cc4327f8bae0a8b21ebe9014ee34b7">fizz::server::AeadTokenCipher::createAead</a></div><div class="ttdeci">AeadType createAead(folly::ByteRange secret, folly::ByteRange salt) const </div><div class="ttdef"><b>Definition:</b> <a href="AeadTokenCipher-inl_8h_source.html#l00109">AeadTokenCipher-inl.h:109</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a50be0ce553b1ac08034b0aa17169afbb"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename AeadType , typename HkdfType &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classfolly_1_1Optional.html">folly::Optional</a>&lt; <a class="el" href="namespacefizz.html#af020f21a568ff86800e03d6ad2a9b84d">Buf</a> &gt; <a class="el" href="classfizz_1_1server_1_1AeadTokenCipher.html">fizz::server::AeadTokenCipher</a>&lt; AeadType, HkdfType &gt;::encrypt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespacefizz.html#af020f21a568ff86800e03d6ad2a9b84d">Buf</a>&#160;</td>
          <td class="paramname"><em>plaintext</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="AeadTokenCipher-inl_8h_source.html#l00062">62</a> of file <a class="el" href="AeadTokenCipher-inl_8h_source.html">AeadTokenCipher-inl.h</a>.</p>

<p>References <a class="el" href="IOBuf_8cpp_source.html#l00229">folly::IOBuf::create()</a>, <a class="el" href="Base-inl_8h_source.html#l02567">folly::gen::move</a>, <a class="el" href="Optional_8h_source.html#l00087">folly::none</a>, <a class="el" href="Cursor_8h_source.html#l00755">folly::io::detail::Writable&lt; Derived &gt;::push()</a>, and <a class="el" href="Range_8h_source.html#l01114">folly::range()</a>.</p>

<p>Referenced by <a class="el" href="AeadTokenCipher_8h_source.html#l00035">fizz::server::AeadTokenCipher&lt; AeadType, HkdfType &gt;::~AeadTokenCipher()</a>.</p>
<div class="fragment"><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;                         {</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classfizz_1_1server_1_1AeadTokenCipher.html#a6827cacf3561a048e884322958bfe0b3">secrets_</a>.empty()) {</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacefolly.html#ac22c63dbe5af3b0bedb0f21031691537">folly::none</a>;</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  }</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  <span class="keyword">auto</span> salt = RandomGenerator&lt;kSaltLength&gt;().generateRandom();</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  <span class="keyword">auto</span> aead = <a class="code" href="classfizz_1_1server_1_1AeadTokenCipher.html#ac6cc4327f8bae0a8b21ebe9014ee34b7">createAead</a>(<a class="code" href="namespacefolly.html#a79a54cd1a19a22878c86be5f90a33643">folly::range</a>(<a class="code" href="classfizz_1_1server_1_1AeadTokenCipher.html#a6827cacf3561a048e884322958bfe0b3">secrets_</a>.front()), <a class="code" href="namespacefolly.html#a79a54cd1a19a22878c86be5f90a33643">folly::range</a>(salt));</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  <span class="comment">// For now we always use sequence number 0.</span></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  <a class="code" href="classfizz_1_1server_1_1AeadTokenCipher.html#a183ec49afa645962d1d70921c77673e9">SeqNum</a> seqNum = 0;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  <span class="keyword">auto</span> token = <a class="code" href="classfolly_1_1IOBuf.html#a744f20ec9d0829fe17cf78fb48b7785e">folly::IOBuf::create</a>(<a class="code" href="classfizz_1_1server_1_1AeadTokenCipher.html#a79dad9001d91d8f2cf62dd54a33ca855">kTokenHeaderLength</a>);</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  <a class="code" href="classfolly_1_1io_1_1Appender.html">folly::io::Appender</a> appender(token.get(), <a class="code" href="classfizz_1_1server_1_1AeadTokenCipher.html#a79dad9001d91d8f2cf62dd54a33ca855">kTokenHeaderLength</a>);</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  appender.<a class="code" href="classfolly_1_1io_1_1detail_1_1Writable.html#a62031acaa273bf8d909783a7f8efc9df">push</a>(<a class="code" href="namespacefolly.html#a79a54cd1a19a22878c86be5f90a33643">folly::range</a>(salt));</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  appender.writeBE(seqNum);</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  token-&gt;prependChain(aead.encrypt(<a class="code" href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">std::move</a>(plaintext), <span class="keyword">nullptr</span>, seqNum));</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">std::move</a>(token);</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;}</div><div class="ttc" id="classfolly_1_1IOBuf_html_a744f20ec9d0829fe17cf78fb48b7785e"><div class="ttname"><a href="classfolly_1_1IOBuf.html#a744f20ec9d0829fe17cf78fb48b7785e">folly::IOBuf::create</a></div><div class="ttdeci">static std::unique_ptr&lt; IOBuf &gt; create(std::size_t capacity)</div><div class="ttdef"><b>Definition:</b> <a href="IOBuf_8cpp_source.html#l00229">IOBuf.cpp:229</a></div></div>
<div class="ttc" id="namespacefolly_1_1gen_html_ac24ec252b1b738a40c274285527c193f"><div class="ttname"><a href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">folly::gen::move</a></div><div class="ttdeci">constexpr detail::Map&lt; Move &gt; move</div><div class="ttdef"><b>Definition:</b> <a href="Base-inl_8h_source.html#l02567">Base-inl.h:2567</a></div></div>
<div class="ttc" id="classfolly_1_1io_1_1detail_1_1Writable_html_a62031acaa273bf8d909783a7f8efc9df"><div class="ttname"><a href="classfolly_1_1io_1_1detail_1_1Writable.html#a62031acaa273bf8d909783a7f8efc9df">folly::io::detail::Writable::push</a></div><div class="ttdeci">void push(const uint8_t *buf, size_t len)</div><div class="ttdef"><b>Definition:</b> <a href="Cursor_8h_source.html#l00755">Cursor.h:755</a></div></div>
<div class="ttc" id="classfolly_1_1io_1_1Appender_html"><div class="ttname"><a href="classfolly_1_1io_1_1Appender.html">folly::io::Appender</a></div><div class="ttdef"><b>Definition:</b> <a href="Cursor_8h_source.html#l00969">Cursor.h:969</a></div></div>
<div class="ttc" id="namespacefolly_html_a79a54cd1a19a22878c86be5f90a33643"><div class="ttname"><a href="namespacefolly.html#a79a54cd1a19a22878c86be5f90a33643">folly::range</a></div><div class="ttdeci">constexpr Range&lt; Iter &gt; range(Iter first, Iter last)</div><div class="ttdef"><b>Definition:</b> <a href="Range_8h_source.html#l01114">Range.h:1114</a></div></div>
<div class="ttc" id="classfizz_1_1server_1_1AeadTokenCipher_html_a79dad9001d91d8f2cf62dd54a33ca855"><div class="ttname"><a href="classfizz_1_1server_1_1AeadTokenCipher.html#a79dad9001d91d8f2cf62dd54a33ca855">fizz::server::AeadTokenCipher::kTokenHeaderLength</a></div><div class="ttdeci">static constexpr size_t kTokenHeaderLength</div><div class="ttdef"><b>Definition:</b> <a href="AeadTokenCipher_8h_source.html#l00055">AeadTokenCipher.h:55</a></div></div>
<div class="ttc" id="classfizz_1_1server_1_1AeadTokenCipher_html_a183ec49afa645962d1d70921c77673e9"><div class="ttname"><a href="classfizz_1_1server_1_1AeadTokenCipher.html#a183ec49afa645962d1d70921c77673e9">fizz::server::AeadTokenCipher::SeqNum</a></div><div class="ttdeci">uint32_t SeqNum</div><div class="ttdef"><b>Definition:</b> <a href="AeadTokenCipher_8h_source.html#l00054">AeadTokenCipher.h:54</a></div></div>
<div class="ttc" id="classfizz_1_1server_1_1AeadTokenCipher_html_a6827cacf3561a048e884322958bfe0b3"><div class="ttname"><a href="classfizz_1_1server_1_1AeadTokenCipher.html#a6827cacf3561a048e884322958bfe0b3">fizz::server::AeadTokenCipher::secrets_</a></div><div class="ttdeci">std::vector&lt; Secret &gt; secrets_</div><div class="ttdef"><b>Definition:</b> <a href="AeadTokenCipher_8h_source.html#l00062">AeadTokenCipher.h:62</a></div></div>
<div class="ttc" id="namespacefolly_html_ac22c63dbe5af3b0bedb0f21031691537"><div class="ttname"><a href="namespacefolly.html#ac22c63dbe5af3b0bedb0f21031691537">folly::none</a></div><div class="ttdeci">constexpr None none</div><div class="ttdef"><b>Definition:</b> <a href="Optional_8h_source.html#l00087">Optional.h:87</a></div></div>
<div class="ttc" id="classfizz_1_1server_1_1AeadTokenCipher_html_ac6cc4327f8bae0a8b21ebe9014ee34b7"><div class="ttname"><a href="classfizz_1_1server_1_1AeadTokenCipher.html#ac6cc4327f8bae0a8b21ebe9014ee34b7">fizz::server::AeadTokenCipher::createAead</a></div><div class="ttdeci">AeadType createAead(folly::ByteRange secret, folly::ByteRange salt) const </div><div class="ttdef"><b>Definition:</b> <a href="AeadTokenCipher-inl_8h_source.html#l00109">AeadTokenCipher-inl.h:109</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aabae5c0ce836611ae212d41d3754cedb"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename AeadType , typename HkdfType &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classfizz_1_1server_1_1AeadTokenCipher.html">fizz::server::AeadTokenCipher</a>&lt; AeadType, HkdfType &gt;::setSecrets </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="namespacefolly.html#a7f61a634c75bc3bb46447ec2b17ff0fe">folly::ByteRange</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>tokenSecrets</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set secrets to use for token encryption/decryption. The first one will be used for encryption. All secrets must be at least kMinTokenSecretLength long. </p>

<p>Definition at line <a class="el" href="AeadTokenCipher-inl_8h_source.html#l00037">37</a> of file <a class="el" href="AeadTokenCipher-inl_8h_source.html">AeadTokenCipher-inl.h</a>.</p>

<p>References <a class="el" href="Base-inl_8h_source.html#l02567">folly::gen::move</a>, and <a class="el" href="Range_8h_source.html#l01114">folly::range()</a>.</p>

<p>Referenced by <a class="el" href="AeadTokenCipher_8h_source.html#l00035">fizz::server::AeadTokenCipher&lt; AeadType, HkdfType &gt;::~AeadTokenCipher()</a>.</p>
<div class="fragment"><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;                                                   {</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  VLOG(3) &lt;&lt; <span class="stringliteral">&quot;Updating token secrets&quot;</span>;</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; tokenSecret : tokenSecrets) {</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <span class="keywordflow">if</span> (tokenSecret.size() &lt; <a class="code" href="classfizz_1_1server_1_1AeadTokenCipher.html#a928e3ee56b9ed6200a0b5d61fd7ded4f">kMinTokenSecretLength</a>) {</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;      LOG(ERROR) &lt;&lt; <span class="stringliteral">&quot;Token cipher secret too small - not updating.&quot;</span>;</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    }</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  }</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  VLOG(4) &lt;&lt; <span class="stringliteral">&quot;Updating token secrets, num=&quot;</span> &lt;&lt; tokenSecrets.size();</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  <a class="code" href="classfizz_1_1server_1_1AeadTokenCipher.html#abce0bfc0929dc0044c04670137b82a5b">clearSecrets</a>();</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; tokenSecret : tokenSecrets) {</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <a class="code" href="classfizz_1_1server_1_1AeadTokenCipher.html#a84038ad65dc5a9e774cc4192c69dfca9">Secret</a> extracted(tokenSecret.begin(), tokenSecret.end());</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; contextString : <a class="code" href="classfizz_1_1server_1_1AeadTokenCipher.html#aee91c509c8e3a89c66274d53983e2355">contextStrings_</a>) {</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;      extracted = HkdfType().extract(</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;          <a class="code" href="namespacefolly.html#a79a54cd1a19a22878c86be5f90a33643">folly::range</a>(contextString), <a class="code" href="namespacefolly.html#a79a54cd1a19a22878c86be5f90a33643">folly::range</a>(extracted));</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    }</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <a class="code" href="classfizz_1_1server_1_1AeadTokenCipher.html#a6827cacf3561a048e884322958bfe0b3">secrets_</a>.push_back(<a class="code" href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">std::move</a>(extracted));</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  }</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;}</div><div class="ttc" id="classfizz_1_1server_1_1AeadTokenCipher_html_abce0bfc0929dc0044c04670137b82a5b"><div class="ttname"><a href="classfizz_1_1server_1_1AeadTokenCipher.html#abce0bfc0929dc0044c04670137b82a5b">fizz::server::AeadTokenCipher::clearSecrets</a></div><div class="ttdeci">void clearSecrets()</div><div class="ttdef"><b>Definition:</b> <a href="AeadTokenCipher-inl_8h_source.html#l00125">AeadTokenCipher-inl.h:125</a></div></div>
<div class="ttc" id="namespacefolly_1_1gen_html_ac24ec252b1b738a40c274285527c193f"><div class="ttname"><a href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">folly::gen::move</a></div><div class="ttdeci">constexpr detail::Map&lt; Move &gt; move</div><div class="ttdef"><b>Definition:</b> <a href="Base-inl_8h_source.html#l02567">Base-inl.h:2567</a></div></div>
<div class="ttc" id="classfizz_1_1server_1_1AeadTokenCipher_html_a84038ad65dc5a9e774cc4192c69dfca9"><div class="ttname"><a href="classfizz_1_1server_1_1AeadTokenCipher.html#a84038ad65dc5a9e774cc4192c69dfca9">fizz::server::AeadTokenCipher::Secret</a></div><div class="ttdeci">std::vector&lt; uint8_t &gt; Secret</div><div class="ttdef"><b>Definition:</b> <a href="AeadTokenCipher_8h_source.html#l00051">AeadTokenCipher.h:51</a></div></div>
<div class="ttc" id="classfizz_1_1server_1_1AeadTokenCipher_html_a928e3ee56b9ed6200a0b5d61fd7ded4f"><div class="ttname"><a href="classfizz_1_1server_1_1AeadTokenCipher.html#a928e3ee56b9ed6200a0b5d61fd7ded4f">fizz::server::AeadTokenCipher::kMinTokenSecretLength</a></div><div class="ttdeci">static constexpr size_t kMinTokenSecretLength</div><div class="ttdef"><b>Definition:</b> <a href="AeadTokenCipher_8h_source.html#l00024">AeadTokenCipher.h:24</a></div></div>
<div class="ttc" id="namespacefolly_html_a79a54cd1a19a22878c86be5f90a33643"><div class="ttname"><a href="namespacefolly.html#a79a54cd1a19a22878c86be5f90a33643">folly::range</a></div><div class="ttdeci">constexpr Range&lt; Iter &gt; range(Iter first, Iter last)</div><div class="ttdef"><b>Definition:</b> <a href="Range_8h_source.html#l01114">Range.h:1114</a></div></div>
<div class="ttc" id="classfizz_1_1server_1_1AeadTokenCipher_html_a6827cacf3561a048e884322958bfe0b3"><div class="ttname"><a href="classfizz_1_1server_1_1AeadTokenCipher.html#a6827cacf3561a048e884322958bfe0b3">fizz::server::AeadTokenCipher::secrets_</a></div><div class="ttdeci">std::vector&lt; Secret &gt; secrets_</div><div class="ttdef"><b>Definition:</b> <a href="AeadTokenCipher_8h_source.html#l00062">AeadTokenCipher.h:62</a></div></div>
<div class="ttc" id="classfizz_1_1server_1_1AeadTokenCipher_html_aee91c509c8e3a89c66274d53983e2355"><div class="ttname"><a href="classfizz_1_1server_1_1AeadTokenCipher.html#aee91c509c8e3a89c66274d53983e2355">fizz::server::AeadTokenCipher::contextStrings_</a></div><div class="ttdeci">std::vector&lt; std::string &gt; contextStrings_</div><div class="ttdef"><b>Definition:</b> <a href="AeadTokenCipher_8h_source.html#l00064">AeadTokenCipher.h:64</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="aee91c509c8e3a89c66274d53983e2355"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename AeadType, typename HkdfType&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="Conv_8cpp.html#ae1adbce218e7a9d09164012443191d24">std::string</a>&gt; <a class="el" href="classfizz_1_1server_1_1AeadTokenCipher.html">fizz::server::AeadTokenCipher</a>&lt; AeadType, HkdfType &gt;::contextStrings_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="AeadTokenCipher_8h_source.html#l00064">64</a> of file <a class="el" href="AeadTokenCipher_8h_source.html">AeadTokenCipher.h</a>.</p>

</div>
</div>
<a class="anchor" id="a928e3ee56b9ed6200a0b5d61fd7ded4f"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename AeadType, typename HkdfType&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">constexpr size_t <a class="el" href="classfizz_1_1server_1_1AeadTokenCipher.html">fizz::server::AeadTokenCipher</a>&lt; AeadType, HkdfType &gt;::kMinTokenSecretLength = 32</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="AeadTokenCipher_8h_source.html#l00024">24</a> of file <a class="el" href="AeadTokenCipher_8h_source.html">AeadTokenCipher.h</a>.</p>

</div>
</div>
<a class="anchor" id="af1eac01b246a6b69dd07f226e7521e30"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename AeadType, typename HkdfType&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">constexpr size_t <a class="el" href="classfizz_1_1server_1_1AeadTokenCipher.html">fizz::server::AeadTokenCipher</a>&lt; AeadType, HkdfType &gt;::kSaltLength = HkdfType::HashLen</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="AeadTokenCipher_8h_source.html#l00052">52</a> of file <a class="el" href="AeadTokenCipher_8h_source.html">AeadTokenCipher.h</a>.</p>

</div>
</div>
<a class="anchor" id="a79dad9001d91d8f2cf62dd54a33ca855"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename AeadType, typename HkdfType&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">constexpr size_t <a class="el" href="classfizz_1_1server_1_1AeadTokenCipher.html">fizz::server::AeadTokenCipher</a>&lt; AeadType, HkdfType &gt;::kTokenHeaderLength = <a class="el" href="classfizz_1_1server_1_1AeadTokenCipher.html#af1eac01b246a6b69dd07f226e7521e30">kSaltLength</a> + sizeof(<a class="el" href="classfizz_1_1server_1_1AeadTokenCipher.html#a183ec49afa645962d1d70921c77673e9">SeqNum</a>)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="AeadTokenCipher_8h_source.html#l00055">55</a> of file <a class="el" href="AeadTokenCipher_8h_source.html">AeadTokenCipher.h</a>.</p>

</div>
</div>
<a class="anchor" id="a6827cacf3561a048e884322958bfe0b3"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename AeadType, typename HkdfType&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="classfizz_1_1server_1_1AeadTokenCipher.html#a84038ad65dc5a9e774cc4192c69dfca9">Secret</a>&gt; <a class="el" href="classfizz_1_1server_1_1AeadTokenCipher.html">fizz::server::AeadTokenCipher</a>&lt; AeadType, HkdfType &gt;::secrets_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="AeadTokenCipher_8h_source.html#l00062">62</a> of file <a class="el" href="AeadTokenCipher_8h_source.html">AeadTokenCipher.h</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>proxygen/fizz/fizz/server/<a class="el" href="AeadTokenCipher_8h_source.html">AeadTokenCipher.h</a></li>
<li>proxygen/fizz/fizz/server/<a class="el" href="AeadTokenCipher-inl_8h_source.html">AeadTokenCipher-inl.h</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacefizz.html">fizz</a></li><li class="navelem"><a class="el" href="namespacefizz_1_1server.html">server</a></li><li class="navelem"><a class="el" href="classfizz_1_1server_1_1AeadTokenCipher.html">AeadTokenCipher</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
