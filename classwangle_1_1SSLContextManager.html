<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>proxygen: wangle::SSLContextManager Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">proxygen
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('classwangle_1_1SSLContextManager.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classwangle_1_1SSLContextManager-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">wangle::SSLContextManager Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="SSLContextManager_8h_source.html">SSLContextManager.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for wangle::SSLContextManager:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classwangle_1_1SSLContextManager.png" usemap="#wangle::SSLContextManager_map" alt=""/>
  <map id="wangle::SSLContextManager_map" name="wangle::SSLContextManager_map">
<area href="classwangle_1_1SSLContextManagerForTest.html" alt="wangle::SSLContextManagerForTest" shape="rect" coords="0,56,217,80"/>
</map>
 </div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structwangle_1_1SSLContextManager_1_1ClientCertVerifyCallback.html">ClientCertVerifyCallback</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structwangle_1_1SSLContextManager_1_1SslContexts.html">SslContexts</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a90825f967d932131f45939423eb77625"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classwangle_1_1SSLContextManager.html#a90825f967d932131f45939423eb77625">SSLContextManager</a> (<a class="el" href="classfolly_1_1EventBase.html">folly::EventBase</a> *eventBase, const <a class="el" href="Conv_8cpp.html#ae1adbce218e7a9d09164012443191d24">std::string</a> &amp;vipName, bool strict, <a class="el" href="classwangle_1_1SSLStats.html">SSLStats</a> *stats)</td></tr>
<tr class="separator:a90825f967d932131f45939423eb77625"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a15362c5ceb1dd357e3383fb3a4d63e8f"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classwangle_1_1SSLContextManager.html#a15362c5ceb1dd357e3383fb3a4d63e8f">~SSLContextManager</a> ()</td></tr>
<tr class="separator:a15362c5ceb1dd357e3383fb3a4d63e8f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a22ab2d51bcd41f1381f42799046e58a8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classwangle_1_1SSLContextManager.html#a22ab2d51bcd41f1381f42799046e58a8">addSSLContextConfig</a> (const <a class="el" href="structwangle_1_1SSLContextConfig.html">SSLContextConfig</a> &amp;ctxConfig, const <a class="el" href="structwangle_1_1SSLCacheOptions.html">SSLCacheOptions</a> &amp;cacheOptions, const <a class="el" href="structwangle_1_1TLSTicketKeySeeds.html">TLSTicketKeySeeds</a> *ticketSeeds, const <a class="el" href="classfolly_1_1SocketAddress.html">folly::SocketAddress</a> &amp;vipAddress, const std::shared_ptr&lt; <a class="el" href="classwangle_1_1SSLCacheProvider.html">SSLCacheProvider</a> &gt; &amp;externalCache, <a class="el" href="structwangle_1_1SSLContextManager_1_1SslContexts.html">SslContexts</a> *contexts=<a class="el" href="http__parser__cpp_8cpp.html#ab979d9d4b4923f7c54d6caa6e1a61936">nullptr</a>)</td></tr>
<tr class="separator:a22ab2d51bcd41f1381f42799046e58a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae1395d3ee7da97c3c324eda06e5c7f05"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classwangle_1_1SSLContextManager.html#ae1395d3ee7da97c3c324eda06e5c7f05">resetSSLContextConfigs</a> (const std::vector&lt; <a class="el" href="structwangle_1_1SSLContextConfig.html">SSLContextConfig</a> &gt; &amp;ctxConfig, const <a class="el" href="structwangle_1_1SSLCacheOptions.html">SSLCacheOptions</a> &amp;cacheOptions, const <a class="el" href="structwangle_1_1TLSTicketKeySeeds.html">TLSTicketKeySeeds</a> *ticketSeeds, const <a class="el" href="classfolly_1_1SocketAddress.html">folly::SocketAddress</a> &amp;vipAddress, const std::shared_ptr&lt; <a class="el" href="classwangle_1_1SSLCacheProvider.html">SSLCacheProvider</a> &gt; &amp;externalCache)</td></tr>
<tr class="separator:ae1395d3ee7da97c3c324eda06e5c7f05"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb2f852c9e1f60d512518b9bedc59e42"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classwangle_1_1SSLContextManager.html#abb2f852c9e1f60d512518b9bedc59e42">clear</a> ()</td></tr>
<tr class="separator:abb2f852c9e1f60d512518b9bedc59e42"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a841fd7a11651764f0bc8d3dbd8fea181"><td class="memItemLeft" align="right" valign="top">std::shared_ptr&lt; <a class="el" href="classfolly_1_1SSLContext.html">folly::SSLContext</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classwangle_1_1SSLContextManager.html#a841fd7a11651764f0bc8d3dbd8fea181">getDefaultSSLCtx</a> () const </td></tr>
<tr class="separator:a841fd7a11651764f0bc8d3dbd8fea181"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7bed5137e735ceec86311bd8adf0ca84"><td class="memItemLeft" align="right" valign="top">std::shared_ptr&lt; <a class="el" href="classfolly_1_1SSLContext.html">folly::SSLContext</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classwangle_1_1SSLContextManager.html#a7bed5137e735ceec86311bd8adf0ca84">getSSLCtx</a> (const <a class="el" href="structwangle_1_1SSLContextKey.html">SSLContextKey</a> &amp;key) const </td></tr>
<tr class="separator:a7bed5137e735ceec86311bd8adf0ca84"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c7e7efc40c2b1718366a07b5d9922d8"><td class="memItemLeft" align="right" valign="top">std::shared_ptr&lt; <a class="el" href="classfolly_1_1SSLContext.html">folly::SSLContext</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classwangle_1_1SSLContextManager.html#a6c7e7efc40c2b1718366a07b5d9922d8">getSSLCtxBySuffix</a> (const <a class="el" href="structwangle_1_1SSLContextKey.html">SSLContextKey</a> &amp;key) const </td></tr>
<tr class="separator:a6c7e7efc40c2b1718366a07b5d9922d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa1f4ccfdd6f79ea6e5e28e178517f294"><td class="memItemLeft" align="right" valign="top">std::shared_ptr&lt; <a class="el" href="classfolly_1_1SSLContext.html">folly::SSLContext</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classwangle_1_1SSLContextManager.html#aa1f4ccfdd6f79ea6e5e28e178517f294">getSSLCtxByExactDomain</a> (const <a class="el" href="structwangle_1_1SSLContextKey.html">SSLContextKey</a> &amp;key) const </td></tr>
<tr class="separator:aa1f4ccfdd6f79ea6e5e28e178517f294"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e8e1dc670932f3809e8c44687f18b3f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classwangle_1_1SSLContextManager.html#a8e8e1dc670932f3809e8c44687f18b3f">reloadTLSTicketKeys</a> (const std::vector&lt; <a class="el" href="Conv_8cpp.html#ae1adbce218e7a9d09164012443191d24">std::string</a> &gt; &amp;oldSeeds, const std::vector&lt; <a class="el" href="Conv_8cpp.html#ae1adbce218e7a9d09164012443191d24">std::string</a> &gt; &amp;currentSeeds, const std::vector&lt; <a class="el" href="Conv_8cpp.html#ae1adbce218e7a9d09164012443191d24">std::string</a> &gt; &amp;newSeeds)</td></tr>
<tr class="separator:a8e8e1dc670932f3809e8c44687f18b3f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab1a849b51eb1677315635ec9242558b0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classwangle_1_1SSLContextManager.html#ab1a849b51eb1677315635ec9242558b0">setSSLStats</a> (<a class="el" href="classwangle_1_1SSLStats.html">SSLStats</a> *stats)</td></tr>
<tr class="separator:ab1a849b51eb1677315635ec9242558b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a96070fefe3ad874e61530d5f98e5da84"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classwangle_1_1SSLContextManager.html#a96070fefe3ad874e61530d5f98e5da84">setClientHelloExtStats</a> (<a class="el" href="classwangle_1_1ClientHelloExtStats.html">ClientHelloExtStats</a> *stats)</td></tr>
<tr class="separator:a96070fefe3ad874e61530d5f98e5da84"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5ee5d82be194cf03268318ec3e4a91a3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classwangle_1_1SSLContextManager.html#a5ee5d82be194cf03268318ec3e4a91a3">setClientVerifyCallback</a> (std::unique_ptr&lt; <a class="el" href="structwangle_1_1SSLContextManager_1_1ClientCertVerifyCallback.html">ClientCertVerifyCallback</a> &gt; cb)</td></tr>
<tr class="separator:a5ee5d82be194cf03268318ec3e4a91a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:a398f1e79da64bfc03e092e92d4e7d7a6"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classwangle_1_1SSLContextManager.html#a398f1e79da64bfc03e092e92d4e7d7a6">loadCertKeyPairExternal</a> (const std::shared_ptr&lt; <a class="el" href="classfolly_1_1SSLContext.html">folly::SSLContext</a> &gt; &amp;, const <a class="el" href="structwangle_1_1SSLContextConfig.html">SSLContextConfig</a> &amp;, const <a class="el" href="Conv_8cpp.html#ae1adbce218e7a9d09164012443191d24">std::string</a> &amp;)</td></tr>
<tr class="separator:a398f1e79da64bfc03e092e92d4e7d7a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef1a8ca42dcc78eba7c0c126aab5fff6"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classwangle_1_1SSLContextManager.html#aef1a8ca42dcc78eba7c0c126aab5fff6">overrideConfiguration</a> (const std::shared_ptr&lt; <a class="el" href="classfolly_1_1SSLContext.html">folly::SSLContext</a> &gt; &amp;, const <a class="el" href="structwangle_1_1SSLContextConfig.html">SSLContextConfig</a> &amp;)</td></tr>
<tr class="separator:aef1a8ca42dcc78eba7c0c126aab5fff6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a385788dd912f5f69a724ca07d51f3f39"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classwangle_1_1SSLContextManager.html#a385788dd912f5f69a724ca07d51f3f39">insertSSLCtxByDomainName</a> (const char *dn, size_t len, std::shared_ptr&lt; <a class="el" href="classfolly_1_1SSLContext.html">folly::SSLContext</a> &gt; sslCtx, <a class="el" href="structwangle_1_1SSLContextManager_1_1SslContexts.html">SslContexts</a> &amp;contexts, <a class="el" href="namespacewangle.html#a01fda0dd64d5e2c4e0bd383502aed8e8">CertCrypto</a> certCrypto=<a class="el" href="namespacewangle.html#a01fda0dd64d5e2c4e0bd383502aed8e8a29fb96fa8da2ac0386a75e7f65d0f674">CertCrypto::BEST_AVAILABLE</a>)</td></tr>
<tr class="separator:a385788dd912f5f69a724ca07d51f3f39"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3fc0ffbe6511686bf0dbe3702316f968"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classwangle_1_1SSLContextManager.html#a3fc0ffbe6511686bf0dbe3702316f968">insertSSLCtxByDomainName</a> (const char *dn, size_t len, std::shared_ptr&lt; <a class="el" href="classfolly_1_1SSLContext.html">folly::SSLContext</a> &gt; sslCtx, <a class="el" href="namespacewangle.html#a01fda0dd64d5e2c4e0bd383502aed8e8">CertCrypto</a> certCrypto=<a class="el" href="namespacewangle.html#a01fda0dd64d5e2c4e0bd383502aed8e8a29fb96fa8da2ac0386a75e7f65d0f674">CertCrypto::BEST_AVAILABLE</a>)</td></tr>
<tr class="separator:a3fc0ffbe6511686bf0dbe3702316f968"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:a2940ce3f798dc56c1a41f7ac06d17d3a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="Conv_8cpp.html#ae1adbce218e7a9d09164012443191d24">std::string</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classwangle_1_1SSLContextManager.html#a2940ce3f798dc56c1a41f7ac06d17d3a">vipName_</a></td></tr>
<tr class="separator:a2940ce3f798dc56c1a41f7ac06d17d3a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a415d4b68d3ac7e819af2a38a8cef91b5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classwangle_1_1SSLStats.html">SSLStats</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classwangle_1_1SSLContextManager.html#a415d4b68d3ac7e819af2a38a8cef91b5">stats_</a> {<a class="el" href="http__parser__cpp_8cpp.html#ab979d9d4b4923f7c54d6caa6e1a61936">nullptr</a>}</td></tr>
<tr class="separator:a415d4b68d3ac7e819af2a38a8cef91b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a9eeec0e81f7d240fd6f13858b07ae85e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classwangle_1_1SSLContextManager.html#a9eeec0e81f7d240fd6f13858b07ae85e">SSLContextManager</a> (const <a class="el" href="classwangle_1_1SSLContextManager.html">SSLContextManager</a> &amp;)=delete</td></tr>
<tr class="separator:a9eeec0e81f7d240fd6f13858b07ae85e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac58a9019a430b301ae2f52871f8764c2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classwangle_1_1SSLContextManager.html#ac58a9019a430b301ae2f52871f8764c2">ctxSetupByOpensslFeature</a> (std::shared_ptr&lt; <a class="el" href="classwangle_1_1ServerSSLContext.html">ServerSSLContext</a> &gt; sslCtx, const <a class="el" href="structwangle_1_1SSLContextConfig.html">SSLContextConfig</a> &amp;ctxConfig, <a class="el" href="structwangle_1_1SSLContextManager_1_1SslContexts.html">SslContexts</a> &amp;contexts)</td></tr>
<tr class="separator:ac58a9019a430b301ae2f52871f8764c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5ec0b5d3f1a21267b3705610839eb90e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classwangle_1_1SSLContextManager.html#a5ec0b5d3f1a21267b3705610839eb90e">insert</a> (std::shared_ptr&lt; <a class="el" href="classwangle_1_1ServerSSLContext.html">ServerSSLContext</a> &gt; sslCtx, bool defaultFallback, <a class="el" href="structwangle_1_1SSLContextManager_1_1SslContexts.html">SslContexts</a> &amp;contexts)</td></tr>
<tr class="separator:a5ec0b5d3f1a21267b3705610839eb90e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9fa4d2ab765bef4dae5f2d6f91d9bbd9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classwangle_1_1SSLContextManager.html#a9fa4d2ab765bef4dae5f2d6f91d9bbd9">insertSSLCtxByDomainNameImpl</a> (const char *dn, size_t len, std::shared_ptr&lt; <a class="el" href="classfolly_1_1SSLContext.html">folly::SSLContext</a> &gt; sslCtx, <a class="el" href="structwangle_1_1SSLContextManager_1_1SslContexts.html">SslContexts</a> &amp;contexts, <a class="el" href="namespacewangle.html#a01fda0dd64d5e2c4e0bd383502aed8e8">CertCrypto</a> certCrypto)</td></tr>
<tr class="separator:a9fa4d2ab765bef4dae5f2d6f91d9bbd9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa8206a43cba93d2fad0d211445af5de7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classwangle_1_1SSLContextManager.html#aa8206a43cba93d2fad0d211445af5de7">insertIntoDnMap</a> (<a class="el" href="structwangle_1_1SSLContextKey.html">SSLContextKey</a> key, std::shared_ptr&lt; <a class="el" href="classfolly_1_1SSLContext.html">folly::SSLContext</a> &gt; sslCtx, bool overwrite, <a class="el" href="structwangle_1_1SSLContextManager_1_1SslContexts.html">SslContexts</a> &amp;contexts)</td></tr>
<tr class="separator:aa8206a43cba93d2fad0d211445af5de7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a6bee82aeb26f347ad78a7e04e84cb3e8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structwangle_1_1SSLContextManager_1_1SslContexts.html">SslContexts</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classwangle_1_1SSLContextManager.html#a6bee82aeb26f347ad78a7e04e84cb3e8">contexts_</a></td></tr>
<tr class="separator:a6bee82aeb26f347ad78a7e04e84cb3e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7f2a5474b57491e9c9566c92e0ba7153"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfolly_1_1EventBase.html">folly::EventBase</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classwangle_1_1SSLContextManager.html#a7f2a5474b57491e9c9566c92e0ba7153">eventBase_</a></td></tr>
<tr class="separator:a7f2a5474b57491e9c9566c92e0ba7153"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a507d445a8f73c0894901fbd5baec5c03"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classwangle_1_1ClientHelloExtStats.html">ClientHelloExtStats</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classwangle_1_1SSLContextManager.html#a507d445a8f73c0894901fbd5baec5c03">clientHelloTLSExtStats_</a> {<a class="el" href="http__parser__cpp_8cpp.html#ab979d9d4b4923f7c54d6caa6e1a61936">nullptr</a>}</td></tr>
<tr class="separator:a507d445a8f73c0894901fbd5baec5c03"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a58d55c34d6693073b0560646a8c96d9e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structwangle_1_1SSLContextConfig.html#aab527b353106f846710ea51423fb8ea3">SSLContextConfig::SNINoMatchFn</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classwangle_1_1SSLContextManager.html#a58d55c34d6693073b0560646a8c96d9e">noMatchFn_</a></td></tr>
<tr class="separator:a58d55c34d6693073b0560646a8c96d9e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad544b66c92f05932105d079b7d357188"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classwangle_1_1SSLContextManager.html#ad544b66c92f05932105d079b7d357188">strict_</a> {true}</td></tr>
<tr class="separator:ad544b66c92f05932105d079b7d357188"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af121e0ab9eed826021009f27708985f2"><td class="memItemLeft" align="right" valign="top">std::unique_ptr&lt; <a class="el" href="structwangle_1_1SSLContextManager_1_1ClientCertVerifyCallback.html">ClientCertVerifyCallback</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classwangle_1_1SSLContextManager.html#af121e0ab9eed826021009f27708985f2">clientCertVerifyCallback_</a> {<a class="el" href="http__parser__cpp_8cpp.html#ab979d9d4b4923f7c54d6caa6e1a61936">nullptr</a>}</td></tr>
<tr class="separator:af121e0ab9eed826021009f27708985f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock">
<p>Definition at line <a class="el" href="SSLContextManager_8h_source.html#l00047">47</a> of file <a class="el" href="SSLContextManager_8h_source.html">SSLContextManager.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a90825f967d932131f45939423eb77625"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">wangle::SSLContextManager::SSLContextManager </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfolly_1_1EventBase.html">folly::EventBase</a> *&#160;</td>
          <td class="paramname"><em>eventBase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="Conv_8cpp.html#ae1adbce218e7a9d09164012443191d24">std::string</a> &amp;&#160;</td>
          <td class="paramname"><em>vipName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>strict</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classwangle_1_1SSLStats.html">SSLStats</a> *&#160;</td>
          <td class="paramname"><em>stats</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">explicit</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="SSLContextManager_8cpp_source.html#l00186">186</a> of file <a class="el" href="SSLContextManager_8cpp_source.html">SSLContextManager.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;                   :</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <a class="code" href="classwangle_1_1SSLContextManager.html#a2940ce3f798dc56c1a41f7ac06d17d3a">vipName_</a>(vipName),</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <a class="code" href="classwangle_1_1SSLContextManager.html#a415d4b68d3ac7e819af2a38a8cef91b5">stats_</a>(stats),</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <a class="code" href="classwangle_1_1SSLContextManager.html#a7f2a5474b57491e9c9566c92e0ba7153">eventBase_</a>(eventBase),</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <a class="code" href="classwangle_1_1SSLContextManager.html#ad544b66c92f05932105d079b7d357188">strict_</a>(strict) {</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;}</div><div class="ttc" id="classwangle_1_1SSLContextManager_html_ad544b66c92f05932105d079b7d357188"><div class="ttname"><a href="classwangle_1_1SSLContextManager.html#ad544b66c92f05932105d079b7d357188">wangle::SSLContextManager::strict_</a></div><div class="ttdeci">bool strict_</div><div class="ttdef"><b>Definition:</b> <a href="SSLContextManager_8h_source.html#l00266">SSLContextManager.h:266</a></div></div>
<div class="ttc" id="classwangle_1_1SSLContextManager_html_a415d4b68d3ac7e819af2a38a8cef91b5"><div class="ttname"><a href="classwangle_1_1SSLContextManager.html#a415d4b68d3ac7e819af2a38a8cef91b5">wangle::SSLContextManager::stats_</a></div><div class="ttdeci">SSLStats * stats_</div><div class="ttdef"><b>Definition:</b> <a href="SSLContextManager_8h_source.html#l00186">SSLContextManager.h:186</a></div></div>
<div class="ttc" id="classwangle_1_1SSLContextManager_html_a2940ce3f798dc56c1a41f7ac06d17d3a"><div class="ttname"><a href="classwangle_1_1SSLContextManager.html#a2940ce3f798dc56c1a41f7ac06d17d3a">wangle::SSLContextManager::vipName_</a></div><div class="ttdeci">std::string vipName_</div><div class="ttdef"><b>Definition:</b> <a href="SSLContextManager_8h_source.html#l00185">SSLContextManager.h:185</a></div></div>
<div class="ttc" id="classwangle_1_1SSLContextManager_html_a7f2a5474b57491e9c9566c92e0ba7153"><div class="ttname"><a href="classwangle_1_1SSLContextManager.html#a7f2a5474b57491e9c9566c92e0ba7153">wangle::SSLContextManager::eventBase_</a></div><div class="ttdeci">folly::EventBase * eventBase_</div><div class="ttdef"><b>Definition:</b> <a href="SSLContextManager_8h_source.html#l00263">SSLContextManager.h:263</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a15362c5ceb1dd357e3383fb3a4d63e8f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">wangle::SSLContextManager::~SSLContextManager </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span><span class="mlabel">default</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a9eeec0e81f7d240fd6f13858b07ae85e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">wangle::SSLContextManager::SSLContextManager </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classwangle_1_1SSLContextManager.html">SSLContextManager</a> &amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span><span class="mlabel">delete</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a22ab2d51bcd41f1381f42799046e58a8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void wangle::SSLContextManager::addSSLContextConfig </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structwangle_1_1SSLContextConfig.html">SSLContextConfig</a> &amp;&#160;</td>
          <td class="paramname"><em>ctxConfig</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structwangle_1_1SSLCacheOptions.html">SSLCacheOptions</a> &amp;&#160;</td>
          <td class="paramname"><em>cacheOptions</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structwangle_1_1TLSTicketKeySeeds.html">TLSTicketKeySeeds</a> *&#160;</td>
          <td class="paramname"><em>ticketSeeds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classfolly_1_1SocketAddress.html">folly::SocketAddress</a> &amp;&#160;</td>
          <td class="paramname"><em>vipAddress</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::shared_ptr&lt; <a class="el" href="classwangle_1_1SSLCacheProvider.html">SSLCacheProvider</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>externalCache</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structwangle_1_1SSLContextManager_1_1SslContexts.html">SslContexts</a> *&#160;</td>
          <td class="paramname"><em>contexts</em> = <code><a class="el" href="http__parser__cpp_8cpp.html#ab979d9d4b4923f7c54d6caa6e1a61936">nullptr</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Add a new X509 to <a class="el" href="classwangle_1_1SSLContextManager.html">SSLContextManager</a>. The details of a X509 is passed as a <a class="el" href="structwangle_1_1SSLContextConfig.html">SSLContextConfig</a> object.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctxConfig</td><td>Details of a X509, its private key, password, etc. </td></tr>
    <tr><td class="paramname">cacheOptions</td><td>Options for how to do session caching. </td></tr>
    <tr><td class="paramname">ticketSeeds</td><td>If non-null, the initial ticket key seeds to use. </td></tr>
    <tr><td class="paramname">vipAddress</td><td>Which VIP are the X509(s) used for? It is only for for user friendly log message </td></tr>
    <tr><td class="paramname">externalCache</td><td>Optional external provider for the session cache; may be null </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="SSLContextManager_8cpp_source.html#l00248">248</a> of file <a class="el" href="SSLContextManager_8cpp_source.html">SSLContextManager.cpp</a>.</p>

<p>References <a class="el" href="namespacewangle.html#a01fda0dd64d5e2c4e0bd383502aed8e8a29fb96fa8da2ac0386a75e7f65d0f674">wangle::BEST_AVAILABLE</a>, <a class="el" href="SSLContextConfig_8h_source.html#l00098">wangle::SSLContextConfig::certificates</a>, <a class="el" href="SSLContextConfig_8h_source.html#l00117">wangle::SSLContextConfig::clientCAFile</a>, <a class="el" href="SSLContextManager_8h_source.html#l00267">clientCertVerifyCallback_</a>, <a class="el" href="SSLContextManager_8h_source.html#l00264">clientHelloTLSExtStats_</a>, <a class="el" href="SSLContextConfig_8h_source.html#l00119">wangle::SSLContextConfig::clientVerification</a>, <a class="el" href="SSLContextManager_8h_source.html#l00262">contexts_</a>, <a class="el" href="fizz_2build___2gtest_2src_2gtest_2googlemock_2test_2gmock__stress__test_8cc_source.html#l00176">count</a>, <a class="el" href="SSLContextManager_8cpp_source.html#l00526">ctxSetupByOpensslFeature()</a>, <a class="el" href="SSLContextManager_8h_source.html#l00055">wangle::SSLContextManager::SslContexts::defaultCtxDomainName</a>, <a class="el" href="SocketAddress_8cpp_source.html#l00482">folly::SocketAddress::describe()</a>, <a class="el" href="SSLContextConfig_8h_source.html#l00105">wangle::SSLContextConfig::eccCurveName</a>, <a class="el" href="ExceptionString_8h_source.html#l00033">folly::exceptionStr()</a>, <a class="el" href="AsyncSSLSocket_8h_source.html#l00716">folly::AsyncSSLSocket::getClientHelloInfo()</a>, <a class="el" href="SSLUtil_8cpp_source.html#l00054">wangle::SSLUtil::getCommonName()</a>, <a class="el" href="AsyncSSLSocket_8cpp_source.html#l00645">folly::AsyncSSLSocket::getFromSSL()</a>, <a class="el" href="SSLContextManager_8cpp_source.html#l00756">getSSLCtx()</a>, <a class="el" href="SSLUtil_8cpp_source.html#l00070">wangle::SSLUtil::getSubjectAltName()</a>, <a class="el" href="Base_8h_source.html#l00840">folly::gen::guard()</a>, <a class="el" href="SSLContextManager_8cpp_source.html#l00587">insert()</a>, <a class="el" href="SSLContextConfig_8h_source.html#l00112">wangle::SSLContextConfig::isDefault</a>, <a class="el" href="SSLContextConfig_8h_source.html#l00122">wangle::SSLContextConfig::keyOffloadParams</a>, <a class="el" href="SSLContextManager_8h_source.html#l00174">loadCertKeyPairExternal()</a>, <a class="el" href="ScopeGuard_8h_source.html#l00184">folly::makeGuard()</a>, <a class="el" href="Base-inl_8h_source.html#l02567">folly::gen::move</a>, <a class="el" href="SSLContextManager_8h_source.html#l00265">noMatchFn_</a>, <a class="el" href="SSLContextConfig_8h_source.html#l00062">wangle::SSLContextConfig::KeyOffloadParams::offloadType</a>, <a class="el" href="SSLContextManager_8h_source.html#l00181">overrideConfiguration()</a>, <a class="el" href="classwangle_1_1ClientHelloExtStats.html#ae553cfa29b5d7e02a16102a4bbdc16e6">wangle::ClientHelloExtStats::recordAbsentHostname()</a>, <a class="el" href="classwangle_1_1ClientHelloExtStats.html#af606b3a3d4331410e91635eabe3f2e7e">wangle::ClientHelloExtStats::recordCertCrypto()</a>, <a class="el" href="classwangle_1_1ClientHelloExtStats.html#a8cec70d54baefa5c11b8d9e27c54d416">wangle::ClientHelloExtStats::recordMatch()</a>, <a class="el" href="classwangle_1_1ClientHelloExtStats.html#a0a7e0051ea3cb9ebb6d53e2cbd20e1b1">wangle::ClientHelloExtStats::recordNotMatch()</a>, <a class="el" href="namespacefolly_1_1ssl.html#a746203c77f32ed76c6400bc5b67768dfaadb6c71505bf42fc16ace8a3f1da2e09">folly::ssl::SERVER_NAME</a>, <a class="el" href="SSLContextConfig_8h_source.html#l00127">wangle::SSLContextConfig::sessionContext</a>, <a class="el" href="namespacewangle.html#a01fda0dd64d5e2c4e0bd383502aed8e8ad35eb783da0580415d1a16a3890d03ad">wangle::SHA1_SIGNATURE</a>, <a class="el" href="namespacefolly_1_1ssl.html#a71e002395f281ab3a90fccf5148f3541ab505df5aa812b4f320420b8a952f20e5">folly::ssl::SHA256</a>, <a class="el" href="SSLContextConfig_8h_source.html#l00104">wangle::SSLContextConfig::sslCiphers</a>, <a class="el" href="SSLContextConfig_8h_source.html#l00099">wangle::SSLContextConfig::sslVersion</a>, <a class="el" href="SSLContextManager_8h_source.html#l00186">stats_</a>, <a class="el" href="Conv_8cpp_source.html#l00212">string</a>, <a class="el" href="String_8cpp_source.html#l00223">folly::stringPrintf()</a>, <a class="el" href="ConstexprMathBenchmark_8cpp_source.html#l00186">uint32_t</a>, and <a class="el" href="SSLContextManager_8h_source.html#l00185">vipName_</a>.</p>

<p>Referenced by <a class="el" href="SSLContextManager_8cpp_source.html#l00212">resetSSLContextConfigs()</a>, and <a class="el" href="SSLContextManagerTest_8cpp_source.html#l00129">wangle::TEST()</a>.</p>
<div class="fragment"><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;                         {</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;  <span class="keywordflow">if</span> (!contexts) {</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    contexts = &amp;<a class="code" href="classwangle_1_1SSLContextManager.html#a6bee82aeb26f347ad78a7e04e84cb3e8">contexts_</a>;</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;  }</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;  <span class="keywordtype">unsigned</span> numCerts = 0;</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;  <a class="code" href="Conv_8cpp.html#ae1adbce218e7a9d09164012443191d24">std::string</a> commonName;</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;  <a class="code" href="Conv_8cpp.html#ae1adbce218e7a9d09164012443191d24">std::string</a> lastCertPath;</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;  std::unique_ptr&lt;std::list&lt;std::string&gt;&gt; subjectAltName;</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;  <span class="keyword">auto</span> sslCtx =</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;      std::make_shared&lt;ServerSSLContext&gt;(ctxConfig.sslVersion);</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; cert : ctxConfig.certificates) {</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <span class="keywordflow">try</span> {</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;      <span class="keywordflow">if</span> (ctxConfig.keyOffloadParams.offloadType.empty()) {</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        <span class="comment">// The private key lives in the same process</span></div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        <span class="comment">// This needs to be called before loadPrivateKey().</span></div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        <span class="keywordflow">if</span> (!cert.passwordPath.empty()) {</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;          <span class="keyword">auto</span> sslPassword = std::make_shared&lt;folly::PasswordInFile&gt;(</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;              cert.passwordPath);</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;          sslCtx-&gt;passwordCollector(<a class="code" href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">std::move</a>(sslPassword));</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        }</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;        sslCtx-&gt;loadCertKeyPairFromFiles(</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;          cert.certPath.c_str(),</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;          cert.keyPath.c_str(),</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;          <span class="stringliteral">&quot;PEM&quot;</span>,</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;          <span class="stringliteral">&quot;PEM&quot;</span>);</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        <a class="code" href="classwangle_1_1SSLContextManager.html#a398f1e79da64bfc03e092e92d4e7d7a6">loadCertKeyPairExternal</a>(sslCtx, ctxConfig, cert.certPath);</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;      }</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception&amp; ex) {</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;        <span class="comment">// The exception isn&#39;t very useful without the certificate path name,</span></div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        <span class="comment">// so throw a new exception that includes the path to the certificate.</span></div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;        <span class="keywordtype">string</span> msg = folly::to&lt;string&gt;(<span class="stringliteral">&quot;error loading SSL certificate &quot;</span>,</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;                                       cert.certPath, <span class="stringliteral">&quot;: &quot;</span>,</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;                                       <a class="code" href="namespacefolly.html#acb103e15fafef3561273c07f9f9d705d">folly::exceptionStr</a>(ex));</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        LOG(ERROR) &lt;&lt; msg;</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;        <span class="keywordflow">throw</span> std::runtime_error(msg);</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    }</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <span class="comment">// Verify that the Common Name and (if present) Subject Alternative Names</span></div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <span class="comment">// are the same for all the certs specified for the SSL context.</span></div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    numCerts++;</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <a class="code" href="namespacefizz_1_1server.html#aa455f59c3f9cd33b8c12b04171d4544aa0b59324064e3fb9e2dd883bf8665dcbc">X509</a>* x509 = getX509(sslCtx-&gt;getSSLCtx());</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <span class="keywordflow">if</span> (!x509) {</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;      <span class="keywordflow">throw</span> std::runtime_error(</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;          folly::to&lt;std::string&gt;(</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;              <span class="stringliteral">&quot;Certificate: &quot;</span>, cert.certPath, <span class="stringliteral">&quot; is invalid&quot;</span>));</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    }</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <span class="keyword">auto</span> <a class="code" href="namespacefolly_1_1gen.html#a4be5af98480886ba055c3d7accd62062">guard</a> = <a class="code" href="namespacefolly.html#a507704cb8cb20963bc6ef5a2f871ab2a">folly::makeGuard</a>([x509] { X509_free(x509); });</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    <span class="keyword">auto</span> cn = <a class="code" href="classwangle_1_1SSLUtil.html#ac67d9c53b99c23b863d8973c9997e82b">SSLUtil::getCommonName</a>(x509);</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <span class="keywordflow">if</span> (!cn) {</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;      <span class="keywordflow">throw</span> std::runtime_error(folly::to&lt;string&gt;(<span class="stringliteral">&quot;Cannot get CN for X509 &quot;</span>,</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;                                                 cert.certPath));</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    }</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <span class="keyword">auto</span> altName = <a class="code" href="classwangle_1_1SSLUtil.html#a070d90baa5c50fe26d576ffcd7723d55">SSLUtil::getSubjectAltName</a>(x509);</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    VLOG(2) &lt;&lt; <span class="stringliteral">&quot;cert &quot;</span> &lt;&lt; cert.certPath &lt;&lt; <span class="stringliteral">&quot; CN: &quot;</span> &lt;&lt; *cn;</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    <span class="keywordflow">if</span> (altName) {</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;      altName-&gt;sort();</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;      VLOG(2) &lt;&lt; <span class="stringliteral">&quot;cert &quot;</span> &lt;&lt; cert.certPath &lt;&lt; <span class="stringliteral">&quot; SAN: &quot;</span> &lt;&lt; flattenList(*altName);</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;      VLOG(2) &lt;&lt; <span class="stringliteral">&quot;cert &quot;</span> &lt;&lt; cert.certPath &lt;&lt; <span class="stringliteral">&quot; SAN: &quot;</span> &lt;&lt; <span class="stringliteral">&quot;{none}&quot;</span>;</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    }</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    <span class="keywordflow">if</span> (numCerts == 1) {</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;      commonName = *cn;</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;      subjectAltName = <a class="code" href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">std::move</a>(altName);</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;      <span class="keywordflow">if</span> (commonName != *cn) {</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;        <span class="keywordflow">throw</span> std::runtime_error(folly::to&lt;string&gt;(<span class="stringliteral">&quot;X509 &quot;</span>, cert.certPath,</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;                                          <span class="stringliteral">&quot; does not have same CN as &quot;</span>,</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;                                          lastCertPath));</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;      }</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;      <span class="keywordflow">if</span> (altName == <span class="keyword">nullptr</span>) {</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;        <span class="keywordflow">if</span> (subjectAltName != <span class="keyword">nullptr</span>) {</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;          <span class="keywordflow">throw</span> std::runtime_error(folly::to&lt;string&gt;(<span class="stringliteral">&quot;X509 &quot;</span>, cert.certPath,</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;                                            <span class="stringliteral">&quot; does not have same SAN as &quot;</span>,</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;                                            lastCertPath));</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;        }</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;        <span class="keywordflow">if</span> ((subjectAltName == <span class="keyword">nullptr</span>) || (*altName != *subjectAltName)) {</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;          <span class="keywordflow">throw</span> std::runtime_error(folly::to&lt;string&gt;(<span class="stringliteral">&quot;X509 &quot;</span>, cert.certPath,</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;                                            <span class="stringliteral">&quot; does not have same SAN as &quot;</span>,</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;                                            lastCertPath));</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        }</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;      }</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    }</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    lastCertPath = cert.certPath;</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;  }</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;  <a class="code" href="classwangle_1_1SSLContextManager.html#aef1a8ca42dcc78eba7c0c126aab5fff6">overrideConfiguration</a>(sslCtx, ctxConfig);</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;  <span class="comment">// Let the server pick the highest performing cipher from among the client&#39;s</span></div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;  <span class="comment">// choices.</span></div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;  <span class="comment">//</span></div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;  <span class="comment">// Let&#39;s use a unique private key for all DH key exchanges.</span></div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;  <span class="comment">//</span></div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;  <span class="comment">// Because some old implementations choke on empty fragments, most SSL</span></div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;  <span class="comment">// applications disable them (it&#39;s part of SSL_OP_ALL).  This</span></div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;  <span class="comment">// will improve performance and decrease write buffer fragmentation.</span></div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;  sslCtx-&gt;setOptions(SSL_OP_CIPHER_SERVER_PREFERENCE |</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    SSL_OP_SINGLE_DH_USE |</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    SSL_OP_SINGLE_ECDH_USE |</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    SSL_OP_DONT_INSERT_EMPTY_FRAGMENTS);</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;  <span class="comment">// Important that we do this *after* checking the TLS1.1 ciphers above,</span></div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;  <span class="comment">// since we test their validity by actually setting them.</span></div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;  sslCtx-&gt;ciphers(ctxConfig.sslCiphers);</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;  <span class="comment">// Use a fix DH param</span></div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;  DH* dh = get_dh2048();</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;  SSL_CTX_set_tmp_dh(sslCtx-&gt;getSSLCtx(), dh);</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;  DH_free(dh);</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">string</span>&amp; curve = ctxConfig.eccCurveName;</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;  <span class="keywordflow">if</span> (!curve.empty()) {</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    set_key_from_curve(sslCtx-&gt;getSSLCtx(), curve);</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;  }</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;  <span class="keywordflow">if</span> (!ctxConfig.clientCAFile.empty()) {</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    <span class="keywordflow">try</span> {</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;      sslCtx-&gt;loadTrustedCertificates(ctxConfig.clientCAFile.c_str());</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;      sslCtx-&gt;loadClientCAList(ctxConfig.clientCAFile.c_str());</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;      <span class="comment">// Only allow over-riding of verification callback if one</span></div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;      <span class="comment">// isn&#39;t explicitly set on the context</span></div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classwangle_1_1SSLContextManager.html#af121e0ab9eed826021009f27708985f2">clientCertVerifyCallback_</a> == <span class="keyword">nullptr</span>) {</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;        sslCtx-&gt;setVerificationOption(ctxConfig.clientVerification);</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;        <a class="code" href="classwangle_1_1SSLContextManager.html#af121e0ab9eed826021009f27708985f2">clientCertVerifyCallback_</a>-&gt;attachSSLContext(sslCtx);</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;      }</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception&amp; ex) {</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;      <span class="keywordtype">string</span> msg = folly::to&lt;string&gt;(<span class="stringliteral">&quot;error loading client CA&quot;</span>,</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;                                     ctxConfig.clientCAFile, <span class="stringliteral">&quot;: &quot;</span>,</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;                                     <a class="code" href="namespacefolly.html#acb103e15fafef3561273c07f9f9d705d">folly::exceptionStr</a>(ex));</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;      LOG(ERROR) &lt;&lt; msg;</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;      <span class="keywordflow">throw</span> std::runtime_error(msg);</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    }</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;  }</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;  <span class="comment">// we always want to setup the session id context</span></div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;  <span class="comment">// to make session resumption work (tickets or session cache)</span></div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;  <a class="code" href="Conv_8cpp.html#ae1adbce218e7a9d09164012443191d24">std::string</a> sessionIdContext = commonName;</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;  <span class="keywordflow">if</span> (ctxConfig.sessionContext &amp;&amp; !ctxConfig.sessionContext-&gt;empty()) {</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    sessionIdContext = *ctxConfig.sessionContext;</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;  }</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;  VLOG(2) &lt;&lt; <span class="stringliteral">&quot;For vip &quot;</span> &lt;&lt; <a class="code" href="classwangle_1_1SSLContextManager.html#a2940ce3f798dc56c1a41f7ac06d17d3a">vipName_</a> &lt;&lt; <span class="stringliteral">&quot;, CN &quot;</span> &lt;&lt; commonName</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;, setting sid_ctx &quot;</span> &lt;&lt; sessionIdContext;</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;  sslCtx-&gt;setSessionCacheContext(sessionIdContext);</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;  sslCtx-&gt;setupSessionCache(</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;      ctxConfig,</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;      cacheOptions,</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;      externalCache,</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;      sessionIdContext,</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;      <a class="code" href="classwangle_1_1SSLContextManager.html#a415d4b68d3ac7e819af2a38a8cef91b5">stats_</a>);</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;  sslCtx-&gt;setupTicketManager(ticketSeeds, ctxConfig, <a class="code" href="classwangle_1_1SSLContextManager.html#a415d4b68d3ac7e819af2a38a8cef91b5">stats_</a>);</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;  VLOG(2) &lt;&lt; <span class="stringliteral">&quot;On VipID=&quot;</span> &lt;&lt; vipAddress.<a class="code" href="classfolly_1_1SocketAddress.html#a31205658ec313a5f26fb1558aad5ab60">describe</a>() &lt;&lt; <span class="stringliteral">&quot; context=&quot;</span> &lt;&lt; sslCtx;</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;  <span class="comment">// finalize sslCtx setup by the individual features supported by openssl</span></div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;  <a class="code" href="classwangle_1_1SSLContextManager.html#ac58a9019a430b301ae2f52871f8764c2">ctxSetupByOpensslFeature</a>(sslCtx, ctxConfig, *contexts);</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;  <span class="keywordflow">try</span> {</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    <a class="code" href="classwangle_1_1SSLContextManager.html#a5ec0b5d3f1a21267b3705610839eb90e">insert</a>(sslCtx,</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;           ctxConfig.isDefault,</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;           *contexts);</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;  } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception&amp; ex) {</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    <span class="keywordtype">string</span> msg = folly::to&lt;string&gt;(<span class="stringliteral">&quot;Error adding certificate : &quot;</span>,</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;                                   <a class="code" href="namespacefolly.html#acb103e15fafef3561273c07f9f9d705d">folly::exceptionStr</a>(ex));</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    LOG(ERROR) &lt;&lt; msg;</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    <span class="keywordflow">throw</span> std::runtime_error(msg);</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;  }</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;}</div><div class="ttc" id="classwangle_1_1SSLContextManager_html_a398f1e79da64bfc03e092e92d4e7d7a6"><div class="ttname"><a href="classwangle_1_1SSLContextManager.html#a398f1e79da64bfc03e092e92d4e7d7a6">wangle::SSLContextManager::loadCertKeyPairExternal</a></div><div class="ttdeci">virtual void loadCertKeyPairExternal(const std::shared_ptr&lt; folly::SSLContext &gt; &amp;, const SSLContextConfig &amp;, const std::string &amp;)</div><div class="ttdef"><b>Definition:</b> <a href="SSLContextManager_8h_source.html#l00174">SSLContextManager.h:174</a></div></div>
<div class="ttc" id="classwangle_1_1SSLContextManager_html_a415d4b68d3ac7e819af2a38a8cef91b5"><div class="ttname"><a href="classwangle_1_1SSLContextManager.html#a415d4b68d3ac7e819af2a38a8cef91b5">wangle::SSLContextManager::stats_</a></div><div class="ttdeci">SSLStats * stats_</div><div class="ttdef"><b>Definition:</b> <a href="SSLContextManager_8h_source.html#l00186">SSLContextManager.h:186</a></div></div>
<div class="ttc" id="classwangle_1_1SSLUtil_html_a070d90baa5c50fe26d576ffcd7723d55"><div class="ttname"><a href="classwangle_1_1SSLUtil.html#a070d90baa5c50fe26d576ffcd7723d55">wangle::SSLUtil::getSubjectAltName</a></div><div class="ttdeci">static std::unique_ptr&lt; std::list&lt; std::string &gt; &gt; getSubjectAltName(const X509 *cert)</div><div class="ttdef"><b>Definition:</b> <a href="SSLUtil_8cpp_source.html#l00070">SSLUtil.cpp:70</a></div></div>
<div class="ttc" id="classwangle_1_1SSLContextManager_html_aef1a8ca42dcc78eba7c0c126aab5fff6"><div class="ttname"><a href="classwangle_1_1SSLContextManager.html#aef1a8ca42dcc78eba7c0c126aab5fff6">wangle::SSLContextManager::overrideConfiguration</a></div><div class="ttdeci">virtual void overrideConfiguration(const std::shared_ptr&lt; folly::SSLContext &gt; &amp;, const SSLContextConfig &amp;)</div><div class="ttdef"><b>Definition:</b> <a href="SSLContextManager_8h_source.html#l00181">SSLContextManager.h:181</a></div></div>
<div class="ttc" id="namespacefolly_html_acb103e15fafef3561273c07f9f9d705d"><div class="ttname"><a href="namespacefolly.html#acb103e15fafef3561273c07f9f9d705d">folly::exceptionStr</a></div><div class="ttdeci">fbstring exceptionStr(const std::exception &amp;e)</div><div class="ttdef"><b>Definition:</b> <a href="ExceptionString_8h_source.html#l00033">ExceptionString.h:33</a></div></div>
<div class="ttc" id="namespacefolly_1_1gen_html_ac24ec252b1b738a40c274285527c193f"><div class="ttname"><a href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">folly::gen::move</a></div><div class="ttdeci">constexpr detail::Map&lt; Move &gt; move</div><div class="ttdef"><b>Definition:</b> <a href="Base-inl_8h_source.html#l02567">Base-inl.h:2567</a></div></div>
<div class="ttc" id="classfolly_1_1SocketAddress_html_a31205658ec313a5f26fb1558aad5ab60"><div class="ttname"><a href="classfolly_1_1SocketAddress.html#a31205658ec313a5f26fb1558aad5ab60">folly::SocketAddress::describe</a></div><div class="ttdeci">std::string describe() const </div><div class="ttdef"><b>Definition:</b> <a href="SocketAddress_8cpp_source.html#l00482">SocketAddress.cpp:482</a></div></div>
<div class="ttc" id="classwangle_1_1SSLContextManager_html_a6bee82aeb26f347ad78a7e04e84cb3e8"><div class="ttname"><a href="classwangle_1_1SSLContextManager.html#a6bee82aeb26f347ad78a7e04e84cb3e8">wangle::SSLContextManager::contexts_</a></div><div class="ttdeci">SslContexts contexts_</div><div class="ttdef"><b>Definition:</b> <a href="SSLContextManager_8h_source.html#l00262">SSLContextManager.h:262</a></div></div>
<div class="ttc" id="classwangle_1_1SSLContextManager_html_a5ec0b5d3f1a21267b3705610839eb90e"><div class="ttname"><a href="classwangle_1_1SSLContextManager.html#a5ec0b5d3f1a21267b3705610839eb90e">wangle::SSLContextManager::insert</a></div><div class="ttdeci">void insert(std::shared_ptr&lt; ServerSSLContext &gt; sslCtx, bool defaultFallback, SslContexts &amp;contexts)</div><div class="ttdef"><b>Definition:</b> <a href="SSLContextManager_8cpp_source.html#l00587">SSLContextManager.cpp:587</a></div></div>
<div class="ttc" id="namespacefizz_1_1server_html_aa455f59c3f9cd33b8c12b04171d4544aa0b59324064e3fb9e2dd883bf8665dcbc"><div class="ttname"><a href="namespacefizz_1_1server.html#aa455f59c3f9cd33b8c12b04171d4544aa0b59324064e3fb9e2dd883bf8665dcbc">fizz::server::CertificateStorage::X509</a></div></div>
<div class="ttc" id="namespacefolly_1_1gen_html_a4be5af98480886ba055c3d7accd62062"><div class="ttname"><a href="namespacefolly_1_1gen.html#a4be5af98480886ba055c3d7accd62062">folly::gen::guard</a></div><div class="ttdeci">GuardImpl guard(ErrorHandler &amp;&amp;handler)</div><div class="ttdef"><b>Definition:</b> <a href="Base_8h_source.html#l00840">Base.h:840</a></div></div>
<div class="ttc" id="classwangle_1_1SSLUtil_html_ac67d9c53b99c23b863d8973c9997e82b"><div class="ttname"><a href="classwangle_1_1SSLUtil.html#ac67d9c53b99c23b863d8973c9997e82b">wangle::SSLUtil::getCommonName</a></div><div class="ttdeci">static std::unique_ptr&lt; std::string &gt; getCommonName(const X509 *cert)</div><div class="ttdef"><b>Definition:</b> <a href="SSLUtil_8cpp_source.html#l00054">SSLUtil.cpp:54</a></div></div>
<div class="ttc" id="namespacefolly_html_a507704cb8cb20963bc6ef5a2f871ab2a"><div class="ttname"><a href="namespacefolly.html#a507704cb8cb20963bc6ef5a2f871ab2a">folly::makeGuard</a></div><div class="ttdeci">FOLLY_NODISCARD detail::ScopeGuardImplDecay&lt; F, true &gt; makeGuard(F &amp;&amp;f) noexcept(noexcept(detail::ScopeGuardImplDecay&lt; F, true &gt;(static_cast&lt; F &amp;&amp; &gt;(f))))</div><div class="ttdef"><b>Definition:</b> <a href="ScopeGuard_8h_source.html#l00184">ScopeGuard.h:184</a></div></div>
<div class="ttc" id="Conv_8cpp_html_ae1adbce218e7a9d09164012443191d24"><div class="ttname"><a href="Conv_8cpp.html#ae1adbce218e7a9d09164012443191d24">string</a></div><div class="ttdeci">const char * string</div><div class="ttdef"><b>Definition:</b> <a href="Conv_8cpp_source.html#l00212">Conv.cpp:212</a></div></div>
<div class="ttc" id="classwangle_1_1SSLContextManager_html_a2940ce3f798dc56c1a41f7ac06d17d3a"><div class="ttname"><a href="classwangle_1_1SSLContextManager.html#a2940ce3f798dc56c1a41f7ac06d17d3a">wangle::SSLContextManager::vipName_</a></div><div class="ttdeci">std::string vipName_</div><div class="ttdef"><b>Definition:</b> <a href="SSLContextManager_8h_source.html#l00185">SSLContextManager.h:185</a></div></div>
<div class="ttc" id="classwangle_1_1SSLContextManager_html_ac58a9019a430b301ae2f52871f8764c2"><div class="ttname"><a href="classwangle_1_1SSLContextManager.html#ac58a9019a430b301ae2f52871f8764c2">wangle::SSLContextManager::ctxSetupByOpensslFeature</a></div><div class="ttdeci">void ctxSetupByOpensslFeature(std::shared_ptr&lt; ServerSSLContext &gt; sslCtx, const SSLContextConfig &amp;ctxConfig, SslContexts &amp;contexts)</div><div class="ttdef"><b>Definition:</b> <a href="SSLContextManager_8cpp_source.html#l00526">SSLContextManager.cpp:526</a></div></div>
<div class="ttc" id="classwangle_1_1SSLContextManager_html_af121e0ab9eed826021009f27708985f2"><div class="ttname"><a href="classwangle_1_1SSLContextManager.html#af121e0ab9eed826021009f27708985f2">wangle::SSLContextManager::clientCertVerifyCallback_</a></div><div class="ttdeci">std::unique_ptr&lt; ClientCertVerifyCallback &gt; clientCertVerifyCallback_</div><div class="ttdef"><b>Definition:</b> <a href="SSLContextManager_8h_source.html#l00267">SSLContextManager.h:267</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="abb2f852c9e1f60d512518b9bedc59e42"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void wangle::SSLContextManager::clear </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Clears all ssl contexts </p>

<p>Definition at line <a class="el" href="SSLContextManager_8cpp_source.html#l00751">751</a> of file <a class="el" href="SSLContextManager_8cpp_source.html">SSLContextManager.cpp</a>.</p>

<p>References <a class="el" href="SSLContextManager_8cpp_source.html#l00205">wangle::SSLContextManager::SslContexts::clear()</a>, and <a class="el" href="SSLContextManager_8h_source.html#l00262">contexts_</a>.</p>
<div class="fragment"><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;                              {</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;  <a class="code" href="classwangle_1_1SSLContextManager.html#a6bee82aeb26f347ad78a7e04e84cb3e8">contexts_</a>.<a class="code" href="structwangle_1_1SSLContextManager_1_1SslContexts.html#a907cbc1f7ebdb67f5f80621dab7cc96e">clear</a>();</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;}</div><div class="ttc" id="classwangle_1_1SSLContextManager_html_a6bee82aeb26f347ad78a7e04e84cb3e8"><div class="ttname"><a href="classwangle_1_1SSLContextManager.html#a6bee82aeb26f347ad78a7e04e84cb3e8">wangle::SSLContextManager::contexts_</a></div><div class="ttdeci">SslContexts contexts_</div><div class="ttdef"><b>Definition:</b> <a href="SSLContextManager_8h_source.html#l00262">SSLContextManager.h:262</a></div></div>
<div class="ttc" id="structwangle_1_1SSLContextManager_1_1SslContexts_html_a907cbc1f7ebdb67f5f80621dab7cc96e"><div class="ttname"><a href="structwangle_1_1SSLContextManager_1_1SslContexts.html#a907cbc1f7ebdb67f5f80621dab7cc96e">wangle::SSLContextManager::SslContexts::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdef"><b>Definition:</b> <a href="SSLContextManager_8cpp_source.html#l00205">SSLContextManager.cpp:205</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ac58a9019a430b301ae2f52871f8764c2"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void wangle::SSLContextManager::ctxSetupByOpensslFeature </td>
          <td>(</td>
          <td class="paramtype">std::shared_ptr&lt; <a class="el" href="classwangle_1_1ServerSSLContext.html">ServerSSLContext</a> &gt;&#160;</td>
          <td class="paramname"><em>sslCtx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structwangle_1_1SSLContextConfig.html">SSLContextConfig</a> &amp;&#160;</td>
          <td class="paramname"><em>ctxConfig</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structwangle_1_1SSLContextManager_1_1SslContexts.html">SslContexts</a> &amp;&#160;</td>
          <td class="paramname"><em>contexts</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="SSLContextManager_8cpp_source.html#l00526">526</a> of file <a class="el" href="SSLContextManager_8cpp_source.html">SSLContextManager.cpp</a>.</p>

<p>References <a class="el" href="NetOps_8cpp_source.html#l00076">folly::netops::bind()</a>, <a class="el" href="SSLContextManager_8h_source.html#l00053">wangle::SSLContextManager::SslContexts::ctxs</a>, <a class="el" href="SSLContextManager_8h_source.html#l00054">wangle::SSLContextManager::SslContexts::defaultCtx</a>, <a class="el" href="SSLContextConfig_8h_source.html#l00112">wangle::SSLContextConfig::isDefault</a>, <a class="el" href="SSLContextConfig_8h_source.html#l00109">wangle::SSLContextConfig::nextProtocols</a>, <a class="el" href="SSLContextManager_8h_source.html#l00265">noMatchFn_</a>, <a class="el" href="SSLContextManager_8cpp_source.html#l00037">OPENSSL_MISSING_FEATURE</a>, and <a class="el" href="SSLContextConfig_8h_source.html#l00115">wangle::SSLContextConfig::sniNoMatchFn</a>.</p>

<p>Referenced by <a class="el" href="SSLContextManager_8cpp_source.html#l00248">addSSLContextConfig()</a>.</p>
<div class="fragment"><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;                         {</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;  <span class="comment">// Disable compression - profiling shows this to be very expensive in</span></div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;  <span class="comment">// terms of CPU and memory consumption.</span></div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;  <span class="comment">//</span></div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;<span class="preprocessor">#ifdef SSL_OP_NO_COMPRESSION</span></div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;  sslCtx-&gt;setOptions(SSL_OP_NO_COMPRESSION);</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;  <span class="comment">// Enable early release of SSL buffers to reduce the memory footprint</span></div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;<span class="preprocessor">#ifdef SSL_MODE_RELEASE_BUFFERS</span></div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;  <span class="comment">// Note: SSL_CTX_set_mode doesn&#39;t set, just ORs the arg with existing mode</span></div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;  SSL_CTX_set_mode(sslCtx-&gt;getSSLCtx(), SSL_MODE_RELEASE_BUFFERS);</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;<span class="preprocessor">#ifdef SSL_MODE_EARLY_RELEASE_BBIO</span></div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;  <span class="comment">// Note: SSL_CTX_set_mode doesn&#39;t set, just ORs the arg with existing mode</span></div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;  SSL_CTX_set_mode(sslCtx-&gt;getSSLCtx(), SSL_MODE_EARLY_RELEASE_BBIO);</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;  <span class="comment">// This number should (probably) correspond to HTTPSession::kMaxReadSize</span></div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;  <span class="comment">// For now, this number must also be large enough to accommodate our</span></div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;  <span class="comment">// largest certificate, because some older clients (IE6/7) require the</span></div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;  <span class="comment">// cert to be in a single fragment.</span></div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;<span class="preprocessor">#ifdef SSL_CTRL_SET_MAX_SEND_FRAGMENT</span></div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;  SSL_CTX_set_max_send_fragment(sslCtx-&gt;getSSLCtx(), 8000);</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;  <span class="comment">// NPN (Next Protocol Negotiation)</span></div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;  <span class="keywordflow">if</span> (!ctxConfig.nextProtocols.empty()) {</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;<span class="preprocessor">#if FOLLY_OPENSSL_HAS_ALPN</span></div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    sslCtx-&gt;setRandomizedAdvertisedNextProtocols(</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;        ctxConfig.nextProtocols);</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    <a class="code" href="SSLContextManager_8cpp.html#a116e5f292529f4061e907074d6b80faf">OPENSSL_MISSING_FEATURE</a>(NPN);</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;  }</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;  <span class="comment">// SNI</span></div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;<span class="preprocessor">#ifdef PROXYGEN_HAVE_SERVERNAMECALLBACK</span></div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;  <a class="code" href="classwangle_1_1SSLContextManager.html#a58d55c34d6693073b0560646a8c96d9e">noMatchFn_</a> = ctxConfig.sniNoMatchFn;</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;  <span class="keywordflow">if</span> (ctxConfig.isDefault) {</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    <span class="keywordflow">if</span> (contexts.defaultCtx) {</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;      <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;&gt;1 X509 is set as default&quot;</span>);</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;    }</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;    contexts.defaultCtx = sslCtx;</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    contexts.defaultCtx-&gt;setServerNameCallback(</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;      <a class="code" href="namespacefolly_1_1netops.html#a169c47f12a823de180fb9e9de51e951f">std::bind</a>(&amp;SSLContextManager::serverNameCallback, <span class="keyword">this</span>,</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;                std::placeholders::_1));</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;  }</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;  <span class="keywordflow">if</span> (contexts.ctxs.size() &gt; 1) {</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;    <a class="code" href="SSLContextManager_8cpp.html#a116e5f292529f4061e907074d6b80faf">OPENSSL_MISSING_FEATURE</a>(SNI);</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;  }</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;}</div><div class="ttc" id="classwangle_1_1SSLContextManager_html_a58d55c34d6693073b0560646a8c96d9e"><div class="ttname"><a href="classwangle_1_1SSLContextManager.html#a58d55c34d6693073b0560646a8c96d9e">wangle::SSLContextManager::noMatchFn_</a></div><div class="ttdeci">SSLContextConfig::SNINoMatchFn noMatchFn_</div><div class="ttdef"><b>Definition:</b> <a href="SSLContextManager_8h_source.html#l00265">SSLContextManager.h:265</a></div></div>
<div class="ttc" id="SSLContextManager_8cpp_html_a116e5f292529f4061e907074d6b80faf"><div class="ttname"><a href="SSLContextManager_8cpp.html#a116e5f292529f4061e907074d6b80faf">OPENSSL_MISSING_FEATURE</a></div><div class="ttdeci">#define OPENSSL_MISSING_FEATURE(name)</div><div class="ttdef"><b>Definition:</b> <a href="SSLContextManager_8cpp_source.html#l00037">SSLContextManager.cpp:37</a></div></div>
<div class="ttc" id="namespacefolly_1_1netops_html_a169c47f12a823de180fb9e9de51e951f"><div class="ttname"><a href="namespacefolly_1_1netops.html#a169c47f12a823de180fb9e9de51e951f">folly::netops::bind</a></div><div class="ttdeci">int bind(NetworkSocket s, const sockaddr *name, socklen_t namelen)</div><div class="ttdef"><b>Definition:</b> <a href="NetOps_8cpp_source.html#l00076">NetOps.cpp:76</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a841fd7a11651764f0bc8d3dbd8fea181"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classshared__ptr.html">shared_ptr</a>&lt; <a class="el" href="classfolly_1_1SSLContext.html">SSLContext</a> &gt; wangle::SSLContextManager::getDefaultSSLCtx </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get the default SSL_CTX for a VIP </p>

<p>Definition at line <a class="el" href="SSLContextManager_8cpp_source.html#l00803">803</a> of file <a class="el" href="SSLContextManager_8cpp_source.html">SSLContextManager.cpp</a>.</p>

<p>References <a class="el" href="SSLContextManager_8h_source.html#l00262">contexts_</a>, and <a class="el" href="SSLContextManager_8h_source.html#l00054">wangle::SSLContextManager::SslContexts::defaultCtx</a>.</p>
<div class="fragment"><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;                                         {</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classwangle_1_1SSLContextManager.html#a6bee82aeb26f347ad78a7e04e84cb3e8">contexts_</a>.<a class="code" href="structwangle_1_1SSLContextManager_1_1SslContexts.html#af22e41c792edcbae521f6db77dd9258a">defaultCtx</a>;</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;}</div><div class="ttc" id="structwangle_1_1SSLContextManager_1_1SslContexts_html_af22e41c792edcbae521f6db77dd9258a"><div class="ttname"><a href="structwangle_1_1SSLContextManager_1_1SslContexts.html#af22e41c792edcbae521f6db77dd9258a">wangle::SSLContextManager::SslContexts::defaultCtx</a></div><div class="ttdeci">std::shared_ptr&lt; ServerSSLContext &gt; defaultCtx</div><div class="ttdef"><b>Definition:</b> <a href="SSLContextManager_8h_source.html#l00054">SSLContextManager.h:54</a></div></div>
<div class="ttc" id="classwangle_1_1SSLContextManager_html_a6bee82aeb26f347ad78a7e04e84cb3e8"><div class="ttname"><a href="classwangle_1_1SSLContextManager.html#a6bee82aeb26f347ad78a7e04e84cb3e8">wangle::SSLContextManager::contexts_</a></div><div class="ttdeci">SslContexts contexts_</div><div class="ttdef"><b>Definition:</b> <a href="SSLContextManager_8h_source.html#l00262">SSLContextManager.h:262</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a7bed5137e735ceec86311bd8adf0ca84"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classshared__ptr.html">shared_ptr</a>&lt; <a class="el" href="classfolly_1_1SSLContext.html">SSLContext</a> &gt; wangle::SSLContextManager::getSSLCtx </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structwangle_1_1SSLContextKey.html">SSLContextKey</a> &amp;&#160;</td>
          <td class="paramname"><em>key</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Search first by exact domain, then by one level up </p>

<p>Definition at line <a class="el" href="SSLContextManager_8cpp_source.html#l00756">756</a> of file <a class="el" href="SSLContextManager_8cpp_source.html">SSLContextManager.cpp</a>.</p>

<p>References <a class="el" href="SSLContextManager_8cpp_source.html#l00788">getSSLCtxByExactDomain()</a>, and <a class="el" href="SSLContextManager_8cpp_source.html#l00766">getSSLCtxBySuffix()</a>.</p>

<p>Referenced by <a class="el" href="SSLContextManager_8cpp_source.html#l00248">addSSLContextConfig()</a>, and <a class="el" href="SSLContextManagerTest_8cpp_source.html#l00129">wangle::TEST()</a>.</p>
<div class="fragment"><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;{</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;  <span class="keyword">auto</span> ctx = <a class="code" href="classwangle_1_1SSLContextManager.html#aa1f4ccfdd6f79ea6e5e28e178517f294">getSSLCtxByExactDomain</a>(key);</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;  <span class="keywordflow">if</span> (ctx) {</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;    <span class="keywordflow">return</span> ctx;</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;  }</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classwangle_1_1SSLContextManager.html#a6c7e7efc40c2b1718366a07b5d9922d8">getSSLCtxBySuffix</a>(key);</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;}</div><div class="ttc" id="classwangle_1_1SSLContextManager_html_aa1f4ccfdd6f79ea6e5e28e178517f294"><div class="ttname"><a href="classwangle_1_1SSLContextManager.html#aa1f4ccfdd6f79ea6e5e28e178517f294">wangle::SSLContextManager::getSSLCtxByExactDomain</a></div><div class="ttdeci">std::shared_ptr&lt; folly::SSLContext &gt; getSSLCtxByExactDomain(const SSLContextKey &amp;key) const </div><div class="ttdef"><b>Definition:</b> <a href="SSLContextManager_8cpp_source.html#l00788">SSLContextManager.cpp:788</a></div></div>
<div class="ttc" id="classwangle_1_1SSLContextManager_html_a6c7e7efc40c2b1718366a07b5d9922d8"><div class="ttname"><a href="classwangle_1_1SSLContextManager.html#a6c7e7efc40c2b1718366a07b5d9922d8">wangle::SSLContextManager::getSSLCtxBySuffix</a></div><div class="ttdeci">std::shared_ptr&lt; folly::SSLContext &gt; getSSLCtxBySuffix(const SSLContextKey &amp;key) const </div><div class="ttdef"><b>Definition:</b> <a href="SSLContextManager_8cpp_source.html#l00766">SSLContextManager.cpp:766</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aa1f4ccfdd6f79ea6e5e28e178517f294"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classshared__ptr.html">shared_ptr</a>&lt; <a class="el" href="classfolly_1_1SSLContext.html">SSLContext</a> &gt; wangle::SSLContextManager::getSSLCtxByExactDomain </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structwangle_1_1SSLContextKey.html">SSLContextKey</a> &amp;&#160;</td>
          <td class="paramname"><em>key</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Search by the full-string domain name </p>

<p>Definition at line <a class="el" href="SSLContextManager_8cpp_source.html#l00788">788</a> of file <a class="el" href="SSLContextManager_8cpp_source.html">SSLContextManager.cpp</a>.</p>

<p>References <a class="el" href="SSLContextManager_8h_source.html#l00262">contexts_</a>, <a class="el" href="SSLContextManager_8h_source.html#l00063">wangle::SSLContextManager::SslContexts::dnMap</a>, <a class="el" href="SSLContextSelectionMisc_8h_source.html#l00073">wangle::SSLContextKey::dnString</a>, and <a class="el" href="String_8cpp_source.html#l00223">folly::stringPrintf()</a>.</p>

<p>Referenced by <a class="el" href="SSLContextManager_8cpp_source.html#l00756">getSSLCtx()</a>, and <a class="el" href="SSLContextManagerTest_8cpp_source.html#l00035">wangle::TEST()</a>.</p>
<div class="fragment"><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;{</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code" href="namespacefolly_1_1pushmi.html">v</a> = <a class="code" href="classwangle_1_1SSLContextManager.html#a6bee82aeb26f347ad78a7e04e84cb3e8">contexts_</a>.<a class="code" href="structwangle_1_1SSLContextManager_1_1SslContexts.html#a4fcd9e57c10d87a306184725d12d0d23">dnMap</a>.find(key);</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacefolly_1_1pushmi.html">v</a> == <a class="code" href="classwangle_1_1SSLContextManager.html#a6bee82aeb26f347ad78a7e04e84cb3e8">contexts_</a>.<a class="code" href="structwangle_1_1SSLContextManager_1_1SslContexts.html#a4fcd9e57c10d87a306184725d12d0d23">dnMap</a>.end()) {</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;    VLOG(6) &lt;&lt; <a class="code" href="namespacefolly.html#a058e7b6a45c912b94995f161a02dc669">folly::stringPrintf</a>(<span class="stringliteral">&quot;\&quot;%s\&quot; is not an exact match&quot;</span>,</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;                                   key.dnString.c_str());</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;    <span class="keywordflow">return</span> shared_ptr&lt;SSLContext&gt;();</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;    VLOG(6) &lt;&lt; <a class="code" href="namespacefolly.html#a058e7b6a45c912b94995f161a02dc669">folly::stringPrintf</a>(<span class="stringliteral">&quot;\&quot;%s\&quot; is an exact match&quot;</span>,</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;                                   key.dnString.c_str());</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacefolly_1_1pushmi.html">v</a>-&gt;second;</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;  }</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;}</div><div class="ttc" id="namespacefolly_1_1pushmi_html"><div class="ttname"><a href="namespacefolly_1_1pushmi.html">folly::pushmi</a></div><div class="ttdef"><b>Definition:</b> <a href="boosters_8h_source.html#l00030">boosters.h:30</a></div></div>
<div class="ttc" id="namespacefolly_html_a058e7b6a45c912b94995f161a02dc669"><div class="ttname"><a href="namespacefolly.html#a058e7b6a45c912b94995f161a02dc669">folly::stringPrintf</a></div><div class="ttdeci">std::string stringPrintf(const char *format,...)</div><div class="ttdef"><b>Definition:</b> <a href="String_8cpp_source.html#l00223">String.cpp:223</a></div></div>
<div class="ttc" id="classwangle_1_1SSLContextManager_html_a6bee82aeb26f347ad78a7e04e84cb3e8"><div class="ttname"><a href="classwangle_1_1SSLContextManager.html#a6bee82aeb26f347ad78a7e04e84cb3e8">wangle::SSLContextManager::contexts_</a></div><div class="ttdeci">SslContexts contexts_</div><div class="ttdef"><b>Definition:</b> <a href="SSLContextManager_8h_source.html#l00262">SSLContextManager.h:262</a></div></div>
<div class="ttc" id="structwangle_1_1SSLContextManager_1_1SslContexts_html_a4fcd9e57c10d87a306184725d12d0d23"><div class="ttname"><a href="structwangle_1_1SSLContextManager_1_1SslContexts.html#a4fcd9e57c10d87a306184725d12d0d23">wangle::SSLContextManager::SslContexts::dnMap</a></div><div class="ttdeci">std::unordered_map&lt; SSLContextKey, std::shared_ptr&lt; folly::SSLContext &gt;, SSLContextKeyHash &gt; dnMap</div><div class="ttdef"><b>Definition:</b> <a href="SSLContextManager_8h_source.html#l00063">SSLContextManager.h:63</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a6c7e7efc40c2b1718366a07b5d9922d8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classshared__ptr.html">shared_ptr</a>&lt; <a class="el" href="classfolly_1_1SSLContext.html">SSLContext</a> &gt; wangle::SSLContextManager::getSSLCtxBySuffix </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structwangle_1_1SSLContextKey.html">SSLContextKey</a> &amp;&#160;</td>
          <td class="paramname"><em>key</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Search by the <em>one</em> level up subdomain </p>

<p>Definition at line <a class="el" href="SSLContextManager_8cpp_source.html#l00766">766</a> of file <a class="el" href="SSLContextManager_8cpp_source.html">SSLContextManager.cpp</a>.</p>

<p>References <a class="el" href="SSLContextSelectionMisc_8h_source.html#l00074">wangle::SSLContextKey::certCrypto</a>, <a class="el" href="SSLContextManager_8h_source.html#l00262">contexts_</a>, <a class="el" href="SSLContextManager_8h_source.html#l00063">wangle::SSLContextManager::SslContexts::dnMap</a>, <a class="el" href="SSLContextSelectionMisc_8h_source.html#l00073">wangle::SSLContextKey::dnString</a>, <a class="el" href="FixedStringTest_8cpp_source.html#l00671">GCC61971::dot</a>, and <a class="el" href="String_8cpp_source.html#l00223">folly::stringPrintf()</a>.</p>

<p>Referenced by <a class="el" href="SSLContextManager_8cpp_source.html#l00756">getSSLCtx()</a>, and <a class="el" href="SSLContextManagerTest_8cpp_source.html#l00035">wangle::TEST()</a>.</p>
<div class="fragment"><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;{</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;  <span class="keywordtype">size_t</span> <a class="code" href="namespaceGCC61971.html#a2049785a76a553e7dae90a3b7e2cc3c9">dot</a>;</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;  <span class="keywordflow">if</span> ((dot = key.dnString.find_first_of(<span class="stringliteral">&quot;.&quot;</span>)) != DNString::npos) {</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;    SSLContextKey suffixKey(<a class="code" href="namespacewangle.html#a6771940e76a7d99d4030c70f8f6067f6">DNString</a>(key.dnString, dot),</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;        key.certCrypto);</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code" href="namespacefolly_1_1pushmi.html">v</a> = <a class="code" href="classwangle_1_1SSLContextManager.html#a6bee82aeb26f347ad78a7e04e84cb3e8">contexts_</a>.<a class="code" href="structwangle_1_1SSLContextManager_1_1SslContexts.html#a4fcd9e57c10d87a306184725d12d0d23">dnMap</a>.find(suffixKey);</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacefolly_1_1pushmi.html">v</a> != <a class="code" href="classwangle_1_1SSLContextManager.html#a6bee82aeb26f347ad78a7e04e84cb3e8">contexts_</a>.<a class="code" href="structwangle_1_1SSLContextManager_1_1SslContexts.html#a4fcd9e57c10d87a306184725d12d0d23">dnMap</a>.end()) {</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;      VLOG(6) &lt;&lt; <a class="code" href="namespacefolly.html#a058e7b6a45c912b94995f161a02dc669">folly::stringPrintf</a>(<span class="stringliteral">&quot;\&quot;%s\&quot; is a willcard match to \&quot;%s\&quot;&quot;</span>,</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;                                     key.dnString.c_str(),</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;                                     suffixKey.dnString.c_str());</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="namespacefolly_1_1pushmi.html">v</a>-&gt;second;</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;    }</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;  }</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;  VLOG(6) &lt;&lt; <a class="code" href="namespacefolly.html#a058e7b6a45c912b94995f161a02dc669">folly::stringPrintf</a>(<span class="stringliteral">&quot;\&quot;%s\&quot; is not a wildcard match&quot;</span>,</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;                                 key.dnString.c_str());</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;  <span class="keywordflow">return</span> shared_ptr&lt;SSLContext&gt;();</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;}</div><div class="ttc" id="namespacefolly_1_1pushmi_html"><div class="ttname"><a href="namespacefolly_1_1pushmi.html">folly::pushmi</a></div><div class="ttdef"><b>Definition:</b> <a href="boosters_8h_source.html#l00030">boosters.h:30</a></div></div>
<div class="ttc" id="namespacewangle_html_a6771940e76a7d99d4030c70f8f6067f6"><div class="ttname"><a href="namespacewangle.html#a6771940e76a7d99d4030c70f8f6067f6">wangle::DNString</a></div><div class="ttdeci">std::basic_string&lt; char, dn_char_traits &gt; DNString</div><div class="ttdef"><b>Definition:</b> <a href="SSLContextSelectionMisc_8h_source.html#l00070">SSLContextSelectionMisc.h:70</a></div></div>
<div class="ttc" id="namespacefolly_html_a058e7b6a45c912b94995f161a02dc669"><div class="ttname"><a href="namespacefolly.html#a058e7b6a45c912b94995f161a02dc669">folly::stringPrintf</a></div><div class="ttdeci">std::string stringPrintf(const char *format,...)</div><div class="ttdef"><b>Definition:</b> <a href="String_8cpp_source.html#l00223">String.cpp:223</a></div></div>
<div class="ttc" id="classwangle_1_1SSLContextManager_html_a6bee82aeb26f347ad78a7e04e84cb3e8"><div class="ttname"><a href="classwangle_1_1SSLContextManager.html#a6bee82aeb26f347ad78a7e04e84cb3e8">wangle::SSLContextManager::contexts_</a></div><div class="ttdeci">SslContexts contexts_</div><div class="ttdef"><b>Definition:</b> <a href="SSLContextManager_8h_source.html#l00262">SSLContextManager.h:262</a></div></div>
<div class="ttc" id="structwangle_1_1SSLContextManager_1_1SslContexts_html_a4fcd9e57c10d87a306184725d12d0d23"><div class="ttname"><a href="structwangle_1_1SSLContextManager_1_1SslContexts.html#a4fcd9e57c10d87a306184725d12d0d23">wangle::SSLContextManager::SslContexts::dnMap</a></div><div class="ttdeci">std::unordered_map&lt; SSLContextKey, std::shared_ptr&lt; folly::SSLContext &gt;, SSLContextKeyHash &gt; dnMap</div><div class="ttdef"><b>Definition:</b> <a href="SSLContextManager_8h_source.html#l00063">SSLContextManager.h:63</a></div></div>
<div class="ttc" id="namespaceGCC61971_html_a2049785a76a553e7dae90a3b7e2cc3c9"><div class="ttname"><a href="namespaceGCC61971.html#a2049785a76a553e7dae90a3b7e2cc3c9">GCC61971::dot</a></div><div class="ttdeci">constexpr auto dot</div><div class="ttdef"><b>Definition:</b> <a href="FixedStringTest_8cpp_source.html#l00671">FixedStringTest.cpp:671</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a5ec0b5d3f1a21267b3705610839eb90e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void wangle::SSLContextManager::insert </td>
          <td>(</td>
          <td class="paramtype">std::shared_ptr&lt; <a class="el" href="classwangle_1_1ServerSSLContext.html">ServerSSLContext</a> &gt;&#160;</td>
          <td class="paramname"><em>sslCtx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>defaultFallback</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structwangle_1_1SSLContextManager_1_1SslContexts.html">SslContexts</a> &amp;&#160;</td>
          <td class="paramname"><em>contexts</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Callback function from openssl to find the right X509 to use during SSL handshake The following functions help to maintain the data structure for domain name matching in SNI. Some notes:</p>
<ol type="1">
<li>It is a best match.</li>
<li>It allows wildcard CN and wildcard subject alternative name in a X509. The wildcard name must be <em>prefixed</em> by '*.'. It errors out whenever it sees '*' in any other locations.</li>
<li>It uses one std::unordered_map&lt;DomainName, SSL_CTX&gt; object to do this. For wildcard name like "*.facebook.com", ".facebook.com" is used as the key.</li>
<li>After getting tlsext_hostname from the client hello message, it will do a full string search first and then try one level up to match any wildcard name (if any) in the X509. [Note, browser also only looks one level up when matching the requesting domain name with the wildcard name in the server X509]. </li>
</ol>
<p>Some notes from RFC 2818. Only for future quick references in case of bugs</p>
<p>RFC 2818 section 3.1: "...... If a subjectAltName extension of type dNSName is present, that MUST be used as the identity. Otherwise, the (most specific) Common Name field in the <a class="el" href="structwangle_1_1Subject.html">Subject</a> field of the certificate MUST be used. Although the use of the Common Name is existing practice, it is deprecated and Certification Authorities are encouraged to use the dNSName instead. ...... In some cases, the URI is specified as an IP address rather than a hostname. In this case, the iPAddress subjectAltName must be present in the certificate and must exactly match the IP in the URI. ......"</p>

<p>Definition at line <a class="el" href="SSLContextManager_8cpp_source.html#l00587">587</a> of file <a class="el" href="SSLContextManager_8cpp_source.html">SSLContextManager.cpp</a>.</p>

<p>References <a class="el" href="namespacewangle.html#a01fda0dd64d5e2c4e0bd383502aed8e8a29fb96fa8da2ac0386a75e7f65d0f674">wangle::BEST_AVAILABLE</a>, <a class="el" href="SSLContextManager_8h_source.html#l00053">wangle::SSLContextManager::SslContexts::ctxs</a>, <a class="el" href="SSLUtil_8cpp_source.html#l00054">wangle::SSLUtil::getCommonName()</a>, <a class="el" href="SSLUtil_8cpp_source.html#l00070">wangle::SSLUtil::getSubjectAltName()</a>, <a class="el" href="Base_8h_source.html#l00840">folly::gen::guard()</a>, <a class="el" href="SSLContextManager_8cpp_source.html#l00666">insertSSLCtxByDomainName()</a>, <a class="el" href="ScopeGuard_8h_source.html#l00184">folly::makeGuard()</a>, <a class="el" href="http__parser_8c_source.html#l00437">name</a>, and <a class="el" href="namespacewangle.html#a01fda0dd64d5e2c4e0bd383502aed8e8ad35eb783da0580415d1a16a3890d03ad">wangle::SHA1_SIGNATURE</a>.</p>

<p>Referenced by <a class="el" href="SSLContextManager_8cpp_source.html#l00248">addSSLContextConfig()</a>.</p>
<div class="fragment"><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;                                                 {</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;  <a class="code" href="namespacefizz_1_1server.html#aa455f59c3f9cd33b8c12b04171d4544aa0b59324064e3fb9e2dd883bf8665dcbc">X509</a>* x509 = getX509(sslCtx-&gt;getSSLCtx());</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;  <span class="keywordflow">if</span> (!x509) {</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;    <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;SSLCtx is invalid&quot;</span>);</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;  }</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;  <span class="keyword">auto</span> <a class="code" href="namespacefolly_1_1gen.html#a4be5af98480886ba055c3d7accd62062">guard</a> = <a class="code" href="namespacefolly.html#a507704cb8cb20963bc6ef5a2f871ab2a">folly::makeGuard</a>([x509] { X509_free(x509); });</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;  <span class="keyword">auto</span> cn = <a class="code" href="classwangle_1_1SSLUtil.html#ac67d9c53b99c23b863d8973c9997e82b">SSLUtil::getCommonName</a>(x509);</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;  <span class="keywordflow">if</span> (!cn) {</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Cannot get CN&quot;</span>);</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;  }</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;  <span class="comment">// Not sure if we ever get this kind of X509...</span></div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;  <span class="comment">// If we do, assume &#39;*&#39; is always in the CN and ignore all subject alternative</span></div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;  <span class="comment">// names.</span></div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;  <span class="keywordflow">if</span> (cn-&gt;length() == 1 &amp;&amp; (*cn)[0] == <span class="charliteral">&#39;*&#39;</span>) {</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;    <span class="keywordflow">if</span> (!defaultFallback) {</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;      <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;STAR X509 is not the default&quot;</span>);</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;    }</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;    contexts.ctxs.emplace_back(sslCtx);</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;  }</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;  <a class="code" href="namespacewangle.html#a01fda0dd64d5e2c4e0bd383502aed8e8">CertCrypto</a> certCrypto;</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;  <span class="keywordtype">int</span> sigAlg = X509_get_signature_nid(x509);</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;  <span class="keywordflow">if</span> (sigAlg == NID_sha1WithRSAEncryption ||</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;      sigAlg == NID_ecdsa_with_SHA1) {</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;    certCrypto = <a class="code" href="namespacewangle.html#a01fda0dd64d5e2c4e0bd383502aed8e8ad35eb783da0580415d1a16a3890d03ad">CertCrypto::SHA1_SIGNATURE</a>;</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;    VLOG(4) &lt;&lt; <span class="stringliteral">&quot;Adding SSLContext with SHA1 Signature&quot;</span>;</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;    certCrypto = <a class="code" href="namespacewangle.html#a01fda0dd64d5e2c4e0bd383502aed8e8a29fb96fa8da2ac0386a75e7f65d0f674">CertCrypto::BEST_AVAILABLE</a>;</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;    VLOG(4) &lt;&lt; <span class="stringliteral">&quot;Adding SSLContext with best available crypto&quot;</span>;</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;  }</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;  <span class="comment">// Insert by CN</span></div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;  <a class="code" href="classwangle_1_1SSLContextManager.html#a385788dd912f5f69a724ca07d51f3f39">insertSSLCtxByDomainName</a>(cn-&gt;c_str(),</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;                           cn-&gt;length(),</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;                           sslCtx,</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;                           contexts,</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;                           certCrypto);</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;  <span class="comment">// Insert by subject alternative name(s)</span></div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;  <span class="keyword">auto</span> altNames = <a class="code" href="classwangle_1_1SSLUtil.html#a070d90baa5c50fe26d576ffcd7723d55">SSLUtil::getSubjectAltName</a>(x509);</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;  <span class="keywordflow">if</span> (altNames) {</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; <a class="code" href="http__parser_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a> : *altNames) {</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;      <a class="code" href="classwangle_1_1SSLContextManager.html#a385788dd912f5f69a724ca07d51f3f39">insertSSLCtxByDomainName</a>(<a class="code" href="http__parser_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>.c_str(),</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;                               <a class="code" href="http__parser_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>.length(),</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;                               sslCtx,</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;                               contexts,</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;                               certCrypto);</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;    }</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;  }</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;  <span class="keywordflow">if</span> (defaultFallback) {</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;    contexts.defaultCtxDomainName = *cn;</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;  }</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;  contexts.ctxs.emplace_back(sslCtx);</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;}</div><div class="ttc" id="classwangle_1_1SSLUtil_html_a070d90baa5c50fe26d576ffcd7723d55"><div class="ttname"><a href="classwangle_1_1SSLUtil.html#a070d90baa5c50fe26d576ffcd7723d55">wangle::SSLUtil::getSubjectAltName</a></div><div class="ttdeci">static std::unique_ptr&lt; std::list&lt; std::string &gt; &gt; getSubjectAltName(const X509 *cert)</div><div class="ttdef"><b>Definition:</b> <a href="SSLUtil_8cpp_source.html#l00070">SSLUtil.cpp:70</a></div></div>
<div class="ttc" id="namespacewangle_html_a01fda0dd64d5e2c4e0bd383502aed8e8a29fb96fa8da2ac0386a75e7f65d0f674"><div class="ttname"><a href="namespacewangle.html#a01fda0dd64d5e2c4e0bd383502aed8e8a29fb96fa8da2ac0386a75e7f65d0f674">wangle::CertCrypto::BEST_AVAILABLE</a></div></div>
<div class="ttc" id="http__parser_8c_html_a8f8f80d37794cde9472343e4487ba3eb"><div class="ttname"><a href="http__parser_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a></div><div class="ttdeci">const char * name</div><div class="ttdef"><b>Definition:</b> <a href="http__parser_8c_source.html#l00437">http_parser.c:437</a></div></div>
<div class="ttc" id="namespacefizz_1_1server_html_aa455f59c3f9cd33b8c12b04171d4544aa0b59324064e3fb9e2dd883bf8665dcbc"><div class="ttname"><a href="namespacefizz_1_1server.html#aa455f59c3f9cd33b8c12b04171d4544aa0b59324064e3fb9e2dd883bf8665dcbc">fizz::server::CertificateStorage::X509</a></div></div>
<div class="ttc" id="classwangle_1_1SSLContextManager_html_a385788dd912f5f69a724ca07d51f3f39"><div class="ttname"><a href="classwangle_1_1SSLContextManager.html#a385788dd912f5f69a724ca07d51f3f39">wangle::SSLContextManager::insertSSLCtxByDomainName</a></div><div class="ttdeci">void insertSSLCtxByDomainName(const char *dn, size_t len, std::shared_ptr&lt; folly::SSLContext &gt; sslCtx, SslContexts &amp;contexts, CertCrypto certCrypto=CertCrypto::BEST_AVAILABLE)</div><div class="ttdef"><b>Definition:</b> <a href="SSLContextManager_8cpp_source.html#l00666">SSLContextManager.cpp:666</a></div></div>
<div class="ttc" id="namespacewangle_html_a01fda0dd64d5e2c4e0bd383502aed8e8ad35eb783da0580415d1a16a3890d03ad"><div class="ttname"><a href="namespacewangle.html#a01fda0dd64d5e2c4e0bd383502aed8e8ad35eb783da0580415d1a16a3890d03ad">wangle::CertCrypto::SHA1_SIGNATURE</a></div></div>
<div class="ttc" id="namespacefolly_1_1gen_html_a4be5af98480886ba055c3d7accd62062"><div class="ttname"><a href="namespacefolly_1_1gen.html#a4be5af98480886ba055c3d7accd62062">folly::gen::guard</a></div><div class="ttdeci">GuardImpl guard(ErrorHandler &amp;&amp;handler)</div><div class="ttdef"><b>Definition:</b> <a href="Base_8h_source.html#l00840">Base.h:840</a></div></div>
<div class="ttc" id="namespacewangle_html_a01fda0dd64d5e2c4e0bd383502aed8e8"><div class="ttname"><a href="namespacewangle.html#a01fda0dd64d5e2c4e0bd383502aed8e8">wangle::CertCrypto</a></div><div class="ttdeci">CertCrypto</div><div class="ttdef"><b>Definition:</b> <a href="SSLContextSelectionMisc_8h_source.html#l00024">SSLContextSelectionMisc.h:24</a></div></div>
<div class="ttc" id="classwangle_1_1SSLUtil_html_ac67d9c53b99c23b863d8973c9997e82b"><div class="ttname"><a href="classwangle_1_1SSLUtil.html#ac67d9c53b99c23b863d8973c9997e82b">wangle::SSLUtil::getCommonName</a></div><div class="ttdeci">static std::unique_ptr&lt; std::string &gt; getCommonName(const X509 *cert)</div><div class="ttdef"><b>Definition:</b> <a href="SSLUtil_8cpp_source.html#l00054">SSLUtil.cpp:54</a></div></div>
<div class="ttc" id="namespacefolly_html_a507704cb8cb20963bc6ef5a2f871ab2a"><div class="ttname"><a href="namespacefolly.html#a507704cb8cb20963bc6ef5a2f871ab2a">folly::makeGuard</a></div><div class="ttdeci">FOLLY_NODISCARD detail::ScopeGuardImplDecay&lt; F, true &gt; makeGuard(F &amp;&amp;f) noexcept(noexcept(detail::ScopeGuardImplDecay&lt; F, true &gt;(static_cast&lt; F &amp;&amp; &gt;(f))))</div><div class="ttdef"><b>Definition:</b> <a href="ScopeGuard_8h_source.html#l00184">ScopeGuard.h:184</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aa8206a43cba93d2fad0d211445af5de7"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void wangle::SSLContextManager::insertIntoDnMap </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structwangle_1_1SSLContextKey.html">SSLContextKey</a>&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::shared_ptr&lt; <a class="el" href="classfolly_1_1SSLContext.html">folly::SSLContext</a> &gt;&#160;</td>
          <td class="paramname"><em>sslCtx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>overwrite</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structwangle_1_1SSLContextManager_1_1SslContexts.html">SslContexts</a> &amp;&#160;</td>
          <td class="paramname"><em>contexts</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="SSLContextManager_8cpp_source.html#l00731">731</a> of file <a class="el" href="SSLContextManager_8cpp_source.html">SSLContextManager.cpp</a>.</p>

<p>References <a class="el" href="SSLContextManager_8h_source.html#l00063">wangle::SSLContextManager::SslContexts::dnMap</a>.</p>

<p>Referenced by <a class="el" href="SSLContextManager_8cpp_source.html#l00682">insertSSLCtxByDomainNameImpl()</a>.</p>
<div class="fragment"><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;{</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code" href="namespacefolly_1_1pushmi.html">v</a> = contexts.dnMap.find(key);</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacefolly_1_1pushmi.html">v</a> == contexts.dnMap.end()) {</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;    VLOG(6) &lt;&lt; <span class="stringliteral">&quot;Inserting SSLContext into map.&quot;</span>;</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;    contexts.dnMap.emplace(key, sslCtx);</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespacefolly_1_1pushmi.html">v</a>-&gt;second == sslCtx) {</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;    VLOG(6)&lt;&lt; <span class="stringliteral">&quot;Duplicate CN or subject alternative name found in the same X509.&quot;</span></div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;      <span class="stringliteral">&quot;  Ignore the later name.&quot;</span>;</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (overwrite) {</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;    VLOG(6) &lt;&lt; <span class="stringliteral">&quot;Overwriting SSLContext.&quot;</span>;</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;    <a class="code" href="namespacefolly_1_1pushmi.html">v</a>-&gt;second = sslCtx;</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;    VLOG(6) &lt;&lt; <span class="stringliteral">&quot;Leaving existing SSLContext in map.&quot;</span>;</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;  }</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;}</div><div class="ttc" id="namespacefolly_1_1pushmi_html"><div class="ttname"><a href="namespacefolly_1_1pushmi.html">folly::pushmi</a></div><div class="ttdef"><b>Definition:</b> <a href="boosters_8h_source.html#l00030">boosters.h:30</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a385788dd912f5f69a724ca07d51f3f39"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void wangle::SSLContextManager::insertSSLCtxByDomainName </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>dn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::shared_ptr&lt; <a class="el" href="classfolly_1_1SSLContext.html">folly::SSLContext</a> &gt;&#160;</td>
          <td class="paramname"><em>sslCtx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structwangle_1_1SSLContextManager_1_1SslContexts.html">SslContexts</a> &amp;&#160;</td>
          <td class="paramname"><em>contexts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacewangle.html#a01fda0dd64d5e2c4e0bd383502aed8e8">CertCrypto</a>&#160;</td>
          <td class="paramname"><em>certCrypto</em> = <code><a class="el" href="namespacewangle.html#a01fda0dd64d5e2c4e0bd383502aed8e8a29fb96fa8da2ac0386a75e7f65d0f674">CertCrypto::BEST_AVAILABLE</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Insert a SSLContext by domain name. </p>

<p>Definition at line <a class="el" href="SSLContextManager_8cpp_source.html#l00666">666</a> of file <a class="el" href="SSLContextManager_8cpp_source.html">SSLContextManager.cpp</a>.</p>

<p>References <a class="el" href="SSLContextManager_8cpp_source.html#l00682">insertSSLCtxByDomainNameImpl()</a>, and <a class="el" href="SSLContextManager_8h_source.html#l00266">strict_</a>.</p>

<p>Referenced by <a class="el" href="SSLContextManager_8cpp_source.html#l00587">insert()</a>, and <a class="el" href="SSLContextManagerTest_8cpp_source.html#l00035">wangle::TEST()</a>.</p>
<div class="fragment"><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;                                                                   {</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;  <span class="keywordflow">try</span> {</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;    <a class="code" href="classwangle_1_1SSLContextManager.html#a9fa4d2ab765bef4dae5f2d6f91d9bbd9">insertSSLCtxByDomainNameImpl</a>(dn, len, sslCtx, contexts, certCrypto);</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;  } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::runtime_error&amp; ex) {</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classwangle_1_1SSLContextManager.html#ad544b66c92f05932105d079b7d357188">strict_</a>) {</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;      <span class="keywordflow">throw</span> ex;</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;      LOG(ERROR) &lt;&lt; ex.what() &lt;&lt; <span class="stringliteral">&quot; DN=&quot;</span> &lt;&lt; dn;</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;    }</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;  }</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;}</div><div class="ttc" id="classwangle_1_1SSLContextManager_html_a9fa4d2ab765bef4dae5f2d6f91d9bbd9"><div class="ttname"><a href="classwangle_1_1SSLContextManager.html#a9fa4d2ab765bef4dae5f2d6f91d9bbd9">wangle::SSLContextManager::insertSSLCtxByDomainNameImpl</a></div><div class="ttdeci">void insertSSLCtxByDomainNameImpl(const char *dn, size_t len, std::shared_ptr&lt; folly::SSLContext &gt; sslCtx, SslContexts &amp;contexts, CertCrypto certCrypto)</div><div class="ttdef"><b>Definition:</b> <a href="SSLContextManager_8cpp_source.html#l00682">SSLContextManager.cpp:682</a></div></div>
<div class="ttc" id="classwangle_1_1SSLContextManager_html_ad544b66c92f05932105d079b7d357188"><div class="ttname"><a href="classwangle_1_1SSLContextManager.html#ad544b66c92f05932105d079b7d357188">wangle::SSLContextManager::strict_</a></div><div class="ttdeci">bool strict_</div><div class="ttdef"><b>Definition:</b> <a href="SSLContextManager_8h_source.html#l00266">SSLContextManager.h:266</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a3fc0ffbe6511686bf0dbe3702316f968"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void wangle::SSLContextManager::insertSSLCtxByDomainName </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>dn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::shared_ptr&lt; <a class="el" href="classfolly_1_1SSLContext.html">folly::SSLContext</a> &gt;&#160;</td>
          <td class="paramname"><em>sslCtx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacewangle.html#a01fda0dd64d5e2c4e0bd383502aed8e8">CertCrypto</a>&#160;</td>
          <td class="paramname"><em>certCrypto</em> = <code><a class="el" href="namespacewangle.html#a01fda0dd64d5e2c4e0bd383502aed8e8a29fb96fa8da2ac0386a75e7f65d0f674">CertCrypto::BEST_AVAILABLE</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="SSLContextManager_8h_source.html#l00198">198</a> of file <a class="el" href="SSLContextManager_8h_source.html">SSLContextManager.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;                                                      {</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <a class="code" href="classwangle_1_1SSLContextManager.html#a385788dd912f5f69a724ca07d51f3f39">insertSSLCtxByDomainName</a>(dn, len, sslCtx, <a class="code" href="classwangle_1_1SSLContextManager.html#a6bee82aeb26f347ad78a7e04e84cb3e8">contexts_</a>, certCrypto);</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  }</div><div class="ttc" id="classwangle_1_1SSLContextManager_html_a6bee82aeb26f347ad78a7e04e84cb3e8"><div class="ttname"><a href="classwangle_1_1SSLContextManager.html#a6bee82aeb26f347ad78a7e04e84cb3e8">wangle::SSLContextManager::contexts_</a></div><div class="ttdeci">SslContexts contexts_</div><div class="ttdef"><b>Definition:</b> <a href="SSLContextManager_8h_source.html#l00262">SSLContextManager.h:262</a></div></div>
<div class="ttc" id="classwangle_1_1SSLContextManager_html_a385788dd912f5f69a724ca07d51f3f39"><div class="ttname"><a href="classwangle_1_1SSLContextManager.html#a385788dd912f5f69a724ca07d51f3f39">wangle::SSLContextManager::insertSSLCtxByDomainName</a></div><div class="ttdeci">void insertSSLCtxByDomainName(const char *dn, size_t len, std::shared_ptr&lt; folly::SSLContext &gt; sslCtx, SslContexts &amp;contexts, CertCrypto certCrypto=CertCrypto::BEST_AVAILABLE)</div><div class="ttdef"><b>Definition:</b> <a href="SSLContextManager_8cpp_source.html#l00666">SSLContextManager.cpp:666</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a9fa4d2ab765bef4dae5f2d6f91d9bbd9"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void wangle::SSLContextManager::insertSSLCtxByDomainNameImpl </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>dn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::shared_ptr&lt; <a class="el" href="classfolly_1_1SSLContext.html">folly::SSLContext</a> &gt;&#160;</td>
          <td class="paramname"><em>sslCtx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structwangle_1_1SSLContextManager_1_1SslContexts.html">SslContexts</a> &amp;&#160;</td>
          <td class="paramname"><em>contexts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacewangle.html#a01fda0dd64d5e2c4e0bd383502aed8e8">CertCrypto</a>&#160;</td>
          <td class="paramname"><em>certCrypto</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="SSLContextManager_8cpp_source.html#l00682">682</a> of file <a class="el" href="SSLContextManager_8cpp_source.html">SSLContextManager.cpp</a>.</p>

<p>References <a class="el" href="namespacewangle.html#a01fda0dd64d5e2c4e0bd383502aed8e8a29fb96fa8da2ac0386a75e7f65d0f674">wangle::BEST_AVAILABLE</a>, <a class="el" href="SSLContextManager_8cpp_source.html#l00731">insertIntoDnMap()</a>, <a class="el" href="Conv_8cpp_source.html#l00212">string</a>, and <a class="el" href="String_8cpp_source.html#l00223">folly::stringPrintf()</a>.</p>

<p>Referenced by <a class="el" href="SSLContextManager_8cpp_source.html#l00666">insertSSLCtxByDomainName()</a>.</p>
<div class="fragment"><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;{</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;  VLOG(4) &lt;&lt;</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;    <a class="code" href="namespacefolly.html#a058e7b6a45c912b94995f161a02dc669">folly::stringPrintf</a>(<span class="stringliteral">&quot;Adding CN/Subject-alternative-name \&quot;%s\&quot; for &quot;</span></div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;                        <span class="stringliteral">&quot;SNI search&quot;</span>, dn);</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;  <span class="comment">// Only support wildcard domains which are prefixed exactly by &quot;*.&quot; .</span></div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;  <span class="comment">// &quot;*&quot; appearing at other locations is not accepted.</span></div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;  <span class="keywordflow">if</span> (len &gt; 2 &amp;&amp; dn[0] == <span class="charliteral">&#39;*&#39;</span>) {</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;    <span class="keywordflow">if</span> (dn[1] == <span class="charliteral">&#39;.&#39;</span>) {</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;      <span class="comment">// skip the first &#39;*&#39;</span></div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;      dn++;</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;      len--;</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;      <span class="keywordflow">throw</span> std::runtime_error(</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;        <span class="stringliteral">&quot;Invalid wildcard CN/subject-alternative-name \&quot;&quot;</span> + <a class="code" href="Conv_8cpp.html#ae1adbce218e7a9d09164012443191d24">std::string</a>(dn) + <span class="stringliteral">&quot;\&quot; &quot;</span></div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;        <span class="stringliteral">&quot;(only allow character \&quot;.\&quot; after \&quot;*\&quot;&quot;</span>);</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;    }</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;  }</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;  <span class="keywordflow">if</span> (len == 1 &amp;&amp; *dn == <span class="charliteral">&#39;.&#39;</span>) {</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;    <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;X509 has only &#39;.&#39; in the CN or subject alternative name &quot;</span></div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;                    <span class="stringliteral">&quot;(after removing any preceding &#39;*&#39;)&quot;</span>);</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;  }</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;  <span class="keywordflow">if</span> (strchr(dn, <span class="charliteral">&#39;*&#39;</span>)) {</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;    <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;X509 has &#39;*&#39; in the the CN or subject alternative name &quot;</span></div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;                    <span class="stringliteral">&quot;(after removing any preceding &#39;*&#39;)&quot;</span>);</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;  }</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;  <a class="code" href="namespacewangle.html#a6771940e76a7d99d4030c70f8f6067f6">DNString</a> dnstr(dn, len);</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;  <a class="code" href="classwangle_1_1SSLContextManager.html#aa8206a43cba93d2fad0d211445af5de7">insertIntoDnMap</a>(SSLContextKey(dnstr, certCrypto), sslCtx, <span class="keyword">true</span>, contexts);</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;  <span class="keywordflow">if</span> (certCrypto != <a class="code" href="namespacewangle.html#a01fda0dd64d5e2c4e0bd383502aed8e8a29fb96fa8da2ac0386a75e7f65d0f674">CertCrypto::BEST_AVAILABLE</a>) {</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;    <span class="comment">// Note: there&#39;s no partial ordering here (you either get what you request,</span></div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;    <span class="comment">// or you get best available).</span></div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;    VLOG(6) &lt;&lt; <span class="stringliteral">&quot;Attempting insert of weak crypto SSLContext as best available.&quot;</span>;</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;    <a class="code" href="classwangle_1_1SSLContextManager.html#aa8206a43cba93d2fad0d211445af5de7">insertIntoDnMap</a>(</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;        SSLContextKey(dnstr, <a class="code" href="namespacewangle.html#a01fda0dd64d5e2c4e0bd383502aed8e8a29fb96fa8da2ac0386a75e7f65d0f674">CertCrypto::BEST_AVAILABLE</a>),</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;        sslCtx,</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;        <span class="keyword">false</span>,</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;        contexts);</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;  }</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;}</div><div class="ttc" id="namespacewangle_html_a6771940e76a7d99d4030c70f8f6067f6"><div class="ttname"><a href="namespacewangle.html#a6771940e76a7d99d4030c70f8f6067f6">wangle::DNString</a></div><div class="ttdeci">std::basic_string&lt; char, dn_char_traits &gt; DNString</div><div class="ttdef"><b>Definition:</b> <a href="SSLContextSelectionMisc_8h_source.html#l00070">SSLContextSelectionMisc.h:70</a></div></div>
<div class="ttc" id="namespacefolly_html_a058e7b6a45c912b94995f161a02dc669"><div class="ttname"><a href="namespacefolly.html#a058e7b6a45c912b94995f161a02dc669">folly::stringPrintf</a></div><div class="ttdeci">std::string stringPrintf(const char *format,...)</div><div class="ttdef"><b>Definition:</b> <a href="String_8cpp_source.html#l00223">String.cpp:223</a></div></div>
<div class="ttc" id="namespacewangle_html_a01fda0dd64d5e2c4e0bd383502aed8e8a29fb96fa8da2ac0386a75e7f65d0f674"><div class="ttname"><a href="namespacewangle.html#a01fda0dd64d5e2c4e0bd383502aed8e8a29fb96fa8da2ac0386a75e7f65d0f674">wangle::CertCrypto::BEST_AVAILABLE</a></div></div>
<div class="ttc" id="classwangle_1_1SSLContextManager_html_aa8206a43cba93d2fad0d211445af5de7"><div class="ttname"><a href="classwangle_1_1SSLContextManager.html#aa8206a43cba93d2fad0d211445af5de7">wangle::SSLContextManager::insertIntoDnMap</a></div><div class="ttdeci">void insertIntoDnMap(SSLContextKey key, std::shared_ptr&lt; folly::SSLContext &gt; sslCtx, bool overwrite, SslContexts &amp;contexts)</div><div class="ttdef"><b>Definition:</b> <a href="SSLContextManager_8cpp_source.html#l00731">SSLContextManager.cpp:731</a></div></div>
<div class="ttc" id="Conv_8cpp_html_ae1adbce218e7a9d09164012443191d24"><div class="ttname"><a href="Conv_8cpp.html#ae1adbce218e7a9d09164012443191d24">string</a></div><div class="ttdeci">const char * string</div><div class="ttdef"><b>Definition:</b> <a href="Conv_8cpp_source.html#l00212">Conv.cpp:212</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a398f1e79da64bfc03e092e92d4e7d7a6"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void wangle::SSLContextManager::loadCertKeyPairExternal </td>
          <td>(</td>
          <td class="paramtype">const std::shared_ptr&lt; <a class="el" href="classfolly_1_1SSLContext.html">folly::SSLContext</a> &gt; &amp;&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structwangle_1_1SSLContextConfig.html">SSLContextConfig</a> &amp;&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="Conv_8cpp.html#ae1adbce218e7a9d09164012443191d24">std::string</a> &amp;&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="SSLContextManager_8h_source.html#l00174">174</a> of file <a class="el" href="SSLContextManager_8h_source.html">SSLContextManager.h</a>.</p>

<p>References <a class="el" href="namespacefolly.html#a925db14fdb0096fe395f6acc43118f4aa19da7170bea36556dde582519795f3fc">folly::FATAL</a>.</p>

<p>Referenced by <a class="el" href="SSLContextManager_8cpp_source.html#l00248">addSSLContextConfig()</a>.</p>
<div class="fragment"><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;                        {</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    LOG(FATAL) &lt;&lt; <span class="stringliteral">&quot;Unsupported in base SSLContextManager&quot;</span>;</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  }</div></div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aef1a8ca42dcc78eba7c0c126aab5fff6"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void wangle::SSLContextManager::overrideConfiguration </td>
          <td>(</td>
          <td class="paramtype">const std::shared_ptr&lt; <a class="el" href="classfolly_1_1SSLContext.html">folly::SSLContext</a> &gt; &amp;&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structwangle_1_1SSLContextConfig.html">SSLContextConfig</a> &amp;&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="SSLContextManager_8h_source.html#l00181">181</a> of file <a class="el" href="SSLContextManager_8h_source.html">SSLContextManager.h</a>.</p>

<p>Referenced by <a class="el" href="SSLContextManager_8cpp_source.html#l00248">addSSLContextConfig()</a>.</p>
<div class="fragment"><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;                             {}</div></div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a8e8e1dc670932f3809e8c44687f18b3f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void wangle::SSLContextManager::reloadTLSTicketKeys </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="Conv_8cpp.html#ae1adbce218e7a9d09164012443191d24">std::string</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>oldSeeds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="Conv_8cpp.html#ae1adbce218e7a9d09164012443191d24">std::string</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>currentSeeds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="Conv_8cpp.html#ae1adbce218e7a9d09164012443191d24">std::string</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>newSeeds</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="SSLContextManager_8cpp_source.html#l00808">808</a> of file <a class="el" href="SSLContextManager_8cpp_source.html">SSLContextManager.cpp</a>.</p>

<p>References <a class="el" href="SSLContextManager_8h_source.html#l00262">contexts_</a>, and <a class="el" href="SSLContextManager_8h_source.html#l00053">wangle::SSLContextManager::SslContexts::ctxs</a>.</p>
<div class="fragment"><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;                                        {</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;<span class="preprocessor">#ifdef SSL_CTRL_SET_TLSEXT_TICKET_KEY_CB</span></div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; ctx : <a class="code" href="classwangle_1_1SSLContextManager.html#a6bee82aeb26f347ad78a7e04e84cb3e8">contexts_</a>.<a class="code" href="structwangle_1_1SSLContextManager_1_1SslContexts.html#ade1f6e95bc12c6da3ac6b56bac6fa4c1">ctxs</a>) {</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;    <span class="keyword">auto</span> tmgr = ctx-&gt;getTicketManager();</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;    <span class="keywordflow">if</span> (tmgr) {</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;      tmgr-&gt;setTLSTicketKeySeeds(oldSeeds, currentSeeds, newSeeds);</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;    }</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;  }</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;}</div><div class="ttc" id="structwangle_1_1SSLContextManager_1_1SslContexts_html_ade1f6e95bc12c6da3ac6b56bac6fa4c1"><div class="ttname"><a href="structwangle_1_1SSLContextManager_1_1SslContexts.html#ade1f6e95bc12c6da3ac6b56bac6fa4c1">wangle::SSLContextManager::SslContexts::ctxs</a></div><div class="ttdeci">std::vector&lt; std::shared_ptr&lt; ServerSSLContext &gt; &gt; ctxs</div><div class="ttdef"><b>Definition:</b> <a href="SSLContextManager_8h_source.html#l00053">SSLContextManager.h:53</a></div></div>
<div class="ttc" id="classwangle_1_1SSLContextManager_html_a6bee82aeb26f347ad78a7e04e84cb3e8"><div class="ttname"><a href="classwangle_1_1SSLContextManager.html#a6bee82aeb26f347ad78a7e04e84cb3e8">wangle::SSLContextManager::contexts_</a></div><div class="ttdeci">SslContexts contexts_</div><div class="ttdef"><b>Definition:</b> <a href="SSLContextManager_8h_source.html#l00262">SSLContextManager.h:262</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ae1395d3ee7da97c3c324eda06e5c7f05"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void wangle::SSLContextManager::resetSSLContextConfigs </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="structwangle_1_1SSLContextConfig.html">SSLContextConfig</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>ctxConfig</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structwangle_1_1SSLCacheOptions.html">SSLCacheOptions</a> &amp;&#160;</td>
          <td class="paramname"><em>cacheOptions</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structwangle_1_1TLSTicketKeySeeds.html">TLSTicketKeySeeds</a> *&#160;</td>
          <td class="paramname"><em>ticketSeeds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classfolly_1_1SocketAddress.html">folly::SocketAddress</a> &amp;&#160;</td>
          <td class="paramname"><em>vipAddress</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::shared_ptr&lt; <a class="el" href="classwangle_1_1SSLCacheProvider.html">SSLCacheProvider</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>externalCache</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Resets <a class="el" href="classwangle_1_1SSLContextManager.html">SSLContextManager</a> with new X509s</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctxConfigs</td><td>Details of a X509s, private key, password, etc. </td></tr>
    <tr><td class="paramname">cacheOptions</td><td>Options for how to do session caching. </td></tr>
    <tr><td class="paramname">ticketSeeds</td><td>If non-null, the initial ticket key seeds to use. </td></tr>
    <tr><td class="paramname">vipAddress</td><td>Which VIP are the X509(s) used for? It is only for for user friendly log message </td></tr>
    <tr><td class="paramname">externalCache</td><td>Optional external provider for the session cache; may be null </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="SSLContextManager_8cpp_source.html#l00212">212</a> of file <a class="el" href="SSLContextManager_8cpp_source.html">SSLContextManager.cpp</a>.</p>

<p>References <a class="el" href="SSLContextManager_8cpp_source.html#l00248">addSSLContextConfig()</a>, <a class="el" href="SSLContextManager_8h_source.html#l00262">contexts_</a>, <a class="el" href="SSLContextManager_8h_source.html#l00053">wangle::SSLContextManager::SslContexts::ctxs</a>, <a class="el" href="TLSTicketKeySeeds_8h_source.html#l00026">wangle::TLSTicketKeySeeds::currentSeeds</a>, <a class="el" href="TLSTicketKeySeeds_8h_source.html#l00027">wangle::TLSTicketKeySeeds::newSeeds</a>, <a class="el" href="TLSTicketKeySeeds_8h_source.html#l00025">wangle::TLSTicketKeySeeds::oldSeeds</a>, and <a class="el" href="SSLContextManager_8cpp_source.html#l00198">wangle::SSLContextManager::SslContexts::swap()</a>.</p>
<div class="fragment"><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;                                                        {</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  SslContexts contexts;</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;  TLSTicketKeySeeds oldTicketSeeds;</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;  <span class="comment">// This assumes that all ctxs have the same ticket seeds. Which we assume in</span></div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;  <span class="comment">// other places as well</span></div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;  <span class="keywordflow">if</span> (!ticketSeeds) {</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <span class="comment">// find first non null ticket manager and update seeds from it</span></div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; ctx : <a class="code" href="classwangle_1_1SSLContextManager.html#a6bee82aeb26f347ad78a7e04e84cb3e8">contexts_</a>.<a class="code" href="structwangle_1_1SSLContextManager_1_1SslContexts.html#ade1f6e95bc12c6da3ac6b56bac6fa4c1">ctxs</a>) {</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;      <span class="keyword">auto</span> ticketManager = ctx-&gt;getTicketManager();</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;      <span class="keywordflow">if</span> (ticketManager) {</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;        ticketManager-&gt;getTLSTicketKeySeeds(</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;          oldTicketSeeds.oldSeeds,</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;          oldTicketSeeds.currentSeeds,</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;          oldTicketSeeds.newSeeds);</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;      }</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    }</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;  }</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; ctxConfig : ctxConfigs) {</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <a class="code" href="classwangle_1_1SSLContextManager.html#a22ab2d51bcd41f1381f42799046e58a8">addSSLContextConfig</a>(ctxConfig,</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;                        cacheOptions,</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;                        ticketSeeds ? ticketSeeds : &amp;oldTicketSeeds,</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;                        vipAddress,</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;                        externalCache,</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;                        &amp;contexts);</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;  }</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;  <a class="code" href="classwangle_1_1SSLContextManager.html#a6bee82aeb26f347ad78a7e04e84cb3e8">contexts_</a>.<a class="code" href="structwangle_1_1SSLContextManager_1_1SslContexts.html#ab468553d93f122ee153bca7dc4a62b9c">swap</a>(contexts);</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;}</div><div class="ttc" id="structwangle_1_1SSLContextManager_1_1SslContexts_html_ade1f6e95bc12c6da3ac6b56bac6fa4c1"><div class="ttname"><a href="structwangle_1_1SSLContextManager_1_1SslContexts.html#ade1f6e95bc12c6da3ac6b56bac6fa4c1">wangle::SSLContextManager::SslContexts::ctxs</a></div><div class="ttdeci">std::vector&lt; std::shared_ptr&lt; ServerSSLContext &gt; &gt; ctxs</div><div class="ttdef"><b>Definition:</b> <a href="SSLContextManager_8h_source.html#l00053">SSLContextManager.h:53</a></div></div>
<div class="ttc" id="classwangle_1_1SSLContextManager_html_a22ab2d51bcd41f1381f42799046e58a8"><div class="ttname"><a href="classwangle_1_1SSLContextManager.html#a22ab2d51bcd41f1381f42799046e58a8">wangle::SSLContextManager::addSSLContextConfig</a></div><div class="ttdeci">void addSSLContextConfig(const SSLContextConfig &amp;ctxConfig, const SSLCacheOptions &amp;cacheOptions, const TLSTicketKeySeeds *ticketSeeds, const folly::SocketAddress &amp;vipAddress, const std::shared_ptr&lt; SSLCacheProvider &gt; &amp;externalCache, SslContexts *contexts=nullptr)</div><div class="ttdef"><b>Definition:</b> <a href="SSLContextManager_8cpp_source.html#l00248">SSLContextManager.cpp:248</a></div></div>
<div class="ttc" id="structwangle_1_1SSLContextManager_1_1SslContexts_html_ab468553d93f122ee153bca7dc4a62b9c"><div class="ttname"><a href="structwangle_1_1SSLContextManager_1_1SslContexts.html#ab468553d93f122ee153bca7dc4a62b9c">wangle::SSLContextManager::SslContexts::swap</a></div><div class="ttdeci">void swap(SslContexts &amp;other) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="SSLContextManager_8cpp_source.html#l00198">SSLContextManager.cpp:198</a></div></div>
<div class="ttc" id="classwangle_1_1SSLContextManager_html_a6bee82aeb26f347ad78a7e04e84cb3e8"><div class="ttname"><a href="classwangle_1_1SSLContextManager.html#a6bee82aeb26f347ad78a7e04e84cb3e8">wangle::SSLContextManager::contexts_</a></div><div class="ttdeci">SslContexts contexts_</div><div class="ttdef"><b>Definition:</b> <a href="SSLContextManager_8h_source.html#l00262">SSLContextManager.h:262</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a96070fefe3ad874e61530d5f98e5da84"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void wangle::SSLContextManager::setClientHelloExtStats </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classwangle_1_1ClientHelloExtStats.html">ClientHelloExtStats</a> *&#160;</td>
          <td class="paramname"><em>stats</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p><a class="el" href="classwangle_1_1SSLContextManager.html">SSLContextManager</a> only collects SNI stats now </p>

<p>Definition at line <a class="el" href="SSLContextManager_8h_source.html#l00165">165</a> of file <a class="el" href="SSLContextManager_8h_source.html">SSLContextManager.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;                                                          {</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <a class="code" href="classwangle_1_1SSLContextManager.html#a507d445a8f73c0894901fbd5baec5c03">clientHelloTLSExtStats_</a> = stats;</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  }</div><div class="ttc" id="classwangle_1_1SSLContextManager_html_a507d445a8f73c0894901fbd5baec5c03"><div class="ttname"><a href="classwangle_1_1SSLContextManager.html#a507d445a8f73c0894901fbd5baec5c03">wangle::SSLContextManager::clientHelloTLSExtStats_</a></div><div class="ttdeci">ClientHelloExtStats * clientHelloTLSExtStats_</div><div class="ttdef"><b>Definition:</b> <a href="SSLContextManager_8h_source.html#l00264">SSLContextManager.h:264</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a5ee5d82be194cf03268318ec3e4a91a3"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void wangle::SSLContextManager::setClientVerifyCallback </td>
          <td>(</td>
          <td class="paramtype">std::unique_ptr&lt; <a class="el" href="structwangle_1_1SSLContextManager_1_1ClientCertVerifyCallback.html">ClientCertVerifyCallback</a> &gt;&#160;</td>
          <td class="paramname"><em>cb</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="SSLContextManager_8h_source.html#l00169">169</a> of file <a class="el" href="SSLContextManager_8h_source.html">SSLContextManager.h</a>.</p>

<p>References <a class="el" href="Base-inl_8h_source.html#l02567">folly::gen::move</a>.</p>
<div class="fragment"><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;                                                                           {</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        <a class="code" href="classwangle_1_1SSLContextManager.html#af121e0ab9eed826021009f27708985f2">clientCertVerifyCallback_</a> = <a class="code" href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">std::move</a>(cb);</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  }</div><div class="ttc" id="namespacefolly_1_1gen_html_ac24ec252b1b738a40c274285527c193f"><div class="ttname"><a href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">folly::gen::move</a></div><div class="ttdeci">constexpr detail::Map&lt; Move &gt; move</div><div class="ttdef"><b>Definition:</b> <a href="Base-inl_8h_source.html#l02567">Base-inl.h:2567</a></div></div>
<div class="ttc" id="classwangle_1_1SSLContextManager_html_af121e0ab9eed826021009f27708985f2"><div class="ttname"><a href="classwangle_1_1SSLContextManager.html#af121e0ab9eed826021009f27708985f2">wangle::SSLContextManager::clientCertVerifyCallback_</a></div><div class="ttdeci">std::unique_ptr&lt; ClientCertVerifyCallback &gt; clientCertVerifyCallback_</div><div class="ttdef"><b>Definition:</b> <a href="SSLContextManager_8h_source.html#l00267">SSLContextManager.h:267</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ab1a849b51eb1677315635ec9242558b0"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void wangle::SSLContextManager::setSSLStats </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classwangle_1_1SSLStats.html">SSLStats</a> *&#160;</td>
          <td class="paramname"><em>stats</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="SSLContextManager_8h_source.html#l00158">158</a> of file <a class="el" href="SSLContextManager_8h_source.html">SSLContextManager.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;                                    {</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <a class="code" href="classwangle_1_1SSLContextManager.html#a415d4b68d3ac7e819af2a38a8cef91b5">stats_</a> = stats;</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  }</div><div class="ttc" id="classwangle_1_1SSLContextManager_html_a415d4b68d3ac7e819af2a38a8cef91b5"><div class="ttname"><a href="classwangle_1_1SSLContextManager.html#a415d4b68d3ac7e819af2a38a8cef91b5">wangle::SSLContextManager::stats_</a></div><div class="ttdeci">SSLStats * stats_</div><div class="ttdef"><b>Definition:</b> <a href="SSLContextManager_8h_source.html#l00186">SSLContextManager.h:186</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="af121e0ab9eed826021009f27708985f2"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt;<a class="el" href="structwangle_1_1SSLContextManager_1_1ClientCertVerifyCallback.html">ClientCertVerifyCallback</a>&gt; wangle::SSLContextManager::clientCertVerifyCallback_ {<a class="el" href="http__parser__cpp_8cpp.html#ab979d9d4b4923f7c54d6caa6e1a61936">nullptr</a>}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="SSLContextManager_8h_source.html#l00267">267</a> of file <a class="el" href="SSLContextManager_8h_source.html">SSLContextManager.h</a>.</p>

<p>Referenced by <a class="el" href="SSLContextManager_8cpp_source.html#l00248">addSSLContextConfig()</a>.</p>

</div>
</div>
<a class="anchor" id="a507d445a8f73c0894901fbd5baec5c03"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classwangle_1_1ClientHelloExtStats.html">ClientHelloExtStats</a>* wangle::SSLContextManager::clientHelloTLSExtStats_ {<a class="el" href="http__parser__cpp_8cpp.html#ab979d9d4b4923f7c54d6caa6e1a61936">nullptr</a>}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="SSLContextManager_8h_source.html#l00264">264</a> of file <a class="el" href="SSLContextManager_8h_source.html">SSLContextManager.h</a>.</p>

<p>Referenced by <a class="el" href="SSLContextManager_8cpp_source.html#l00248">addSSLContextConfig()</a>.</p>

</div>
</div>
<a class="anchor" id="a6bee82aeb26f347ad78a7e04e84cb3e8"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structwangle_1_1SSLContextManager_1_1SslContexts.html">SslContexts</a> wangle::SSLContextManager::contexts_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="SSLContextManager_8h_source.html#l00262">262</a> of file <a class="el" href="SSLContextManager_8h_source.html">SSLContextManager.h</a>.</p>

<p>Referenced by <a class="el" href="SSLContextManager_8cpp_source.html#l00248">addSSLContextConfig()</a>, <a class="el" href="SSLContextManager_8cpp_source.html#l00751">clear()</a>, <a class="el" href="SSLContextManager_8cpp_source.html#l00803">getDefaultSSLCtx()</a>, <a class="el" href="SSLContextManager_8cpp_source.html#l00788">getSSLCtxByExactDomain()</a>, <a class="el" href="SSLContextManager_8cpp_source.html#l00766">getSSLCtxBySuffix()</a>, <a class="el" href="SSLContextManager_8cpp_source.html#l00808">reloadTLSTicketKeys()</a>, and <a class="el" href="SSLContextManager_8cpp_source.html#l00212">resetSSLContextConfigs()</a>.</p>

</div>
</div>
<a class="anchor" id="a7f2a5474b57491e9c9566c92e0ba7153"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classfolly_1_1EventBase.html">folly::EventBase</a>* wangle::SSLContextManager::eventBase_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="SSLContextManager_8h_source.html#l00263">263</a> of file <a class="el" href="SSLContextManager_8h_source.html">SSLContextManager.h</a>.</p>

</div>
</div>
<a class="anchor" id="a58d55c34d6693073b0560646a8c96d9e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structwangle_1_1SSLContextConfig.html#aab527b353106f846710ea51423fb8ea3">SSLContextConfig::SNINoMatchFn</a> wangle::SSLContextManager::noMatchFn_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="SSLContextManager_8h_source.html#l00265">265</a> of file <a class="el" href="SSLContextManager_8h_source.html">SSLContextManager.h</a>.</p>

<p>Referenced by <a class="el" href="SSLContextManager_8cpp_source.html#l00248">addSSLContextConfig()</a>, and <a class="el" href="SSLContextManager_8cpp_source.html#l00526">ctxSetupByOpensslFeature()</a>.</p>

</div>
</div>
<a class="anchor" id="a415d4b68d3ac7e819af2a38a8cef91b5"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classwangle_1_1SSLStats.html">SSLStats</a>* wangle::SSLContextManager::stats_ {<a class="el" href="http__parser__cpp_8cpp.html#ab979d9d4b4923f7c54d6caa6e1a61936">nullptr</a>}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="SSLContextManager_8h_source.html#l00186">186</a> of file <a class="el" href="SSLContextManager_8h_source.html">SSLContextManager.h</a>.</p>

<p>Referenced by <a class="el" href="SSLContextManager_8cpp_source.html#l00248">addSSLContextConfig()</a>.</p>

</div>
</div>
<a class="anchor" id="ad544b66c92f05932105d079b7d357188"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool wangle::SSLContextManager::strict_ {true}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="SSLContextManager_8h_source.html#l00266">266</a> of file <a class="el" href="SSLContextManager_8h_source.html">SSLContextManager.h</a>.</p>

<p>Referenced by <a class="el" href="SSLContextManager_8cpp_source.html#l00666">insertSSLCtxByDomainName()</a>.</p>

</div>
</div>
<a class="anchor" id="a2940ce3f798dc56c1a41f7ac06d17d3a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="Conv_8cpp.html#ae1adbce218e7a9d09164012443191d24">std::string</a> wangle::SSLContextManager::vipName_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="SSLContextManager_8h_source.html#l00185">185</a> of file <a class="el" href="SSLContextManager_8h_source.html">SSLContextManager.h</a>.</p>

<p>Referenced by <a class="el" href="SSLContextManager_8cpp_source.html#l00248">addSSLContextConfig()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>proxygen/wangle/wangle/ssl/<a class="el" href="SSLContextManager_8h_source.html">SSLContextManager.h</a></li>
<li>proxygen/wangle/wangle/ssl/<a class="el" href="SSLContextManager_8cpp_source.html">SSLContextManager.cpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacewangle.html">wangle</a></li><li class="navelem"><a class="el" href="classwangle_1_1SSLContextManager.html">SSLContextManager</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
