<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>proxygen: folly::recordio_helpers Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">proxygen
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li class="current"><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="namespaces.html"><span>Namespace&#160;List</span></a></li>
      <li><a href="namespacemembers.html"><span>Namespace&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('namespacefolly_1_1recordio__helpers.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#namespaces">Namespaces</a> &#124;
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">folly::recordio_helpers Namespace Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="namespaces"></a>
Namespaces</h2></td></tr>
<tr class="memitem:namespacefolly_1_1recordio__helpers_1_1recordio__detail"><td class="memItemLeft" align="right" valign="top"> &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefolly_1_1recordio__helpers_1_1recordio__detail.html">recordio_detail</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structfolly_1_1recordio__helpers_1_1RecordInfo.html">RecordInfo</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a2cff394fae2c30873b85f3ab8d1570df"><td class="memItemLeft" align="right" valign="top">constexpr size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefolly_1_1recordio__helpers.html#a2cff394fae2c30873b85f3ab8d1570df">headerSize</a> ()</td></tr>
<tr class="separator:a2cff394fae2c30873b85f3ab8d1570df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a645b6bd1dd25231d6c8523d960bde480"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structfolly_1_1recordio__helpers_1_1RecordInfo.html">RecordInfo</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefolly_1_1recordio__helpers.html#a645b6bd1dd25231d6c8523d960bde480">findRecord</a> (<a class="el" href="namespacefolly.html#a7f61a634c75bc3bb46447ec2b17ff0fe">ByteRange</a> <a class="el" href="namespacefolly.html#a79a54cd1a19a22878c86be5f90a33643">range</a>, <a class="el" href="ConstexprMathBenchmark_8cpp.html#a09a1e304d66d35dd47daffee9731edaa">uint32_t</a> fileId)</td></tr>
<tr class="separator:a645b6bd1dd25231d6c8523d960bde480"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abd944d8ae89fa73c51d1362e6deb1b54"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefolly_1_1recordio__helpers.html#abd944d8ae89fa73c51d1362e6deb1b54">prependHeader</a> (std::unique_ptr&lt; <a class="el" href="classfolly_1_1IOBuf.html">IOBuf</a> &gt; &amp;buf, <a class="el" href="ConstexprMathBenchmark_8cpp.html#a09a1e304d66d35dd47daffee9731edaa">uint32_t</a> fileId)</td></tr>
<tr class="separator:abd944d8ae89fa73c51d1362e6deb1b54"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab2f38d2a8eea14bf7894040934fcaab2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structfolly_1_1recordio__helpers_1_1RecordInfo.html">RecordInfo</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefolly_1_1recordio__helpers.html#ab2f38d2a8eea14bf7894040934fcaab2">validateRecord</a> (<a class="el" href="namespacefolly.html#a7f61a634c75bc3bb46447ec2b17ff0fe">ByteRange</a> <a class="el" href="namespacefolly.html#a79a54cd1a19a22878c86be5f90a33643">range</a>, <a class="el" href="ConstexprMathBenchmark_8cpp.html#a09a1e304d66d35dd47daffee9731edaa">uint32_t</a> fileId)</td></tr>
<tr class="separator:ab2f38d2a8eea14bf7894040934fcaab2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abba5c323d75e78f50410bbba14efb8eb"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structfolly_1_1recordio__helpers_1_1RecordInfo.html">RecordInfo</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefolly_1_1recordio__helpers.html#abba5c323d75e78f50410bbba14efb8eb">findRecord</a> (<a class="el" href="namespacefolly.html#a7f61a634c75bc3bb46447ec2b17ff0fe">ByteRange</a> searchRange, <a class="el" href="namespacefolly.html#a7f61a634c75bc3bb46447ec2b17ff0fe">ByteRange</a> wholeRange, <a class="el" href="ConstexprMathBenchmark_8cpp.html#a09a1e304d66d35dd47daffee9731edaa">uint32_t</a> fileId)</td></tr>
<tr class="separator:abba5c323d75e78f50410bbba14efb8eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a645b6bd1dd25231d6c8523d960bde480"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structfolly_1_1recordio__helpers_1_1RecordInfo.html">RecordInfo</a> folly::recordio_helpers::findRecord </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespacefolly.html#a7f61a634c75bc3bb46447ec2b17ff0fe">ByteRange</a>&#160;</td>
          <td class="paramname"><em>range</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ConstexprMathBenchmark_8cpp.html#a09a1e304d66d35dd47daffee9731edaa">uint32_t</a>&#160;</td>
          <td class="paramname"><em>fileId</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Search for the first valid record in range. </p>

<p>Definition at line <a class="el" href="RecordIO-inl_8h_source.html#l00105">105</a> of file <a class="el" href="RecordIO-inl_8h_source.html">RecordIO-inl.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;                                                               {</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacefolly_1_1recordio__helpers.html#a645b6bd1dd25231d6c8523d960bde480">findRecord</a>(<a class="code" href="namespacefolly_1_1gen.html#a5dc95286e63c672f9b60bb9bac6ea476">range</a>, <a class="code" href="namespacefolly_1_1gen.html#a5dc95286e63c672f9b60bb9bac6ea476">range</a>, fileId);</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;}</div><div class="ttc" id="namespacefolly_1_1gen_html_a5dc95286e63c672f9b60bb9bac6ea476"><div class="ttname"><a href="namespacefolly_1_1gen.html#a5dc95286e63c672f9b60bb9bac6ea476">folly::gen::range</a></div><div class="ttdeci">Gen range(Value begin, Value end)</div><div class="ttdef"><b>Definition:</b> <a href="Base_8h_source.html#l00467">Base.h:467</a></div></div>
<div class="ttc" id="namespacefolly_1_1recordio__helpers_html_a645b6bd1dd25231d6c8523d960bde480"><div class="ttname"><a href="namespacefolly_1_1recordio__helpers.html#a645b6bd1dd25231d6c8523d960bde480">folly::recordio_helpers::findRecord</a></div><div class="ttdeci">RecordInfo findRecord(ByteRange range, uint32_t fileId)</div><div class="ttdef"><b>Definition:</b> <a href="RecordIO-inl_8h_source.html#l00105">RecordIO-inl.h:105</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="abba5c323d75e78f50410bbba14efb8eb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structfolly_1_1recordio__helpers_1_1RecordInfo.html">RecordInfo</a> folly::recordio_helpers::findRecord </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespacefolly.html#a7f61a634c75bc3bb46447ec2b17ff0fe">ByteRange</a>&#160;</td>
          <td class="paramname"><em>searchRange</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacefolly.html#a7f61a634c75bc3bb46447ec2b17ff0fe">ByteRange</a>&#160;</td>
          <td class="paramname"><em>wholeRange</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ConstexprMathBenchmark_8cpp.html#a09a1e304d66d35dd47daffee9731edaa">uint32_t</a>&#160;</td>
          <td class="paramname"><em>fileId</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="RecordIO_8cpp_source.html#l00193">193</a> of file <a class="el" href="RecordIO_8cpp_source.html">RecordIO.cpp</a>.</p>

<p>References <a class="el" href="Range_8h_source.html#l00452">folly::Range&lt; Iter &gt;::begin()</a>, <a class="el" href="RecordIO-inl_8h_source.html#l00066">folly::RecordIOReader::end()</a>, <a class="el" href="Range_8h_source.html#l00455">folly::Range&lt; Iter &gt;::end()</a>, <a class="el" href="Range_8h_source.html#l00721">folly::Range&lt; Iter &gt;::find()</a>, <a class="el" href="Dump_8cpp_source.html#l00028">folly::bser::kMagic</a>, <a class="el" href="LogLevel_8cpp_source.html#l00030">min</a>, <a class="el" href="Range_8h_source.html#l00197">folly::Range&lt; const unsigned char * &gt;::npos</a>, <a class="el" href="ParallelBenchmark_8cpp_source.html#l00083">start</a>, <a class="el" href="ConstexprMathBenchmark_8cpp_source.html#l00186">uint32_t</a>, <a class="el" href="ConstexprMathBenchmark_8cpp_source.html#l00178">uint8_t</a>, and <a class="el" href="RecordIO_8cpp_source.html#l00170">validateRecord()</a>.</p>

<p>Referenced by <a class="el" href="RecordIO_8cpp_source.html#l00088">folly::RecordIOReader::Iterator::advanceToValid()</a>.</p>
<div class="fragment"><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                                                                         {</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;  <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="ConstexprMathBenchmark_8cpp.html#a09a1e304d66d35dd47daffee9731edaa">uint32_t</a> magic = <a class="code" href="namespacefolly_1_1bser.html#a1bace4de4e7ba4f4348d6d4e7cf2f211">Header::kMagic</a>;</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;  <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="namespacefolly.html#a7f61a634c75bc3bb46447ec2b17ff0fe">ByteRange</a> magicRange(</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;      reinterpret_cast&lt;const uint8_t*&gt;(&amp;magic), <span class="keyword">sizeof</span>(magic));</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  DCHECK_GE(searchRange.begin(), wholeRange.begin());</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  DCHECK_LE(searchRange.end(), wholeRange.end());</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  <span class="keyword">const</span> <a class="code" href="ConstexprMathBenchmark_8cpp.html#ae1affc9ca37cfb624959c866a73f83c2">uint8_t</a>* <a class="code" href="ParallelBenchmark_8cpp.html#a7f02a749754f40365411f74cf75d08fa">start</a> = searchRange.begin();</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  <span class="keyword">const</span> <a class="code" href="ConstexprMathBenchmark_8cpp.html#ae1affc9ca37cfb624959c866a73f83c2">uint8_t</a>* <a class="code" href="namespacefolly_1_1test.html#a0917528775d48fd53a51907e08c14adf">end</a> =</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;      <a class="code" href="LogLevel_8cpp.html#a7361901234703a521a82885405734c53">std::min</a>(searchRange.end(), wholeRange.end() - <span class="keyword">sizeof</span>(Header));</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  <span class="comment">// end-1: the last place where a Header could start</span></div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  <span class="keywordflow">while</span> (start &lt; end) {</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <span class="keyword">auto</span> p = <a class="code" href="namespacefolly.html#a7f61a634c75bc3bb46447ec2b17ff0fe">ByteRange</a>(start, end + <span class="keyword">sizeof</span>(magic)).<a class="code" href="classfolly_1_1Range.html#a68f61672432bf9e0f035092b0fefd8c0">find</a>(magicRange);</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <span class="keywordflow">if</span> (p == ByteRange::npos) {</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    }</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    start += p;</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <span class="keyword">auto</span> r = <a class="code" href="namespacefolly_1_1recordio__helpers.html#ab2f38d2a8eea14bf7894040934fcaab2">validateRecord</a>(<a class="code" href="namespacefolly.html#a7f61a634c75bc3bb46447ec2b17ff0fe">ByteRange</a>(start, wholeRange.end()), fileId);</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <span class="keywordflow">if</span> (!r.record.empty()) {</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;      <span class="keywordflow">return</span> r;</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    }</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <span class="comment">// No repeated prefix in magic, so we can do better than start++</span></div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    start += <span class="keyword">sizeof</span>(magic);</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  }</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;  <span class="keywordflow">return</span> {0, {}};</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;}</div><div class="ttc" id="classfolly_1_1Range_html_a68f61672432bf9e0f035092b0fefd8c0"><div class="ttname"><a href="classfolly_1_1Range.html#a68f61672432bf9e0f035092b0fefd8c0">folly::Range::find</a></div><div class="ttdeci">size_type find(const_range_type str) const </div><div class="ttdef"><b>Definition:</b> <a href="Range_8h_source.html#l00721">Range.h:721</a></div></div>
<div class="ttc" id="namespacefolly_1_1recordio__helpers_html_ab2f38d2a8eea14bf7894040934fcaab2"><div class="ttname"><a href="namespacefolly_1_1recordio__helpers.html#ab2f38d2a8eea14bf7894040934fcaab2">folly::recordio_helpers::validateRecord</a></div><div class="ttdeci">RecordInfo validateRecord(ByteRange range, uint32_t fileId)</div><div class="ttdef"><b>Definition:</b> <a href="RecordIO_8cpp_source.html#l00170">RecordIO.cpp:170</a></div></div>
<div class="ttc" id="LogLevel_8cpp_html_a7361901234703a521a82885405734c53"><div class="ttname"><a href="LogLevel_8cpp.html#a7361901234703a521a82885405734c53">min</a></div><div class="ttdeci">LogLevel min</div><div class="ttdef"><b>Definition:</b> <a href="LogLevel_8cpp_source.html#l00030">LogLevel.cpp:30</a></div></div>
<div class="ttc" id="namespacefolly_1_1test_html_a0917528775d48fd53a51907e08c14adf"><div class="ttname"><a href="namespacefolly_1_1test.html#a0917528775d48fd53a51907e08c14adf">folly::test::end</a></div><div class="ttdeci">auto end(TestAdlIterable &amp;instance)</div><div class="ttdef"><b>Definition:</b> <a href="ForeachTest_8cpp_source.html#l00062">ForeachTest.cpp:62</a></div></div>
<div class="ttc" id="ConstexprMathBenchmark_8cpp_html_ae1affc9ca37cfb624959c866a73f83c2"><div class="ttname"><a href="ConstexprMathBenchmark_8cpp.html#ae1affc9ca37cfb624959c866a73f83c2">uint8_t</a></div><div class="ttdeci">uint8_t</div><div class="ttdef"><b>Definition:</b> <a href="ConstexprMathBenchmark_8cpp_source.html#l00178">ConstexprMathBenchmark.cpp:178</a></div></div>
<div class="ttc" id="ParallelBenchmark_8cpp_html_a7f02a749754f40365411f74cf75d08fa"><div class="ttname"><a href="ParallelBenchmark_8cpp.html#a7f02a749754f40365411f74cf75d08fa">start</a></div><div class="ttdeci">auto start</div><div class="ttdef"><b>Definition:</b> <a href="ParallelBenchmark_8cpp_source.html#l00083">ParallelBenchmark.cpp:83</a></div></div>
<div class="ttc" id="namespacefolly_html_a7f61a634c75bc3bb46447ec2b17ff0fe"><div class="ttname"><a href="namespacefolly.html#a7f61a634c75bc3bb46447ec2b17ff0fe">folly::ByteRange</a></div><div class="ttdeci">Range&lt; const unsigned char * &gt; ByteRange</div><div class="ttdef"><b>Definition:</b> <a href="Range_8h_source.html#l01163">Range.h:1163</a></div></div>
<div class="ttc" id="ConstexprMathBenchmark_8cpp_html_a09a1e304d66d35dd47daffee9731edaa"><div class="ttname"><a href="ConstexprMathBenchmark_8cpp.html#a09a1e304d66d35dd47daffee9731edaa">uint32_t</a></div><div class="ttdeci">uint32_t</div><div class="ttdef"><b>Definition:</b> <a href="ConstexprMathBenchmark_8cpp_source.html#l00186">ConstexprMathBenchmark.cpp:186</a></div></div>
<div class="ttc" id="namespacefolly_1_1bser_html_a1bace4de4e7ba4f4348d6d4e7cf2f211"><div class="ttname"><a href="namespacefolly_1_1bser.html#a1bace4de4e7ba4f4348d6d4e7cf2f211">folly::bser::kMagic</a></div><div class="ttdeci">const uint8_t kMagic[2]</div><div class="ttdef"><b>Definition:</b> <a href="Dump_8cpp_source.html#l00028">Dump.cpp:28</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a2cff394fae2c30873b85f3ab8d1570df"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">constexpr size_t folly::recordio_helpers::headerSize </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Header size. </p>

<p>Definition at line <a class="el" href="RecordIO-inl_8h_source.html#l00101">101</a> of file <a class="el" href="RecordIO-inl_8h_source.html">RecordIO-inl.h</a>.</p>

<p>Referenced by <a class="el" href="RecordIO_8cpp_source.html#l00088">folly::RecordIOReader::Iterator::advanceToValid()</a>, <a class="el" href="StaticTracepointTest_8cpp_source.html#l00170">getTracepointArguments()</a>, <a class="el" href="RecordIO-inl_8h_source.html#l00043">folly::RecordIOReader::Iterator::increment()</a>, <a class="el" href="HTTP1xCodecTest_8cpp_source.html#l00031">HTTP1xCodecCallback::onHeadersComplete()</a>, <a class="el" href="RecordIO_8cpp_source.html#l00139">prependHeader()</a>, <a class="el" href="RecordIOTest_8cpp_source.html#l00163">folly::test::TEST()</a>, and <a class="el" href="RecordIO_8cpp_source.html#l00170">validateRecord()</a>.</p>
<div class="fragment"><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;                              {</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">sizeof</span>(recordio_detail::Header);</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;}</div></div><!-- fragment -->
</div>
</div>
<a class="anchor" id="abd944d8ae89fa73c51d1362e6deb1b54"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t folly::recordio_helpers::prependHeader </td>
          <td>(</td>
          <td class="paramtype">std::unique_ptr&lt; <a class="el" href="classfolly_1_1IOBuf.html">IOBuf</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ConstexprMathBenchmark_8cpp.html#a09a1e304d66d35dd47daffee9731edaa">uint32_t</a>&#160;</td>
          <td class="paramname"><em>fileId</em> = <code>1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Write a header in the buffer. We will prepend the header to the front of the chain. Do not write the buffer if empty (we don't allow empty records). Returns the total length, including header (0 if empty) (same as buf-&gt;computeChainDataLength(), but likely faster)</p>
<p>The fileId should be unique per stream and allows you to have RecordIO headers stored inside the data (for example, have an entire RecordIO file stored as a record inside another RecordIO file). The fileId may not be 0. </p>

<p>Definition at line <a class="el" href="RecordIO_8cpp_source.html#l00139">139</a> of file <a class="el" href="RecordIO_8cpp_source.html">RecordIO.cpp</a>.</p>

<p>References <a class="el" href="OptionalTest_8cpp_source.html#l00053">b</a>, <a class="el" href="IOBuf_8cpp_source.html#l00229">folly::IOBuf::create()</a>, <a class="el" href="RecordIO-inl_8h_source.html#l00101">headerSize()</a>, <a class="el" href="Dump_8cpp_source.html#l00028">folly::bser::kMagic</a>, <a class="el" href="Base-inl_8h_source.html#l02567">folly::gen::move</a>, and <a class="el" href="ConstexprMathBenchmark_8cpp_source.html#l00186">uint32_t</a>.</p>

<p>Referenced by <a class="el" href="RecordIO_8cpp_source.html#l00048">folly::RecordIOWriter::write()</a>.</p>
<div class="fragment"><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;                                                                 {</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  <span class="keywordflow">if</span> (fileId == 0) {</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <span class="keywordflow">throw</span> std::invalid_argument(<span class="stringliteral">&quot;invalid file id&quot;</span>);</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  }</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  <span class="keyword">auto</span> lengthAndHash = dataLengthAndHash(buf.get());</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  <span class="keywordflow">if</span> (lengthAndHash.first == 0) {</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <span class="keywordflow">return</span> 0; <span class="comment">// empty, nothing to do, no zero-length records</span></div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  }</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  <span class="comment">// Prepend to the first buffer in the chain if we have room, otherwise</span></div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  <span class="comment">// prepend a new buffer.</span></div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  <span class="keywordflow">if</span> (buf-&gt;headroom() &gt;= <a class="code" href="namespacefolly_1_1recordio__helpers.html#a2cff394fae2c30873b85f3ab8d1570df">headerSize</a>()) {</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    buf-&gt;unshareOne();</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    buf-&gt;prepend(<a class="code" href="namespacefolly_1_1recordio__helpers.html#a2cff394fae2c30873b85f3ab8d1570df">headerSize</a>());</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <span class="keyword">auto</span> <a class="code" href="OptionalTest_8cpp.html#a9c67fe724294816aca4adddf8255fece">b</a> = IOBuf::create(<a class="code" href="namespacefolly_1_1recordio__helpers.html#a2cff394fae2c30873b85f3ab8d1570df">headerSize</a>());</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <a class="code" href="OptionalTest_8cpp.html#a9c67fe724294816aca4adddf8255fece">b</a>-&gt;append(<a class="code" href="namespacefolly_1_1recordio__helpers.html#a2cff394fae2c30873b85f3ab8d1570df">headerSize</a>());</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <a class="code" href="OptionalTest_8cpp.html#a9c67fe724294816aca4adddf8255fece">b</a>-&gt;appendChain(<a class="code" href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">std::move</a>(buf));</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    buf = <a class="code" href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">std::move</a>(<a class="code" href="OptionalTest_8cpp.html#a9c67fe724294816aca4adddf8255fece">b</a>);</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  }</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;  Header* header = <span class="keyword">reinterpret_cast&lt;</span>Header*<span class="keyword">&gt;</span>(buf-&gt;writableData());</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  memset(header, 0, <span class="keyword">sizeof</span>(Header));</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  header-&gt;magic = <a class="code" href="namespacefolly_1_1bser.html#a1bace4de4e7ba4f4348d6d4e7cf2f211">Header::kMagic</a>;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  header-&gt;fileId = fileId;</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  header-&gt;dataLength = <a class="code" href="ConstexprMathBenchmark_8cpp.html#a09a1e304d66d35dd47daffee9731edaa">uint32_t</a>(lengthAndHash.first);</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  header-&gt;dataHash = lengthAndHash.second;</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  header-&gt;headerHash = headerHash(*header);</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  <span class="keywordflow">return</span> lengthAndHash.first + <a class="code" href="namespacefolly_1_1recordio__helpers.html#a2cff394fae2c30873b85f3ab8d1570df">headerSize</a>();</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;}</div><div class="ttc" id="namespacefolly_1_1recordio__helpers_html_a2cff394fae2c30873b85f3ab8d1570df"><div class="ttname"><a href="namespacefolly_1_1recordio__helpers.html#a2cff394fae2c30873b85f3ab8d1570df">folly::recordio_helpers::headerSize</a></div><div class="ttdeci">constexpr size_t headerSize()</div><div class="ttdef"><b>Definition:</b> <a href="RecordIO-inl_8h_source.html#l00101">RecordIO-inl.h:101</a></div></div>
<div class="ttc" id="OptionalTest_8cpp_html_a9c67fe724294816aca4adddf8255fece"><div class="ttname"><a href="OptionalTest_8cpp.html#a9c67fe724294816aca4adddf8255fece">b</a></div><div class="ttdeci">char b</div><div class="ttdef"><b>Definition:</b> <a href="OptionalTest_8cpp_source.html#l00053">OptionalTest.cpp:53</a></div></div>
<div class="ttc" id="namespacefolly_1_1gen_html_ac24ec252b1b738a40c274285527c193f"><div class="ttname"><a href="namespacefolly_1_1gen.html#ac24ec252b1b738a40c274285527c193f">folly::gen::move</a></div><div class="ttdeci">constexpr detail::Map&lt; Move &gt; move</div><div class="ttdef"><b>Definition:</b> <a href="Base-inl_8h_source.html#l02567">Base-inl.h:2567</a></div></div>
<div class="ttc" id="ConstexprMathBenchmark_8cpp_html_a09a1e304d66d35dd47daffee9731edaa"><div class="ttname"><a href="ConstexprMathBenchmark_8cpp.html#a09a1e304d66d35dd47daffee9731edaa">uint32_t</a></div><div class="ttdeci">uint32_t</div><div class="ttdef"><b>Definition:</b> <a href="ConstexprMathBenchmark_8cpp_source.html#l00186">ConstexprMathBenchmark.cpp:186</a></div></div>
<div class="ttc" id="namespacefolly_1_1bser_html_a1bace4de4e7ba4f4348d6d4e7cf2f211"><div class="ttname"><a href="namespacefolly_1_1bser.html#a1bace4de4e7ba4f4348d6d4e7cf2f211">folly::bser::kMagic</a></div><div class="ttdeci">const uint8_t kMagic[2]</div><div class="ttdef"><b>Definition:</b> <a href="Dump_8cpp_source.html#l00028">Dump.cpp:28</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ab2f38d2a8eea14bf7894040934fcaab2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structfolly_1_1recordio__helpers_1_1RecordInfo.html">RecordInfo</a> folly::recordio_helpers::validateRecord </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespacefolly.html#a7f61a634c75bc3bb46447ec2b17ff0fe">ByteRange</a>&#160;</td>
          <td class="paramname"><em>range</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ConstexprMathBenchmark_8cpp.html#a09a1e304d66d35dd47daffee9731edaa">uint32_t</a>&#160;</td>
          <td class="paramname"><em>fileId</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Check if there is a valid record at the beginning of range. Returns the record data (not the header) if the record is valid, <a class="el" href="namespacefolly.html#a7f61a634c75bc3bb46447ec2b17ff0fe">ByteRange()</a> otherwise. </p>

<p>Definition at line <a class="el" href="RecordIO_8cpp_source.html#l00170">170</a> of file <a class="el" href="RecordIO_8cpp_source.html">RecordIO.cpp</a>.</p>

<p>References <a class="el" href="Range_8h_source.html#l00672">folly::Range&lt; Iter &gt;::advance()</a>, <a class="el" href="Range_8h_source.html#l00452">folly::Range&lt; Iter &gt;::begin()</a>, <a class="el" href="RecordIO-inl_8h_source.html#l00101">headerSize()</a>, <a class="el" href="Dump_8cpp_source.html#l00028">folly::bser::kMagic</a>, <a class="el" href="Range_8h_source.html#l00421">folly::Range&lt; Iter &gt;::reset()</a>, and <a class="el" href="Range_8h_source.html#l00431">folly::Range&lt; Iter &gt;::size()</a>.</p>

<p>Referenced by <a class="el" href="RecordIO_8cpp_source.html#l00193">findRecord()</a>.</p>
<div class="fragment"><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;                                                            {</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacefolly_1_1gen.html#a5dc95286e63c672f9b60bb9bac6ea476">range</a>.size() &lt;= <a class="code" href="namespacefolly_1_1recordio__helpers.html#a2cff394fae2c30873b85f3ab8d1570df">headerSize</a>()) { <span class="comment">// records may not be empty</span></div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <span class="keywordflow">return</span> {0, {}};</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  }</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  <span class="keyword">const</span> Header* header = <span class="keyword">reinterpret_cast&lt;</span><span class="keyword">const </span>Header*<span class="keyword">&gt;</span>(<a class="code" href="namespacefolly_1_1gen.html#a5dc95286e63c672f9b60bb9bac6ea476">range</a>.begin());</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  <a class="code" href="namespacefolly_1_1gen.html#a5dc95286e63c672f9b60bb9bac6ea476">range</a>.advance(<span class="keyword">sizeof</span>(Header));</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  <span class="keywordflow">if</span> (header-&gt;magic != <a class="code" href="namespacefolly_1_1bser.html#a1bace4de4e7ba4f4348d6d4e7cf2f211">Header::kMagic</a> || header-&gt;version != 0 ||</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;      header-&gt;hashFunction != 0 || header-&gt;flags != 0 ||</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;      (fileId != 0 &amp;&amp; header-&gt;fileId != fileId) ||</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;      header-&gt;dataLength &gt; <a class="code" href="namespacefolly_1_1gen.html#a5dc95286e63c672f9b60bb9bac6ea476">range</a>.size()) {</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <span class="keywordflow">return</span> {0, {}};</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;  }</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  <span class="keywordflow">if</span> (headerHash(*header) != header-&gt;headerHash) {</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="keywordflow">return</span> {0, {}};</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;  }</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  <a class="code" href="namespacefolly_1_1gen.html#a5dc95286e63c672f9b60bb9bac6ea476">range</a>.reset(<a class="code" href="namespacefolly_1_1gen.html#a5dc95286e63c672f9b60bb9bac6ea476">range</a>.begin(), header-&gt;dataLength);</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  <span class="keywordflow">if</span> (dataHash(<a class="code" href="namespacefolly_1_1gen.html#a5dc95286e63c672f9b60bb9bac6ea476">range</a>) != header-&gt;dataHash) {</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <span class="keywordflow">return</span> {0, {}};</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  }</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  <span class="keywordflow">return</span> {header-&gt;fileId, <a class="code" href="namespacefolly_1_1gen.html#a5dc95286e63c672f9b60bb9bac6ea476">range</a>};</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;}</div><div class="ttc" id="namespacefolly_1_1recordio__helpers_html_a2cff394fae2c30873b85f3ab8d1570df"><div class="ttname"><a href="namespacefolly_1_1recordio__helpers.html#a2cff394fae2c30873b85f3ab8d1570df">folly::recordio_helpers::headerSize</a></div><div class="ttdeci">constexpr size_t headerSize()</div><div class="ttdef"><b>Definition:</b> <a href="RecordIO-inl_8h_source.html#l00101">RecordIO-inl.h:101</a></div></div>
<div class="ttc" id="namespacefolly_1_1gen_html_a5dc95286e63c672f9b60bb9bac6ea476"><div class="ttname"><a href="namespacefolly_1_1gen.html#a5dc95286e63c672f9b60bb9bac6ea476">folly::gen::range</a></div><div class="ttdeci">Gen range(Value begin, Value end)</div><div class="ttdef"><b>Definition:</b> <a href="Base_8h_source.html#l00467">Base.h:467</a></div></div>
<div class="ttc" id="namespacefolly_1_1bser_html_a1bace4de4e7ba4f4348d6d4e7cf2f211"><div class="ttname"><a href="namespacefolly_1_1bser.html#a1bace4de4e7ba4f4348d6d4e7cf2f211">folly::bser::kMagic</a></div><div class="ttdeci">const uint8_t kMagic[2]</div><div class="ttdef"><b>Definition:</b> <a href="Dump_8cpp_source.html#l00028">Dump.cpp:28</a></div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacefolly.html">folly</a></li><li class="navelem"><a class="el" href="namespacefolly_1_1recordio__helpers.html">recordio_helpers</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
